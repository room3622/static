(function(){var n=this,t=n._,r={},e=Array.prototype,u=Object.prototype,i=Function.prototype,a=e.push,o=e.slice,c=e.concat,l=u.toString,f=u.hasOwnProperty,s=e.forEach,p=e.map,h=e.reduce,v=e.reduceRight,g=e.filter,d=e.every,m=e.some,y=e.indexOf,b=e.lastIndexOf,x=Array.isArray,w=Object.keys,_=i.bind,j=function(n){return n instanceof j?n:this instanceof j?void(this._wrapped=n):new j(n)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=j),exports._=j):n._=j,j.VERSION="1.6.0";var A=j.each=j.forEach=function(n,t,e){if(null==n)return n;if(s&&n.forEach===s)n.forEach(t,e);else if(n.length===+n.length){for(var u=0,i=n.length;i>u;u++)if(t.call(e,n[u],u,n)===r)return}else for(var a=j.keys(n),u=0,i=a.length;i>u;u++)if(t.call(e,n[a[u]],a[u],n)===r)return;return n};j.map=j.collect=function(n,t,r){var e=[];return null==n?e:p&&n.map===p?n.map(t,r):(A(n,function(n,u,i){e.push(t.call(r,n,u,i))}),e)};var O="Reduce of empty array with no initial value";j.reduce=j.foldl=j.inject=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),h&&n.reduce===h)return e&&(t=j.bind(t,e)),u?n.reduce(t,r):n.reduce(t);if(A(n,function(n,i,a){u?r=t.call(e,r,n,i,a):(r=n,u=!0)}),!u)throw new TypeError(O);return r},j.reduceRight=j.foldr=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),v&&n.reduceRight===v)return e&&(t=j.bind(t,e)),u?n.reduceRight(t,r):n.reduceRight(t);var i=n.length;if(i!==+i){var a=j.keys(n);i=a.length}if(A(n,function(o,c,l){c=a?a[--i]:--i,u?r=t.call(e,r,n[c],c,l):(r=n[c],u=!0)}),!u)throw new TypeError(O);return r},j.find=j.detect=function(n,t,r){var e;return k(n,function(n,u,i){return t.call(r,n,u,i)?(e=n,!0):void 0}),e},j.filter=j.select=function(n,t,r){var e=[];return null==n?e:g&&n.filter===g?n.filter(t,r):(A(n,function(n,u,i){t.call(r,n,u,i)&&e.push(n)}),e)},j.reject=function(n,t,r){return j.filter(n,function(n,e,u){return!t.call(r,n,e,u)},r)},j.every=j.all=function(n,t,e){t||(t=j.identity);var u=!0;return null==n?u:d&&n.every===d?n.every(t,e):(A(n,function(n,i,a){return(u=u&&t.call(e,n,i,a))?void 0:r}),!!u)};var k=j.some=j.any=function(n,t,e){t||(t=j.identity);var u=!1;return null==n?u:m&&n.some===m?n.some(t,e):(A(n,function(n,i,a){return u||(u=t.call(e,n,i,a))?r:void 0}),!!u)};j.contains=j.include=function(n,t){return null==n?!1:y&&n.indexOf===y?n.indexOf(t)!=-1:k(n,function(n){return n===t})},j.invoke=function(n,t){var r=o.call(arguments,2),e=j.isFunction(t);return j.map(n,function(n){return(e?t:n[t]).apply(n,r)})},j.pluck=function(n,t){return j.map(n,j.property(t))},j.where=function(n,t){return j.filter(n,j.matches(t))},j.findWhere=function(n,t){return j.find(n,j.matches(t))},j.max=function(n,t,r){if(!t&&j.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.max.apply(Math,n);var e=-1/0,u=-1/0;return A(n,function(n,i,a){var o=t?t.call(r,n,i,a):n;o>u&&(e=n,u=o)}),e},j.min=function(n,t,r){if(!t&&j.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.min.apply(Math,n);var e=1/0,u=1/0;return A(n,function(n,i,a){var o=t?t.call(r,n,i,a):n;u>o&&(e=n,u=o)}),e},j.shuffle=function(n){var t,r=0,e=[];return A(n,function(n){t=j.random(r++),e[r-1]=e[t],e[t]=n}),e},j.sample=function(n,t,r){return null==t||r?(n.length!==+n.length&&(n=j.values(n)),n[j.random(n.length-1)]):j.shuffle(n).slice(0,Math.max(0,t))};var E=function(n){return null==n?j.identity:j.isFunction(n)?n:j.property(n)};j.sortBy=function(n,t,r){return t=E(t),j.pluck(j.map(n,function(n,e,u){return{value:n,index:e,criteria:t.call(r,n,e,u)}}).sort(function(n,t){var r=n.criteria,e=t.criteria;if(r!==e){if(r>e||r===void 0)return 1;if(e>r||e===void 0)return-1}return n.index-t.index}),"value")};var F=function(n){return function(t,r,e){var u={};return r=E(r),A(t,function(i,a){var o=r.call(e,i,a,t);n(u,o,i)}),u}};j.groupBy=F(function(n,t,r){j.has(n,t)?n[t].push(r):n[t]=[r]}),j.indexBy=F(function(n,t,r){n[t]=r}),j.countBy=F(function(n,t){j.has(n,t)?n[t]++:n[t]=1}),j.sortedIndex=function(n,t,r,e){r=E(r);for(var u=r.call(e,t),i=0,a=n.length;a>i;){var o=i+a>>>1;r.call(e,n[o])<u?i=o+1:a=o}return i},j.toArray=function(n){return n?j.isArray(n)?o.call(n):n.length===+n.length?j.map(n,j.identity):j.values(n):[]},j.size=function(n){return null==n?0:n.length===+n.length?n.length:j.keys(n).length},j.first=j.head=j.take=function(n,t,r){return null==n?void 0:null==t||r?n[0]:0>t?[]:o.call(n,0,t)},j.initial=function(n,t,r){return o.call(n,0,n.length-(null==t||r?1:t))},j.last=function(n,t,r){return null==n?void 0:null==t||r?n[n.length-1]:o.call(n,Math.max(n.length-t,0))},j.rest=j.tail=j.drop=function(n,t,r){return o.call(n,null==t||r?1:t)},j.compact=function(n){return j.filter(n,j.identity)};var M=function(n,t,r){return t&&j.every(n,j.isArray)?c.apply(r,n):(A(n,function(n){j.isArray(n)||j.isArguments(n)?t?a.apply(r,n):M(n,t,r):r.push(n)}),r)};j.flatten=function(n,t){return M(n,t,[])},j.without=function(n){return j.difference(n,o.call(arguments,1))},j.partition=function(n,t){var r=[],e=[];return A(n,function(n){(t(n)?r:e).push(n)}),[r,e]},j.uniq=j.unique=function(n,t,r,e){j.isFunction(t)&&(e=r,r=t,t=!1);var u=r?j.map(n,r,e):n,i=[],a=[];return A(u,function(r,e){(t?e&&a[a.length-1]===r:j.contains(a,r))||(a.push(r),i.push(n[e]))}),i},j.union=function(){return j.uniq(j.flatten(arguments,!0))},j.intersection=function(n){var t=o.call(arguments,1);return j.filter(j.uniq(n),function(n){return j.every(t,function(t){return j.contains(t,n)})})},j.difference=function(n){var t=c.apply(e,o.call(arguments,1));return j.filter(n,function(n){return!j.contains(t,n)})},j.zip=function(){for(var n=j.max(j.pluck(arguments,"length").concat(0)),t=new Array(n),r=0;n>r;r++)t[r]=j.pluck(arguments,""+r);return t},j.object=function(n,t){if(null==n)return{};for(var r={},e=0,u=n.length;u>e;e++)t?r[n[e]]=t[e]:r[n[e][0]]=n[e][1];return r},j.indexOf=function(n,t,r){if(null==n)return-1;var e=0,u=n.length;if(r){if("number"!=typeof r)return e=j.sortedIndex(n,t),n[e]===t?e:-1;e=0>r?Math.max(0,u+r):r}if(y&&n.indexOf===y)return n.indexOf(t,r);for(;u>e;e++)if(n[e]===t)return e;return-1},j.lastIndexOf=function(n,t,r){if(null==n)return-1;var e=null!=r;if(b&&n.lastIndexOf===b)return e?n.lastIndexOf(t,r):n.lastIndexOf(t);for(var u=e?r:n.length;u--;)if(n[u]===t)return u;return-1},j.range=function(n,t,r){arguments.length<=1&&(t=n||0,n=0),r=arguments[2]||1;for(var e=Math.max(Math.ceil((t-n)/r),0),u=0,i=new Array(e);e>u;)i[u++]=n,n+=r;return i};var R=function(){};j.bind=function(n,t){var r,e;if(_&&n.bind===_)return _.apply(n,o.call(arguments,1));if(!j.isFunction(n))throw new TypeError;return r=o.call(arguments,2),e=function(){if(!(this instanceof e))return n.apply(t,r.concat(o.call(arguments)));R.prototype=n.prototype;var u=new R;R.prototype=null;var i=n.apply(u,r.concat(o.call(arguments)));return Object(i)===i?i:u}},j.partial=function(n){var t=o.call(arguments,1);return function(){for(var r=0,e=t.slice(),u=0,i=e.length;i>u;u++)e[u]===j&&(e[u]=arguments[r++]);for(;r<arguments.length;)e.push(arguments[r++]);return n.apply(this,e)}},j.bindAll=function(n){var t=o.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return A(t,function(t){n[t]=j.bind(n[t],n)}),n},j.memoize=function(n,t){var r={};return t||(t=j.identity),function(){var e=t.apply(this,arguments);return j.has(r,e)?r[e]:r[e]=n.apply(this,arguments)}},j.delay=function(n,t){var r=o.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},t)},j.defer=function(n){return j.delay.apply(j,[n,1].concat(o.call(arguments,1)))},j.throttle=function(n,t,r){var e,u,i,a=null,o=0;r||(r={});var c=function(){o=r.leading===!1?0:j.now(),a=null,i=n.apply(e,u),e=u=null};return function(){var l=j.now();o||r.leading!==!1||(o=l);var f=t-(l-o);return e=this,u=arguments,0>=f?(clearTimeout(a),a=null,o=l,i=n.apply(e,u),e=u=null):a||r.trailing===!1||(a=setTimeout(c,f)),i}},j.debounce=function(n,t,r){var e,u,i,a,o,c=function(){var l=j.now()-a;t>l?e=setTimeout(c,t-l):(e=null,r||(o=n.apply(i,u),i=u=null))};return function(){i=this,u=arguments,a=j.now();var l=r&&!e;return e||(e=setTimeout(c,t)),l&&(o=n.apply(i,u),i=u=null),o}},j.once=function(n){var t,r=!1;return function(){return r?t:(r=!0,t=n.apply(this,arguments),n=null,t)}},j.wrap=function(n,t){return j.partial(t,n)},j.compose=function(){var n=arguments;return function(){for(var t=arguments,r=n.length-1;r>=0;r--)t=[n[r].apply(this,t)];return t[0]}},j.after=function(n,t){return function(){return--n<1?t.apply(this,arguments):void 0}},j.keys=function(n){if(!j.isObject(n))return[];if(w)return w(n);var t=[];for(var r in n)j.has(n,r)&&t.push(r);return t},j.values=function(n){for(var t=j.keys(n),r=t.length,e=new Array(r),u=0;r>u;u++)e[u]=n[t[u]];return e},j.pairs=function(n){for(var t=j.keys(n),r=t.length,e=new Array(r),u=0;r>u;u++)e[u]=[t[u],n[t[u]]];return e},j.invert=function(n){for(var t={},r=j.keys(n),e=0,u=r.length;u>e;e++)t[n[r[e]]]=r[e];return t},j.functions=j.methods=function(n){var t=[];for(var r in n)j.isFunction(n[r])&&t.push(r);return t.sort()},j.extend=function(n){return A(o.call(arguments,1),function(t){if(t)for(var r in t)n[r]=t[r]}),n},j.pick=function(n){var t={},r=c.apply(e,o.call(arguments,1));return A(r,function(r){r in n&&(t[r]=n[r])}),t},j.omit=function(n){var t={},r=c.apply(e,o.call(arguments,1));for(var u in n)j.contains(r,u)||(t[u]=n[u]);return t},j.defaults=function(n){return A(o.call(arguments,1),function(t){if(t)for(var r in t)n[r]===void 0&&(n[r]=t[r])}),n},j.clone=function(n){return j.isObject(n)?j.isArray(n)?n.slice():j.extend({},n):n},j.tap=function(n,t){return t(n),n};var S=function(n,t,r,e){if(n===t)return 0!==n||1/n==1/t;if(null==n||null==t)return n===t;n instanceof j&&(n=n._wrapped),t instanceof j&&(t=t._wrapped);var u=l.call(n);if(u!=l.call(t))return!1;switch(u){case"[object String]":return n==String(t);case"[object Number]":return n!=+n?t!=+t:0==n?1/n==1/t:n==+t;case"[object Date]":case"[object Boolean]":return+n==+t;case"[object RegExp]":return n.source==t.source&&n.global==t.global&&n.multiline==t.multiline&&n.ignoreCase==t.ignoreCase}if("object"!=typeof n||"object"!=typeof t)return!1;for(var i=r.length;i--;)if(r[i]==n)return e[i]==t;var a=n.constructor,o=t.constructor;if(a!==o&&!(j.isFunction(a)&&a instanceof a&&j.isFunction(o)&&o instanceof o)&&"constructor"in n&&"constructor"in t)return!1;r.push(n),e.push(t);var c=0,f=!0;if("[object Array]"==u){if(c=n.length,f=c==t.length)for(;c--&&(f=S(n[c],t[c],r,e)););}else{for(var s in n)if(j.has(n,s)&&(c++,!(f=j.has(t,s)&&S(n[s],t[s],r,e))))break;if(f){for(s in t)if(j.has(t,s)&&!c--)break;f=!c}}return r.pop(),e.pop(),f};j.isEqual=function(n,t){return S(n,t,[],[])},j.isEmpty=function(n){if(null==n)return!0;if(j.isArray(n)||j.isString(n))return 0===n.length;for(var t in n)if(j.has(n,t))return!1;return!0},j.isElement=function(n){return!(!n||1!==n.nodeType)},j.isArray=x||function(n){return"[object Array]"==l.call(n)},j.isObject=function(n){return n===Object(n)},A(["Arguments","Function","String","Number","Date","RegExp"],function(n){j["is"+n]=function(t){return l.call(t)=="[object "+n+"]"}}),j.isArguments(arguments)||(j.isArguments=function(n){return!(!n||!j.has(n,"callee"))}),"function"!=typeof/./&&(j.isFunction=function(n){return"function"==typeof n}),j.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},j.isNaN=function(n){return j.isNumber(n)&&n!=+n},j.isBoolean=function(n){return n===!0||n===!1||"[object Boolean]"==l.call(n)},j.isNull=function(n){return null===n},j.isUndefined=function(n){return n===void 0},j.has=function(n,t){return f.call(n,t)},j.noConflict=function(){return n._=t,this},j.identity=function(n){return n},j.constant=function(n){return function(){return n}},j.property=function(n){return function(t){return t[n]}},j.matches=function(n){return function(t){if(t===n)return!0;for(var r in n)if(n[r]!==t[r])return!1;return!0}},j.times=function(n,t,r){for(var e=Array(Math.max(0,n)),u=0;n>u;u++)e[u]=t.call(r,u);return e},j.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))},j.now=Date.now||function(){return(new Date).getTime()};var T={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};T.unescape=j.invert(T.escape);var I={escape:new RegExp("["+j.keys(T.escape).join("")+"]","g"),unescape:new RegExp("("+j.keys(T.unescape).join("|")+")","g")};j.each(["escape","unescape"],function(n){j[n]=function(t){return null==t?"":(""+t).replace(I[n],function(t){return T[n][t]})}}),j.result=function(n,t){if(null==n)return void 0;var r=n[t];return j.isFunction(r)?r.call(n):r},j.mixin=function(n){A(j.functions(n),function(t){var r=j[t]=n[t];j.prototype[t]=function(){var n=[this._wrapped];return a.apply(n,arguments),z.call(this,r.apply(j,n))}})};var N=0;j.uniqueId=function(n){var t=++N+"";return n?n+t:t},j.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var q=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},D=/\\|'|\r|\n|\t|\u2028|\u2029/g;j.template=function(n,t,r){var e;r=j.defaults({},r,j.templateSettings);var u=new RegExp([(r.escape||q).source,(r.interpolate||q).source,(r.evaluate||q).source].join("|")+"|$","g"),i=0,a="__p+='";n.replace(u,function(t,r,e,u,o){return a+=n.slice(i,o).replace(D,function(n){return"\\"+B[n]}),r&&(a+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'"),e&&(a+="'+\n((__t=("+e+"))==null?'':__t)+\n'"),u&&(a+="';\n"+u+"\n__p+='"),i=o+t.length,t}),a+="';\n",r.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{e=new Function(r.variable||"obj","_",a)}catch(o){throw o.source=a,o}if(t)return e(t,j);var c=function(n){return e.call(this,n,j)};return c.source="function("+(r.variable||"obj")+"){\n"+a+"}",c},j.chain=function(n){return j(n).chain()};var z=function(n){return this._chain?j(n).chain():n};j.mixin(j),A(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var t=e[n];j.prototype[n]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!=n&&"splice"!=n||0!==r.length||delete r[0],z.call(this,r)}}),A(["concat","join","slice"],function(n){var t=e[n];j.prototype[n]=function(){return z.call(this,t.apply(this._wrapped,arguments))}}),j.extend(j.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return j})}).call(this);(function(){(function(e){var n=this||(0,eval)("this"),t=n.document,r=n.navigator,a=n.jQuery,i=n.JSON;(function(e){"function"===typeof require&&"object"===typeof exports&&"object"===typeof module?e(module.exports||exports,require):"function"===typeof define&&define.amd?define(["exports","require"],e):e(n.ko={})})(function(o,u){function c(e,n){return null===e||typeof e in d?e===n:!1}function s(n,t){var r;return function(){r||(r=setTimeout(function(){r=e;n()},t))}}function f(e,n){var t;return function(){clearTimeout(t);t=setTimeout(e,n)}}function l(e,n,t,r){p.d[e]={init:function(e,a,i,o,u){var c,s;p.s(function(){var i=p.a.c(a()),o=!t!==!i,f=!s;if(f||n||o!==c)f&&p.Y.la()&&(s=p.a.ia(p.f.childNodes(e),!0)),o?(f||p.f.T(e,p.a.ia(s)),p.Ca(r?r(u,i):u,e)):p.f.ja(e),c=o},null,{o:e});return{controlsDescendantBindings:!0}}};p.h.ha[e]=!1;p.f.Q[e]=!0}var p="undefined"!==typeof o?o:{};p.b=function(e,n){for(var t=e.split("."),r=p,a=0;a<t.length-1;a++)r=r[t[a]];r[t[t.length-1]]=n};p.A=function(e,n,t){e[n]=t};p.version="3.2.0";p.b("version",p.version);p.a=function(){function o(e,n){for(var t in e)e.hasOwnProperty(t)&&n(t,e[t])}function u(e,n){if(n)for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e}function c(e,n){e.__proto__=n;return e}var s={__proto__:[]}instanceof Array,f={},l={};f[r&&/Firefox\/2/i.test(r.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"];f.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" ");o(f,function(e,n){if(n.length)for(var t=0,r=n.length;t<r;t++)l[n[t]]=e});var d={propertychange:!0},h=t&&function(){for(var n=3,r=t.createElement("div"),a=r.getElementsByTagName("i");r.innerHTML="<!--[if gt IE "+ ++n+"]><i></i><![endif]-->",a[0];);return 4<n?n:e}();return{vb:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],u:function(e,n){for(var t=0,r=e.length;t<r;t++)n(e[t],t)},m:function(e,n){if("function"==typeof Array.prototype.indexOf)return Array.prototype.indexOf.call(e,n);for(var t=0,r=e.length;t<r;t++)if(e[t]===n)return t;return-1},qb:function(e,n,t){for(var r=0,a=e.length;r<a;r++)if(n.call(t,e[r],r))return e[r];return null},ua:function(e,n){var t=p.a.m(e,n);0<t?e.splice(t,1):0===t&&e.shift()},rb:function(e){e=e||[];for(var n=[],t=0,r=e.length;t<r;t++)0>p.a.m(n,e[t])&&n.push(e[t]);return n},Da:function(e,n){e=e||[];for(var t=[],r=0,a=e.length;r<a;r++)t.push(n(e[r],r));return t},ta:function(e,n){e=e||[];for(var t=[],r=0,a=e.length;r<a;r++)n(e[r],r)&&t.push(e[r]);return t},ga:function(e,n){if(n instanceof Array)e.push.apply(e,n);else for(var t=0,r=n.length;t<r;t++)e.push(n[t]);return e},ea:function(e,n,t){var r=p.a.m(p.a.Xa(e),n);0>r?t&&e.push(n):t||e.splice(r,1)},xa:s,extend:u,za:c,Aa:s?c:u,G:o,na:function(e,n){if(!e)return e;var t={},r;for(r in e)e.hasOwnProperty(r)&&(t[r]=n(e[r],r,e));return t},Ka:function(e){for(;e.firstChild;)p.removeNode(e.firstChild)},oc:function(e){e=p.a.S(e);for(var n=t.createElement("div"),r=0,a=e.length;r<a;r++)n.appendChild(p.R(e[r]));return n},ia:function(e,n){for(var t=0,r=e.length,a=[];t<r;t++){var i=e[t].cloneNode(!0);a.push(n?p.R(i):i)}return a},T:function(e,n){p.a.Ka(e);if(n)for(var t=0,r=n.length;t<r;t++)e.appendChild(n[t])},Lb:function(e,n){var t=e.nodeType?[e]:e;if(0<t.length){for(var r=t[0],a=r.parentNode,i=0,o=n.length;i<o;i++)a.insertBefore(n[i],r);i=0;for(o=t.length;i<o;i++)p.removeNode(t[i])}},ka:function(e,n){if(e.length){for(n=8===n.nodeType&&n.parentNode||n;e.length&&e[0].parentNode!==n;)e.shift();if(1<e.length){var t=e[0],r=e[e.length-1];for(e.length=0;t!==r;)if(e.push(t),t=t.nextSibling,!t)return;e.push(r)}}return e},Nb:function(e,n){7>h?e.setAttribute("selected",n):e.selected=n},cb:function(n){return null===n||n===e?"":n.trim?n.trim():n.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},vc:function(e,n){e=e||"";return n.length>e.length?!1:e.substring(0,n.length)===n},cc:function(e,n){if(e===n)return!0;if(11===e.nodeType)return!1;if(n.contains)return n.contains(3===e.nodeType?e.parentNode:e);if(n.compareDocumentPosition)return 16==(n.compareDocumentPosition(e)&16);for(;e&&e!=n;)e=e.parentNode;return!!e},Ja:function(e){return p.a.cc(e,e.ownerDocument.documentElement)},ob:function(e){return!!p.a.qb(e,p.a.Ja)},t:function(e){return e&&e.tagName&&e.tagName.toLowerCase()},n:function(e,n,t){var r=h&&d[n];if(!r&&a)a(e).bind(n,t);else if(r||"function"!=typeof e.addEventListener)if("undefined"!=typeof e.attachEvent){var i=function(n){t.call(e,n)},o="on"+n;e.attachEvent(o,i);p.a.w.da(e,function(){e.detachEvent(o,i)})}else throw Error("Browser doesn't support addEventListener or attachEvent");else e.addEventListener(n,t,!1)},oa:function(e,r){if(!e||!e.nodeType)throw Error("element must be a DOM node when calling triggerEvent");var i;"input"===p.a.t(e)&&e.type&&"click"==r.toLowerCase()?(i=e.type,i="checkbox"==i||"radio"==i):i=!1;if(a&&!i)a(e).trigger(r);else if("function"==typeof t.createEvent)if("function"==typeof e.dispatchEvent)i=t.createEvent(l[r]||"HTMLEvents"),i.initEvent(r,!0,!0,n,0,0,0,0,0,!1,!1,!1,!1,0,e),e.dispatchEvent(i);else throw Error("The supplied element doesn't support dispatchEvent");else if(i&&e.click)e.click();else if("undefined"!=typeof e.fireEvent)e.fireEvent("on"+r);else throw Error("Browser doesn't support triggering events")},c:function(e){return p.C(e)?e():e},Xa:function(e){return p.C(e)?e.v():e},Ba:function(e,n,t){if(n){var r=/\S+/g,a=e.className.match(r)||[];p.a.u(n.match(r),function(e){p.a.ea(a,e,t)});e.className=a.join(" ")}},bb:function(n,t){var r=p.a.c(t);if(null===r||r===e)r="";var a=p.f.firstChild(n);!a||3!=a.nodeType||p.f.nextSibling(a)?p.f.T(n,[n.ownerDocument.createTextNode(r)]):a.data=r;p.a.fc(n)},Mb:function(e,n){e.name=n;if(7>=h)try{e.mergeAttributes(t.createElement("<input name='"+e.name+"'/>"),!1)}catch(r){}},fc:function(e){9<=h&&(e=1==e.nodeType?e:e.parentNode,e.style&&(e.style.zoom=e.style.zoom))},dc:function(e){if(h){var n=e.style.width;e.style.width=0;e.style.width=n}},sc:function(e,n){e=p.a.c(e);n=p.a.c(n);for(var t=[],r=e;r<=n;r++)t.push(r);return t},S:function(e){for(var n=[],t=0,r=e.length;t<r;t++)n.push(e[t]);return n},yc:6===h,zc:7===h,L:h,xb:function(e,n){for(var t=p.a.S(e.getElementsByTagName("input")).concat(p.a.S(e.getElementsByTagName("textarea"))),r="string"==typeof n?function(e){return e.name===n}:function(e){return n.test(e.name)},a=[],i=t.length-1;0<=i;i--)r(t[i])&&a.push(t[i]);return a},pc:function(e){return"string"==typeof e&&(e=p.a.cb(e))?i&&i.parse?i.parse(e):new Function("return "+e)():null},eb:function(e,n,t){if(!i||!i.stringify)throw Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return i.stringify(p.a.c(e),n,t)},qc:function(e,n,r){r=r||{};var a=r.params||{},i=r.includeFields||this.vb,u=e;if("object"==typeof e&&"form"===p.a.t(e))for(var u=e.action,c=i.length-1;0<=c;c--)for(var s=p.a.xb(e,i[c]),f=s.length-1;0<=f;f--)a[s[f].name]=s[f].value;n=p.a.c(n);var l=t.createElement("form");l.style.display="none";l.action=u;l.method="post";for(var d in n)e=t.createElement("input"),e.type="hidden",e.name=d,e.value=p.a.eb(p.a.c(n[d])),l.appendChild(e);o(a,function(e,n){var r=t.createElement("input");r.type="hidden";r.name=e;r.value=n;l.appendChild(r)});t.body.appendChild(l);r.submitter?r.submitter(l):l.submit();setTimeout(function(){l.parentNode.removeChild(l)},0)}}}();p.b("utils",p.a);p.b("utils.arrayForEach",p.a.u);p.b("utils.arrayFirst",p.a.qb);p.b("utils.arrayFilter",p.a.ta);p.b("utils.arrayGetDistinctValues",p.a.rb);p.b("utils.arrayIndexOf",p.a.m);p.b("utils.arrayMap",p.a.Da);p.b("utils.arrayPushAll",p.a.ga);p.b("utils.arrayRemoveItem",p.a.ua);p.b("utils.extend",p.a.extend);p.b("utils.fieldsIncludedWithJsonPost",p.a.vb);p.b("utils.getFormFields",p.a.xb);p.b("utils.peekObservable",p.a.Xa);p.b("utils.postJson",p.a.qc);p.b("utils.parseJson",p.a.pc);p.b("utils.registerEventHandler",p.a.n);p.b("utils.stringifyJson",p.a.eb);p.b("utils.range",p.a.sc);p.b("utils.toggleDomNodeCssClass",p.a.Ba);p.b("utils.triggerEvent",p.a.oa);p.b("utils.unwrapObservable",p.a.c);p.b("utils.objectForEach",p.a.G);p.b("utils.addOrRemoveItem",p.a.ea);p.b("unwrap",p.a.c);Function.prototype.bind||(Function.prototype.bind=function(e){var n=this,t=Array.prototype.slice.call(arguments);e=t.shift();return function(){return n.apply(e,t.concat(Array.prototype.slice.call(arguments)))}});p.a.e=new function(){function n(n,i){var o=n[r];if(!o||"null"===o||!a[o]){if(!i)return e;o=n[r]="ko"+t++;a[o]={}}return a[o]}var t=0,r="__ko__"+(new Date).getTime(),a={};return{get:function(t,r){var a=n(t,!1);return a===e?e:a[r]},set:function(t,r,a){if(a!==e||n(t,!1)!==e)n(t,!0)[r]=a},clear:function(e){var n=e[r];return n?(delete a[n],e[r]=null,!0):!1},F:function(){return t++ +r}}};p.b("utils.domData",p.a.e);p.b("utils.domData.clear",p.a.e.clear);p.a.w=new function(){function n(n,t){var a=p.a.e.get(n,r);a===e&&t&&(a=[],p.a.e.set(n,r,a));return a}function t(e){var r=n(e,!1);if(r)for(var r=r.slice(0),a=0;a<r.length;a++)r[a](e);p.a.e.clear(e);p.a.w.cleanExternalData(e);if(o[e.nodeType])for(r=e.firstChild;e=r;)r=e.nextSibling,8===e.nodeType&&t(e)}var r=p.a.e.F(),i={1:!0,8:!0,9:!0},o={1:!0,9:!0};return{da:function(e,t){if("function"!=typeof t)throw Error("Callback must be a function");n(e,!0).push(t)},Kb:function(t,a){var i=n(t,!1);i&&(p.a.ua(i,a),0==i.length&&p.a.e.set(t,r,e))},R:function(e){if(i[e.nodeType]&&(t(e),o[e.nodeType])){var n=[];p.a.ga(n,e.getElementsByTagName("*"));for(var r=0,a=n.length;r<a;r++)t(n[r])}return e},removeNode:function(e){p.R(e);e.parentNode&&e.parentNode.removeChild(e)},cleanExternalData:function(e){a&&"function"==typeof a.cleanData&&a.cleanData([e])}}};p.R=p.a.w.R;p.removeNode=p.a.w.removeNode;p.b("cleanNode",p.R);p.b("removeNode",p.removeNode);p.b("utils.domNodeDisposal",p.a.w);p.b("utils.domNodeDisposal.addDisposeCallback",p.a.w.da);p.b("utils.domNodeDisposal.removeDisposeCallback",p.a.w.Kb);(function(){p.a.ba=function(e){var r;if(a)if(a.parseHTML)r=a.parseHTML(e)||[];else{if((r=a.clean([e]))&&r[0]){for(e=r[0];e.parentNode&&11!==e.parentNode.nodeType;)e=e.parentNode;e.parentNode&&e.parentNode.removeChild(e)}}else{var i=p.a.cb(e).toLowerCase();r=t.createElement("div");i=i.match(/^<(thead|tbody|tfoot)/)&&[1,"<table>","</table>"]||!i.indexOf("<tr")&&[2,"<table><tbody>","</tbody></table>"]||(!i.indexOf("<td")||!i.indexOf("<th"))&&[3,"<table><tbody><tr>","</tr></tbody></table>"]||[0,"",""];e="ignored<div>"+i[1]+e+i[2]+"</div>";for("function"==typeof n.innerShiv?r.appendChild(n.innerShiv(e)):r.innerHTML=e;i[0]--;)r=r.lastChild;r=p.a.S(r.lastChild.childNodes)}return r};p.a.$a=function(n,t){p.a.Ka(n);t=p.a.c(t);if(null!==t&&t!==e)if("string"!=typeof t&&(t=t.toString()),a)a(n).html(t);else for(var r=p.a.ba(t),i=0;i<r.length;i++)n.appendChild(r[i])}})();p.b("utils.parseHtmlFragment",p.a.ba);p.b("utils.setHtml",p.a.$a);p.D=function(){function n(e,t){if(e)if(8==e.nodeType){var r=p.D.Gb(e.nodeValue);null!=r&&t.push({bc:e,mc:r})}else if(1==e.nodeType)for(var r=0,a=e.childNodes,i=a.length;r<i;r++)n(a[r],t)}var t={};return{Ua:function(e){if("function"!=typeof e)throw Error("You can only pass a function to ko.memoization.memoize()");var n=(4294967296*(1+Math.random())|0).toString(16).substring(1)+(4294967296*(1+Math.random())|0).toString(16).substring(1);t[n]=e;return"<!--[ko_memo:"+n+"]-->"},Rb:function(n,r){var a=t[n];if(a===e)throw Error("Couldn't find any memo with ID "+n+". Perhaps it's already been unmemoized.");try{return a.apply(null,r||[]),!0}finally{delete t[n]}},Sb:function(e,t){var r=[];n(e,r);for(var a=0,i=r.length;a<i;a++){var o=r[a].bc,u=[o];t&&p.a.ga(u,t);p.D.Rb(r[a].mc,u);o.nodeValue="";o.parentNode&&o.parentNode.removeChild(o)}},Gb:function(e){return(e=e.match(/^\[ko_memo\:(.*?)\]$/))?e[1]:null}}}();p.b("memoization",p.D);p.b("memoization.memoize",p.D.Ua);p.b("memoization.unmemoize",p.D.Rb);p.b("memoization.parseMemoText",p.D.Gb);p.b("memoization.unmemoizeDomNodeAndDescendants",p.D.Sb);p.La={throttle:function(e,n){e.throttleEvaluation=n;var t=null;return p.j({read:e,write:function(r){clearTimeout(t);t=setTimeout(function(){e(r)},n)}})},rateLimit:function(e,n){var t,r,a;"number"==typeof n?t=n:(t=n.timeout,r=n.method);a="notifyWhenChangesStop"==r?f:s;e.Ta(function(e){return a(e,t)})},notify:function(e,n){e.equalityComparer="always"==n?null:c}};var d={undefined:1,"boolean":1,number:1,string:1};p.b("extenders",p.La);p.Pb=function(e,n,t){this.target=e;this.wa=n;this.ac=t;this.Cb=!1;p.A(this,"dispose",this.K)};p.Pb.prototype.K=function(){this.Cb=!0;this.ac()};p.P=function(){p.a.Aa(this,p.P.fn);this.M={}};var h="change",b={U:function(e,n,t){var r=this;t=t||h;var a=new p.Pb(r,n?e.bind(n):e,function(){p.a.ua(r.M[t],a);r.nb&&r.nb()});r.va&&r.va(t);r.M[t]||(r.M[t]=[]);r.M[t].push(a);return a},notifySubscribers:function(e,n){n=n||h;if(this.Ab(n))try{p.k.Ea();for(var t=this.M[n].slice(0),r=0,a;a=t[r];++r)a.Cb||a.wa(e)}finally{p.k.end()}},Ta:function(e){var n=this,t=p.C(n),r,a,i;n.qa||(n.qa=n.notifySubscribers,n.notifySubscribers=function(e,t){t&&t!==h?"beforeChange"===t?n.kb(e):n.qa(e,t):n.lb(e)});var o=e(function(){t&&i===n&&(i=n());r=!1;n.Pa(a,i)&&n.qa(a=i)});n.lb=function(e){r=!0;i=e;o()};n.kb=function(e){r||(a=e,n.qa(e,"beforeChange"))}},Ab:function(e){return this.M[e]&&this.M[e].length},yb:function(){var e=0;p.a.G(this.M,function(n,t){e+=t.length});return e},Pa:function(e,n){return!this.equalityComparer||!this.equalityComparer(e,n)},extend:function(e){var n=this;e&&p.a.G(e,function(e,t){var r=p.La[e];"function"==typeof r&&(n=r(n,t)||n)});return n}};p.A(b,"subscribe",b.U);p.A(b,"extend",b.extend);p.A(b,"getSubscriptionsCount",b.yb);p.a.xa&&p.a.za(b,Function.prototype);p.P.fn=b;p.Db=function(e){return null!=e&&"function"==typeof e.U&&"function"==typeof e.notifySubscribers};p.b("subscribable",p.P);p.b("isSubscribable",p.Db);p.Y=p.k=function(){function e(e){t.push(r);r=e}function n(){r=t.pop()}var t=[],r,a=0;return{Ea:e,end:n,Jb:function(e){if(r){if(!p.Db(e))throw Error("Only subscribable things can act as dependencies");r.wa(e,e.Vb||(e.Vb=++a))}},B:function(t,r,a){try{return e(),t.apply(r,a||[])}finally{n()}},la:function(){if(r)return r.s.la()},ma:function(){if(r)return r.ma}}}();p.b("computedContext",p.Y);p.b("computedContext.getDependenciesCount",p.Y.la);p.b("computedContext.isInitial",p.Y.ma);p.b("computedContext.isSleeping",p.Y.Ac);p.p=function(e){function n(){if(0<arguments.length)return n.Pa(t,arguments[0])&&(n.X(),t=arguments[0],n.W()),this;p.k.Jb(n);return t}var t=e;p.P.call(n);p.a.Aa(n,p.p.fn);n.v=function(){return t};n.W=function(){n.notifySubscribers(t)};n.X=function(){n.notifySubscribers(t,"beforeChange")};p.A(n,"peek",n.v);p.A(n,"valueHasMutated",n.W);p.A(n,"valueWillMutate",n.X);return n};p.p.fn={equalityComparer:c};var m=p.p.rc="__ko_proto__";p.p.fn[m]=p.p;p.a.xa&&p.a.za(p.p.fn,p.P.fn);p.Ma=function(n,t){return null===n||n===e||n[m]===e?!1:n[m]===t?!0:p.Ma(n[m],t)};p.C=function(e){return p.Ma(e,p.p)};p.Ra=function(e){return"function"==typeof e&&e[m]===p.p||"function"==typeof e&&e[m]===p.j&&e.hc?!0:!1};p.b("observable",p.p);p.b("isObservable",p.C);p.b("isWriteableObservable",p.Ra);p.b("isWritableObservable",p.Ra);p.aa=function(e){e=e||[];if("object"!=typeof e||!("length"in e))throw Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");e=p.p(e);p.a.Aa(e,p.aa.fn);return e.extend({trackArrayChanges:!0})};p.aa.fn={remove:function(e){for(var n=this.v(),t=[],r="function"!=typeof e||p.C(e)?function(n){return n===e}:e,a=0;a<n.length;a++){var i=n[a];r(i)&&(0===t.length&&this.X(),t.push(i),n.splice(a,1),a--)}t.length&&this.W();return t},removeAll:function(n){if(n===e){var t=this.v(),r=t.slice(0);this.X();t.splice(0,t.length);this.W();return r}return n?this.remove(function(e){return 0<=p.a.m(n,e)}):[]},destroy:function(e){var n=this.v(),t="function"!=typeof e||p.C(e)?function(n){return n===e}:e;this.X();for(var r=n.length-1;0<=r;r--)t(n[r])&&(n[r]._destroy=!0);this.W()},destroyAll:function(n){return n===e?this.destroy(function(){return!0}):n?this.destroy(function(e){return 0<=p.a.m(n,e)}):[]},indexOf:function(e){var n=this();return p.a.m(n,e)},replace:function(e,n){var t=this.indexOf(e);0<=t&&(this.X(),this.v()[t]=n,this.W())}};p.a.u("pop push reverse shift sort splice unshift".split(" "),function(e){p.aa.fn[e]=function(){var n=this.v();this.X();this.sb(n,e,arguments);n=n[e].apply(n,arguments);this.W();return n}});p.a.u(["slice"],function(e){p.aa.fn[e]=function(){var n=this();return n[e].apply(n,arguments)}});p.a.xa&&p.a.za(p.aa.fn,p.p.fn);p.b("observableArray",p.aa);var g="arrayChange";p.La.trackArrayChanges=function(e){function n(){if(!t){t=!0;var n=e.notifySubscribers;e.notifySubscribers=function(e,t){t&&t!==h||++a;return n.apply(this,arguments)};var i=[].concat(e.v()||[]);r=null;e.U(function(n){n=[].concat(n||[]);if(e.Ab(g)){var t;if(!r||1<a)r=p.a.Fa(i,n,{sparse:!0});t=r;t.length&&e.notifySubscribers(t,g)}i=n;r=null;a=0})}}if(!e.sb){var t=!1,r=null,a=0,i=e.U;e.U=e.subscribe=function(e,t,r){r===g&&n();return i.apply(this,arguments)};e.sb=function(e,n,i){function o(e,n,t){return u[u.length]={status:e,value:n,index:t}}if(t&&!a){var u=[],c=e.length,s=i.length,f=0;switch(n){case"push":f=c;case"unshift":for(n=0;n<s;n++)o("added",i[n],f+n);break;case"pop":f=c-1;case"shift":c&&o("deleted",e[f],f);break;case"splice":n=Math.min(Math.max(0,0>i[0]?c+i[0]:i[0]),c);for(var c=1===s?c:Math.min(n+(i[1]||0),c),s=n+s-2,f=Math.max(c,s),l=[],d=[],h=2;n<f;++n,++h)n<c&&d.push(o("deleted",e[n],n)),n<s&&l.push(o("added",i[h],n));p.a.wb(d,l);break;default:return}r=u}}}};p.s=p.j=function(n,t,r){function a(){p.a.G(C,function(e,n){n.K()});C={}}function i(){a();N=0;m=!0;d=!1}function o(){var e=c.throttleEvaluation;e&&0<=e?(clearTimeout(S),S=setTimeout(u,e)):c.ib?c.ib():u()}function u(n){if(h){if(v)throw Error("A 'pure' computed must not be called recursively")}else if(!m){if(E&&E()){if(!b){T();return}}else b=!1;h=!0;if(y)try{var r={};p.k.Ea({wa:function(e,n){r[n]||(r[n]=1,++N)},s:c,ma:e});N=0;l=g.call(t)}finally{p.k.end(),h=!1}else try{var a=C,i=N;p.k.Ea({wa:function(e,n){m||(i&&a[n]?(C[n]=a[n],++N,delete a[n],--i):C[n]||(C[n]=e.U(o),++N))},s:c,ma:v?e:!N});C={};N=0;try{var u=t?g.call(t):g()}finally{p.k.end(),i&&p.a.G(a,function(e,n){n.K()}),d=!1}c.Pa(l,u)&&(c.notifySubscribers(l,"beforeChange"),l=u,!0!==n&&c.notifySubscribers(l))}finally{h=!1}N||T()}}function c(){if(0<arguments.length){if("function"===typeof w)w.apply(t,arguments);else throw Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");return this}p.k.Jb(c);d&&u(!0);return l}function s(){d&&!N&&u(!0);return l}function f(){return d||0<N}var l,d=!0,h=!1,b=!1,m=!1,g=n,v=!1,y=!1;g&&"object"==typeof g?(r=g,g=r.read):(r=r||{},g||(g=r.read));if("function"!=typeof g)throw Error("Pass a function that returns the value of the ko.computed");var w=r.write,x=r.disposeWhenNodeIsRemoved||r.o||null,k=r.disposeWhen||r.Ia,E=k,T=i,C={},N=0,S=null;t||(t=r.owner);p.P.call(c);p.a.Aa(c,p.j.fn);c.v=s;c.la=function(){return N};c.hc="function"===typeof r.write;c.K=function(){T()};c.Z=f;var _=c.Ta;c.Ta=function(e){_.call(c,e);c.ib=function(){c.kb(l);d=!0;c.lb(c)}};r.pure?(y=v=!0,c.va=function(){y&&(y=!1,u(!0))},c.nb=function(){c.yb()||(a(),y=d=!0)}):r.deferEvaluation&&(c.va=function(){s();delete c.va});p.A(c,"peek",c.v);p.A(c,"dispose",c.K);p.A(c,"isActive",c.Z);p.A(c,"getDependenciesCount",c.la);x&&(b=!0,x.nodeType&&(E=function(){return!p.a.Ja(x)||k&&k()}));y||r.deferEvaluation||u();x&&f()&&x.nodeType&&(T=function(){p.a.w.Kb(x,T);i()},p.a.w.da(x,T));return c};p.jc=function(e){return p.Ma(e,p.j)};b=p.p.rc;p.j[b]=p.p;p.j.fn={equalityComparer:c};p.j.fn[b]=p.j;p.a.xa&&p.a.za(p.j.fn,p.P.fn);p.b("dependentObservable",p.j);p.b("computed",p.j);p.b("isComputed",p.jc);p.Ib=function(e,n){if("function"===typeof e)return p.s(e,n,{pure:!0});e=p.a.extend({},e);e.pure=!0;return p.s(e,n)};p.b("pureComputed",p.Ib);(function(){function n(a,i,o){o=o||new r;a=i(a);if("object"!=typeof a||null===a||a===e||a instanceof Date||a instanceof String||a instanceof Number||a instanceof Boolean)return a;var u=a instanceof Array?[]:{};o.save(a,u);t(a,function(t){var r=i(a[t]);switch(typeof r){case"boolean":case"number":case"string":case"function":u[t]=r;break;case"object":case"undefined":var c=o.get(r);u[t]=c!==e?c:n(r,i,o)}});return u}function t(e,n){if(e instanceof Array){for(var t=0;t<e.length;t++)n(t);"function"==typeof e.toJSON&&n("toJSON")}else for(t in e)n(t)}function r(){this.keys=[];this.hb=[]}p.Qb=function(e){if(0==arguments.length)throw Error("When calling ko.toJS, pass the object you want to convert.");return n(e,function(e){for(var n=0;p.C(e)&&10>n;n++)e=e();return e})};p.toJSON=function(e,n,t){e=p.Qb(e);return p.a.eb(e,n,t)};r.prototype={save:function(e,n){var t=p.a.m(this.keys,e);0<=t?this.hb[t]=n:(this.keys.push(e),this.hb.push(n))},get:function(n){n=p.a.m(this.keys,n);return 0<=n?this.hb[n]:e}}})();p.b("toJS",p.Qb);p.b("toJSON",p.toJSON);(function(){p.i={q:function(n){switch(p.a.t(n)){case"option":return!0===n.__ko__hasDomDataOptionValue__?p.a.e.get(n,p.d.options.Va):7>=p.a.L?n.getAttributeNode("value")&&n.getAttributeNode("value").specified?n.value:n.text:n.value;case"select":return 0<=n.selectedIndex?p.i.q(n.options[n.selectedIndex]):e;default:return n.value}},ca:function(n,t,r){switch(p.a.t(n)){case"option":switch(typeof t){case"string":p.a.e.set(n,p.d.options.Va,e);"__ko__hasDomDataOptionValue__"in n&&delete n.__ko__hasDomDataOptionValue__;n.value=t;break;default:p.a.e.set(n,p.d.options.Va,t),n.__ko__hasDomDataOptionValue__=!0,n.value="number"===typeof t?t:""}break;case"select":if(""===t||null===t)t=e;for(var a=-1,i=0,o=n.options.length,u;i<o;++i)if(u=p.i.q(n.options[i]),u==t||""==u&&t===e){a=i;break}if(r||0<=a||t===e&&1<n.size)n.selectedIndex=a;break;default:if(null===t||t===e)t="";n.value=t}}}})();p.b("selectExtensions",p.i);p.b("selectExtensions.readValue",p.i.q);p.b("selectExtensions.writeValue",p.i.ca);p.h=function(){function e(e){e=p.a.cb(e);123===e.charCodeAt(0)&&(e=e.slice(1,-1));var n=[],t=e.match(r),o,u,c=0;if(t){t.push(",");for(var s=0,f;f=t[s];++s){var l=f.charCodeAt(0);if(44===l){if(0>=c){o&&n.push(u?{key:o,value:u.join("")}:{unknown:o});o=u=c=0;continue}}else if(58===l){if(!u)continue}else if(47===l&&s&&1<f.length)(l=t[s-1].match(a))&&!i[l[0]]&&(e=e.substr(e.indexOf(f)+1),t=e.match(r),t.push(","),s=-1,f="/");else if(40===l||123===l||91===l)++c;else if(41===l||125===l||93===l)--c;else if(!o&&!u){o=34===l||39===l?f.slice(1,-1):f;continue}u?u.push(f):u=[f]}}return n}var n=["true","false","null","undefined"],t=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,r=RegExp("\"(?:[^\"\\\\]|\\\\.)*\"|'(?:[^'\\\\]|\\\\.)*'|/(?:[^/\\\\]|\\\\.)*/w*|[^\\s:,/][^,\"'{}()/:[\\]]*[^\\s,\"'{}()/:[\\]]|[^\\s]","g"),a=/[\])"'A-Za-z0-9_$]+$/,i={"in":1,"return":1,"typeof":1},o={};return{ha:[],V:o,Wa:e,ya:function(r,a){function i(e,r){var a;if(!f){var l=p.getBindingHandler(e);if(l&&l.preprocess&&!(r=l.preprocess(r,e,i)))return;if(l=o[e])a=r,0<=p.a.m(n,a)?a=!1:(l=a.match(t),a=null===l?!1:l[1]?"Object("+l[1]+")"+l[2]:a),l=a;l&&c.push("'"+e+"':function(_z){"+a+"=_z}")}s&&(r="function(){return "+r+" }");u.push("'"+e+"':"+r)}a=a||{};var u=[],c=[],s=a.valueAccessors,f=a.bindingParams,l="string"===typeof r?e(r):r;p.a.u(l,function(e){i(e.key||e.unknown,e.value)});c.length&&i("_ko_property_writers","{"+c.join(",")+" }");return u.join(",")},lc:function(e,n){for(var t=0;t<e.length;t++)if(e[t].key==n)return!0;return!1},pa:function(e,n,t,r,a){if(e&&p.C(e))!p.Ra(e)||a&&e.v()===r||e(r);else if((e=n.get("_ko_property_writers"))&&e[t])e[t](r)}}}();p.b("expressionRewriting",p.h);p.b("expressionRewriting.bindingRewriteValidators",p.h.ha);p.b("expressionRewriting.parseObjectLiteral",p.h.Wa);p.b("expressionRewriting.preProcessBindings",p.h.ya);p.b("expressionRewriting._twoWayBindings",p.h.V);p.b("jsonExpressionRewriting",p.h);p.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",p.h.ya);(function(){function e(e){return 8==e.nodeType&&o.test(i?e.text:e.nodeValue)}function n(e){return 8==e.nodeType&&u.test(i?e.text:e.nodeValue)}function r(t,r){for(var a=t,i=1,o=[];a=a.nextSibling;){if(n(a)&&(i--,0===i))return o;o.push(a);e(a)&&i++}if(!r)throw Error("Cannot find closing comment tag to match: "+t.nodeValue);return null}function a(e,n){var t=r(e,n);return t?0<t.length?t[t.length-1].nextSibling:e.nextSibling:null}var i=t&&"<!--test-->"===t.createComment("test").text,o=i?/^\x3c!--\s*ko(?:\s+([\s\S]+))?\s*--\x3e$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,u=i?/^\x3c!--\s*\/ko\s*--\x3e$/:/^\s*\/ko\s*$/,c={ul:!0,ol:!0};p.f={Q:{},childNodes:function(n){return e(n)?r(n):n.childNodes},ja:function(n){if(e(n)){n=p.f.childNodes(n);for(var t=0,r=n.length;t<r;t++)p.removeNode(n[t])}else p.a.Ka(n)},T:function(n,t){if(e(n)){p.f.ja(n);for(var r=n.nextSibling,a=0,i=t.length;a<i;a++)r.parentNode.insertBefore(t[a],r)}else p.a.T(n,t)},Hb:function(n,t){e(n)?n.parentNode.insertBefore(t,n.nextSibling):n.firstChild?n.insertBefore(t,n.firstChild):n.appendChild(t)},Bb:function(n,t,r){r?e(n)?n.parentNode.insertBefore(t,r.nextSibling):r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):p.f.Hb(n,t)},firstChild:function(t){return e(t)?!t.nextSibling||n(t.nextSibling)?null:t.nextSibling:t.firstChild},nextSibling:function(t){e(t)&&(t=a(t));return t.nextSibling&&n(t.nextSibling)?null:t.nextSibling},gc:e,xc:function(e){return(e=(i?e.text:e.nodeValue).match(o))?e[1]:null},Fb:function(t){if(c[p.a.t(t)]){var r=t.firstChild;if(r){do if(1===r.nodeType){var i;i=r.firstChild;var o=null;if(i){do if(o)o.push(i);else if(e(i)){var u=a(i,!0);u?i=u:o=[i]}else n(i)&&(o=[i]);while(i=i.nextSibling)}if(i=o)for(o=r.nextSibling,u=0;u<i.length;u++)o?t.insertBefore(i[u],o):t.appendChild(i[u])}while(r=r.nextSibling)}}}}})();p.b("virtualElements",p.f);p.b("virtualElements.allowedBindings",p.f.Q);p.b("virtualElements.emptyNode",p.f.ja);p.b("virtualElements.insertAfter",p.f.Bb);p.b("virtualElements.prepend",p.f.Hb);p.b("virtualElements.setDomNodeChildren",p.f.T);(function(){p.J=function(){this.Yb={}};p.a.extend(p.J.prototype,{nodeHasBindings:function(e){switch(e.nodeType){case 1:return null!=e.getAttribute("data-bind")||p.g.getComponentNameForNode(e);case 8:return p.f.gc(e);default:return!1}},getBindings:function(e,n){var t=this.getBindingsString(e,n),t=t?this.parseBindingsString(t,n,e):null;return p.g.mb(t,e,n,!1)},getBindingAccessors:function(e,n){var t=this.getBindingsString(e,n),t=t?this.parseBindingsString(t,n,e,{valueAccessors:!0}):null;return p.g.mb(t,e,n,!0)},getBindingsString:function(e){switch(e.nodeType){case 1:return e.getAttribute("data-bind");case 8:return p.f.xc(e);default:return null}},parseBindingsString:function(e,n,t,r){try{var a=this.Yb,i=e+(r&&r.valueAccessors||""),o;if(!(o=a[i])){var u,c="with($context){with($data||{}){return{"+p.h.ya(e,r)+"}}}";u=new Function("$context","$element",c);o=a[i]=u}return o(n,t)}catch(s){throw s.message="Unable to parse bindings.\nBindings value: "+e+"\nMessage: "+s.message,s}}});p.J.instance=new p.J})();p.b("bindingProvider",p.J);(function(){function t(e){return function(){return e}}function r(e){return e()}function i(e){return p.a.na(p.k.B(e),function(n,t){return function(){return e()[t]}})}function o(e,n){return i(this.getBindings.bind(this,e,n))}function u(e,n,t){var r,a=p.f.firstChild(n),i=p.J.instance,o=i.preprocessNode;if(o){for(;r=a;)a=p.f.nextSibling(r),o.call(i,r);a=p.f.firstChild(n)}for(;r=a;)a=p.f.nextSibling(r),c(e,r,t)}function c(e,n,t){var r=!0,a=1===n.nodeType;a&&p.f.Fb(n);if(a&&t||p.J.instance.nodeHasBindings(n))r=f(n,null,e,t).shouldBindDescendants;r&&!d[p.a.t(n)]&&u(e,n,!a)}function s(e){var n=[],t={},r=[];p.a.G(e,function a(i){if(!t[i]){var o=p.getBindingHandler(i);o&&(o.after&&(r.push(i),p.a.u(o.after,function(n){if(e[n]){if(-1!==p.a.m(r,n))throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+r.join(", "));a(n)}}),r.length--),n.push({key:i,zb:o}));t[i]=!0}});return n}function f(n,t,a,i){var u=p.a.e.get(n,h);if(!t){if(u)throw Error("You cannot apply bindings multiple times to the same element.");p.a.e.set(n,h,!0)}!u&&i&&p.Ob(n,a);var c;if(t&&"function"!==typeof t)c=t;else{var f=p.J.instance,l=f.getBindingAccessors||o,d=p.j(function(){(c=t?t(a,n):l.call(f,n,a))&&a.I&&a.I();return c},null,{o:n});c&&d.Z()||(d=null)}var b;if(c){var m=d?function(e){return function(){return r(d()[e])}}:function(e){return c[e]},g=function(){return p.a.na(d?d():c,r)};g.get=function(e){return c[e]&&r(m(e))};g.has=function(e){return e in c};i=s(c);p.a.u(i,function(t){var r=t.zb.init,i=t.zb.update,o=t.key;if(8===n.nodeType&&!p.f.Q[o])throw Error("The binding '"+o+"' cannot be used with virtual elements");try{"function"==typeof r&&p.k.B(function(){var t=r(n,m(o),g,a.$data,a);if(t&&t.controlsDescendantBindings){if(b!==e)throw Error("Multiple bindings ("+b+" and "+o+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");b=o}}),"function"==typeof i&&p.j(function(){i(n,m(o),g,a.$data,a)},null,{o:n})}catch(u){throw u.message='Unable to process binding "'+o+": "+c[o]+'"\nMessage: '+u.message,u}})}return{shouldBindDescendants:b===e}}function l(e){return e&&e instanceof p.N?e:new p.N(e)}p.d={};var d={script:!0};p.getBindingHandler=function(e){return p.d[e]};p.N=function(n,t,r,a){var i=this,o="function"==typeof n&&!p.C(n),u,c=p.j(function(){var e=o?n():n,u=p.a.c(e);t?(t.I&&t.I(),p.a.extend(i,t),c&&(i.I=c)):(i.$parents=[],i.$root=u,i.ko=p);i.$rawData=e;i.$data=u;r&&(i[r]=u);a&&a(i,t,u);return i.$data},null,{Ia:function(){return u&&!p.a.ob(u)},o:!0});c.Z()&&(i.I=c,c.equalityComparer=null,u=[],c.Tb=function(n){u.push(n);p.a.w.da(n,function(n){p.a.ua(u,n);u.length||(c.K(),i.I=c=e)})})};p.N.prototype.createChildContext=function(e,n,t){return new p.N(e,this,n,function(e,n){e.$parentContext=n;e.$parent=n.$data;e.$parents=(n.$parents||[]).slice(0);e.$parents.unshift(e.$parent);t&&t(e)})};p.N.prototype.extend=function(e){return new p.N(this.I||this.$data,this,null,function(n,t){n.$rawData=t.$rawData;p.a.extend(n,"function"==typeof e?e():e)})};var h=p.a.e.F(),b=p.a.e.F();p.Ob=function(e,n){if(2==arguments.length)p.a.e.set(e,b,n),n.I&&n.I.Tb(e);else return p.a.e.get(e,b)};p.ra=function(e,n,t){1===e.nodeType&&p.f.Fb(e);return f(e,n,l(t),!0)};p.Wb=function(e,n,r){r=l(r);return p.ra(e,"function"===typeof n?i(n.bind(null,r,e)):p.a.na(n,t),r)};p.Ca=function(e,n){1!==n.nodeType&&8!==n.nodeType||u(l(e),n,!0)};p.pb=function(e,t){!a&&n.jQuery&&(a=n.jQuery);if(t&&1!==t.nodeType&&8!==t.nodeType)throw Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");t=t||n.document.body;c(l(e),t,!0)};p.Ha=function(n){switch(n.nodeType){case 1:case 8:var t=p.Ob(n);if(t)return t;if(n.parentNode)return p.Ha(n.parentNode)}return e};p.$b=function(n){return(n=p.Ha(n))?n.$data:e};p.b("bindingHandlers",p.d);p.b("applyBindings",p.pb);p.b("applyBindingsToDescendants",p.Ca);p.b("applyBindingAccessorsToNode",p.ra);p.b("applyBindingsToNode",p.Wb);p.b("contextFor",p.Ha);p.b("dataFor",p.$b)})();(function(e){function n(n,r){var o=a.hasOwnProperty(n)?a[n]:e,u;o||(o=a[n]=new p.P,t(n,function(e){i[n]=e;delete a[n];u?o.notifySubscribers(e):setTimeout(function(){o.notifySubscribers(e)},0)}),u=!0);o.U(r)}function t(e,n){r("getConfig",[e],function(t){t?r("loadComponent",[e,t],function(e){n(e)}):n(null)})}function r(n,t,a,i){i||(i=p.g.loaders.slice(0));var o=i.shift();if(o){var u=o[n];if(u){var c=!1;if(u.apply(o,t.concat(function(e){c?a(null):null!==e?a(e):r(n,t,a,i)}))!==e&&(c=!0,!o.suppressLoaderExceptions))throw Error("Component loaders must supply values by invoking the callback, not by returning values synchronously.")}else r(n,t,a,i)}else a(null)}var a={},i={};p.g={get:function(t,r){var a=i.hasOwnProperty(t)?i[t]:e;a?setTimeout(function(){r(a)},0):n(t,r)},tb:function(e){delete i[e]},jb:r};p.g.loaders=[];p.b("components",p.g);p.b("components.get",p.g.get);p.b("components.clearCachedDefinition",p.g.tb)})();(function(){function e(e,n,t,r){function a(){0===--u&&r(i)}var i={},u=2,c=t.template;t=t.viewModel;c?o(n,c,function(n){p.g.jb("loadTemplate",[e,n],function(e){i.template=e;a()})}):a();t?o(n,t,function(n){p.g.jb("loadViewModel",[e,n],function(e){i[f]=e;a()})}):a()}function r(e,n,t){if("function"===typeof n)t(function(e){return new n(e)});else if("function"===typeof n[f])t(n[f]);else if("instance"in n){var a=n.instance;t(function(){return a})}else"viewModel"in n?r(e,n.viewModel,t):e("Unknown viewModel value: "+n)}function a(e){switch(p.a.t(e)){case"script":return p.a.ba(e.text);case"textarea":return p.a.ba(e.value);case"template":if(i(e.content))return p.a.ia(e.content.childNodes)}return p.a.ia(e.childNodes)}function i(e){return n.DocumentFragment?e instanceof DocumentFragment:e&&11===e.nodeType}function o(e,t,r){"string"===typeof t.require?u||n.require?(u||n.require)([t.require],r):e("Uses require, but no AMD loader is present"):r(t)}function c(e){return function(n){throw Error("Component '"+e+"': "+n)}}var s={};p.g.tc=function(e,n){if(!n)throw Error("Invalid configuration for "+e);if(p.g.Qa(e))throw Error("Component "+e+" is already registered");s[e]=n};p.g.Qa=function(e){return e in s};p.g.wc=function(e){delete s[e];p.g.tb(e)};p.g.ub={getConfig:function(e,n){n(s.hasOwnProperty(e)?s[e]:null)},loadComponent:function(n,t,r){var a=c(n);o(a,t,function(t){e(n,a,t,r)})},loadTemplate:function(e,r,o){e=c(e);if("string"===typeof r)o(p.a.ba(r));else if(r instanceof Array)o(r);else if(i(r))o(p.a.S(r.childNodes));else if(r.element)if(r=r.element,n.HTMLElement?r instanceof HTMLElement:r&&r.tagName&&1===r.nodeType)o(a(r));else if("string"===typeof r){var u=t.getElementById(r);u?o(a(u)):e("Cannot find element with ID "+r)}else e("Unknown element type: "+r);else e("Unknown template value: "+r)},loadViewModel:function(e,n,t){r(c(e),n,t)}};var f="createViewModel";p.b("components.register",p.g.tc);p.b("components.isRegistered",p.g.Qa);p.b("components.unregister",p.g.wc);p.b("components.defaultLoader",p.g.ub);p.g.loaders.push(p.g.ub);p.g.Ub=s})();(function(){function e(e,t){var r=e.getAttribute("params");if(r){var r=n.parseBindingsString(r,t,e,{valueAccessors:!0,bindingParams:!0}),r=p.a.na(r,function(n){return p.s(n,null,{o:e})}),a=p.a.na(r,function(n){return n.Z()?p.s(function(){return p.a.c(n())},null,{o:e}):n.v()});a.hasOwnProperty("$raw")||(a.$raw=r);return a}return{$raw:{}}}p.g.getComponentNameForNode=function(e){e=p.a.t(e);return p.g.Qa(e)&&e};p.g.mb=function(n,t,r,a){if(1===t.nodeType){var i=p.g.getComponentNameForNode(t);if(i){n=n||{};if(n.component)throw Error('Cannot use the "component" binding on a custom element matching a component');var o={name:i,params:e(t,r)};n.component=a?function(){return o}:o}}return n};var n=new p.J;9>p.a.L&&(p.g.register=function(e){return function(n){t.createElement(n);return e.apply(this,arguments)}}(p.g.register),t.createDocumentFragment=function(e){return function(){var n=e(),t=p.g.Ub,r;for(r in t)t.hasOwnProperty(r)&&n.createElement(r);return n}}(t.createDocumentFragment))})();(function(){var e=0;p.d.component={init:function(n,t,r,a,i){function o(){var e=u&&u.dispose;"function"===typeof e&&e.call(u);c=null}var u,c;p.a.w.da(n,o);p.s(function(){var r=p.a.c(t()),a,s;"string"===typeof r?a=r:(a=p.a.c(r.name),s=p.a.c(r.params));if(!a)throw Error("No component name specified");var f=c=++e;p.g.get(a,function(e){if(c===f){o();if(!e)throw Error("Unknown component '"+a+"'");var t=e.template;if(!t)throw Error("Component '"+a+"' has no template");t=p.a.ia(t);p.f.T(n,t);var t=s,r=e.createViewModel;e=r?r.call(e,t,{element:n}):t;t=i.createChildContext(e);u=e;p.Ca(t,n)}})},null,{o:n});return{controlsDescendantBindings:!0}}};p.f.Q.component=!0})();var v={"class":"className","for":"htmlFor"};p.d.attr={update:function(n,t){var r=p.a.c(t())||{};p.a.G(r,function(t,r){r=p.a.c(r);var a=!1===r||null===r||r===e;a&&n.removeAttribute(t);8>=p.a.L&&t in v?(t=v[t],a?n.removeAttribute(t):n[t]=r):a||n.setAttribute(t,r.toString());"name"===t&&p.a.Mb(n,a?"":r.toString())})}};(function(){p.d.checked={after:["value","attr"],init:function(n,t,r){function a(){var e=n.checked,a=l?o():e;if(!p.Y.ma()&&(!c||e)){var i=p.k.B(t);s?f!==a?(e&&(p.a.ea(i,a,!0),p.a.ea(i,f,!1)),f=a):p.a.ea(i,a,e):p.h.pa(i,r,"checked",a,!0)}}function i(){var e=p.a.c(t());n.checked=s?0<=p.a.m(e,o()):u?e:o()===e}var o=p.Ib(function(){return r.has("checkedValue")?p.a.c(r.get("checkedValue")):r.has("value")?p.a.c(r.get("value")):n.value}),u="checkbox"==n.type,c="radio"==n.type;if(u||c){var s=u&&p.a.c(t())instanceof Array,f=s?o():e,l=c||s;c&&!n.name&&p.d.uniqueName.init(n,function(){return!0});p.s(a,null,{o:n});p.a.n(n,"click",a);p.s(i,null,{o:n})}}};p.h.V.checked=!0;p.d.checkedValue={update:function(e,n){e.value=p.a.c(n())}}})();p.d.css={update:function(e,n){var t=p.a.c(n());"object"==typeof t?p.a.G(t,function(n,t){t=p.a.c(t);p.a.Ba(e,n,t)}):(t=String(t||""),p.a.Ba(e,e.__ko__cssValue,!1),e.__ko__cssValue=t,p.a.Ba(e,t,!0))}};p.d.enable={update:function(e,n){var t=p.a.c(n());t&&e.disabled?e.removeAttribute("disabled"):t||e.disabled||(e.disabled=!0)}};p.d.disable={update:function(e,n){p.d.enable.update(e,function(){return!p.a.c(n())})}};p.d.event={init:function(e,n,t,r,a){var i=n()||{};p.a.G(i,function(i){"string"==typeof i&&p.a.n(e,i,function(e){var o,u=n()[i];if(u){try{var c=p.a.S(arguments);r=a.$data;c.unshift(r);o=u.apply(r,c)}finally{!0!==o&&(e.preventDefault?e.preventDefault():e.returnValue=!1)}!1===t.get(i+"Bubble")&&(e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation())}})})}};p.d.foreach={Eb:function(e){return function(){var n=e(),t=p.a.Xa(n);if(!t||"number"==typeof t.length)return{foreach:n,templateEngine:p.O.Oa};p.a.c(n);return{foreach:t.data,as:t.as,includeDestroyed:t.includeDestroyed,afterAdd:t.afterAdd,beforeRemove:t.beforeRemove,afterRender:t.afterRender,beforeMove:t.beforeMove,afterMove:t.afterMove,templateEngine:p.O.Oa}}},init:function(e,n){return p.d.template.init(e,p.d.foreach.Eb(n))},update:function(e,n,t,r,a){return p.d.template.update(e,p.d.foreach.Eb(n),t,r,a)}};p.h.ha.foreach=!1;p.f.Q.foreach=!0;p.d.hasfocus={init:function(e,n,t){function r(r){e.__ko_hasfocusUpdating=!0;var a=e.ownerDocument;if("activeElement"in a){var i;try{i=a.activeElement}catch(o){i=a.body}r=i===e}a=n();p.h.pa(a,t,"hasfocus",r,!0);e.__ko_hasfocusLastValue=r;e.__ko_hasfocusUpdating=!1}var a=r.bind(null,!0),i=r.bind(null,!1);p.a.n(e,"focus",a);p.a.n(e,"focusin",a);p.a.n(e,"blur",i);p.a.n(e,"focusout",i)},update:function(e,n){var t=!!p.a.c(n());e.__ko_hasfocusUpdating||e.__ko_hasfocusLastValue===t||(t?e.focus():e.blur(),p.k.B(p.a.oa,null,[e,t?"focusin":"focusout"]))}};p.h.V.hasfocus=!0;p.d.hasFocus=p.d.hasfocus;p.h.V.hasFocus=!0;p.d.html={init:function(){return{controlsDescendantBindings:!0}},update:function(e,n){p.a.$a(e,n())}};l("if");l("ifnot",!1,!0);l("with",!0,!1,function(e,n){return e.createChildContext(n)});var y={};p.d.options={init:function(e){if("select"!==p.a.t(e))throw Error("options binding applies only to SELECT elements");for(;0<e.length;)e.remove(0);return{controlsDescendantBindings:!0}},update:function(n,t,r){function a(){return p.a.ta(n.options,function(e){return e.selected})}function i(e,n,t){var r=typeof n;return"function"==r?n(e):"string"==r?e[n]:t}function o(e,t){if(l.length){var r=0<=p.a.m(l,p.i.q(t[0]));p.a.Nb(t[0],r);d&&!r&&p.k.B(p.a.oa,null,[n,"change"])}}var u=0!=n.length&&n.multiple?n.scrollTop:null,c=p.a.c(t()),s=r.get("optionsIncludeDestroyed");t={};var f,l;l=n.multiple?p.a.Da(a(),p.i.q):0<=n.selectedIndex?[p.i.q(n.options[n.selectedIndex])]:[];c&&("undefined"==typeof c.length&&(c=[c]),f=p.a.ta(c,function(n){return s||n===e||null===n||!p.a.c(n._destroy)}),r.has("optionsCaption")&&(c=p.a.c(r.get("optionsCaption")),null!==c&&c!==e&&f.unshift(y)));var d=!1;t.beforeRemove=function(e){n.removeChild(e)};c=o;r.has("optionsAfterRender")&&(c=function(n,t){o(0,t);p.k.B(r.get("optionsAfterRender"),null,[t[0],n!==y?n:e])});p.a.Za(n,f,function(t,a,o){o.length&&(l=o[0].selected?[p.i.q(o[0])]:[],d=!0);a=n.ownerDocument.createElement("option");t===y?(p.a.bb(a,r.get("optionsCaption")),p.i.ca(a,e)):(o=i(t,r.get("optionsValue"),t),p.i.ca(a,p.a.c(o)),t=i(t,r.get("optionsText"),o),p.a.bb(a,t));return[a]},t,c);p.k.B(function(){r.get("valueAllowUnset")&&r.has("value")?p.i.ca(n,p.a.c(r.get("value")),!0):(n.multiple?l.length&&a().length<l.length:l.length&&0<=n.selectedIndex?p.i.q(n.options[n.selectedIndex])!==l[0]:l.length||0<=n.selectedIndex)&&p.a.oa(n,"change")});p.a.dc(n);u&&20<Math.abs(u-n.scrollTop)&&(n.scrollTop=u)}};p.d.options.Va=p.a.e.F();p.d.selectedOptions={after:["options","foreach"],init:function(e,n,t){p.a.n(e,"change",function(){var r=n(),a=[];p.a.u(e.getElementsByTagName("option"),function(e){e.selected&&a.push(p.i.q(e))});p.h.pa(r,t,"selectedOptions",a)})},update:function(e,n){if("select"!=p.a.t(e))throw Error("values binding applies only to SELECT elements");var t=p.a.c(n());t&&"number"==typeof t.length&&p.a.u(e.getElementsByTagName("option"),function(e){var n=0<=p.a.m(t,p.i.q(e));p.a.Nb(e,n)})}};p.h.V.selectedOptions=!0;p.d.style={update:function(n,t){var r=p.a.c(t()||{});p.a.G(r,function(t,r){r=p.a.c(r);if(null===r||r===e||!1===r)r="";n.style[t]=r})}};p.d.submit={init:function(e,n,t,r,a){if("function"!=typeof n())throw Error("The value for a submit binding must be a function");p.a.n(e,"submit",function(t){var r,i=n();try{r=i.call(a.$data,e)}finally{!0!==r&&(t.preventDefault?t.preventDefault():t.returnValue=!1)}})}};p.d.text={init:function(){return{controlsDescendantBindings:!0}},update:function(e,n){p.a.bb(e,n())}};p.f.Q.text=!0;(function(){if(n&&n.navigator)var t=function(e){if(e)return parseFloat(e[1])},r=n.opera&&n.opera.version&&parseInt(n.opera.version()),a=n.navigator.userAgent,i=t(a.match(/^(?:(?!chrome).)*version\/([^ ]*) safari/i)),o=t(a.match(/Firefox\/([^ ]*)/));if(10>p.a.L)var u=p.a.e.F(),c=p.a.e.F(),s=function(e){var n=this.activeElement;(n=n&&p.a.e.get(n,c))&&n(e)},f=function(e,n){var t=e.ownerDocument;p.a.e.get(t,u)||(p.a.e.set(t,u,!0),p.a.n(t,"selectionchange",s));p.a.e.set(e,c,n)};p.d.textInput={init:function(n,t,a){function u(e,t){p.a.n(n,e,t)}function c(){var r=p.a.c(t());if(null===r||r===e)r="";b!==e&&r===b?setTimeout(c,4):n.value!==r&&(d=r,n.value=r)}function s(){h||(b=n.value,h=setTimeout(l,4))}function l(){clearTimeout(h);b=h=e;var r=n.value;d!==r&&(d=r,p.h.pa(t(),a,"textInput",r))}var d=n.value,h,b;10>p.a.L?(u("propertychange",function(e){"value"===e.propertyName&&l()}),8==p.a.L&&(u("keyup",l),u("keydown",l)),8<=p.a.L&&(f(n,l),u("dragend",s))):(u("input",l),5>i&&"textarea"===p.a.t(n)?(u("keydown",s),u("paste",s),u("cut",s)):11>r?u("keydown",s):4>o&&(u("DOMAutoComplete",l),u("dragdrop",l),u("drop",l)));u("change",l);p.s(c,null,{o:n})}};p.h.V.textInput=!0;p.d.textinput={preprocess:function(e,n,t){t("textInput",e)}}})();p.d.uniqueName={init:function(e,n){if(n()){var t="ko_unique_"+ ++p.d.uniqueName.Zb;p.a.Mb(e,t)}}};p.d.uniqueName.Zb=0;p.d.value={after:["options","foreach"],init:function(e,n,t){if("input"!=e.tagName.toLowerCase()||"checkbox"!=e.type&&"radio"!=e.type){var r=["change"],a=t.get("valueUpdate"),i=!1,o=null;a&&("string"==typeof a&&(a=[a]),p.a.ga(r,a),r=p.a.rb(r));var u=function(){o=null;i=!1;var r=n(),a=p.i.q(e);p.h.pa(r,t,"value",a)};!p.a.L||"input"!=e.tagName.toLowerCase()||"text"!=e.type||"off"==e.autocomplete||e.form&&"off"==e.form.autocomplete||-1!=p.a.m(r,"propertychange")||(p.a.n(e,"propertychange",function(){i=!0}),p.a.n(e,"focus",function(){i=!1}),p.a.n(e,"blur",function(){i&&u()}));p.a.u(r,function(n){var t=u;p.a.vc(n,"after")&&(t=function(){o=p.i.q(e);setTimeout(u,0)},n=n.substring(5));p.a.n(e,n,t)});var c=function(){var r=p.a.c(n()),a=p.i.q(e);if(null!==o&&r===o)setTimeout(c,0);else if(r!==a)if("select"===p.a.t(e)){var i=t.get("valueAllowUnset"),a=function(){p.i.ca(e,r,i)};a();i||r===p.i.q(e)?setTimeout(a,0):p.k.B(p.a.oa,null,[e,"change"])}else p.i.ca(e,r)};p.s(c,null,{o:e})}else p.ra(e,{checkedValue:n})},update:function(){}};p.h.V.value=!0;p.d.visible={update:function(e,n){var t=p.a.c(n()),r="none"!=e.style.display;t&&!r?e.style.display="":!t&&r&&(e.style.display="none")}};(function(e){p.d[e]={init:function(n,t,r,a,i){return p.d.event.init.call(this,n,function(){var n={};n[e]=t();return n},r,a,i)}}})("click");p.H=function(){};p.H.prototype.renderTemplateSource=function(){throw Error("Override renderTemplateSource")};p.H.prototype.createJavaScriptEvaluatorBlock=function(){throw Error("Override createJavaScriptEvaluatorBlock")};p.H.prototype.makeTemplateSource=function(e,n){if("string"==typeof e){n=n||t;var r=n.getElementById(e);if(!r)throw Error("Cannot find template with ID "+e);return new p.r.l(r)}if(1==e.nodeType||8==e.nodeType)return new p.r.fa(e);throw Error("Unknown template type: "+e)};p.H.prototype.renderTemplate=function(e,n,t,r){e=this.makeTemplateSource(e,r);return this.renderTemplateSource(e,n,t)};p.H.prototype.isTemplateRewritten=function(e,n){return!1===this.allowTemplateRewriting?!0:this.makeTemplateSource(e,n).data("isRewritten")};p.H.prototype.rewriteTemplate=function(e,n,t){e=this.makeTemplateSource(e,t);n=n(e.text());e.text(n);e.data("isRewritten",!0)};p.b("templateEngine",p.H);p.fb=function(){function e(e,n,t,r){e=p.h.Wa(e);for(var a=p.h.ha,i=0;i<e.length;i++){var o=e[i].key;if(a.hasOwnProperty(o)){var u=a[o];if("function"===typeof u){if(o=u(e[i].value))throw Error(o)}else if(!u)throw Error("This template engine does not support the '"+o+"' binding within its templates")}}t="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+p.h.ya(e,{valueAccessors:!0})+" } })()},'"+t.toLowerCase()+"')";return r.createJavaScriptEvaluatorBlock(t)+n}var n=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,t=/\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g;return{ec:function(e,n,t){n.isTemplateRewritten(e,t)||n.rewriteTemplate(e,function(e){return p.fb.nc(e,n)},t)},nc:function(r,a){return r.replace(n,function(n,t,r,i,o){return e(o,t,r,a)}).replace(t,function(n,t){return e(t,"<!-- ko -->","#comment",a)})},Xb:function(e,n){return p.D.Ua(function(t,r){var a=t.nextSibling;a&&a.nodeName.toLowerCase()===n&&p.ra(a,e,r)})}}}();p.b("__tr_ambtns",p.fb.Xb);(function(){p.r={};p.r.l=function(e){this.l=e};p.r.l.prototype.text=function(){var e=p.a.t(this.l),e="script"===e?"text":"textarea"===e?"value":"innerHTML";if(0==arguments.length)return this.l[e];var n=arguments[0];"innerHTML"===e?p.a.$a(this.l,n):this.l[e]=n};var n=p.a.e.F()+"_";p.r.l.prototype.data=function(e){if(1===arguments.length)return p.a.e.get(this.l,n+e);p.a.e.set(this.l,n+e,arguments[1])};var t=p.a.e.F();p.r.fa=function(e){this.l=e};p.r.fa.prototype=new p.r.l;p.r.fa.prototype.text=function(){if(0==arguments.length){var n=p.a.e.get(this.l,t)||{};n.gb===e&&n.Ga&&(n.gb=n.Ga.innerHTML);return n.gb}p.a.e.set(this.l,t,{gb:arguments[0]})};p.r.l.prototype.nodes=function(){if(0==arguments.length)return(p.a.e.get(this.l,t)||{}).Ga;p.a.e.set(this.l,t,{Ga:arguments[0]})};p.b("templateSources",p.r);p.b("templateSources.domElement",p.r.l);p.b("templateSources.anonymousTemplate",p.r.fa)})();(function(){function n(e,n,t){var r;for(n=p.f.nextSibling(n);e&&(r=e)!==n;)e=p.f.nextSibling(r),t(r,e)}function t(e,t){if(e.length){var r=e[0],a=e[e.length-1],i=r.parentNode,o=p.J.instance,u=o.preprocessNode;if(u){n(r,a,function(e,n){var t=e.previousSibling,i=u.call(o,e);i&&(e===r&&(r=i[0]||n),e===a&&(a=i[i.length-1]||t))});e.length=0;if(!r)return;r===a?e.push(r):(e.push(r,a),p.a.ka(e,i))}n(r,a,function(e){1!==e.nodeType&&8!==e.nodeType||p.pb(t,e)});n(r,a,function(e){1!==e.nodeType&&8!==e.nodeType||p.D.Sb(e,[t])});p.a.ka(e,i)}}function r(e){return e.nodeType?e:0<e.length?e[0]:null}function a(e,n,a,o,u){u=u||{};var c=e&&r(e),c=c&&c.ownerDocument,s=u.templateEngine||i;p.fb.ec(a,s,c);a=s.renderTemplate(a,o,u,c);if("number"!=typeof a.length||0<a.length&&"number"!=typeof a[0].nodeType)throw Error("Template engine must return an array of DOM nodes");c=!1;switch(n){case"replaceChildren":p.f.T(e,a);c=!0;break;case"replaceNode":p.a.Lb(e,a);c=!0;break;case"ignoreTargetNode":break;default:throw Error("Unknown renderMode: "+n)}c&&(t(a,o),u.afterRender&&p.k.B(u.afterRender,null,[a,o.$data]));return a}var i;p.ab=function(n){if(n!=e&&!(n instanceof p.H))throw Error("templateEngine must inherit from ko.templateEngine");i=n};p.Ya=function(n,t,o,u,c){o=o||{};if((o.templateEngine||i)==e)throw Error("Set a template engine before calling renderTemplate");c=c||"replaceChildren";if(u){var s=r(u);return p.j(function(){var e=t&&t instanceof p.N?t:new p.N(p.a.c(t)),i=p.C(n)?n():"function"===typeof n?n(e.$data,e):n,e=a(u,c,i,e,o);"replaceNode"==c&&(u=e,s=r(u))},null,{Ia:function(){return!s||!p.a.Ja(s)},o:s&&"replaceNode"==c?s.parentNode:s})}return p.D.Ua(function(e){p.Ya(n,t,o,e,"replaceNode")})};p.uc=function(n,r,i,o,u){function c(e,n){t(n,f);i.afterRender&&i.afterRender(n,e)}function s(e,t){f=u.createChildContext(e,i.as,function(e){e.$index=t});var r=p.C(n)?n():"function"===typeof n?n(e,f):n;return a(null,"ignoreTargetNode",r,f,i)}var f;return p.j(function(){var n=p.a.c(r)||[];"undefined"==typeof n.length&&(n=[n]);n=p.a.ta(n,function(n){return i.includeDestroyed||n===e||null===n||!p.a.c(n._destroy)});p.k.B(p.a.Za,null,[o,n,s,i,c])},null,{o:o})};var o=p.a.e.F();p.d.template={init:function(e,n){var t=p.a.c(n());"string"==typeof t||t.name?p.f.ja(e):(t=p.f.childNodes(e),t=p.a.oc(t),new p.r.fa(e).nodes(t));return{controlsDescendantBindings:!0}},update:function(n,t,r,a,i){var u=t(),c;t=p.a.c(u);r=!0;a=null;"string"==typeof t?t={}:(u=t.name,"if"in t&&(r=p.a.c(t["if"])),r&&"ifnot"in t&&(r=!p.a.c(t.ifnot)),c=p.a.c(t.data));"foreach"in t?a=p.uc(u||n,r&&t.foreach||[],t,n,i):r?(i="data"in t?i.createChildContext(c,t.as):i,a=p.Ya(u||n,i,t,n)):p.f.ja(n);i=a;(c=p.a.e.get(n,o))&&"function"==typeof c.K&&c.K();p.a.e.set(n,o,i&&i.Z()?i:e)}};p.h.ha.template=function(e){e=p.h.Wa(e);return 1==e.length&&e[0].unknown||p.h.lc(e,"name")?null:"This template engine does not support anonymous templates nested within its templates"};p.f.Q.template=!0})();p.b("setTemplateEngine",p.ab);p.b("renderTemplate",p.Ya);p.a.wb=function(e,n,t){if(e.length&&n.length){var r,a,i,o,u;for(r=a=0;(!t||r<t)&&(o=e[a]);++a){for(i=0;u=n[i];++i)if(o.value===u.value){o.moved=u.index;u.moved=o.index;n.splice(i,1);r=i=0;break}r+=i}}};p.a.Fa=function(){function e(e,n,t,r,a){var i=Math.min,o=Math.max,u=[],c,s=e.length,f,l=n.length,d=l-s||1,h=s+l+1,b,m,g;for(c=0;c<=s;c++)for(m=b,u.push(b=[]),g=i(l,c+d),f=o(0,c-1);f<=g;f++)b[f]=f?c?e[c-1]===n[f-1]?m[f-1]:i(m[f]||h,b[f-1]||h)+1:f+1:c+1;i=[];o=[];d=[];c=s;for(f=l;c||f;)l=u[c][f]-1,f&&l===u[c][f-1]?o.push(i[i.length]={status:t,value:n[--f],index:f}):c&&l===u[c-1][f]?d.push(i[i.length]={status:r,value:e[--c],index:c}):(--f,--c,a.sparse||i.push({status:"retained",value:n[f]}));p.a.wb(o,d,10*s);return i.reverse()}return function(n,t,r){r="boolean"===typeof r?{dontLimitMoves:r}:r||{};n=n||[];t=t||[];return n.length<=t.length?e(n,t,"added","deleted",r):e(t,n,"deleted","added",r)}}();p.b("utils.compareArrays",p.a.Fa);(function(){function n(n,t,r,a,i){var o=[],u=p.j(function(){var e=t(r,i,p.a.ka(o,n))||[];0<o.length&&(p.a.Lb(o,e),a&&p.k.B(a,null,[r,e,i]));o.length=0;p.a.ga(o,e)},null,{o:n,Ia:function(){return!p.a.ob(o)}});return{$:o,j:u.Z()?u:e}}var t=p.a.e.F();p.a.Za=function(r,a,i,o,u){function c(e,n){x=l[n];g!==n&&(w[e]=x);x.Na(g++);p.a.ka(x.$,r);b.push(x);y.push(x)}function s(e,n){if(e)for(var t=0,r=n.length;t<r;t++)n[t]&&p.a.u(n[t].$,function(r){e(r,t,n[t].sa)})}a=a||[];o=o||{};var f=p.a.e.get(r,t)===e,l=p.a.e.get(r,t)||[],d=p.a.Da(l,function(e){return e.sa}),h=p.a.Fa(d,a,o.dontLimitMoves),b=[],m=0,g=0,v=[],y=[];a=[];for(var w=[],d=[],x,k=0,E,T;E=h[k];k++)switch(T=E.moved,E.status){case"deleted":T===e&&(x=l[m],x.j&&x.j.K(),v.push.apply(v,p.a.ka(x.$,r)),o.beforeRemove&&(a[k]=x,y.push(x)));m++;break;case"retained":c(k,m++);break;case"added":T!==e?c(k,T):(x={sa:E.value,Na:p.p(g++)},b.push(x),y.push(x),f||(d[k]=x))}s(o.beforeMove,w);p.a.u(v,o.beforeRemove?p.R:p.removeNode);for(var k=0,f=p.f.firstChild(r),C;x=y[k];k++){x.$||p.a.extend(x,n(r,i,x.sa,u,x.Na));for(m=0;h=x.$[m];f=h.nextSibling,C=h,m++)h!==f&&p.f.Bb(r,h,C);!x.ic&&u&&(u(x.sa,x.$,x.Na),x.ic=!0)}s(o.beforeRemove,a);s(o.afterMove,w);s(o.afterAdd,d);p.a.e.set(r,t,b)}})();p.b("utils.setDomNodeChildrenFromArrayMapping",p.a.Za);p.O=function(){this.allowTemplateRewriting=!1};p.O.prototype=new p.H;p.O.prototype.renderTemplateSource=function(e){var n=(9>p.a.L?0:e.nodes)?e.nodes():null;if(n)return p.a.S(n.cloneNode(!0).childNodes);e=e.text();return p.a.ba(e)};p.O.Oa=new p.O;p.ab(p.O.Oa);p.b("nativeTemplateEngine",p.O);(function(){p.Sa=function(){var e=this.kc=function(){if(!a||!a.tmpl)return 0;try{if(0<=a.tmpl.tag.tmpl.open.toString().indexOf("__"))return 2}catch(e){}return 1}();this.renderTemplateSource=function(n,r,i){i=i||{};if(2>e)throw Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.");var o=n.data("precompiled");o||(o=n.text()||"",o=a.template(null,"{{ko_with $item.koBindingContext}}"+o+"{{/ko_with}}"),n.data("precompiled",o));n=[r.$data];r=a.extend({koBindingContext:r},i.templateOptions);r=a.tmpl(o,n,r);r.appendTo(t.createElement("div"));a.fragments={};return r};this.createJavaScriptEvaluatorBlock=function(e){return"{{ko_code ((function() { return "+e+" })()) }}"};this.addTemplate=function(e,n){t.write("<script type='text/html' id='"+e+"'>"+n+"</script>")};0<e&&(a.tmpl.tag.ko_code={open:"__.push($1 || '');"},a.tmpl.tag.ko_with={open:"with($1) {",close:"} "})};p.Sa.prototype=new p.H;var e=new p.Sa;0<e.kc&&p.ab(e);p.b("jqueryTmplTemplateEngine",p.Sa)})()})})()})();var Base64=function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var t={encode:function(t){var n="";var s,i,r;var a,o,h,l;var c=0;do{s=t.charCodeAt(c++);i=t.charCodeAt(c++);r=t.charCodeAt(c++);a=s>>2;o=(s&3)<<4|i>>4;h=(i&15)<<2|r>>6;l=r&63;if(isNaN(i)){h=l=64}else if(isNaN(r)){l=64}n=n+e.charAt(a)+e.charAt(o)+e.charAt(h)+e.charAt(l)}while(c<t.length);return n},decode:function(t){var n="";var s,i,r;var a,o,h,l;var c=0;t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{a=e.indexOf(t.charAt(c++));o=e.indexOf(t.charAt(c++));h=e.indexOf(t.charAt(c++));l=e.indexOf(t.charAt(c++));s=a<<2|o>>4;i=(o&15)<<4|h>>2;r=(h&3)<<6|l;n=n+String.fromCharCode(s);if(h!=64){n=n+String.fromCharCode(i)}if(l!=64){n=n+String.fromCharCode(r)}}while(c<t.length);return n}};return t}();function b64_sha1(e){return binb2b64(core_sha1(str2binb(e),e.length*8))}function str_sha1(e){return binb2str(core_sha1(str2binb(e),e.length*8))}function b64_hmac_sha1(e,t){return binb2b64(core_hmac_sha1(e,t))}function str_hmac_sha1(e,t){return binb2str(core_hmac_sha1(e,t))}function core_sha1(e,t){e[t>>5]|=128<<24-t%32;e[(t+64>>9<<4)+15]=t;var n=new Array(80);var s=1732584193;var i=-271733879;var r=-1732584194;var a=271733878;var o=-1009589776;var h,l,c,u,d,f,_,m;for(h=0;h<e.length;h+=16){u=s;d=i;f=r;_=a;m=o;for(l=0;l<80;l++){if(l<16){n[l]=e[h+l]}else{n[l]=rol(n[l-3]^n[l-8]^n[l-14]^n[l-16],1)}c=safe_add(safe_add(rol(s,5),sha1_ft(l,i,r,a)),safe_add(safe_add(o,n[l]),sha1_kt(l)));o=a;a=r;r=rol(i,30);i=s;s=c}s=safe_add(s,u);i=safe_add(i,d);r=safe_add(r,f);a=safe_add(a,_);o=safe_add(o,m)}return[s,i,r,a,o]}function sha1_ft(e,t,n,s){if(e<20){return t&n|~t&s}if(e<40){return t^n^s}if(e<60){return t&n|t&s|n&s}return t^n^s}function sha1_kt(e){return e<20?1518500249:e<40?1859775393:e<60?-1894007588:-899497514}function core_hmac_sha1(e,t){var n=str2binb(e);if(n.length>16){n=core_sha1(n,e.length*8)}var s=new Array(16),i=new Array(16);for(var r=0;r<16;r++){s[r]=n[r]^909522486;i[r]=n[r]^1549556828}var a=core_sha1(s.concat(str2binb(t)),512+t.length*8);return core_sha1(i.concat(a),512+160)}function safe_add(e,t){var n=(e&65535)+(t&65535);var s=(e>>16)+(t>>16)+(n>>16);return s<<16|n&65535}function rol(e,t){return e<<t|e>>>32-t}function str2binb(e){var t=[];var n=255;for(var s=0;s<e.length*8;s+=8){t[s>>5]|=(e.charCodeAt(s/8)&n)<<24-s%32}return t}function binb2str(e){var t="";var n=255;for(var s=0;s<e.length*32;s+=8){t+=String.fromCharCode(e[s>>5]>>>24-s%32&n)}return t}function binb2b64(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var n="";var s,i;for(var r=0;r<e.length*4;r+=3){s=(e[r>>2]>>8*(3-r%4)&255)<<16|(e[r+1>>2]>>8*(3-(r+1)%4)&255)<<8|e[r+2>>2]>>8*(3-(r+2)%4)&255;for(i=0;i<4;i++){if(r*8+i*6>e.length*32){n+="="}else{n+=t.charAt(s>>6*(3-i)&63)}}}return n}var MD5=function(){var e=function(e,t){var n=(e&65535)+(t&65535);var s=(e>>16)+(t>>16)+(n>>16);return s<<16|n&65535};var t=function(e,t){return e<<t|e>>>32-t};var n=function(e){var t=[];for(var n=0;n<e.length*8;n+=8){t[n>>5]|=(e.charCodeAt(n/8)&255)<<n%32}return t};var s=function(e){var t="";for(var n=0;n<e.length*32;n+=8){t+=String.fromCharCode(e[n>>5]>>>n%32&255)}return t};var i=function(e){var t="0123456789abcdef";var n="";for(var s=0;s<e.length*4;s++){n+=t.charAt(e[s>>2]>>s%4*8+4&15)+t.charAt(e[s>>2]>>s%4*8&15)}return n};var r=function(n,s,i,r,a,o){return e(t(e(e(s,n),e(r,o)),a),i)};var a=function(e,t,n,s,i,a,o){return r(t&n|~t&s,e,t,i,a,o)};var o=function(e,t,n,s,i,a,o){return r(t&s|n&~s,e,t,i,a,o)};var h=function(e,t,n,s,i,a,o){return r(t^n^s,e,t,i,a,o)};var l=function(e,t,n,s,i,a,o){return r(n^(t|~s),e,t,i,a,o)};var c=function(t,n){t[n>>5]|=128<<n%32;t[(n+64>>>9<<4)+14]=n;var s=1732584193;var i=-271733879;var r=-1732584194;var c=271733878;var u,d,f,_;for(var m=0;m<t.length;m+=16){u=s;d=i;f=r;_=c;s=a(s,i,r,c,t[m+0],7,-680876936);c=a(c,s,i,r,t[m+1],12,-389564586);r=a(r,c,s,i,t[m+2],17,606105819);i=a(i,r,c,s,t[m+3],22,-1044525330);s=a(s,i,r,c,t[m+4],7,-176418897);c=a(c,s,i,r,t[m+5],12,1200080426);r=a(r,c,s,i,t[m+6],17,-1473231341);i=a(i,r,c,s,t[m+7],22,-45705983);s=a(s,i,r,c,t[m+8],7,1770035416);c=a(c,s,i,r,t[m+9],12,-1958414417);r=a(r,c,s,i,t[m+10],17,-42063);i=a(i,r,c,s,t[m+11],22,-1990404162);s=a(s,i,r,c,t[m+12],7,1804603682);c=a(c,s,i,r,t[m+13],12,-40341101);r=a(r,c,s,i,t[m+14],17,-1502002290);i=a(i,r,c,s,t[m+15],22,1236535329);s=o(s,i,r,c,t[m+1],5,-165796510);c=o(c,s,i,r,t[m+6],9,-1069501632);r=o(r,c,s,i,t[m+11],14,643717713);i=o(i,r,c,s,t[m+0],20,-373897302);s=o(s,i,r,c,t[m+5],5,-701558691);c=o(c,s,i,r,t[m+10],9,38016083);r=o(r,c,s,i,t[m+15],14,-660478335);i=o(i,r,c,s,t[m+4],20,-405537848);s=o(s,i,r,c,t[m+9],5,568446438);c=o(c,s,i,r,t[m+14],9,-1019803690);r=o(r,c,s,i,t[m+3],14,-187363961);i=o(i,r,c,s,t[m+8],20,1163531501);s=o(s,i,r,c,t[m+13],5,-1444681467);c=o(c,s,i,r,t[m+2],9,-51403784);r=o(r,c,s,i,t[m+7],14,1735328473);i=o(i,r,c,s,t[m+12],20,-1926607734);s=h(s,i,r,c,t[m+5],4,-378558);c=h(c,s,i,r,t[m+8],11,-2022574463);r=h(r,c,s,i,t[m+11],16,1839030562);i=h(i,r,c,s,t[m+14],23,-35309556);s=h(s,i,r,c,t[m+1],4,-1530992060);c=h(c,s,i,r,t[m+4],11,1272893353);r=h(r,c,s,i,t[m+7],16,-155497632);i=h(i,r,c,s,t[m+10],23,-1094730640);s=h(s,i,r,c,t[m+13],4,681279174);c=h(c,s,i,r,t[m+0],11,-358537222);r=h(r,c,s,i,t[m+3],16,-722521979);i=h(i,r,c,s,t[m+6],23,76029189);s=h(s,i,r,c,t[m+9],4,-640364487);c=h(c,s,i,r,t[m+12],11,-421815835);r=h(r,c,s,i,t[m+15],16,530742520);i=h(i,r,c,s,t[m+2],23,-995338651);s=l(s,i,r,c,t[m+0],6,-198630844);c=l(c,s,i,r,t[m+7],10,1126891415);r=l(r,c,s,i,t[m+14],15,-1416354905);i=l(i,r,c,s,t[m+5],21,-57434055);s=l(s,i,r,c,t[m+12],6,1700485571);c=l(c,s,i,r,t[m+3],10,-1894986606);r=l(r,c,s,i,t[m+10],15,-1051523);i=l(i,r,c,s,t[m+1],21,-2054922799);s=l(s,i,r,c,t[m+8],6,1873313359);c=l(c,s,i,r,t[m+15],10,-30611744);r=l(r,c,s,i,t[m+6],15,-1560198380);i=l(i,r,c,s,t[m+13],21,1309151649);s=l(s,i,r,c,t[m+4],6,-145523070);c=l(c,s,i,r,t[m+11],10,-1120210379);r=l(r,c,s,i,t[m+2],15,718787259);i=l(i,r,c,s,t[m+9],21,-343485551);s=e(s,u);i=e(i,d);r=e(r,f);c=e(c,_)}return[s,i,r,c]};var u={hexdigest:function(e){return i(c(n(e),e.length*8))},hash:function(e){return s(c(n(e),e.length*8))}};return u}();if(!Function.prototype.bind){Function.prototype.bind=function(e){var t=this;var n=Array.prototype.slice;var s=Array.prototype.concat;var i=n.call(arguments,1);return function(){return t.apply(e?e:this,s.call(i,n.call(arguments,0)))}}}(function(e){var t;function n(e,n){return new t.Builder(e,n)}function s(e){return new t.Builder("message",e)}function i(e){return new t.Builder("iq",e)}function r(e){return new t.Builder("presence",e)}t={VERSION:"1.1.3",NS:{HTTPBIND:"http://jabber.org/protocol/httpbind",BOSH:"urn:xmpp:xbosh",CLIENT:"jabber:client",AUTH:"jabber:iq:auth",ROSTER:"jabber:iq:roster",PROFILE:"jabber:iq:profile",DISCO_INFO:"http://jabber.org/protocol/disco#info",DISCO_ITEMS:"http://jabber.org/protocol/disco#items",MUC:"http://jabber.org/protocol/muc",SASL:"urn:ietf:params:xml:ns:xmpp-sasl",STREAM:"http://etherx.jabber.org/streams",BIND:"urn:ietf:params:xml:ns:xmpp-bind",SESSION:"urn:ietf:params:xml:ns:xmpp-session",VERSION:"jabber:iq:version",STANZAS:"urn:ietf:params:xml:ns:xmpp-stanzas",XHTML_IM:"http://jabber.org/protocol/xhtml-im",XHTML:"http://www.w3.org/1999/xhtml"},XHTML:{tags:["a","blockquote","br","cite","em","img","li","ol","p","span","strong","ul","body"],attributes:{a:["href"],blockquote:["style"],br:[],cite:["style"],em:[],img:["src","alt","style","height","width"],li:["style"],ol:["style"],p:["style"],span:["style"],strong:[],ul:["style"],body:[]},css:["background-color","color","font-family","font-size","font-style","font-weight","margin-left","margin-right","text-align","text-decoration"],validTag:function(e){for(var n=0;n<t.XHTML.tags.length;n++){if(e==t.XHTML.tags[n]){return true}}return false},validAttribute:function(e,n){if(typeof t.XHTML.attributes[e]!=="undefined"&&t.XHTML.attributes[e].length>0){for(var s=0;s<t.XHTML.attributes[e].length;s++){if(n==t.XHTML.attributes[e][s]){return true}}}return false},validCSS:function(e){for(var n=0;n<t.XHTML.css.length;n++){if(e==t.XHTML.css[n]){return true}}return false}},Status:{ERROR:0,CONNECTING:1,CONNFAIL:2,AUTHENTICATING:3,AUTHFAIL:4,CONNECTED:5,DISCONNECTED:6,DISCONNECTING:7,ATTACHED:8},LogLevel:{DEBUG:0,INFO:1,WARN:2,ERROR:3,FATAL:4},ElementType:{NORMAL:1,TEXT:3,CDATA:4,FRAGMENT:11},TIMEOUT:1.1,SECONDARY_TIMEOUT:.1,addNamespace:function(e,n){t.NS[e]=n},forEachChild:function(e,n,s){var i,r;for(i=0;i<e.childNodes.length;i++){r=e.childNodes[i];if(r.nodeType==t.ElementType.NORMAL&&(!n||this.isTagEqual(r,n))){s(r)}}},isTagEqual:function(e,t){return e.tagName.toLowerCase()==t.toLowerCase()},_xmlGenerator:null,_makeGenerator:function(){var e;if(document.implementation.createDocument===undefined||document.implementation.createDocument&&document.documentMode&&document.documentMode<10){e=this._getIEXmlDom();e.appendChild(e.createElement("strophe"))}else{e=document.implementation.createDocument("jabber:client","strophe",null)}return e},xmlGenerator:function(){if(!t._xmlGenerator){t._xmlGenerator=t._makeGenerator()}return t._xmlGenerator},_getIEXmlDom:function(){var e=null;var t=["Msxml2.DOMDocument.6.0","Msxml2.DOMDocument.5.0","Msxml2.DOMDocument.4.0","MSXML2.DOMDocument.3.0","MSXML2.DOMDocument","MSXML.DOMDocument","Microsoft.XMLDOM"];for(var n=0;n<t.length;n++){if(e===null){try{e=new ActiveXObject(t[n])}catch(s){e=null}}else{break}}return e},xmlElement:function(e){if(!e){return null}var n=t.xmlGenerator().createElement(e);var s,i,r;for(s=1;s<arguments.length;s++){if(!arguments[s]){continue}if(typeof arguments[s]=="string"||typeof arguments[s]=="number"){n.appendChild(t.xmlTextNode(arguments[s]))}else if(typeof arguments[s]=="object"&&typeof arguments[s].sort=="function"){for(i=0;i<arguments[s].length;i++){if(typeof arguments[s][i]=="object"&&typeof arguments[s][i].sort=="function"){n.setAttribute(arguments[s][i][0],arguments[s][i][1])}}}else if(typeof arguments[s]=="object"){for(r in arguments[s]){if(arguments[s].hasOwnProperty(r)){n.setAttribute(r,arguments[s][r])}}}}return n},xmlescape:function(e){e=e.replace(/\&/g,"&amp;");e=e.replace(/</g,"&lt;");e=e.replace(/>/g,"&gt;");e=e.replace(/'/g,"&apos;");e=e.replace(/"/g,"&quot;");return e},xmlTextNode:function(e){return t.xmlGenerator().createTextNode(e)},xmlHtmlNode:function(e){var t;if(window.DOMParser){var n=new DOMParser;t=n.parseFromString(e,"text/xml")}else{t=new ActiveXObject("Microsoft.XMLDOM");t.async="false";t.loadXML(e)}return t},getText:function(e){if(!e){return null}var n="";if(e.childNodes.length===0&&e.nodeType==t.ElementType.TEXT){n+=e.nodeValue}for(var s=0;s<e.childNodes.length;s++){if(e.childNodes[s].nodeType==t.ElementType.TEXT){n+=e.childNodes[s].nodeValue}}return t.xmlescape(n)},copyElement:function(e){var n,s;if(e.nodeType==t.ElementType.NORMAL){s=t.xmlElement(e.tagName);for(n=0;n<e.attributes.length;n++){s.setAttribute(e.attributes[n].nodeName.toLowerCase(),e.attributes[n].value)}for(n=0;n<e.childNodes.length;n++){s.appendChild(t.copyElement(e.childNodes[n]))}}else if(e.nodeType==t.ElementType.TEXT){s=t.xmlGenerator().createTextNode(e.nodeValue)}return s},createHtml:function(e){var n,s,i,r,a,o,h,l,c,u,d;if(e.nodeType==t.ElementType.NORMAL){r=e.nodeName.toLowerCase();if(t.XHTML.validTag(r)){try{s=t.xmlElement(r);for(n=0;n<t.XHTML.attributes[r].length;n++){a=t.XHTML.attributes[r][n];o=e.getAttribute(a);if(typeof o=="undefined"||o===null||o===""||o===false||o===0){continue}if(a=="style"&&typeof o=="object"){if(typeof o.cssText!="undefined"){o=o.cssText}}if(a=="style"){h=[];l=o.split(";");for(i=0;i<l.length;i++){c=l[i].split(":");u=c[0].replace(/^\s*/,"").replace(/\s*$/,"").toLowerCase();if(t.XHTML.validCSS(u)){d=c[1].replace(/^\s*/,"").replace(/\s*$/,"");h.push(u+": "+d)}}if(h.length>0){o=h.join("; ");s.setAttribute(a,o)}}else{s.setAttribute(a,o)}}for(n=0;n<e.childNodes.length;n++){s.appendChild(t.createHtml(e.childNodes[n]))}}catch(f){s=t.xmlTextNode("")}}else{s=t.xmlGenerator().createDocumentFragment();for(n=0;n<e.childNodes.length;n++){s.appendChild(t.createHtml(e.childNodes[n]))}}}else if(e.nodeType==t.ElementType.FRAGMENT){s=t.xmlGenerator().createDocumentFragment();for(n=0;n<e.childNodes.length;n++){s.appendChild(t.createHtml(e.childNodes[n]))}}else if(e.nodeType==t.ElementType.TEXT){s=t.xmlTextNode(e.nodeValue)}return s},escapeNode:function(e){return e.replace(/^\s+|\s+$/g,"").replace(/\\/g,"\\5c").replace(/ /g,"\\20").replace(/\"/g,"\\22").replace(/\&/g,"\\26").replace(/\'/g,"\\27").replace(/\//g,"\\2f").replace(/:/g,"\\3a").replace(/</g,"\\3c").replace(/>/g,"\\3e").replace(/@/g,"\\40")},unescapeNode:function(e){return e.replace(/\\20/g," ").replace(/\\22/g,'"').replace(/\\26/g,"&").replace(/\\27/g,"'").replace(/\\2f/g,"/").replace(/\\3a/g,":").replace(/\\3c/g,"<").replace(/\\3e/g,">").replace(/\\40/g,"@").replace(/\\5c/g,"\\")},getNodeFromJid:function(e){if(e.indexOf("@")<0){return null}return e.split("@")[0]},getDomainFromJid:function(e){var n=t.getBareJidFromJid(e);if(n.indexOf("@")<0){return n}else{var s=n.split("@");s.splice(0,1);return s.join("@")}},getResourceFromJid:function(e){var t=e.split("/");if(t.length<2){return null}t.splice(0,1);return t.join("/")},getBareJidFromJid:function(e){return e?e.split("/")[0]:null},log:function(e,t){return},debug:function(e){this.log(this.LogLevel.DEBUG,e)},info:function(e){this.log(this.LogLevel.INFO,e)},warn:function(e){this.log(this.LogLevel.WARN,e)},error:function(e){this.log(this.LogLevel.ERROR,e)},fatal:function(e){this.log(this.LogLevel.FATAL,e)},serialize:function(e){var n;if(!e){return null}if(typeof e.tree==="function"){e=e.tree()}var s=e.nodeName;var i,r;if(e.getAttribute("_realname")){s=e.getAttribute("_realname")}n="<"+s;for(i=0;i<e.attributes.length;i++){if(e.attributes[i].nodeName!="_realname"){n+=" "+e.attributes[i].nodeName.toLowerCase()+"='"+e.attributes[i].value.replace(/&/g,"&amp;").replace(/\'/g,"&apos;").replace(/>/g,"&gt;").replace(/</g,"&lt;")+"'"}}if(e.childNodes.length>0){n+=">";for(i=0;i<e.childNodes.length;i++){r=e.childNodes[i];switch(r.nodeType){case t.ElementType.NORMAL:n+=t.serialize(r);break;case t.ElementType.TEXT:n+=t.xmlescape(r.nodeValue);break;case t.ElementType.CDATA:n+="<![CDATA["+r.nodeValue+"]]>"}}n+="</"+s+">"}else{n+="/>"}return n},_requestId:0,_connectionPlugins:{},addConnectionPlugin:function(e,n){t._connectionPlugins[e]=n}};t.Builder=function(e,n){if(e=="presence"||e=="message"||e=="iq"){if(n&&!n.xmlns){n.xmlns=t.NS.CLIENT}else if(!n){n={xmlns:t.NS.CLIENT}}}this.nodeTree=t.xmlElement(e,n);this.node=this.nodeTree};t.Builder.prototype={tree:function(){return this.nodeTree},toString:function(){return t.serialize(this.nodeTree)},up:function(){this.node=this.node.parentNode;return this},attrs:function(e){for(var t in e){if(e.hasOwnProperty(t)){this.node.setAttribute(t,e[t])}}return this},c:function(e,n,s){var i=t.xmlElement(e,n,s);this.node.appendChild(i);if(!s){this.node=i}return this},cnode:function(e){var n;var s=t.xmlGenerator();try{n=s.importNode!==undefined}catch(i){n=false}var r=n?s.importNode(e,true):t.copyElement(e);this.node.appendChild(r);this.node=r;return this},t:function(e){var n=t.xmlTextNode(e);this.node.appendChild(n);return this},h:function(e){var n=document.createElement("body");n.innerHTML=e;var s=t.createHtml(n);while(s.childNodes.length>0){this.node.appendChild(s.childNodes[0])}return this}};t.Handler=function(e,n,s,i,r,a,o){this.handler=e;this.ns=n;this.name=s;this.type=i;this.id=r;this.options=o||{matchBare:false};if(!this.options.matchBare){this.options.matchBare=false}if(this.options.matchBare){this.from=a?t.getBareJidFromJid(a):null}else{this.from=a}this.user=true};t.Handler.prototype={isMatch:function(e){var n;var s=null;if(this.options.matchBare){s=t.getBareJidFromJid(e.getAttribute("from"))}else{s=e.getAttribute("from")}n=false;if(!this.ns){n=true}else{var i=this;t.forEachChild(e,null,function(e){if(e.getAttribute("xmlns")==i.ns){n=true}});n=n||e.getAttribute("xmlns")==this.ns}if(n&&(!this.name||t.isTagEqual(e,this.name))&&(!this.type||e.getAttribute("type")==this.type)&&(!this.id||e.getAttribute("id")==this.id)&&(!this.from||s==this.from)){return true}return false},run:function(e){var n=null;try{n=this.handler(e)}catch(s){if(s.sourceURL){t.fatal("error: "+this.handler+" "+s.sourceURL+":"+s.line+" - "+s.name+": "+s.message)}else if(s.fileName){if(typeof console!="undefined"){console.trace();console.error(this.handler," - error - ",s,s.message)}t.fatal("error: "+this.handler+" "+s.fileName+":"+s.lineNumber+" - "+s.name+": "+s.message)}else{t.fatal("error: "+s.message+"\n"+s.stack)}throw s}return n},toString:function(){return"{Handler: "+this.handler+"("+this.name+","+this.id+","+this.ns+")}"}};t.TimedHandler=function(e,t){this.period=e;this.handler=t;this.lastCalled=(new Date).getTime();this.user=true};t.TimedHandler.prototype={run:function(){this.lastCalled=(new Date).getTime();return this.handler()},reset:function(){this.lastCalled=(new Date).getTime()},toString:function(){return"{TimedHandler: "+this.handler+"("+this.period+")}"}};t.Connection=function(e,n){this.service=e;this.options=n||{};var s=this.options.protocol||"";if(e.indexOf("ws:")===0||e.indexOf("wss:")===0||s.indexOf("ws")===0){this._proto=new t.Websocket(this)}else{this._proto=new t.Bosh(this)}this.jid="";this.domain=null;this.features=null;this._sasl_data={};this.do_session=false;this.do_bind=false;this.timedHandlers=[];this.handlers=[];this.removeTimeds=[];this.removeHandlers=[];this.addTimeds=[];this.addHandlers=[];this._authentication={};this._idleTimeout=null;this._disconnectTimeout=null;this.do_authentication=true;this.authenticated=false;this.disconnecting=false;this.connected=false;this.errors=0;this.paused=false;this._data=[];this._uniqueId=0;this._sasl_success_handler=null;this._sasl_failure_handler=null;this._sasl_challenge_handler=null;this.maxRetries=5;this._idleTimeout=setTimeout(this._onIdle.bind(this),100);for(var i in t._connectionPlugins){if(t._connectionPlugins.hasOwnProperty(i)){var r=t._connectionPlugins[i];var a=function(){};a.prototype=r;this[i]=new a;this[i].init(this)}}};t.Connection.prototype={reset:function(){this._proto._reset();this.do_session=false;this.do_bind=false;this.timedHandlers=[];this.handlers=[];this.removeTimeds=[];this.removeHandlers=[];this.addTimeds=[];this.addHandlers=[];this._authentication={};this.authenticated=false;this.disconnecting=false;this.connected=false;this.errors=0;this._requests=[];this._uniqueId=0},pause:function(){this.paused=true},resume:function(){this.paused=false},getUniqueId:function(e){if(typeof e=="string"||typeof e=="number"){return++this._uniqueId+":"+e}else{return++this._uniqueId+""}},connect:function(e,n,s,i,r,a){this.jid=e;this.authzid=t.getBareJidFromJid(this.jid);this.authcid=t.getNodeFromJid(this.jid);this.pass=n;this.servtype="xmpp";this.connect_callback=s;this.disconnecting=false;this.connected=false;this.authenticated=false;this.errors=0;this.domain=t.getDomainFromJid(this.jid);this._changeConnectStatus(t.Status.CONNECTING,null);this._proto._connect(i,r,a)},attach:function(e,t,n,s,i,r,a){this._proto._attach(e,t,n,s,i,r,a)},xmlInput:function(e){return},xmlOutput:function(e){return},rawInput:function(e){return},rawOutput:function(e){return},send:function(e){if(e===null){return}if(typeof e.sort==="function"){for(var t=0;t<e.length;t++){this._queueData(e[t])}}else if(typeof e.tree==="function"){this._queueData(e.tree())}else{this._queueData(e)}this._proto._send()},flush:function(){clearTimeout(this._idleTimeout);this._onIdle()},sendIQ:function(e,t,n,s){var i=null;var r=this;if(typeof e.tree==="function"){e=e.tree()}var a=e.getAttribute("id");if(!a){a=this.getUniqueId("sendIQ");e.setAttribute("id",a)}var o=this.addHandler(function(e){if(i){r.deleteTimedHandler(i)}var s=e.getAttribute("type");if(s=="result"){if(t){t(e)}}else if(s=="error"){if(n){n(e)}}else{throw{name:"StropheError",message:"Got bad IQ type of "+s}}},null,"iq",null,a);if(s){i=this.addTimedHandler(s,function(){r.deleteHandler(o);if(n){n(null)}return false})}this.send(e);return a},_queueData:function(e){if(e===null||!e.tagName||!e.childNodes){throw{name:"StropheError",message:"Cannot queue non-DOMElement."}}this._data.push(e)},_sendRestart:function(){this._data.push("restart");this._proto._sendRestart();this._idleTimeout=setTimeout(this._onIdle.bind(this),100)},addTimedHandler:function(e,n){var s=new t.TimedHandler(e,n);this.addTimeds.push(s);return s},deleteTimedHandler:function(e){this.removeTimeds.push(e)},addHandler:function(e,n,s,i,r,a,o){var h=new t.Handler(e,n,s,i,r,a,o);this.addHandlers.push(h);return h},deleteHandler:function(e){this.removeHandlers.push(e)},disconnect:function(e){this._changeConnectStatus(t.Status.DISCONNECTING,e);t.info("Disconnect was called because: "+e);if(this.connected){var n=false;this.disconnecting=true;if(this.authenticated){n=r({xmlns:t.NS.CLIENT,type:"unavailable"})}this._disconnectTimeout=this._addSysTimedHandler(3e3,this._onDisconnectTimeout.bind(this));this._proto._disconnect(n)}},_changeConnectStatus:function(e,n){for(var s in t._connectionPlugins){if(t._connectionPlugins.hasOwnProperty(s)){var i=this[s];if(i.statusChanged){try{i.statusChanged(e,n)}catch(r){t.error(""+s+" plugin caused an exception "+"changing status: "+r)}}}}if(this.connect_callback){try{this.connect_callback(e,n)}catch(a){t.error("User connection callback caused an "+"exception: "+a)}}},_doDisconnect:function(){if(this._disconnectTimeout!==null){this.deleteTimedHandler(this._disconnectTimeout);this._disconnectTimeout=null}t.info("_doDisconnect was called");this._proto._doDisconnect();this.authenticated=false;this.disconnecting=false;this.handlers=[];this.timedHandlers=[];this.removeTimeds=[];this.removeHandlers=[];this.addTimeds=[];this.addHandlers=[];this._changeConnectStatus(t.Status.DISCONNECTED,null);this.connected=false},_dataRecv:function(e,n){t.info("_dataRecv called");var s=this._proto._reqToData(e);if(s===null){return}if(this.xmlInput!==t.Connection.prototype.xmlInput){if(s.nodeName===this._proto.strip&&s.childNodes.length){this.xmlInput(s.childNodes[0])}else{this.xmlInput(s)}}if(this.rawInput!==t.Connection.prototype.rawInput){if(n){this.rawInput(n)}else{this.rawInput(t.serialize(s))}}var i,r;while(this.removeHandlers.length>0){r=this.removeHandlers.pop();i=this.handlers.indexOf(r);if(i>=0){this.handlers.splice(i,1)}}while(this.addHandlers.length>0){this.handlers.push(this.addHandlers.pop())}if(this.disconnecting&&this._proto._emptyQueue()){this._doDisconnect();return}var a=s.getAttribute("type");var o,h;if(a!==null&&a=="terminate"){if(this.disconnecting){return}o=s.getAttribute("condition");h=s.getElementsByTagName("conflict");if(o!==null){if(o=="remote-stream-error"&&h.length>0){o="conflict"}this._changeConnectStatus(t.Status.CONNFAIL,o)}else{this._changeConnectStatus(t.Status.CONNFAIL,"unknown")}this.disconnect("unknown stream-error");return}var l=this;t.forEachChild(s,null,function(e){var n,s;s=l.handlers;l.handlers=[];for(n=0;n<s.length;n++){var i=s[n];try{if(i.isMatch(e)&&(l.authenticated||!i.user)){if(i.run(e)){l.handlers.push(i)}}else{l.handlers.push(i)}}catch(r){t.warn("Removing Strophe handlers due to uncaught exception: "+r.message)}}})},mechanisms:{},_connect_cb:function(e,n,s){t.info("_connect_cb was called");this.connected=true;var i=this._proto._reqToData(e);if(!i){return}if(this.xmlInput!==t.Connection.prototype.xmlInput){if(i.nodeName===this._proto.strip&&i.childNodes.length){this.xmlInput(i.childNodes[0])}else{this.xmlInput(i)}}if(this.rawInput!==t.Connection.prototype.rawInput){if(s){this.rawInput(s)}else{this.rawInput(t.serialize(i))}}var r=this._proto._connect_cb(i);if(r===t.Status.CONNFAIL){return}this._authentication.sasl_scram_sha1=false;this._authentication.sasl_plain=false;this._authentication.sasl_digest_md5=false;this._authentication.sasl_anonymous=false;this._authentication.legacy_auth=false;var a=i.getElementsByTagName("stream:features").length>0;if(!a){a=i.getElementsByTagName("features").length>0}var o=i.getElementsByTagName("mechanism");var h=[];var l,c,u=false;if(!a){this._proto._no_auth_received(n);return}if(o.length>0){for(l=0;l<o.length;l++){c=t.getText(o[l]);if(this.mechanisms[c])h.push(this.mechanisms[c])}}this._authentication.legacy_auth=i.getElementsByTagName("auth").length>0;u=this._authentication.legacy_auth||h.length>0;if(!u){this._proto._no_auth_received(n);return}if(this.do_authentication!==false)this.authenticate(h)},authenticate:function(e){var s;for(s=0;s<e.length-1;++s){var r=s;for(var a=s+1;a<e.length;++a){if(e[a].prototype.priority>e[r].prototype.priority){r=a}}if(r!=s){var o=e[s];e[s]=e[r];e[r]=o}}var h=false;for(s=0;s<e.length;++s){if(!e[s].test(this))continue;this._sasl_success_handler=this._addSysHandler(this._sasl_success_cb.bind(this),null,"success",null,null);this._sasl_failure_handler=this._addSysHandler(this._sasl_failure_cb.bind(this),null,"failure",null,null);this._sasl_challenge_handler=this._addSysHandler(this._sasl_challenge_cb.bind(this),null,"challenge",null,null);this._sasl_mechanism=new e[s];this._sasl_mechanism.onStart(this);var l=n("auth",{xmlns:t.NS.SASL,mechanism:this._sasl_mechanism.name});if(this._sasl_mechanism.isClientFirst){var c=this._sasl_mechanism.onChallenge(this,null);l.t(Base64.encode(c))}this.send(l.tree());h=true;break}if(!h){if(t.getNodeFromJid(this.jid)===null){this._changeConnectStatus(t.Status.CONNFAIL,"x-strophe-bad-non-anon-jid");this.disconnect("x-strophe-bad-non-anon-jid")}else{this._changeConnectStatus(t.Status.AUTHENTICATING,null);this._addSysHandler(this._auth1_cb.bind(this),null,null,null,"_auth_1");this.send(i({type:"get",to:this.domain,id:"_auth_1"}).c("query",{xmlns:t.NS.AUTH}).c("username",{}).t(t.getNodeFromJid(this.jid)).tree())}}},_sasl_challenge_cb:function(e){var s=Base64.decode(t.getText(e));var i=this._sasl_mechanism.onChallenge(this,s);var r=n("response",{xmlns:t.NS.SASL});if(i!==""){r.t(Base64.encode(i))}this.send(r.tree());return true},_auth1_cb:function(e){var n=i({type:"set",id:"_auth_2"}).c("query",{xmlns:t.NS.AUTH}).c("username",{}).t(t.getNodeFromJid(this.jid)).up().c("password").t(this.pass);if(!t.getResourceFromJid(this.jid)){this.jid=t.getBareJidFromJid(this.jid)+"/strophe"}n.up().c("resource",{}).t(t.getResourceFromJid(this.jid));this._addSysHandler(this._auth2_cb.bind(this),null,null,null,"_auth_2");this.send(n.tree());return false},_sasl_success_cb:function(e){if(this._sasl_data["server-signature"]){var n;var s=Base64.decode(t.getText(e));var i=/([a-z]+)=([^,]+)(,|$)/;var r=s.match(i);if(r[1]=="v"){n=r[2]}if(n!=this._sasl_data["server-signature"]){this.deleteHandler(this._sasl_failure_handler);this._sasl_failure_handler=null;if(this._sasl_challenge_handler){this.deleteHandler(this._sasl_challenge_handler);this._sasl_challenge_handler=null}this._sasl_data={};return this._sasl_failure_cb(null)}}t.info("SASL authentication succeeded.");if(this._sasl_mechanism)this._sasl_mechanism.onSuccess();this.deleteHandler(this._sasl_failure_handler);this._sasl_failure_handler=null;if(this._sasl_challenge_handler){this.deleteHandler(this._sasl_challenge_handler);this._sasl_challenge_handler=null}this._addSysHandler(this._sasl_auth1_cb.bind(this),null,"stream:features",null,null);this._sendRestart();return false},_sasl_auth1_cb:function(e){this.features=e;var n,s;for(n=0;n<e.childNodes.length;n++){s=e.childNodes[n];if(s.nodeName=="bind"){this.do_bind=true}if(s.nodeName=="session"){this.do_session=true}}if(!this.do_bind){this._changeConnectStatus(t.Status.AUTHFAIL,null);return false}else{this._addSysHandler(this._sasl_bind_cb.bind(this),null,null,null,"_bind_auth_2");var r=t.getResourceFromJid(this.jid);if(r){this.send(i({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:t.NS.BIND}).c("resource",{}).t(r).tree())}else{this.send(i({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:t.NS.BIND}).tree())}}return false},_sasl_bind_cb:function(e){if(e.getAttribute("type")=="error"){t.info("SASL binding failed.");var n=e.getElementsByTagName("conflict"),s;if(n.length>0){s="conflict"}this._changeConnectStatus(t.Status.AUTHFAIL,s);return false}var r=e.getElementsByTagName("bind");var a;if(r.length>0){a=r[0].getElementsByTagName("jid");if(a.length>0){this.jid=t.getText(a[0]);if(this.do_session){this._addSysHandler(this._sasl_session_cb.bind(this),null,null,null,"_session_auth_2");this.send(i({type:"set",id:"_session_auth_2"}).c("session",{xmlns:t.NS.SESSION}).tree())}else{this.authenticated=true;this._changeConnectStatus(t.Status.CONNECTED,null)}}}else{t.info("SASL binding failed.");this._changeConnectStatus(t.Status.AUTHFAIL,null);return false}},_sasl_session_cb:function(e){if(e.getAttribute("type")=="result"){this.authenticated=true;this._changeConnectStatus(t.Status.CONNECTED,null)}else if(e.getAttribute("type")=="error"){t.info("Session creation failed.");this._changeConnectStatus(t.Status.AUTHFAIL,null);return false}return false},_sasl_failure_cb:function(e){if(this._sasl_success_handler){this.deleteHandler(this._sasl_success_handler);this._sasl_success_handler=null}if(this._sasl_challenge_handler){this.deleteHandler(this._sasl_challenge_handler);this._sasl_challenge_handler=null}if(this._sasl_mechanism)this._sasl_mechanism.onFailure();this._changeConnectStatus(t.Status.AUTHFAIL,null);return false},_auth2_cb:function(e){if(e.getAttribute("type")=="result"){this.authenticated=true;this._changeConnectStatus(t.Status.CONNECTED,null)}else if(e.getAttribute("type")=="error"){this._changeConnectStatus(t.Status.AUTHFAIL,null);this.disconnect("authentication failed")}return false},_addSysTimedHandler:function(e,n){var s=new t.TimedHandler(e,n);s.user=false;this.addTimeds.push(s);return s},_addSysHandler:function(e,n,s,i,r){var a=new t.Handler(e,n,s,i,r);a.user=false;this.addHandlers.push(a);return a},_onDisconnectTimeout:function(){t.info("_onDisconnectTimeout was called");this._proto._onDisconnectTimeout();this._doDisconnect();return false},_onIdle:function(){var e,t,n,s;while(this.addTimeds.length>0){this.timedHandlers.push(this.addTimeds.pop())}while(this.removeTimeds.length>0){t=this.removeTimeds.pop();e=this.timedHandlers.indexOf(t);if(e>=0){this.timedHandlers.splice(e,1)}}var i=(new Date).getTime();s=[];for(e=0;e<this.timedHandlers.length;e++){t=this.timedHandlers[e];if(this.authenticated||!t.user){n=t.lastCalled+t.period;if(n-i<=0){if(t.run()){s.push(t)}}else{s.push(t)}}}this.timedHandlers=s;clearTimeout(this._idleTimeout);this._proto._onIdle();if(this.connected){this._idleTimeout=setTimeout(this._onIdle.bind(this),100)}}};if(e){e(t,n,s,i,r)}t.SASLMechanism=function(e,t,n){this.name=e;this.isClientFirst=t;this.priority=n};t.SASLMechanism.prototype={test:function(e){return true},onStart:function(e){this._connection=e},onChallenge:function(e,t){throw new Error("You should implement challenge handling!")},onFailure:function(){this._connection=null},onSuccess:function(){this._connection=null}};t.SASLAnonymous=function(){};t.SASLAnonymous.prototype=new t.SASLMechanism("ANONYMOUS",false,10);t.SASLAnonymous.test=function(e){return e.authcid===null};t.Connection.prototype.mechanisms[t.SASLAnonymous.prototype.name]=t.SASLAnonymous;t.SASLPlain=function(){};t.SASLPlain.prototype=new t.SASLMechanism("PLAIN",true,20);t.SASLPlain.test=function(e){return e.authcid!==null};t.SASLPlain.prototype.onChallenge=function(e){var t=e.authzid;t=t+"\x00";t=t+e.authcid;t=t+"\x00";t=t+e.pass;return t};t.Connection.prototype.mechanisms[t.SASLPlain.prototype.name]=t.SASLPlain;t.SASLSHA1=function(){};t.SASLSHA1.prototype=new t.SASLMechanism("SCRAM-SHA-1",true,40);t.SASLSHA1.test=function(e){return e.authcid!==null};t.SASLSHA1.prototype.onChallenge=function(e,t,n){var s=n||MD5.hexdigest(Math.random()*1234567890);var i="n="+e.authcid;i+=",r=";i+=s;e._sasl_data.cnonce=s;e._sasl_data["client-first-message-bare"]=i;i="n,,"+i;this.onChallenge=function(e,t){var n,s,i,r,a,o,h,l;var c,u,d;var f="c=biws,";var _=e._sasl_data["client-first-message-bare"]+","+t+",";var m=e._sasl_data.cnonce;var p=/([a-z]+)=([^,]+)(,|$)/;while(t.match(p)){var g=t.match(p);t=t.replace(g[0],"");switch(g[1]){case"r":n=g[2];break;case"s":s=g[2];break;case"i":i=g[2];break}}if(n.substr(0,m.length)!==m){e._sasl_data={};return e._sasl_failure_cb()}f+="r="+n;_+=f;s=Base64.decode(s);s+="\x00\x00\x00";r=o=core_hmac_sha1(e.pass,s);for(h=1;h<i;h++){a=core_hmac_sha1(e.pass,binb2str(o));for(l=0;l<5;l++){r[l]^=a[l]}o=a}r=binb2str(r);c=core_hmac_sha1(r,"Client Key");u=str_hmac_sha1(r,"Server Key");d=core_hmac_sha1(str_sha1(binb2str(c)),_);e._sasl_data["server-signature"]=b64_hmac_sha1(u,_);for(l=0;l<5;l++){c[l]^=d[l]}f+=",p="+Base64.encode(binb2str(c));return f}.bind(this);return i};t.Connection.prototype.mechanisms[t.SASLSHA1.prototype.name]=t.SASLSHA1;t.SASLMD5=function(){};t.SASLMD5.prototype=new t.SASLMechanism("DIGEST-MD5",false,30);t.SASLMD5.test=function(e){return e.authcid!==null};t.SASLMD5.prototype._quote=function(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'};t.SASLMD5.prototype.onChallenge=function(e,t,n){var s=/([a-z]+)=("[^"]+"|[^,"]+)(?:,|$)/;var i=n||MD5.hexdigest(""+Math.random()*1234567890);var r="";var a=null;var o="";var h="";var l;while(t.match(s)){l=t.match(s);t=t.replace(l[0],"");l[2]=l[2].replace(/^"(.+)"$/,"$1");switch(l[1]){case"realm":r=l[2];break;case"nonce":o=l[2];break;case"qop":h=l[2];break;case"host":a=l[2];break}}var c=e.servtype+"/"+e.domain;if(a!==null){c=c+"/"+a}var u=MD5.hash(e.authcid+":"+r+":"+this._connection.pass)+":"+o+":"+i;var d="AUTHENTICATE:"+c;var f="";f+="charset=utf-8,";f+="username="+this._quote(e.authcid)+",";f+="realm="+this._quote(r)+",";f+="nonce="+this._quote(o)+",";f+="nc=00000001,";f+="cnonce="+this._quote(i)+",";f+="digest-uri="+this._quote(c)+",";f+="response="+MD5.hexdigest(MD5.hexdigest(u)+":"+o+":00000001:"+i+":auth:"+MD5.hexdigest(d))+",";f+="qop=auth";this.onChallenge=function(){return""}.bind(this);return f};t.Connection.prototype.mechanisms[t.SASLMD5.prototype.name]=t.SASLMD5})(function(){window.Strophe=arguments[0];window.$build=arguments[1];window.$msg=arguments[2];window.$iq=arguments[3];window.$pres=arguments[4]});Strophe.Request=function(e,t,n,s){this.id=++Strophe._requestId;this.xmlData=e;this.data=Strophe.serialize(e);this.origFunc=t;this.func=t;this.rid=n;this.date=NaN;this.sends=s||0;this.abort=false;this.dead=null;this.age=function(){if(!this.date){return 0}var e=new Date;return(e-this.date)/1e3};this.timeDead=function(){if(!this.dead){return 0}var e=new Date;return(e-this.dead)/1e3};this.xhr=this._newXHR()};Strophe.Request.prototype={getResponse:function(){var e=null;if(this.xhr.responseXML&&this.xhr.responseXML.documentElement){e=this.xhr.responseXML.documentElement;if(e.tagName=="parsererror"){Strophe.error("invalid response received");Strophe.error("responseText: "+this.xhr.responseText);Strophe.error("responseXML: "+Strophe.serialize(this.xhr.responseXML));throw"parsererror"}}else if(this.xhr.responseText){Strophe.error("invalid response received");Strophe.error("responseText: "+this.xhr.responseText);Strophe.error("responseXML: "+Strophe.serialize(this.xhr.responseXML))}return e},_newXHR:function(){var e=null;if(window.XMLHttpRequest){e=new XMLHttpRequest;if(e.overrideMimeType){e.overrideMimeType("text/xml")}}else if(window.ActiveXObject){e=new ActiveXObject("Microsoft.XMLHTTP")}e.onreadystatechange=this.func.bind(null,this);return e}};Strophe.Bosh=function(e){this._conn=e;this.rid=Math.floor(Math.random()*4294967295);this.sid=null;this.hold=1;this.wait=60;this.window=5;this._requests=[]};Strophe.Bosh.prototype={strip:null,_buildBody:function(){var e=$build("body",{rid:this.rid++,xmlns:Strophe.NS.HTTPBIND});if(this.sid!==null){e.attrs({sid:this.sid})}return e},_reset:function(){this.rid=Math.floor(Math.random()*4294967295);this.sid=null},_connect:function(e,t,n){this.wait=e||this.wait;this.hold=t||this.hold;var s=this._buildBody().attrs({to:this._conn.domain,"xml:lang":"en",wait:this.wait,hold:this.hold,content:"text/xml; charset=utf-8",ver:"1.6","xmpp:version":"1.0","xmlns:xmpp":Strophe.NS.BOSH});if(n){s.attrs({route:n})}var i=this._conn._connect_cb;this._requests.push(new Strophe.Request(s.tree(),this._onRequestStateChange.bind(this,i.bind(this._conn)),s.tree().getAttribute("rid")));this._throttledRequestHandler()},_attach:function(e,t,n,s,i,r,a){this._conn.jid=e;this.sid=t;this.rid=n;this._conn.connect_callback=s;this._conn.domain=Strophe.getDomainFromJid(this._conn.jid);this._conn.authenticated=true;this._conn.connected=true;this.wait=i||this.wait;this.hold=r||this.hold;this.window=a||this.window;this._conn._changeConnectStatus(Strophe.Status.ATTACHED,null)},_connect_cb:function(e){var t=e.getAttribute("type");var n,s;if(t!==null&&t=="terminate"){Strophe.error("BOSH-Connection failed: "+n);n=e.getAttribute("condition");s=e.getElementsByTagName("conflict");if(n!==null){if(n=="remote-stream-error"&&s.length>0){n="conflict"}this._conn._changeConnectStatus(Strophe.Status.CONNFAIL,n)}else{this._conn._changeConnectStatus(Strophe.Status.CONNFAIL,"unknown")}this._conn._doDisconnect();return Strophe.Status.CONNFAIL}if(!this.sid){this.sid=e.getAttribute("sid")}var i=e.getAttribute("requests");if(i){this.window=parseInt(i,10)}var r=e.getAttribute("hold");if(r){this.hold=parseInt(r,10)}var a=e.getAttribute("wait");if(a){this.wait=parseInt(a,10)}},_disconnect:function(e){this._sendTerminate(e)},_doDisconnect:function(){this.sid=null;this.rid=Math.floor(Math.random()*4294967295)},_emptyQueue:function(){return this._requests.length===0},_hitError:function(e){this.errors++;Strophe.warn("request errored, status: "+e+", number of errors: "+this.errors);if(this.errors>4){this._onDisconnectTimeout()}},_no_auth_received:function(e){if(e){e=e.bind(this._conn)}else{e=this._conn._connect_cb.bind(this._conn)}var t=this._buildBody();this._requests.push(new Strophe.Request(t.tree(),this._onRequestStateChange.bind(this,e.bind(this._conn)),t.tree().getAttribute("rid")));this._throttledRequestHandler()},_onDisconnectTimeout:function(){var e;while(this._requests.length>0){e=this._requests.pop();e.abort=true;e.xhr.abort();e.xhr.onreadystatechange=function(){}}},_onIdle:function(){var e=this._conn._data;if(this._conn.authenticated&&this._requests.length===0&&e.length===0&&!this._conn.disconnecting){Strophe.info("no requests during idle cycle, sending "+"blank request");e.push(null)}if(this._requests.length<2&&e.length>0&&!this._conn.paused){var t=this._buildBody();for(var n=0;n<e.length;n++){if(e[n]!==null){if(e[n]==="restart"){t.attrs({to:this._conn.domain,"xml:lang":"en","xmpp:restart":"true","xmlns:xmpp":Strophe.NS.BOSH})}else{t.cnode(e[n]).up()}}}delete this._conn._data;this._conn._data=[];this._requests.push(new Strophe.Request(t.tree(),this._onRequestStateChange.bind(this,this._conn._dataRecv.bind(this._conn)),t.tree().getAttribute("rid")));this._processRequest(this._requests.length-1)}if(this._requests.length>0){var s=this._requests[0].age();if(this._requests[0].dead!==null){if(this._requests[0].timeDead()>Math.floor(Strophe.SECONDARY_TIMEOUT*this.wait)){this._throttledRequestHandler()}}if(s>Math.floor(Strophe.TIMEOUT*this.wait)){Strophe.warn("Request "+this._requests[0].id+" timed out, over "+Math.floor(Strophe.TIMEOUT*this.wait)+" seconds since last activity");this._throttledRequestHandler()}}},_onRequestStateChange:function(e,t){Strophe.debug("request id "+t.id+"."+t.sends+" state changed to "+t.xhr.readyState);if(t.abort){t.abort=false;return}var n;if(t.xhr.readyState==4){n=0;try{n=t.xhr.status}catch(s){}if(typeof n=="undefined"){n=0}if(this.disconnecting){if(n>=400){this._hitError(n);return}}var i=this._requests[0]==t;var r=this._requests[1]==t;if(n>0&&n<500||t.sends>5){this._removeRequest(t);Strophe.debug("request id "+t.id+" should now be removed")}if(n==200){if(r||i&&this._requests.length>0&&this._requests[0].age()>Math.floor(Strophe.SECONDARY_TIMEOUT*this.wait)){this._restartRequest(0)}Strophe.debug("request id "+t.id+"."+t.sends+" got 200");e(t);this.errors=0}else{Strophe.error("request id "+t.id+"."+t.sends+" error "+n+" happened");if(n===0||n>=400&&n<600||n>=12e3){this._hitError(n);if(n>=400&&n<500){this._conn._changeConnectStatus(Strophe.Status.DISCONNECTING,null);this._conn._doDisconnect()}}}if(!(n>0&&n<500||t.sends>5)){this._throttledRequestHandler()}}},_processRequest:function(e){var t=this;var n=this._requests[e];var s=-1;try{if(n.xhr.readyState==4){s=n.xhr.status}}catch(i){Strophe.error("caught an error in _requests["+e+"], reqStatus: "+s)}if(typeof s=="undefined"){s=-1}if(n.sends>this.maxRetries){this._onDisconnectTimeout();return}var r=n.age();var a=!isNaN(r)&&r>Math.floor(Strophe.TIMEOUT*this.wait);var o=n.dead!==null&&n.timeDead()>Math.floor(Strophe.SECONDARY_TIMEOUT*this.wait);var h=n.xhr.readyState==4&&(s<1||s>=500);if(a||o||h){if(o){Strophe.error("Request "+this._requests[e].id+" timed out (secondary), restarting")}n.abort=true;n.xhr.abort();n.xhr.onreadystatechange=function(){};this._requests[e]=new Strophe.Request(n.xmlData,n.origFunc,n.rid,n.sends);n=this._requests[e]}if(n.xhr.readyState===0){Strophe.debug("request id "+n.id+"."+n.sends+" posting");try{n.xhr.open("POST",this._conn.service,this._conn.options.sync?false:true)}catch(l){Strophe.error("XHR open failed.");if(!this._conn.connected){this._conn._changeConnectStatus(Strophe.Status.CONNFAIL,"bad-service")}this._conn.disconnect();return}var c=function(){n.date=new Date;if(t._conn.options.customHeaders){var e=t._conn.options.customHeaders;for(var s in e){if(e.hasOwnProperty(s)){n.xhr.setRequestHeader(s,e[s])}}}n.xhr.send(n.data)};if(n.sends>1){var u=Math.min(Math.floor(Strophe.TIMEOUT*this.wait),Math.pow(n.sends,3))*1e3;setTimeout(c,u)}else{c()}n.sends++;if(this._conn.xmlOutput!==Strophe.Connection.prototype.xmlOutput){if(n.xmlData.nodeName===this.strip&&n.xmlData.childNodes.length){this._conn.xmlOutput(n.xmlData.childNodes[0])}else{this._conn.xmlOutput(n.xmlData)}}if(this._conn.rawOutput!==Strophe.Connection.prototype.rawOutput){this._conn.rawOutput(n.data)}}else{Strophe.debug("_processRequest: "+(e===0?"first":"second")+" request has readyState of "+n.xhr.readyState)}},_removeRequest:function(e){Strophe.debug("removing request");var t;for(t=this._requests.length-1;t>=0;t--){if(e==this._requests[t]){this._requests.splice(t,1)}}e.xhr.onreadystatechange=function(){};this._throttledRequestHandler()},_restartRequest:function(e){var t=this._requests[e];if(t.dead===null){t.dead=new Date}this._processRequest(e)},_reqToData:function(e){try{return e.getResponse()}catch(t){if(t!="parsererror"){throw t}this._conn.disconnect("strophe-parsererror")}},_sendTerminate:function(e){Strophe.info("_sendTerminate was called");var t=this._buildBody().attrs({type:"terminate"});if(e){t.cnode(e.tree())}var n=new Strophe.Request(t.tree(),this._onRequestStateChange.bind(this,this._conn._dataRecv.bind(this._conn)),t.tree().getAttribute("rid"));this._requests.push(n);this._throttledRequestHandler()},_send:function(){clearTimeout(this._conn._idleTimeout);this._throttledRequestHandler();this._conn._idleTimeout=setTimeout(this._conn._onIdle.bind(this._conn),100)},_sendRestart:function(){this._throttledRequestHandler();clearTimeout(this._conn._idleTimeout)},_throttledRequestHandler:function(){if(!this._requests){Strophe.debug("_throttledRequestHandler called with "+"undefined requests")}else{Strophe.debug("_throttledRequestHandler called with "+this._requests.length+" requests")}if(!this._requests||this._requests.length===0){return}if(this._requests.length>0){this._processRequest(0)}if(this._requests.length>1&&Math.abs(this._requests[0].rid-this._requests[1].rid)<this.window){this._processRequest(1)}}};Strophe.Websocket=function(e){this._conn=e;this.strip="stream:stream";var t=e.service;if(t.indexOf("ws:")!==0&&t.indexOf("wss:")!==0){var n="";if(e.options.protocol==="ws"&&window.location.protocol!=="https:"){n+="ws"}else{n+="wss"}n+="://"+window.location.host;if(t.indexOf("/")!==0){n+=window.location.pathname+t}else{n+=t}e.service=n}};Strophe.Websocket.prototype={_buildStream:function(){return $build("stream:stream",{to:this._conn.domain,xmlns:Strophe.NS.CLIENT,"xmlns:stream":Strophe.NS.STREAM,version:"1.0"})},_check_streamerror:function(e,t){var n=e.getElementsByTagName("stream:error");if(n.length===0){return false}var s=n[0];var i="";var r="";var a="urn:ietf:params:xml:ns:xmpp-streams";for(var o=0;o<s.childNodes.length;o++){var h=s.childNodes[o];if(h.getAttribute("xmlns")!==a){break}if(h.nodeName==="text"){r=h.textContent}else{i=h.nodeName}}var l="WebSocket stream error: ";if(i){l+=i}else{l+="unknown"}if(r){l+=" - "+i}Strophe.error(l);this._conn._changeConnectStatus(t,i);this._conn._doDisconnect();return true},_reset:function(){return},_connect:function(){this._closeSocket();this.socket=new WebSocket(this._conn.service,"xmpp");this.socket.onopen=this._onOpen.bind(this);this.socket.onerror=this._onError.bind(this);this.socket.onclose=this._onClose.bind(this);this.socket.onmessage=this._connect_cb_wrapper.bind(this)},_connect_cb:function(e){var t=this._check_streamerror(e,Strophe.Status.CONNFAIL);if(t){return Strophe.Status.CONNFAIL}},_handleStreamStart:function(e){var t=false;var n=e.getAttribute("xmlns");if(typeof n!=="string"){t="Missing xmlns in stream:stream"}else if(n!==Strophe.NS.CLIENT){t="Wrong xmlns in stream:stream: "+n}var s=e.namespaceURI;if(typeof s!=="string"){t="Missing xmlns:stream in stream:stream"}else if(s!==Strophe.NS.STREAM){t="Wrong xmlns:stream in stream:stream: "+s}var i=e.getAttribute("version");if(typeof i!=="string"){t="Missing version in stream:stream"}else if(i!=="1.0"){t="Wrong version in stream:stream: "+i}if(t){this._conn._changeConnectStatus(Strophe.Status.CONNFAIL,t);this._conn._doDisconnect();return false}return true},_connect_cb_wrapper:function(e){if(e.data.indexOf("<stream:stream ")===0||e.data.indexOf("<?xml")===0){var t=e.data.replace(/^(<\?.*?\?>\s*)*/,"");if(t==="")return;t=e.data.replace(/<stream:stream (.*[^\/])>/,"<stream:stream $1/>");var n=(new DOMParser).parseFromString(t,"text/xml").documentElement;this._conn.xmlInput(n);this._conn.rawInput(e.data);if(this._handleStreamStart(n)){this._connect_cb(n);this.streamStart=e.data.replace(/^<stream:(.*)\/>$/,"<stream:$1>")}}else if(e.data==="</stream:stream>"){this._conn.rawInput(e.data);this._conn.xmlInput(document.createElement("stream:stream"));this._conn._changeConnectStatus(Strophe.Status.CONNFAIL,"Received closing stream");this._conn._doDisconnect();return}else{var s=this._streamWrap(e.data);var i=(new DOMParser).parseFromString(s,"text/xml").documentElement;this.socket.onmessage=this._onMessage.bind(this);this._conn._connect_cb(i,null,e.data)}},_disconnect:function(e){if(this.socket.readyState!==WebSocket.CLOSED){if(e){this._conn.send(e)}var t="</stream:stream>";this._conn.xmlOutput(document.createElement("stream:stream"));this._conn.rawOutput(t);try{this.socket.send(t)}catch(n){Strophe.info("Couldn't send closing stream tag.")}}this._conn._doDisconnect()},_doDisconnect:function(){Strophe.info("WebSockets _doDisconnect was called");this._closeSocket()},_streamWrap:function(e){return this.streamStart+e+"</stream:stream>"},_closeSocket:function(){if(this.socket){try{this.socket.close()}catch(e){}}this.socket=null},_emptyQueue:function(){return true},_onClose:function(){if(this._conn.connected&&!this._conn.disconnecting){Strophe.error("Websocket closed unexcectedly");this._conn._doDisconnect()}else{Strophe.info("Websocket closed")}},_no_auth_received:function(e){Strophe.error("Server did not send any auth methods");this._conn._changeConnectStatus(Strophe.Status.CONNFAIL,"Server did not send any auth methods");if(e){e=e.bind(this._conn);e()}this._conn._doDisconnect()},_onDisconnectTimeout:function(){},_onError:function(e){Strophe.error("Websocket error "+e);this._conn._changeConnectStatus(Strophe.Status.CONNFAIL,"The WebSocket connection could not be established was disconnected.");this._disconnect()},_onIdle:function(){var e=this._conn._data;if(e.length>0&&!this._conn.paused){for(var t=0;t<e.length;t++){if(e[t]!==null){var n,s;if(e[t]==="restart"){n=this._buildStream();s=this._removeClosingTag(n);n=n.tree()}else{n=e[t];s=Strophe.serialize(n)}this._conn.xmlOutput(n);this._conn.rawOutput(s);this.socket.send(s)}}this._conn._data=[]}},_onMessage:function(e){var t,n;if(e.data==="</stream:stream>"){var s="</stream:stream>";this._conn.rawInput(s);this._conn.xmlInput(document.createElement("stream:stream"));if(!this._conn.disconnecting){this._conn._doDisconnect()}return}else if(e.data.search("<stream:stream ")===0){n=e.data.replace(/<stream:stream (.*[^\/])>/,"<stream:stream $1/>");t=(new DOMParser).parseFromString(n,"text/xml").documentElement;if(!this._handleStreamStart(t)){return}}else{n=this._streamWrap(e.data);t=(new DOMParser).parseFromString(n,"text/xml").documentElement}if(this._check_streamerror(t,Strophe.Status.ERROR)){return}if(this._conn.disconnecting&&t.firstChild.nodeName==="presence"&&t.firstChild.getAttribute("type")==="unavailable"){this._conn.xmlInput(t);this._conn.rawInput(Strophe.serialize(t));return}this._conn._dataRecv(t,e.data)},_onOpen:function(){Strophe.info("Websocket open");var e=this._buildStream();this._conn.xmlOutput(e.tree());var t=this._removeClosingTag(e);this._conn.rawOutput(t);this.socket.send(t)},_removeClosingTag:function(e){var t=Strophe.serialize(e);t=t.replace(/<(stream:stream .*[^\/])\/>$/,"<$1>");return t},_reqToData:function(e){return e},_send:function(){this._conn.flush()},_sendRestart:function(){clearTimeout(this._conn._idleTimeout);this._conn._onIdle.bind(this._conn)()}};(function(){var t,e,i,n={}.hasOwnProperty,o=function(t,e){return function(){return t.apply(e,arguments)}};Strophe.addConnectionPlugin("muc",{_connection:null,rooms:{},roomNames:[],init:function(t){this._connection=t;this._muc_handler=null;Strophe.addNamespace("MUC_OWNER",Strophe.NS.MUC+"#owner");Strophe.addNamespace("MUC_ADMIN",Strophe.NS.MUC+"#admin");Strophe.addNamespace("MUC_USER",Strophe.NS.MUC+"#user");Strophe.addNamespace("MUC_ROOMCONF",Strophe.NS.MUC+"#roomconfig");return Strophe.addNamespace("MUC_REGISTER","jabber:iq:register")},join:function(t,e,n,o,r,s,c){var h,u;u=this.test_append_nick(t,e);h=$pres({from:this._connection.jid,to:u}).c("x",{xmlns:Strophe.NS.MUC});if(c!=null){h=h.c("history",c).up()}if(s!=null){h.cnode(Strophe.xmlElement("password",[],s))}if(typeof extended_presence!=="undefined"&&extended_presence!==null){h.up.cnode(extended_presence)}if(this._muc_handler==null){this._muc_handler=this._connection.addHandler(function(e){return function(i){var n,o,r,s,c,h,u,a,l,d;n=i.getAttribute("from");if(!n){return true}c=n.split("/")[0];if(!e.rooms[c]){return true}t=e.rooms[c];r={};if(i.nodeName==="message"){r=t._message_handlers}else if(i.nodeName==="presence"){a=i.getElementsByTagName("x");if(a.length>0){for(l=0,d=a.length;l<d;l++){h=a[l];u=h.getAttribute("xmlns");if(u&&u.match(Strophe.NS.MUC)){r=t._presence_handlers;break}}}}for(s in r){o=r[s];if(!o(i,t)){delete r[s]}}return true}}(this))}if(!this.rooms.hasOwnProperty(t)){this.rooms[t]=new i(this,t,e,s);this.roomNames.push(t)}if(o){this.rooms[t].addHandler("presence",o)}if(n){this.rooms[t].addHandler("message",n)}if(r){this.rooms[t].addHandler("roster",r)}return this._connection.send(h)},leave:function(t,e,i,n){var o,r,s,c;o=this.roomNames.indexOf(t);delete this.rooms[t];if(o>=0){this.roomNames.splice(o,1);if(this.roomNames.length===0){this._connection.deleteHandler(this._muc_handler);this._muc_handler=null}}c=this.test_append_nick(t,e);s=this._connection.getUniqueId();r=$pres({type:"unavailable",id:s,from:this._connection.jid,to:c});if(n!=null){r.c("status",n)}if(i!=null){this._connection.addHandler(i,null,"presence",null,s)}this._connection.send(r);return s},message:function(t,e,i,n,o){var r,s,c,h;h=this.test_append_nick(t,e);o=o||(e!=null?"chat":"groupchat");s=this._connection.getUniqueId();r=$msg({to:h,from:this._connection.jid,type:o,id:s}).c("body",{xmlns:Strophe.NS.CLIENT}).t(i);r.up();if(n!=null){r.c("html",{xmlns:Strophe.NS.XHTML_IM}).c("body",{xmlns:Strophe.NS.XHTML}).h(n);if(r.node.childNodes.length===0){c=r.node.parentNode;r.up().up();r.node.removeChild(c)}else{r.up().up()}}r.c("x",{xmlns:"jabber:x:event"}).c("composing");this._connection.send(r);return s},groupchat:function(t,e,i){return this.message(t,null,e,i)},invite:function(t,e,i){var n,o;o=this._connection.getUniqueId();n=$msg({from:this._connection.jid,to:t,id:o}).c("x",{xmlns:Strophe.NS.MUC_USER}).c("invite",{to:e});if(i!=null){n.c("reason",i)}this._connection.send(n);return o},multipleInvites:function(t,e,i){var n,o,r,s,c;o=this._connection.getUniqueId();n=$msg({from:this._connection.jid,to:t,id:o}).c("x",{xmlns:Strophe.NS.MUC_USER});for(s=0,c=e.length;s<c;s++){r=e[s];n.c("invite",{to:r});if(i!=null){n.c("reason",i);n.up()}n.up()}this._connection.send(n);return o},directInvite:function(t,e,i,n){var o,r,s;s=this._connection.getUniqueId();o={xmlns:"jabber:x:conference",jid:t};if(i!=null){o.reason=i}if(n!=null){o.password=n}r=$msg({from:this._connection.jid,to:e,id:s}).c("x",o);this._connection.send(r);return s},queryOccupants:function(t,e,i){var n,o;n={xmlns:Strophe.NS.DISCO_ITEMS};o=$iq({from:this._connection.jid,to:t,type:"get"}).c("query",n);return this._connection.sendIQ(o,e,i)},configure:function(t,e,i){var n,o;n=$iq({to:t,type:"get"}).c("query",{xmlns:Strophe.NS.MUC_OWNER});o=n.tree();return this._connection.sendIQ(o,e,i)},cancelConfigure:function(t){var e,i;e=$iq({to:t,type:"set"}).c("query",{xmlns:Strophe.NS.MUC_OWNER}).c("x",{xmlns:"jabber:x:data",type:"cancel"});i=e.tree();return this._connection.sendIQ(i)},saveConfiguration:function(t,e,i,n){var o,r,s,c,h;r=$iq({to:t,type:"set"}).c("query",{xmlns:Strophe.NS.MUC_OWNER});if(typeof Form!=="undefined"&&e instanceof Form){e.type="submit";r.cnode(e.toXML())}else{r.c("x",{xmlns:"jabber:x:data",type:"submit"});for(c=0,h=e.length;c<h;c++){o=e[c];r.cnode(o).up()}}s=r.tree();return this._connection.sendIQ(s,i,n)},createInstantRoom:function(t,e,i){var n;n=$iq({to:t,type:"set"}).c("query",{xmlns:Strophe.NS.MUC_OWNER}).c("x",{xmlns:"jabber:x:data",type:"submit"});return this._connection.sendIQ(n.tree(),e,i)},createConfiguredRoom:function(t,e,i,o){var r,s,c;s=$iq({to:t,type:"set"}).c("query",{xmlns:Strophe.NS.MUC_OWNER}).c("x",{xmlns:"jabber:x:data",type:"submit"});s.c("field",{"var":"FORM_TYPE"}).c("value").t("http://jabber.org/protocol/muc#roomconfig").up().up();for(r in e){if(!n.call(e,r))continue;c=e[r];s.c("field",{"var":r}).c("value").t(c).up().up()}return this._connection.sendIQ(s.tree(),i,o)},setTopic:function(t,e){var i;i=$msg({to:t,from:this._connection.jid,type:"groupchat"}).c("subject",{xmlns:"jabber:client"}).t(e);return this._connection.send(i.tree())},_modifyPrivilege:function(t,e,i,n,o){var r;r=$iq({to:t,type:"set"}).c("query",{xmlns:Strophe.NS.MUC_ADMIN}).cnode(e.node);if(i!=null){r.c("reason",i)}return this._connection.sendIQ(r.tree(),n,o)},modifyRole:function(t,e,i,n,o,r){var s;s=$build("item",{nick:e,role:i});return this._modifyPrivilege(t,s,n,o,r)},kick:function(t,e,i,n,o){return this.modifyRole(t,e,"none",i,n,o)},voice:function(t,e,i,n,o){return this.modifyRole(t,e,"participant",i,n,o)},mute:function(t,e,i,n,o){return this.modifyRole(t,e,"visitor",i,n,o)},op:function(t,e,i,n,o){return this.modifyRole(t,e,"moderator",i,n,o)},deop:function(t,e,i,n,o){return this.modifyRole(t,e,"participant",i,n,o)},modifyAffiliation:function(t,e,i,n,o,r){var s;s=$build("item",{jid:e,affiliation:i});return this._modifyPrivilege(t,s,n,o,r)},ban:function(t,e,i,n,o){return this.modifyAffiliation(t,e,"outcast",i,n,o)},member:function(t,e,i,n,o){return this.modifyAffiliation(t,e,"member",i,n,o)},revoke:function(t,e,i,n,o){return this.modifyAffiliation(t,e,"none",i,n,o)},owner:function(t,e,i,n,o){return this.modifyAffiliation(t,e,"owner",i,n,o)},admin:function(t,e,i,n,o){return this.modifyAffiliation(t,e,"admin",i,n,o)},changeNick:function(t,e){var i,n;n=this.test_append_nick(t,e);i=$pres({from:this._connection.jid,to:n,id:this._connection.getUniqueId()});return this._connection.send(i.tree())},setStatus:function(t,e,i,n){var o,r;r=this.test_append_nick(t,e);o=$pres({from:this._connection.jid,to:r});if(i!=null){o.c("show",i).up()}if(n!=null){o.c("status",n)}return this._connection.send(o.tree())},registrationRequest:function(t,e,i){var n;n=$iq({to:t,from:this._connection.jid,type:"get"}).c("query",{xmlns:Strophe.NS.MUC_REGISTER});return this._connection.sendIQ(n,function(t){var i,n,o,r,s,c,h;n=t.getElementsByTagName("field");s=n.length;r={required:[],optional:[]};for(c=0,h=n.length;c<h;c++){i=n[c];o={"var":i.getAttribute("var"),label:i.getAttribute("label"),type:i.getAttribute("type")};if(i.getElementsByTagName("required").length>0){r.required.push(o)}else{r.optional.push(o)}}return e(r)},i)},submitRegistrationForm:function(t,e,i,n){var o,r,s;o=$iq({to:t,type:"set"}).c("query",{xmlns:Strophe.NS.MUC_REGISTER});o.c("x",{xmlns:"jabber:x:data",type:"submit"});o.c("field",{"var":"FORM_TYPE"}).c("value").t("http://jabber.org/protocol/muc#register").up().up();for(r in e){s=e[r];o.c("field",{"var":r}).c("value").t(s).up().up()}return this._connection.sendIQ(o,i,n)},listRooms:function(t,e,i){var n;n=$iq({to:t,from:this._connection.jid,type:"get"}).c("query",{xmlns:Strophe.NS.DISCO_ITEMS});return this._connection.sendIQ(n,e,i)},test_append_nick:function(t,e){var i,n;n=Strophe.escapeNode(Strophe.getNodeFromJid(t));i=Strophe.getDomainFromJid(t);return n+"@"+i+(e!=null?"/"+e:"")}});i=function(){function e(t,e,i,n){this.client=t;this.name=e;this.nick=i;this.password=n;this._roomRosterHandler=o(this._roomRosterHandler,this);this._addOccupant=o(this._addOccupant,this);this.roster={};this._message_handlers={};this._presence_handlers={};this._roster_handlers={};this._handler_ids=0;if(t.muc){this.client=t.muc}this.name=Strophe.getBareJidFromJid(e);this.addHandler("presence",this._roomRosterHandler)}e.prototype.join=function(t,e,i){return this.client.join(this.name,this.nick,t,e,i,this.password)};e.prototype.leave=function(t,e){this.client.leave(this.name,this.nick,t,e);return delete this.client.rooms[this.name]};e.prototype.message=function(t,e,i,n){return this.client.message(this.name,t,e,i,n)};e.prototype.groupchat=function(t,e){return this.client.groupchat(this.name,t,e)};e.prototype.invite=function(t,e){return this.client.invite(this.name,t,e)};e.prototype.multipleInvites=function(t,e){return this.client.invite(this.name,t,e)};e.prototype.directInvite=function(t,e){return this.client.directInvite(this.name,t,e,this.password)};e.prototype.configure=function(t){return this.client.configure(this.name,t)};e.prototype.cancelConfigure=function(){return this.client.cancelConfigure(this.name)};e.prototype.saveConfiguration=function(t){return this.client.saveConfiguration(this.name,t)};e.prototype.queryOccupants=function(t,e){return this.client.queryOccupants(this.name,t,e)};e.prototype.setTopic=function(t){return this.client.setTopic(this.name,t)};e.prototype.modifyRole=function(t,e,i,n,o){return this.client.modifyRole(this.name,t,e,i,n,o)};e.prototype.kick=function(t,e,i,n){return this.client.kick(this.name,t,e,i,n)};e.prototype.voice=function(t,e,i,n){return this.client.voice(this.name,t,e,i,n)};e.prototype.mute=function(t,e,i,n){return this.client.mute(this.name,t,e,i,n)};e.prototype.op=function(t,e,i,n){return this.client.op(this.name,t,e,i,n)};e.prototype.deop=function(t,e,i,n){return this.client.deop(this.name,t,e,i,n)};e.prototype.modifyAffiliation=function(t,e,i,n,o){return this.client.modifyAffiliation(this.name,t,e,i,n,o)};e.prototype.ban=function(t,e,i,n){return this.client.ban(this.name,t,e,i,n)};e.prototype.member=function(t,e,i,n){return this.client.member(this.name,t,e,i,n)};e.prototype.revoke=function(t,e,i,n){return this.client.revoke(this.name,t,e,i,n)};e.prototype.owner=function(t,e,i,n){return this.client.owner(this.name,t,e,i,n)};e.prototype.admin=function(t,e,i,n){return this.client.admin(this.name,t,e,i,n)};e.prototype.changeNick=function(t){this.nick=t;return this.client.changeNick(this.name,t)};e.prototype.setStatus=function(t,e){return this.client.setStatus(this.name,this.nick,t,e)};e.prototype.addHandler=function(t,e){var i;i=this._handler_ids++;switch(t){case"presence":this._presence_handlers[i]=e;break;case"message":this._message_handlers[i]=e;break;case"roster":this._roster_handlers[i]=e;break;default:this._handler_ids--;return null}return i};e.prototype.removeHandler=function(t){delete this._presence_handlers[t];delete this._message_handlers[t];return delete this._roster_handlers[t]};e.prototype._addOccupant=function(e){var i;i=new t(e,this);this.roster[i.nick]=i;return i};e.prototype._roomRosterHandler=function(t){var i,n,o,r,s,c;i=e._parsePresence(t);s=i.nick;r=i.newnick||null;switch(i.type){case"error":return true;case"unavailable":if(r){i.nick=r;if(this.roster[s]&&this.roster[r]){this.roster[s].update(this.roster[r]);this.roster[r]=this.roster[s]}if(this.roster[s]&&!this.roster[r]){this.roster[r]=this.roster[s].update(i)}}delete this.roster[s];break;default:if(this.roster[s]){this.roster[s].update(i)}else{this._addOccupant(i)}}c=this._roster_handlers;for(o in c){n=c[o];if(!n(this.roster,this)){delete this._roster_handlers[o]}}return true};e._parsePresence=function(t){var e,i,n,o,r,s,c,h,u;n={};n.nick=Strophe.getResourceFromJid(t.getAttribute("from"));n.type=t.getAttribute("type");n.states=[];h=t.childNodes;for(o=0,s=h.length;o<s;o++){e=h[o];switch(e.nodeName){case"status":n.status=e.textContent||null;break;case"show":n.show=e.textContent||null;break;case"x":if(e.getAttribute("xmlns")===Strophe.NS.MUC_USER){u=e.childNodes;for(r=0,c=u.length;r<c;r++){i=u[r];switch(i.nodeName){case"item":n.affiliation=i.getAttribute("affiliation");n.role=i.getAttribute("role");n.jid=i.getAttribute("jid");n.newnick=i.getAttribute("nick");break;case"status":if(i.getAttribute("code")){n.states.push(i.getAttribute("code"))}}}}}}return n};return e}();e=function(){function t(t){this.parse=o(this.parse,this);if(t!=null){this.parse(t)}}t.prototype.parse=function(t){var e,i,n,o,r,s,c,h,u,a,l,d,p;s=t.getElementsByTagName("query")[0].childNodes;this.identities=[];this.features=[];this.x=[];for(c=0,a=s.length;c<a;c++){n=s[c];i=n.attributes;switch(n.nodeName){case"identity":r={};for(h=0,l=i.length;h<l;h++){e=i[h];r[e.name]=e.textContent}this.identities.push(r);break;case"feature":this.features.push(n.getAttribute("var"));break;case"x":if(!n.childNodes[0].getAttribute("var")==="FORM_TYPE"||!n.childNodes[0].getAttribute("type")==="hidden"){break}p=n.childNodes;for(u=0,d=p.length;u<d;u++){o=p[u];if(!o.attributes.type){this.x.push({"var":o.getAttribute("var"),label:o.getAttribute("label")||"",value:o.firstChild.textContent||""})}}}}return{identities:this.identities,features:this.features,x:this.x}};return t}();t=function(){function t(t,e){this.room=e;this.update=o(this.update,this);this.admin=o(this.admin,this);this.owner=o(this.owner,this);this.revoke=o(this.revoke,this);this.member=o(this.member,this);this.ban=o(this.ban,this);this.modifyAffiliation=o(this.modifyAffiliation,this);this.deop=o(this.deop,this);this.op=o(this.op,this);this.mute=o(this.mute,this);this.voice=o(this.voice,this);this.kick=o(this.kick,this);this.modifyRole=o(this.modifyRole,this);this.update(t)}t.prototype.modifyRole=function(t,e,i,n){return this.room.modifyRole(this.nick,t,e,i,n)};t.prototype.kick=function(t,e,i){return this.room.kick(this.nick,t,e,i)};t.prototype.voice=function(t,e,i){return this.room.voice(this.nick,t,e,i)};t.prototype.mute=function(t,e,i){return this.room.mute(this.nick,t,e,i)};t.prototype.op=function(t,e,i){return this.room.op(this.nick,t,e,i)};t.prototype.deop=function(t,e,i){return this.room.deop(this.nick,t,e,i)};t.prototype.modifyAffiliation=function(t,e,i,n){return this.room.modifyAffiliation(this.jid,t,e,i,n)};t.prototype.ban=function(t,e,i){return this.room.ban(this.jid,t,e,i)};t.prototype.member=function(t,e,i){return this.room.member(this.jid,t,e,i)};t.prototype.revoke=function(t,e,i){return this.room.revoke(this.jid,t,e,i)};t.prototype.owner=function(t,e,i){return this.room.owner(this.jid,t,e,i)};t.prototype.admin=function(t,e,i){return this.room.admin(this.jid,t,e,i)};t.prototype.update=function(t){this.nick=t.nick||null;this.affiliation=t.affiliation||null;this.role=t.role||null;this.jid=t.jid||null;this.status=t.status||null;this.show=t.show||null;return this};return t}()}).call(this);(function(t){"use strict";t.prompt=function(e,o){void 0!==o&&void 0!==o.classes&&"string"==typeof o.classes&&(o={box:o.classes}),t.prompt.options=t.extend({},t.prompt.defaults,o),t.prompt.currentPrefix=t.prompt.options.prefix,t.prompt.timeout&&clearTimeout(t.prompt.timeout),t.prompt.timeout=!1;var p=t.prompt.options,r=t(document.body),i=t(window),n='<div class="'+t.prompt.options.prefix+"box "+p.classes.box+'">';n+=p.useiframe&&t("object, applet").length>0?'<iframe src="javascript:false;" style="display:block;position:absolute;z-index:-1;" class="'+p.prefix+"fade "+p.classes.fade+'"></iframe>':'<div class="'+p.prefix+"fade "+p.classes.fade+'"></div>',n+='<div class="'+p.prefix+" "+p.classes.prompt+'">'+'<form action="javascript:false;" onsubmit="return false;" class="'+p.prefix+"form "+p.classes.form+'">'+'<div class="'+p.prefix+"close "+p.classes.close+'">'+p.closeText+"</div>"+'<div class="'+p.prefix+'states"></div>'+"</form>"+"</div>"+"</div>",t.prompt.jqib=t(n).appendTo(r),t.prompt.jqi=t.prompt.jqib.children("."+p.prefix),t.prompt.jqif=t.prompt.jqib.children("."+p.prefix+"fade"),e.constructor===String&&(e={state0:{title:p.title,html:e,buttons:p.buttons,position:p.position,focus:p.focus,defaultButton:p.defaultButton,submit:p.submit}}),t.prompt.options.states={};var s,a;for(s in e)a=t.extend({},t.prompt.defaults.state,{name:s},e[s]),t.prompt.addState(a.name,a),""===t.prompt.currentStateName&&(t.prompt.currentStateName=a.name);t.prompt.jqi.on("click","."+p.prefix+"buttons button",function(){var e=t(this),o=e.parents("."+p.prefix+"state"),r=t.prompt.options.states[o.data("jqi-name")],i=o.children("."+p.prefix+"message"),n=r.buttons[e.text()]||r.buttons[e.html()],s={};if(void 0===n)for(var a in r.buttons)(r.buttons[a].title===e.text()||r.buttons[a].title===e.html())&&(n=r.buttons[a].value);t.each(t.prompt.jqi.children("form").serializeArray(),function(t,e){void 0===s[e.name]?s[e.name]=e.value:typeof s[e.name]===Array||"object"==typeof s[e.name]?s[e.name].push(e.value):s[e.name]=[s[e.name],e.value]});var m=new t.Event("impromptu:submit");m.stateName=r.name,m.state=o,o.trigger(m,[n,i,s]),m.isDefaultPrevented()||t.prompt.close(!0,n,i,s)});var m=function(){if(p.persistent){var e=(""+p.top).indexOf("%")>=0?i.height()*(parseInt(p.top,10)/100):parseInt(p.top,10),o=parseInt(t.prompt.jqi.css("top").replace("px",""),10)-e;t("html,body").animate({scrollTop:o},"fast",function(){var e=0;t.prompt.jqib.addClass(p.prefix+"warning");var o=setInterval(function(){t.prompt.jqib.toggleClass(p.prefix+"warning"),e++>1&&(clearInterval(o),t.prompt.jqib.removeClass(p.prefix+"warning"))},100)})}else t.prompt.close(!0)},u=function(e){var o=window.event?event.keyCode:e.keyCode;if(27===o&&m(),13===o){var r=t.prompt.getCurrentState().find("."+p.prefix+"defaultbutton"),i=t(e.target);i.is("textarea,."+p.prefix+"button")===!1&&r.length>0&&(e.preventDefault(),r.click())}if(9===o){var n=t("input,select,textarea,button",t.prompt.getCurrentState()),s=!e.shiftKey&&e.target===n[n.length-1],a=e.shiftKey&&e.target===n[0];if(s||a)return setTimeout(function(){if(n){var t=n[a===!0?n.length-1:0];t&&t.focus()}},10),!1}};return t.prompt.position(),t.prompt.style(),t.prompt.jqif.click(m),i.resize({animate:!1},t.prompt.position),t.prompt.jqi.find("."+p.prefix+"close").click(t.prompt.close),t.prompt.jqib.on("keydown",u).on("impromptu:loaded",p.loaded).on("impromptu:close",p.close).on("impromptu:statechanging",p.statechanging).on("impromptu:statechanged",p.statechanged),t.prompt.jqif[p.show](p.overlayspeed),t.prompt.jqi[p.show](p.promptspeed,function(){var e=t.prompt.jqi.find("."+p.prefix+"states ."+p.prefix+"state").eq(0);t.prompt.goToState(e.data("jqi-name")),t.prompt.jqib.trigger("impromptu:loaded")}),p.timeout>0&&(t.prompt.timeout=setTimeout(function(){t.prompt.close(!0)},p.timeout)),t.prompt.jqib},t.prompt.defaults={prefix:"jqi",classes:{box:"",fade:"",prompt:"",form:"",close:"",title:"",message:"",buttons:"",button:"",defaultButton:""},title:"",closeText:"&times;",buttons:{Ok:!0},loaded:function(){},submit:function(){},close:function(){},statechanging:function(){},statechanged:function(){},opacity:.6,zIndex:999,overlayspeed:"slow",promptspeed:"fast",show:"fadeIn",focus:0,defaultButton:0,useiframe:!1,top:"15%",position:{container:null,x:null,y:null,arrow:null,width:null},persistent:!0,timeout:0,states:{},state:{name:null,title:"",html:"",buttons:{Ok:!0},focus:0,defaultButton:0,position:{container:null,x:null,y:null,arrow:null,width:null},submit:function(){return!0}}},t.prompt.currentPrefix=t.prompt.defaults.prefix,t.prompt.currentStateName="",t.prompt.setDefaults=function(e){t.prompt.defaults=t.extend({},t.prompt.defaults,e)},t.prompt.setStateDefaults=function(e){t.prompt.defaults.state=t.extend({},t.prompt.defaults.state,e)},t.prompt.position=function(e){var o=t.fx.off,p=t.prompt.getCurrentState(),r=t.prompt.options.states[p.data("jqi-name")],i=r?r.position:void 0,n=t(window),s=document.body.scrollHeight,a=t(window).height(),m=(t(document).height(),s>a?s:a),u=parseInt(n.scrollTop(),10)+((""+t.prompt.options.top).indexOf("%")>=0?a*(parseInt(t.prompt.options.top,10)/100):parseInt(t.prompt.options.top,10));if(void 0!==e&&e.data.animate===!1&&(t.fx.off=!0),t.prompt.jqib.css({position:"absolute",height:m,width:"100%",top:0,left:0,right:0,bottom:0}),t.prompt.jqif.css({position:"fixed",height:m,width:"100%",top:0,left:0,right:0,bottom:0}),i&&i.container){var l=t(i.container).offset();t.isPlainObject(l)&&void 0!==l.top&&(t.prompt.jqi.css({position:"absolute"}),t.prompt.jqi.animate({top:l.top+i.y,left:l.left+i.x,marginLeft:0,width:void 0!==i.width?i.width:null}),u=l.top+i.y-((""+t.prompt.options.top).indexOf("%")>=0?a*(parseInt(t.prompt.options.top,10)/100):parseInt(t.prompt.options.top,10)),t("html,body").animate({scrollTop:u},"slow","swing",function(){}))}else i&&i.width?(t.prompt.jqi.css({position:"absolute",left:"50%"}),t.prompt.jqi.animate({top:i.y||u,left:i.x||"50%",marginLeft:-1*(i.width/2),width:i.width})):t.prompt.jqi.css({position:"absolute",top:u,left:"50%",marginLeft:-1*(t.prompt.jqi.outerWidth(!1)/2)});void 0!==e&&e.data.animate===!1&&(t.fx.off=o)},t.prompt.style=function(){t.prompt.jqif.css({zIndex:t.prompt.options.zIndex,display:"none",opacity:t.prompt.options.opacity}),t.prompt.jqi.css({zIndex:t.prompt.options.zIndex+1,display:"none"}),t.prompt.jqib.css({zIndex:t.prompt.options.zIndex})},t.prompt.get=function(){return t("."+t.prompt.currentPrefix)},t.prompt.addState=function(e,o,p){var r,i,n,s="",a=null,m="",u="",l=t.prompt.options,f=t("."+t.prompt.currentPrefix+"states"),c=0;o=t.extend({},t.prompt.defaults.state,{name:e},o),null!==o.position.arrow&&(m='<div class="'+l.prefix+"arrow "+l.prefix+"arrow"+o.position.arrow+'"></div>'),o.title&&""!==o.title&&(u='<div class="lead '+l.prefix+"title "+l.classes.title+'">'+o.title+"</div>"),s+='<div id="'+l.prefix+"state_"+e+'" class="'+l.prefix+'state" data-jqi-name="'+e+'" style="display:none;">'+m+u+'<div class="'+l.prefix+"message "+l.classes.message+'">'+o.html+"</div>"+'<div class="'+l.prefix+"buttons "+l.classes.buttons+'"'+(t.isEmptyObject(o.buttons)?'style="display:none;"':"")+">";for(i in o.buttons)n=o.buttons[i],r=o.focus===c||isNaN(o.focus)&&o.defaultButton===c?t.prompt.currentPrefix+"defaultbutton "+l.classes.defaultButton:"","object"==typeof n?(s+='<button class="'+l.classes.button+" "+t.prompt.currentPrefix+"button "+r,n.classes!==void 0&&(s+=" "+(t.isArray(n.classes)?n.classes.join(" "):n.classes)+" "),s+='" name="'+l.prefix+"_"+e+"_button"+n.title.replace(/[^a-z0-9]+/gi,"")+'" id="'+l.prefix+"_"+e+"_button"+n.title.replace(/[^a-z0-9]+/gi,"")+'" value="'+n.value+'">'+n.title+"</button>"):s+='<button class="'+t.prompt.currentPrefix+"button "+l.classes.button+" "+r+'" name="'+l.prefix+"_"+e+"_button"+i.replace(/[^a-z0-9]+/gi,"")+'" id="'+l.prefix+"_"+e+"_button"+i.replace(/[^a-z0-9]+/gi,"")+'" value="'+n+'">'+i+"</button>",c++;return s+="</div></div>",a=t(s),a.on("impromptu:submit",o.submit),void 0!==p?f.find("#"+t.prompt.currentPrefix+"state_"+p).after(a):f.append(a),t.prompt.options.states[e]=o,a},t.prompt.removeState=function(e,o){var p=t.prompt.getState(e),r=function(){p.remove()};return 0===p.length?!1:("none"!==p.css("display")?void 0!==o&&t.prompt.getState(o).length>0?t.prompt.goToState(o,!1,r):p.next().length>0?t.prompt.nextState(r):p.prev().length>0?t.prompt.prevState(r):t.prompt.close():p.slideUp("slow",r),!0)},t.prompt.getState=function(e){return t("#"+t.prompt.currentPrefix+"state_"+e)},t.prompt.getStateContent=function(e){return t.prompt.getState(e)},t.prompt.getCurrentState=function(){return t.prompt.getState(t.prompt.getCurrentStateName())},t.prompt.getCurrentStateName=function(){return t.prompt.currentStateName},t.prompt.goToState=function(e,o,p){var r=(t.prompt.get(),t.prompt.options),i=t.prompt.getState(e),n=r.states[i.data("jqi-name")],s=new t.Event("impromptu:statechanging");return"function"==typeof o&&(p=o,o=!1),t.prompt.jqib.trigger(s,[t.prompt.getCurrentStateName(),e]),!s.isDefaultPrevented()&&i.length>0&&(t.prompt.jqi.find("."+t.prompt.currentPrefix+"parentstate").removeClass(t.prompt.currentPrefix+"parentstate"),o?(t.prompt.jqi.find("."+t.prompt.currentPrefix+"substate").not(i).slideUp(r.promptspeed).removeClass("."+t.prompt.currentPrefix+"substate").find("."+t.prompt.currentPrefix+"arrow").hide(),t.prompt.jqi.find("."+t.prompt.currentPrefix+"state:visible").addClass(t.prompt.currentPrefix+"parentstate"),i.addClass(t.prompt.currentPrefix+"substate")):t.prompt.jqi.find("."+t.prompt.currentPrefix+"state").not(i).slideUp(r.promptspeed).find("."+t.prompt.currentPrefix+"arrow").hide(),t.prompt.currentStateName=n.name,i.slideDown(r.promptspeed,function(){var o=t(this);"string"==typeof n.focus?o.find(n.focus).eq(0).focus():o.find("."+t.prompt.currentPrefix+"defaultbutton").focus(),o.find("."+t.prompt.currentPrefix+"arrow").show(r.promptspeed),"function"==typeof p&&t.prompt.jqib.on("impromptu:statechanged",p),t.prompt.jqib.trigger("impromptu:statechanged",[e]),"function"==typeof p&&t.prompt.jqib.off("impromptu:statechanged",p)}),o||t.prompt.position()),i},t.prompt.nextState=function(e){var o=t("#"+t.prompt.currentPrefix+"state_"+t.prompt.getCurrentStateName()).next();return o.length>0&&t.prompt.goToState(o.attr("id").replace(t.prompt.currentPrefix+"state_",""),e),o},t.prompt.prevState=function(e){var o=t("#"+t.prompt.currentPrefix+"state_"+t.prompt.getCurrentStateName()).prev();return o.length>0&&t.prompt.goToState(o.attr("id").replace(t.prompt.currentPrefix+"state_",""),e),o},t.prompt.close=function(e,o,p,r){t.prompt.timeout&&(clearTimeout(t.prompt.timeout),t.prompt.timeout=!1),t.prompt.jqib&&t.prompt.jqib.fadeOut("fast",function(){t.prompt.jqib.trigger("impromptu:close",[o,p,r]),t.prompt.jqib.remove(),t(window).off("resize",t.prompt.position)}),t.prompt.currentStateName=""},t.fn.prompt=function(e){void 0===e&&(e={}),void 0===e.withDataAndEvents&&(e.withDataAndEvents=!1),t.prompt(t(this).clone(e.withDataAndEvents).html(),e)}})(jQuery);!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}(function(e){function t(t){var s=t||window.event,a=h.call(arguments,1),r=0,f=0,d=0,c=0,m=0,g=0;if(t=e.event.fix(s),t.type="mousewheel","detail"in s&&(d=-1*s.detail),"wheelDelta"in s&&(d=s.wheelDelta),"wheelDeltaY"in s&&(d=s.wheelDeltaY),"wheelDeltaX"in s&&(f=-1*s.wheelDeltaX),"axis"in s&&s.axis===s.HORIZONTAL_AXIS&&(f=-1*d,d=0),r=0===d?f:d,"deltaY"in s&&(d=-1*s.deltaY,r=d),"deltaX"in s&&(f=s.deltaX,0===d&&(r=-1*f)),0!==d||0!==f){if(1===s.deltaMode){var w=e.data(this,"mousewheel-line-height");r*=w,d*=w,f*=w}else if(2===s.deltaMode){var v=e.data(this,"mousewheel-page-height");r*=v,d*=v,f*=v}if(c=Math.max(Math.abs(d),Math.abs(f)),(!l||l>c)&&(l=c,i(s,c)&&(l/=40)),i(s,c)&&(r/=40,f/=40,d/=40),r=Math[r>=1?"floor":"ceil"](r/l),f=Math[f>=1?"floor":"ceil"](f/l),d=Math[d>=1?"floor":"ceil"](d/l),u.settings.normalizeOffset&&this.getBoundingClientRect){var p=this.getBoundingClientRect();m=t.clientX-p.left,g=t.clientY-p.top}return t.deltaX=f,t.deltaY=d,t.deltaFactor=l,t.offsetX=m,t.offsetY=g,t.deltaMode=0,a.unshift(t,r,f,d),o&&clearTimeout(o),o=setTimeout(n,200),(e.event.dispatch||e.event.handle).apply(this,a)}}function n(){l=null}function i(e,t){return u.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120===0}var o,l,s=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],a="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],h=Array.prototype.slice;if(e.event.fixHooks)for(var r=s.length;r;)e.event.fixHooks[s[--r]]=e.event.mouseHooks;var u=e.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var n=a.length;n;)this.addEventListener(a[--n],t,!1);else this.onmousewheel=t;e.data(this,"mousewheel-line-height",u.getLineHeight(this)),e.data(this,"mousewheel-page-height",u.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var n=a.length;n;)this.removeEventListener(a[--n],t,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var n=e(t),i=n["offsetParent"in e.fn?"offsetParent":"parent"]();return i.length||(i=e("body")),parseInt(i.css("fontSize"),10)||parseInt(n.css("fontSize"),10)||16},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})});(function(t){if(typeof define==="function"&&define.amd){define(["jquery"],t)}else{t(jQuery)}})(function(t){"use strict";var i={},s=Math.max,h=Math.min;i.c={};i.c.d=t(document);i.c.t=function(t){return t.originalEvent.touches.length-1};i.o=function(){var s=this;this.o=null;this.$=null;this.i=null;this.g=null;this.v=null;this.cv=null;this.x=0;this.y=0;this.w=0;this.h=0;this.$c=null;this.c=null;this.t=0;this.isInit=false;this.fgColor=null;this.pColor=null;this.dH=null;this.cH=null;this.eH=null;this.rH=null;this.scale=1;this.relative=false;this.relativeWidth=false;this.relativeHeight=false;this.$div=null;this.run=function(){var i=function(t,i){var h;for(h in i){s.o[h]=i[h]}s._carve().init();s._configure()._draw()};if(this.$.data("kontroled"))return;this.$.data("kontroled",true);this.extend();this.o=t.extend({min:this.$.data("min")!==undefined?this.$.data("min"):0,max:this.$.data("max")!==undefined?this.$.data("max"):100,stopper:true,readOnly:this.$.data("readonly")||this.$.attr("readonly")==="readonly",cursor:this.$.data("cursor")===true&&30||this.$.data("cursor")||0,thickness:this.$.data("thickness")&&Math.max(Math.min(this.$.data("thickness"),1),.01)||.35,lineCap:this.$.data("linecap")||"butt",width:this.$.data("width")||200,height:this.$.data("height")||200,displayInput:this.$.data("displayinput")==null||this.$.data("displayinput"),displayPrevious:this.$.data("displayprevious"),fgColor:this.$.data("fgcolor")||"#87CEEB",inputColor:this.$.data("inputcolor"),font:this.$.data("font")||"Arial",fontWeight:this.$.data("font-weight")||"bold",inline:false,step:this.$.data("step")||1,rotation:this.$.data("rotation"),draw:null,change:null,cancel:null,release:null,format:function(t){return t},parse:function(t){return parseFloat(t)}},this.o);this.o.flip=this.o.rotation==="anticlockwise"||this.o.rotation==="acw";if(!this.o.inputColor){this.o.inputColor=this.o.fgColor}if(this.$.is("fieldset")){this.v={};this.i=this.$.find("input");this.i.each(function(i){var h=t(this);s.i[i]=h;s.v[i]=s.o.parse(h.val());h.bind("change blur",function(){var t={};t[i]=h.val();s.val(t)})});this.$.find("legend").remove()}else{this.i=this.$;this.v=this.o.parse(this.$.val());this.v===""&&(this.v=this.o.min);this.$.bind("change blur",function(){s.val(s._validate(s.o.parse(s.$.val())))})}!this.o.displayInput&&this.$.hide();this.$c=t(document.createElement("canvas")).attr({width:this.o.width,height:this.o.height});this.$div=t('<div style="'+(this.o.inline?"display:inline;":"")+"width:"+this.o.width+"px;height:"+this.o.height+"px;"+'"></div>');this.$.wrap(this.$div).before(this.$c);this.$div=this.$.parent();if(typeof G_vmlCanvasManager!=="undefined"){G_vmlCanvasManager.initElement(this.$c[0])}this.c=this.$c[0].getContext?this.$c[0].getContext("2d"):null;if(!this.c){throw{name:"CanvasNotSupportedException",message:"Canvas not supported. Please use excanvas on IE8.0.",toString:function(){return this.name+": "+this.message}}}this.scale=(window.devicePixelRatio||1)/(this.c.webkitBackingStorePixelRatio||this.c.mozBackingStorePixelRatio||this.c.msBackingStorePixelRatio||this.c.oBackingStorePixelRatio||this.c.backingStorePixelRatio||1);this.relativeWidth=this.o.width%1!==0&&this.o.width.indexOf("%");this.relativeHeight=this.o.height%1!==0&&this.o.height.indexOf("%");this.relative=this.relativeWidth||this.relativeHeight;this._carve();if(this.v instanceof Object){this.cv={};this.copy(this.v,this.cv)}else{this.cv=this.v}this.$.bind("configure",i).parent().bind("configure",i);this._listen()._configure()._xy().init();this.isInit=true;this.$.val(this.o.format(this.v));this._draw();return this};this._carve=function(){if(this.relative){var t=this.relativeWidth?this.$div.parent().width()*parseInt(this.o.width)/100:this.$div.parent().width(),i=this.relativeHeight?this.$div.parent().height()*parseInt(this.o.height)/100:this.$div.parent().height();this.w=this.h=Math.min(t,i)}else{this.w=this.o.width;this.h=this.o.height}this.$div.css({width:this.w+"px",height:this.h+"px"});this.$c.attr({width:this.w,height:this.h});if(this.scale!==1){this.$c[0].width=this.$c[0].width*this.scale;this.$c[0].height=this.$c[0].height*this.scale;this.$c.width(this.w);this.$c.height(this.h)}return this};this._draw=function(){var t=true;s.g=s.c;s.clear();s.dH&&(t=s.dH());t!==false&&s.draw()};this._touch=function(t){var h=function(t){var i=s.xy2val(t.originalEvent.touches[s.t].pageX,t.originalEvent.touches[s.t].pageY);if(i==s.cv)return;if(s.cH&&s.cH(i)===false)return;s.change(s._validate(i));s._draw()};this.t=i.c.t(t);h(t);i.c.d.bind("touchmove.k",h).bind("touchend.k",function(){i.c.d.unbind("touchmove.k touchend.k");s.val(s.cv)});return this};this._mouse=function(t){var h=function(t){var i=s.xy2val(t.pageX,t.pageY);if(i==s.cv)return;if(s.cH&&s.cH(i)===false)return;s.change(s._validate(i));s._draw()};h(t);i.c.d.bind("mousemove.k",h).bind("keyup.k",function(t){if(t.keyCode===27){i.c.d.unbind("mouseup.k mousemove.k keyup.k");if(s.eH&&s.eH()===false)return;s.cancel()}}).bind("mouseup.k",function(t){i.c.d.unbind("mousemove.k mouseup.k keyup.k");s.val(s.cv)});return this};this._xy=function(){var t=this.$c.offset();this.x=t.left;this.y=t.top;return this};this._listen=function(){if(!this.o.readOnly){this.$c.bind("mousedown",function(t){t.preventDefault();s._xy()._mouse(t)}).bind("touchstart",function(t){t.preventDefault();s._xy()._touch(t)});this.listen()}else{this.$.attr("readonly","readonly")}if(this.relative){t(window).resize(function(){s._carve().init();s._draw()})}return this};this._configure=function(){if(this.o.draw)this.dH=this.o.draw;if(this.o.change)this.cH=this.o.change;if(this.o.cancel)this.eH=this.o.cancel;if(this.o.release)this.rH=this.o.release;if(this.o.displayPrevious){this.pColor=this.h2rgba(this.o.fgColor,"0.4");this.fgColor=this.h2rgba(this.o.fgColor,"0.6")}else{this.fgColor=this.o.fgColor}return this};this._clear=function(){this.$c[0].width=this.$c[0].width};this._validate=function(t){return~~((t<0?-.5:.5)+t/this.o.step)*this.o.step};this.listen=function(){};this.extend=function(){};this.init=function(){};this.change=function(t){};this.val=function(t){};this.xy2val=function(t,i){};this.draw=function(){};this.clear=function(){this._clear()};this.h2rgba=function(t,i){var s;t=t.substring(1,7);s=[parseInt(t.substring(0,2),16),parseInt(t.substring(2,4),16),parseInt(t.substring(4,6),16)];return"rgba("+s[0]+","+s[1]+","+s[2]+","+i+")"};this.copy=function(t,i){for(var s in t){i[s]=t[s]}}};i.Dial=function(){i.o.call(this);this.startAngle=null;this.xy=null;this.radius=null;this.lineWidth=null;this.cursorExt=null;this.w2=null;this.PI2=2*Math.PI;this.extend=function(){this.o=t.extend({bgColor:this.$.data("bgcolor")||"#EEEEEE",angleOffset:this.$.data("angleoffset")||0,angleArc:this.$.data("anglearc")||360,inline:true},this.o)};this.val=function(t,i){if(null!=t){t=this.o.parse(t);if(i!==false&&t!=this.v&&this.rH&&this.rH(t)===false)return;this.cv=this.o.stopper?s(h(t,this.o.max),this.o.min):t;this.v=this.cv;this.$.val(this.o.format(this.v));this._draw()}else{return this.v}};this.xy2val=function(t,i){var e,n;e=Math.atan2(t-(this.x+this.w2),-(i-this.y-this.w2))-this.angleOffset;if(this.o.flip){e=this.angleArc-e-this.PI2}if(this.angleArc!=this.PI2&&e<0&&e>-.5){e=0}else if(e<0){e+=this.PI2}n=~~(.5+e*(this.o.max-this.o.min)/this.angleArc)+this.o.min;this.o.stopper&&(n=s(h(n,this.o.max),this.o.min));return n};this.listen=function(){var i=this,e,n,a=function(t){t.preventDefault();var a=t.originalEvent,o=a.detail||a.wheelDeltaX,r=a.detail||a.wheelDeltaY,l=i._validate(i.o.parse(i.$.val()))+(o>0||r>0?i.o.step:o<0||r<0?-i.o.step:0);l=s(h(l,i.o.max),i.o.min);i.val(l,false);if(i.rH){clearTimeout(e);e=setTimeout(function(){i.rH(l);e=null},100);if(!n){n=setTimeout(function(){if(e)i.rH(l);n=null},200)}}},o,r,l=1,c={37:-i.o.step,38:i.o.step,39:i.o.step,40:-i.o.step};this.$.bind("keydown",function(e){var n=e.keyCode;if(n>=96&&n<=105){n=e.keyCode=n-48}o=parseInt(String.fromCharCode(n));if(isNaN(o)){n!==13&&n!==8&&n!==9&&n!==189&&(n!==190||i.$.val().match(/\./))&&e.preventDefault();if(t.inArray(n,[37,38,39,40])>-1){e.preventDefault();var a=i.o.parse(i.$.val())+c[n]*l;i.o.stopper&&(a=s(h(a,i.o.max),i.o.min));i.change(a);i._draw();r=window.setTimeout(function(){l*=2},30)}}}).bind("keyup",function(t){if(isNaN(o)){if(r){window.clearTimeout(r);r=null;l=1;i.val(i.$.val())}}else{i.$.val()>i.o.max&&i.$.val(i.o.max)||i.$.val()<i.o.min&&i.$.val(i.o.min)}});this.$c.bind("mousewheel DOMMouseScroll",a);this.$.bind("mousewheel DOMMouseScroll",a)};this.init=function(){if(this.v<this.o.min||this.v>this.o.max)this.v=this.o.min;this.$.val(this.v);this.w2=this.w/2;this.cursorExt=this.o.cursor/100;this.xy=this.w2*this.scale;this.lineWidth=this.xy*this.o.thickness;this.lineCap=this.o.lineCap;this.radius=this.xy-this.lineWidth/2;this.o.angleOffset&&(this.o.angleOffset=isNaN(this.o.angleOffset)?0:this.o.angleOffset);this.o.angleArc&&(this.o.angleArc=isNaN(this.o.angleArc)?this.PI2:this.o.angleArc);this.angleOffset=this.o.angleOffset*Math.PI/180;this.angleArc=this.o.angleArc*Math.PI/180;this.startAngle=1.5*Math.PI+this.angleOffset;this.endAngle=1.5*Math.PI+this.angleOffset+this.angleArc;var t=s(String(Math.abs(this.o.max)).length,String(Math.abs(this.o.min)).length,2)+2;this.o.displayInput&&this.i.css({width:(this.w/2+4>>0)+"px",height:(this.w/3>>0)+"px",position:"absolute","vertical-align":"middle","margin-top":(this.w/3>>0)+"px","margin-left":"-"+(this.w*3/4+2>>0)+"px",border:0,background:"none",font:this.o.fontWeight+" "+(this.w/t>>0)+"px "+this.o.font,"text-align":"center",color:this.o.inputColor||this.o.fgColor,padding:"0px","-webkit-appearance":"none"})||this.i.css({width:"0px",visibility:"hidden"})};this.change=function(t){this.cv=t;this.$.val(this.o.format(t))};this.angle=function(t){return(t-this.o.min)*this.angleArc/(this.o.max-this.o.min)};this.arc=function(t){var i,s;t=this.angle(t);if(this.o.flip){i=this.endAngle+1e-5;s=i-t-1e-5}else{i=this.startAngle-1e-5;s=i+t+1e-5}this.o.cursor&&(i=s-this.cursorExt)&&(s=s+this.cursorExt);return{s:i,e:s,d:this.o.flip&&!this.o.cursor}};this.draw=function(){var t=this.g,i=this.arc(this.cv),s,h=1;t.lineWidth=this.lineWidth;t.lineCap=this.lineCap;t.beginPath();t.strokeStyle=this.o.bgColor;t.arc(this.xy,this.xy,this.radius,this.endAngle-1e-5,this.startAngle+1e-5,true);t.stroke();if(this.o.displayPrevious){s=this.arc(this.v);t.beginPath();t.strokeStyle=this.pColor;t.arc(this.xy,this.xy,this.radius,s.s,s.e,s.d);t.stroke();h=this.cv==this.v}t.beginPath();t.strokeStyle=h?this.o.fgColor:this.fgColor;t.arc(this.xy,this.xy,this.radius,i.s,i.e,i.d);t.stroke()};this.cancel=function(){this.val(this.v)}};t.fn.dial=t.fn.knob=function(s){return this.each(function(){var h=new i.Dial;h.o=s;h.$=t(this);h.run()}).parent()}});!function(t){"use strict";var e=function(t){var e,s,n;return e=function(){s=!1},function(){var e=i(arguments);if(s)return n=e,void 0;s=!0;var o=this;e.unshift(function a(){if(n){var e=n;n=void 0,e.unshift(a),t.apply(o,e)}else s=!1}),t.apply(this,e)}},i=function(t){var e;return e=Array.prototype.slice.call(t)},s=function(){var e;return e=t("<div></div>").css(["color"]).color,"undefined"!=typeof e?function(t,e){return t.css(e)}:function(e,i){var s;return s={},t.each(i,function(t,i){s[i]=e.css(i)}),s}}(),n=function(t){return t},o=function(t){var e={};return function(i,s){e[i]?s(e[i]):t.call(this,i,function(t){e[i]=(e[i]||[]).concat(t),s.apply(null,arguments)})}},a=function(t,e){var i,s;if(t.indexOf)return-1!=t.indexOf(e);for(i=0,s=t.length;s>i;i++)if(t[i]===e)return!0;return!1},r=function(){function i(e,i){var s;this.el=e.get(0),s=this.el===document.activeElement,this.$el=e,this.id="textComplete"+r++,this.strategies=[],this.option=i,s?(this.initialize(),this.$el.focus()):this.$el.one("focus.textComplete",t.proxy(this.initialize,this))}var n,o,a,r;return n={list:'<ul class="dropdown-menu"></ul>'},o={list:{position:"absolute",left:0,zIndex:"100",display:"none"}},a=t(n.list).css(o.list),r=0,t.extend(i.prototype,{initialize:function(){var e,i,s,n;e=a.clone(),this.listView=new l(e,this),this.$el.on({"keyup.textComplete":t.proxy(this.onKeyup,this),"keydown.textComplete":t.proxy(this.listView.onKeydown,this.listView)}),s=this.option.appendTo,s?this.listView.appendTo(s instanceof t?s:t(s)):this.listView.appendTo(t("body")),n=this.option.height,n&&(e.css("overflow-y","auto"),e.height(n)),i={},i["click."+this.id]=t.proxy(this.onClickDocument,this),i["keyup."+this.id]=t.proxy(this.onKeyupDocument,this),t(document).on(i)},register:function(t){this.strategies=this.strategies.concat(t)},renderList:function(t){this.clearAtNext&&(this.listView.clear(),this.clearAtNext=!1),t.length&&(this.listView.strategy=this.strategy,this.listView.shown||this.listView.setPosition(this.getCaretPosition()).clear().activate(),t=t.slice(0,this.strategy.maxCount),this.listView.render(t)),!this.listView.data.length&&this.listView.shown&&this.listView.deactivate()},searchCallbackFactory:function(t){var e=this;return function(i,s){e.renderList(i),s||(t(),e.clearAtNext=!0)}},onKeyup:function(t){this.skipSearch(t)||this.trigger(null,!0)},trigger:function(t,e){var i,s;if(t||(t=this.getTextFromHeadToCaret()),i=this.extractSearchQuery(t),i.length){if(s=i[1],e&&this.term===s)return;this.term=s,this.search(i)}else this.term=null,this.listView.deactivate()},skipSearch:function(t){switch(t.keyCode){case 40:case 38:return!0}if(t.ctrlKey)switch(t.keyCode){case 78:case 80:return!0}},onSelect:function(e){var i,s,n,o,a,r,l;if(i=this.getTextFromHeadToCaret(),l=i.length,this.el.isContentEditable){o=window.getSelection(),a=o.getRangeAt(0),r=a.cloneRange(),r.selectNodeContents(a.startContainer);var h=r.toString();s=h.substring(a.startOffset)}else s=this.el.value.substring(this.el.selectionEnd);if(n=this.strategy.replace(e),t.isArray(n)&&(s=n[1]+s,n=n[0]),i=i.replace(this.strategy.match,n),this.el.isContentEditable){a.selectNodeContents(a.startContainer),a.deleteContents();var c=document.createTextNode(i+s);a.insertNode(c),a.setStart(c,i.length),a.collapse(!0),o.removeAllRanges(),o.addRange(a)}else this.$el.val(i+s),this.el.selectionStart=this.el.selectionEnd=i.length;this.$el.trigger("change").trigger("textComplete:select",e),this.el.focus()},onClickDocument:function(t){t.originalEvent&&!t.originalEvent.keepTextCompleteDropdown&&this.listView.deactivate()},onKeyupDocument:function(t){this.listView.shown&&27===t.keyCode&&(this.listView.deactivate(),this.$el.focus())},destroy:function(){this.$el.off(".textComplete"),t(document).off("."+this.id),this.listView&&this.listView.destroy(),this.$el.removeData("textComplete"),this.$el=null},getCaretPosition:function(){var t,e;return t=this.getCaretRelativePosition(),e=this.$el.offset(),t.top+=e.top,t.left+=e.left,t},getCaretRelativePosition:function(){var e,i,n,o,a,r,l,h,c,d;return this.el.isContentEditable?(h=window.getSelection().getRangeAt(0).cloneRange(),c=document.createElement("span"),h.insertNode(c),h.selectNodeContents(c),h.deleteContents(),d=t(c),a=d.offset(),a.left-=this.$el.offset().left,a.top+=d.height()-this.$el.offset().top):(e=["border-width","font-family","font-size","font-style","font-variant","font-weight","height","letter-spacing","word-spacing","line-height","text-decoration","text-align","width","padding-top","padding-right","padding-bottom","padding-left","margin-top","margin-right","margin-bottom","margin-left","border-style","box-sizing"],l=this.$el[0].scrollHeight>this.$el[0].offsetHeight,i=t.extend({position:"absolute",overflow:l?"scroll":"auto","white-space":"pre-wrap",top:0,left:-9999,direction:r},s(this.$el,e)),n=t("<div></div>").css(i).text(this.getTextFromHeadToCaret()),o=t("<span></span>").text(".").appendTo(n),this.$el.before(n),a=o.position(),a.top+=o.height()-this.$el.scrollTop(),n.remove()),r=this.$el.attr("dir")||this.$el.css("direction"),"rtl"===r&&(a.left-=this.listView.$el.width()),a},getTextFromHeadToCaret:function(){var t,e,i;if(this.el.isContentEditable){if(window.getSelection){var i=window.getSelection().getRangeAt(0),s=i.cloneRange();s.selectNodeContents(i.startContainer),t=s.toString().substring(0,i.startOffset)}}else e=this.el.selectionEnd,"number"==typeof e?t=this.el.value.substring(0,e):document.selection&&(i=this.el.createTextRange(),i.moveStart("character",0),i.moveEnd("textedit"),t=i.text);return t},extractSearchQuery:function(t){var e,i,s,n;for(e=0,i=this.strategies.length;i>e;e++)if(s=this.strategies[e],n=t.match(s.match))return[s,n[s.index]];return[]},search:e(function(t,e){var i;this.strategy=e[0],i=e[1],this.strategy.search(i,this.searchCallbackFactory(t))})}),i}(),l=function(){function e(e,i){this.data=[],this.$el=e,this.index=0,this.completer=i,i.option.listPosition&&(this.setPosition=i.option.listPosition),this.$el.on("mousedown.textComplete","li.textcomplete-item",t.proxy(this.onClick,this)),this.$el.on("mouseover.textComplete","li.textcomplete-item",t.proxy(this.onMouseover,this))}return t.extend(e.prototype,{shown:!1,render:function(e){var i,s,n,o,r,l;for(i="",this.strategy.header&&(l=t.isFunction(this.strategy.header)?this.strategy.header(e):this.strategy.header,i+='<li class="textcomplete-header">'+l+"</li>"),s=0,n=e.length;n>s&&(r=e[s],a(this.data,r)||(o=this.data.length,this.data.push(r),i+='<li class="textcomplete-item" data-index="'+o+'"><a>',i+=this.strategy.template(r),i+="</a></li>",this.data.length!==this.strategy.maxCount));s++);this.strategy.footer&&(l=t.isFunction(this.strategy.footer)?this.strategy.footer(e):this.strategy.footer,i+='<li class="textcomplete-footer">'+l+"</li>"),this.$el.append(i),this.data.length?(this.activateIndexedItem(),this.setScroll()):this.deactivate()},clear:function(){return this.data=[],this.$el.html(""),this.index=0,this},activateIndexedItem:function(){this.$el.find(".active").removeClass("active"),this.getActiveItem().addClass("active")},getActiveItem:function(){return t(this.$el.children(".textcomplete-item").get(this.index))},activate:function(){return this.shown||(this.$el.show(),this.completer.$el.trigger("textComplete:show"),this.shown=!0),this},deactivate:function(){return this.shown&&(this.$el.hide(),this.completer.$el.trigger("textComplete:hide"),this.shown=!1,this.data=[],this.index=null),this},setPosition:function(t){var e;return this.strategy.placement.indexOf("top")>-1?(e=parseInt(this.$el.css("font-size")),t={top:"auto",bottom:this.$el.parent().height()-t.top+e,left:t.left}):t.bottom="auto",this.strategy.placement.indexOf("absleft")>-1&&(t.left=0),this.strategy.placement.indexOf("absright")>-1&&(t.right=0,t.left="auto"),this.$el.css(t),this},setScroll:function(){var t=this.getActiveItem(),e=t.position().top,i=t.outerHeight(),s=this.$el.innerHeight(),n=this.$el.scrollTop();0===this.index||this.index===this.data.length-1||0>e?this.$el.scrollTop(e+n):e+i>s&&this.$el.scrollTop(e+i+n-s)},select:function(t){var e=this;this.completer.onSelect(this.data[t]),setTimeout(function(){e.deactivate()},0)},onKeydown:function(e){if(this.shown){var i=e.ctrlKey||e.altKey||e.metaKey||e.shiftKey;if(38===e.keyCode||e.ctrlKey&&80===e.keyCode)e.preventDefault(),0===this.index?this.index=this.data.length-1:this.index-=1,this.activateIndexedItem(),this.setScroll();else if(40===e.keyCode||e.ctrlKey&&78===e.keyCode)e.preventDefault(),this.index===this.data.length-1?this.index=0:this.index+=1,this.activateIndexedItem(),this.setScroll();else if(i||13!==e.keyCode&&9!==e.keyCode){if(33===e.keyCode){e.preventDefault();var s=0,n=this.getActiveItem().position().top-this.$el.innerHeight();this.$el.children().each(function(e){return t(this).position().top+t(this).outerHeight()>n?(s=e,!1):void 0}),this.index=s,this.activateIndexedItem(),this.setScroll()}else if(34===e.keyCode){e.preventDefault();var s=this.data.length-1,n=this.getActiveItem().position().top+this.$el.innerHeight();this.$el.children().each(function(e){return t(this).position().top>n?(s=e,!1):void 0}),this.index=s,this.activateIndexedItem(),this.setScroll()}}else e.preventDefault(),this.select(parseInt(this.getActiveItem().data("index"),10))}},onClick:function(e){var i=t(e.target);e.preventDefault(),e.originalEvent.keepTextCompleteDropdown=!0,i.hasClass("textcomplete-item")||(i=i.parents("li.textcomplete-item")),this.select(parseInt(i.data("index"),10))},onMouseover:function(e){var i=t(e.target);e.preventDefault(),i.hasClass("textcomplete-item")||(i=i.parents("li.textcomplete-item")),this.index=parseInt(i.data("index"),10),this.activateIndexedItem()},destroy:function(){this.deactivate(),this.$el.off("click.textComplete").remove(),this.$el=null},appendTo:function(t){t.css({position:"relative"}).append(this.$el)}}),e}();t.fn.textcomplete=function(e,i){var s,a,l,h;if(h="textComplete",i||(i={}),"destroy"===e)return this.each(function(){var e=t(this).data(h);e&&e.destroy()});for(s=0,a=e.length;a>s;s++)l=e[s],l.template||(l.template=n),null==l.index&&(l.index=2),null==l.placement&&(l.placement=""),l.cache&&(l.search=o(l.search)),l.maxCount||(l.maxCount=10);return this.each(function(){var s,n;s=t(this),n=s.data(h),n||(n=new r(s,i),s.data(h,n)),n.register(e)})}}(window.jQuery||window.Zepto);!function(c){c.fn.simpleColor=function(f){function o(){f=c.simpleColorOptions;var o=c("<div class='simpleColorContainer' />");o.css("position","relative");var l=this.value&&""!=this.value?this.value:f.defaultColor,i=c("<div class='simpleColorDisplay' />");i.css(c.extend(f.displayCSS,{"background-color":l})),i.data("color",l),o.append(i),f.displayColorCode&&(i.data("displayColorCode",!0),i.text(this.value),i.css({color:f.colorCodeColor,textAlign:f.colorCodeAlign}));var e=function(o){if(c("html").bind("click.simpleColorDisplay",function(l){c("html").unbind("click.simpleColorDisplay"),c(".simpleColorChooser").hide();var e=c(l.target);(e.is(".simpleColorCell")===!1||c.contains(c(o.target).closest(".simpleColorContainer")[0],e[0])===!1)&&(i.css("background-color",i.data("color")),f.displayColorCode&&i.text(i.data("color"))),f.onClose&&f.onClose(t)}),o.data.container.chooser)o.data.container.chooser.toggle();else{var l=c("<div class='simpleColorChooser'/>");l.css(f.chooserCSS),o.data.container.chooser=l,o.data.container.append(l);for(var e=0;e<f.colors.length;e++){var r=c("<div class='simpleColorCell' id='"+f.colors[e]+"'/>");r.css({width:f.cellWidth+"px",height:f.cellHeight+"px",margin:f.cellMargin+"px",cursor:"pointer",lineHeight:f.cellHeight+"px",fontSize:"1px","float":"left","background-color":"#"+f.colors[e]}),l.append(r),(f.onCellEnter||f.livePreview)&&r.bind("mouseenter",function(){f.onCellEnter&&f.onCellEnter(this.id,t),f.livePreview&&(i.css("background-color","#"+this.id),f.displayColorCode&&i.text("#"+this.id))}),r.bind("click",{input:o.data.input,chooser:l,displayBox:i},function(o){var l="#"+this.id;o.data.input.value=l,c(o.data.input).change(),c(o.data.displayBox).data("color",l),o.data.displayBox.css("background-color",l),o.data.chooser.hide(),f.displayColorCode&&o.data.displayBox.text(l),f.onSelect&&f.onSelect(this.id,t)})}}},r={input:this,container:o,displayBox:i};i.bind("click",r,e),c(this).after(o),c(this).data("container",o)}var t=this,l=["990033","ff3366","cc0033","ff0033","ff9999","cc3366","ffccff","cc6699","993366","660033","cc3399","ff99cc","ff66cc","ff99ff","ff6699","cc0066","ff0066","ff3399","ff0099","ff33cc","ff00cc","ff66ff","ff33ff","ff00ff","cc0099","990066","cc66cc","cc33cc","cc99ff","cc66ff","cc33ff","993399","cc00cc","cc00ff","9900cc","990099","cc99cc","996699","663366","660099","9933cc","660066","9900ff","9933ff","9966cc","330033","663399","6633cc","6600cc","9966ff","330066","6600ff","6633ff","ccccff","9999ff","9999cc","6666cc","6666ff","666699","333366","333399","330099","3300cc","3300ff","3333ff","3333cc","0066ff","0033ff","3366ff","3366cc","000066","000033","0000ff","000099","0033cc","0000cc","336699","0066cc","99ccff","6699ff","003366","6699cc","006699","3399cc","0099cc","66ccff","3399ff","003399","0099ff","33ccff","00ccff","99ffff","66ffff","33ffff","00ffff","00cccc","009999","669999","99cccc","ccffff","33cccc","66cccc","339999","336666","006666","003333","00ffcc","33ffcc","33cc99","00cc99","66ffcc","99ffcc","00ff99","339966","006633","336633","669966","66cc66","99ff99","66ff66","339933","99cc99","66ff99","33ff99","33cc66","00cc66","66cc99","009966","009933","33ff66","00ff66","ccffcc","ccff99","99ff66","99ff33","00ff33","33ff33","00cc33","33cc33","66ff33","00ff00","66cc33","006600","003300","009900","33ff00","66ff00","99ff00","66cc00","00cc00","33cc00","339900","99cc66","669933","99cc33","336600","669900","99cc00","ccff66","ccff33","ccff00","999900","cccc00","cccc33","333300","666600","999933","cccc66","666633","999966","cccc99","ffffcc","ffff99","ffff66","ffff33","ffff00","ffcc00","ffcc66","ffcc33","cc9933","996600","cc9900","ff9900","cc6600","993300","cc6633","663300","ff9966","ff6633","ff9933","ff6600","cc3300","996633","330000","663333","996666","cc9999","993333","cc6666","ffcccc","ff3333","cc3333","ff6666","660000","990000","cc0000","ff0000","ff3300","cc9966","ffcc99","ffffff","cccccc","999999","666666","333333","000000","000000","000000","000000","000000","000000","000000","000000","000000"];return f=c.extend({defaultColor:this.attr("defaultColor")||"#FFF",cellWidth:this.attr("cellWidth")||10,cellHeight:this.attr("cellHeight")||10,cellMargin:this.attr("cellMargin")||1,boxWidth:this.attr("boxWidth")||"115px",boxHeight:this.attr("boxHeight")||"20px",columns:this.attr("columns")||16,insert:this.attr("insert")||"after",colors:this.attr("colors")||l,displayColorCode:this.attr("displayColorCode")||!1,colorCodeAlign:this.attr("colorCodeAlign")||"center",colorCodeColor:this.attr("colorCodeColor")||"#FFF",onSelect:null,onCellEnter:null,onClose:null,livePreview:!1},f||{}),f.totalWidth=f.columns*(f.cellWidth+2*f.cellMargin),f.chooserCSS=c.extend({border:"1px solid #000",margin:"0 0 0 5px",width:f.totalWidth,height:f.totalHeight,top:0,left:f.boxWidth,position:"absolute","background-color":"#fff"},f.chooserCSS||{}),f.displayCSS=c.extend({"background-color":f.defaultColor,border:"1px solid #000",width:f.boxWidth,height:f.boxHeight,"line-height":f.boxHeight+"px",cursor:"pointer"},f.displayCSS||{}),this.hide(),-1!=navigator.userAgent.indexOf("MSIE")&&(f.totalWidth+=2),f.totalHeight=Math.ceil(f.colors.length/f.columns)*(f.cellHeight+2*f.cellMargin),c.simpleColorOptions=f,this.each(o),c(".simpleColorDisplay").each(function(){c(this).click(function(c){c.stopPropagation()})}),this},c.fn.closeChooser=function(){return this.each(function(){c(this).data("container").find(".simpleColorChooser").hide()}),this},c.fn.setColor=function(f){return this.each(function(){var o=c(this).data("container").find(".simpleColorDisplay");o.css("background-color",f).data("color",f),o.data("displayColorCode")===!0&&o.text(f)}),this}}(jQuery);!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?e(require("jquery")):e(jQuery)}(function(e){function n(e){return u.raw?e:encodeURIComponent(e)}function o(e){return u.raw?e:decodeURIComponent(e)}function i(e){return n(u.json?JSON.stringify(e):String(e))}function r(e){0===e.indexOf('"')&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return e=decodeURIComponent(e.replace(c," ")),u.json?JSON.parse(e):e}catch(n){}}function t(n,o){var i=u.raw?n:r(n);return e.isFunction(o)?o(i):i}var c=/\+/g,u=e.cookie=function(r,c,f){if(void 0!==c&&!e.isFunction(c)){if(f=e.extend({},u.defaults,f),"number"==typeof f.expires){var a=f.expires,d=f.expires=new Date;d.setTime(+d+864e5*a)}return document.cookie=[n(r),"=",i(c),f.expires?"; expires="+f.expires.toUTCString():"",f.path?"; path="+f.path:"",f.domain?"; domain="+f.domain:"",f.secure?"; secure":""].join("")}for(var p=r?void 0:{},s=document.cookie?document.cookie.split("; "):[],m=0,x=s.length;x>m;m++){var v=s[m].split("="),k=o(v.shift()),l=v.join("=");if(r&&r===k){p=t(l,c);break}r||void 0===(l=t(l))||(p[k]=l)}return p};u.defaults={},e.removeCookie=function(n,o){return void 0===e.cookie(n)?!1:(e.cookie(n,"",e.extend({},o,{expires:-1})),!e.cookie(n))}});(function(t){function i(t){if(t.attr("title")||typeof t.attr("original-title")!="string"){t.attr("original-title",t.attr("title")||"").removeAttr("title")}}function e(e,s){this.$element=t(e);this.options=s;this.enabled=true;i(this.$element)}e.prototype={show:function(){var i=this.getTitle();if(i&&this.enabled){var e=this.tip();e.find(".tipsy-inner")[this.options.html?"html":"text"](i);e[0].className="tipsy";e.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).appendTo(document.body);var s=t.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight});var n=e[0].offsetWidth,o=e[0].offsetHeight;var l=typeof this.options.gravity=="function"?this.options.gravity.call(this.$element[0]):this.options.gravity;var a;switch(l.charAt(0)){case"n":a={top:s.top+s.height+this.options.offset,left:s.left+s.width/2-n/2};break;case"s":a={top:s.top-o-this.options.offset,left:s.left+s.width/2-n/2};break;case"e":a={top:s.top+s.height/2-o/2,left:s.left-n-this.options.offset};break;case"w":a={top:s.top+s.height/2-o/2,left:s.left+s.width+this.options.offset};break}if(l.length==2){if(l.charAt(1)=="w"){a.left=s.left+s.width/2-15}else{a.left=s.left+s.width/2-n+15}}e.css(a).addClass("tipsy-"+l);if(this.options.fade){e.stop().css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:this.options.opacity})}else{e.css({visibility:"visible",opacity:this.options.opacity})}}},hide:function(){if(this.options.fade){this.tip().stop().fadeOut(function(){t(this).remove()})}else{this.tip().remove()}},getTitle:function(){var t,e=this.$element,s=this.options;i(e);var t,s=this.options;if(typeof s.title=="string"){t=e.attr(s.title=="title"?"original-title":s.title)}else if(typeof s.title=="function"){t=s.title.call(e[0])}t=(""+t).replace(/(^\s*|\s*$)/,"");return t||s.fallback},tip:function(){if(!this.$tip){this.$tip=t('<div class="tipsy"></div>').html('<div class="tipsy-arrow"></div><div class="tipsy-inner"/></div>')}return this.$tip},validate:function(){if(!this.$element[0].parentNode){this.hide();this.$element=null;this.options=null}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},toggleEnabled:function(){this.enabled=!this.enabled}};t.fn.tipsy=function(i){if(i===true){return this.data("tipsy")}else if(typeof i=="string"){return this.data("tipsy")[i]()}i=t.extend({},t.fn.tipsy.defaults,i);function s(s){var n=t.data(s,"tipsy");if(!n){n=new e(s,t.fn.tipsy.elementOptions(s,i));t.data(s,"tipsy",n)}return n}function n(){var t=s(this);t.hoverState="in";if(i.delayIn==0){t.show()}else{setTimeout(function(){if(t.hoverState=="in")t.show()},i.delayIn)}}function o(){var t=s(this);t.hoverState="out";if(i.delayOut==0){t.hide()}else{setTimeout(function(){if(t.hoverState=="out")t.hide()},i.delayOut)}}if(!i.live)this.each(function(){s(this)});if(i.trigger!="manual"){var l=i.live?"live":"bind",a=i.trigger=="hover"?"mouseenter":"focus",f=i.trigger=="hover"?"mouseleave":"blur";this[l](a,n)[l](f,o)}return this};t.fn.tipsy.defaults={delayIn:0,delayOut:0,fade:false,fallback:"",gravity:"n",html:false,live:false,offset:0,opacity:.8,title:"title",trigger:"hover"};t.fn.tipsy.elementOptions=function(i,e){return t.metadata?t.extend({},e,t(i).metadata()):e};t.fn.tipsy.autoNS=function(){return t(this).offset().top>t(document).scrollTop()+t(window).height()/2?"s":"n"};t.fn.tipsy.autoWE=function(){return t(this).offset().left>t(document).scrollLeft()+t(window).width()/2?"e":"w"}})(jQuery);(function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?e(require("jquery")):e(jQuery)})(function(e){"use strict";var t={wheelSpeed:1,wheelPropagation:!1,minScrollbarLength:null,maxScrollbarLength:null,useBothWheelAxes:!1,useKeyboard:!0,suppressScrollX:!1,suppressScrollY:!1,scrollXMarginOffset:0,scrollYMarginOffset:0,includePadding:!1},o=function(){var e=0;return function(){var t=e;return e+=1,".perfect-scrollbar-"+t}}();e.fn.perfectScrollbar=function(n,r){return this.each(function(){var l=e.extend(!0,{},t),a=e(this);if("object"==typeof n?e.extend(!0,l,n):r=n,"update"===r)return a.data("perfect-scrollbar-update")&&a.data("perfect-scrollbar-update")(),a;if("destroy"===r)return a.data("perfect-scrollbar-destroy")&&a.data("perfect-scrollbar-destroy")(),a;if(a.data("perfect-scrollbar"))return a.data("perfect-scrollbar");a.addClass("ps-container");var s,i,c,d,u,p,f,v,h,b,g=e("<div class='ps-scrollbar-x-rail'></div>").appendTo(a),m=e("<div class='ps-scrollbar-y-rail'></div>").appendTo(a),w=e("<div class='ps-scrollbar-x'></div>").appendTo(g),T=e("<div class='ps-scrollbar-y'></div>").appendTo(m),L=parseInt(g.css("bottom"),10),y=L===L,I=y?null:parseInt(g.css("top"),10),S=parseInt(m.css("right"),10),C=S===S,x=C?null:parseInt(m.css("left"),10),D="rtl"===a.css("direction"),X=o(),Y=parseInt(g.css("borderLeftWidth"),10)+parseInt(g.css("borderRightWidth"),10),P=parseInt(g.css("borderTopWidth"),10)+parseInt(g.css("borderBottomWidth"),10),k=function(e,t){var o=e+t,n=d-h;b=0>o?0:o>n?n:o;var r=parseInt(b*(p-d)/(d-h),10);a.scrollTop(r)},E=function(e,t){var o=e+t,n=c-f;v=0>o?0:o>n?n:o;var r=parseInt(v*(u-c)/(c-f),10);a.scrollLeft(r)},M=function(e){return l.minScrollbarLength&&(e=Math.max(e,l.minScrollbarLength)),l.maxScrollbarLength&&(e=Math.min(e,l.maxScrollbarLength)),e},W=function(){var e={width:c,display:s?"inherit":"none"};e.left=D?a.scrollLeft()+c-u:a.scrollLeft(),y?e.bottom=L-a.scrollTop():e.top=I+a.scrollTop(),g.css(e);var t={top:a.scrollTop(),height:d,display:i?"inherit":"none"};C?t.right=D?u-a.scrollLeft()-S-T.outerWidth():S-a.scrollLeft():t.left=D?a.scrollLeft()+2*c-u-x-T.outerWidth():x+a.scrollLeft(),m.css(t),w.css({left:v,width:f-Y}),T.css({top:b,height:h-P}),s?a.addClass("ps-active-x"):a.removeClass("ps-active-x"),i?a.addClass("ps-active-y"):a.removeClass("ps-active-y")},j=function(){g.hide(),m.hide(),c=l.includePadding?a.innerWidth():a.width(),d=l.includePadding?a.innerHeight():a.height(),u=a.prop("scrollWidth"),p=a.prop("scrollHeight"),!l.suppressScrollX&&u>c+l.scrollXMarginOffset?(s=!0,f=M(parseInt(c*c/u,10)),v=parseInt(a.scrollLeft()*(c-f)/(u-c),10)):(s=!1,f=0,v=0,a.scrollLeft(0)),!l.suppressScrollY&&p>d+l.scrollYMarginOffset?(i=!0,h=M(parseInt(d*d/p,10)),b=parseInt(a.scrollTop()*(d-h)/(p-d),10)):(i=!1,h=0,b=0,a.scrollTop(0)),b>=d-h&&(b=d-h),v>=c-f&&(v=c-f),W(),l.suppressScrollX||g.show(),l.suppressScrollY||m.show()},O=function(){var t,o;w.bind("mousedown"+X,function(e){o=e.pageX,t=w.position().left,g.addClass("in-scrolling"),e.stopPropagation(),e.preventDefault()}),e(document).bind("mousemove"+X,function(e){g.hasClass("in-scrolling")&&(E(t,e.pageX-o),j(),e.stopPropagation(),e.preventDefault())}),e(document).bind("mouseup"+X,function(){g.hasClass("in-scrolling")&&g.removeClass("in-scrolling")}),t=o=null},q=function(){var t,o;T.bind("mousedown"+X,function(e){o=e.pageY,t=T.position().top,m.addClass("in-scrolling"),e.stopPropagation(),e.preventDefault()}),e(document).bind("mousemove"+X,function(e){m.hasClass("in-scrolling")&&(k(t,e.pageY-o),j(),e.stopPropagation(),e.preventDefault())}),e(document).bind("mouseup"+X,function(){m.hasClass("in-scrolling")&&m.removeClass("in-scrolling")}),t=o=null},A=function(e,t){var o=a.scrollTop();if(0===e){if(!i)return!1;if(0===o&&t>0||o>=p-d&&0>t)return!l.wheelPropagation}var n=a.scrollLeft();if(0===t){if(!s)return!1;if(0===n&&0>e||n>=u-c&&e>0)return!l.wheelPropagation}return!0},B=function(){var e=!1,t=function(e){var t=e.originalEvent.deltaX,o=-1*e.originalEvent.deltaY;return(t===void 0||o===void 0)&&(t=-1*e.originalEvent.wheelDeltaX/6,o=e.originalEvent.wheelDeltaY/6),e.originalEvent.deltaMode&&1===e.originalEvent.deltaMode&&(t*=10,o*=10),t!==t&&o!==o&&(t=0,o=e.originalEvent.wheelDelta),[t,o]},o=function(o){var n=t(o),r=n[0],c=n[1];e=!1,l.useBothWheelAxes?i&&!s?(c?a.scrollTop(a.scrollTop()-c*l.wheelSpeed):a.scrollTop(a.scrollTop()+r*l.wheelSpeed),e=!0):s&&!i&&(r?a.scrollLeft(a.scrollLeft()+r*l.wheelSpeed):a.scrollLeft(a.scrollLeft()-c*l.wheelSpeed),e=!0):(a.scrollTop(a.scrollTop()-c*l.wheelSpeed),a.scrollLeft(a.scrollLeft()+r*l.wheelSpeed)),j(),e=e||A(r,c),e&&(o.stopPropagation(),o.preventDefault())};window.onwheel!==void 0?a.bind("wheel"+X,o):window.onmousewheel!==void 0&&a.bind("mousewheel"+X,o)},H=function(){var t=!1;a.bind("mouseenter"+X,function(){t=!0}),a.bind("mouseleave"+X,function(){t=!1});var o=!1;e(document).bind("keydown"+X,function(n){if(!(n.isDefaultPrevented&&n.isDefaultPrevented()||!t||e(document.activeElement).is(":input,[contenteditable]"))){var r=0,l=0;switch(n.which){case 37:r=-30;break;case 38:l=30;break;case 39:r=30;break;case 40:l=-30;break;case 33:l=90;break;case 32:case 34:l=-90;break;case 35:l=-d;break;case 36:l=d;break;default:return}a.scrollTop(a.scrollTop()-l),a.scrollLeft(a.scrollLeft()+r),o=A(r,l),o&&n.preventDefault()}})},K=function(){var e=function(e){e.stopPropagation()};T.bind("click"+X,e),m.bind("click"+X,function(e){var t=parseInt(h/2,10),o=e.pageY-m.offset().top-t,n=d-h,r=o/n;0>r?r=0:r>1&&(r=1),a.scrollTop((p-d)*r)}),w.bind("click"+X,e),g.bind("click"+X,function(e){var t=parseInt(f/2,10),o=e.pageX-g.offset().left-t,n=c-f,r=o/n;0>r?r=0:r>1&&(r=1),a.scrollLeft((u-c)*r)})},Q=function(){var t=function(e,t){a.scrollTop(a.scrollTop()-t),a.scrollLeft(a.scrollLeft()-e),j()},o={},n=0,r={},l=null,s=!1;e(window).bind("touchstart"+X,function(){s=!0}),e(window).bind("touchend"+X,function(){s=!1}),a.bind("touchstart"+X,function(e){var t=e.originalEvent.targetTouches[0];o.pageX=t.pageX,o.pageY=t.pageY,n=(new Date).getTime(),null!==l&&clearInterval(l),e.stopPropagation()}),a.bind("touchmove"+X,function(e){if(!s&&1===e.originalEvent.targetTouches.length){var l=e.originalEvent.targetTouches[0],a={};a.pageX=l.pageX,a.pageY=l.pageY;var i=a.pageX-o.pageX,c=a.pageY-o.pageY;t(i,c),o=a;var d=(new Date).getTime(),u=d-n;u>0&&(r.x=i/u,r.y=c/u,n=d),e.preventDefault()}}),a.bind("touchend"+X,function(){clearInterval(l),l=setInterval(function(){return.01>Math.abs(r.x)&&.01>Math.abs(r.y)?(clearInterval(l),void 0):(t(30*r.x,30*r.y),r.x*=.8,r.y*=.8,void 0)},10)})},R=function(){a.bind("scroll"+X,function(){j()})},z=function(){a.unbind(X),e(window).unbind(X),e(document).unbind(X),a.data("perfect-scrollbar",null),a.data("perfect-scrollbar-update",null),a.data("perfect-scrollbar-destroy",null),w.remove(),T.remove(),g.remove(),m.remove(),g=m=w=T=s=i=c=d=u=p=f=v=L=y=I=h=b=S=C=x=D=X=null},F=function(t){a.addClass("ie").addClass("ie"+t);var o=function(){var t=function(){e(this).addClass("hover")},o=function(){e(this).removeClass("hover")};a.bind("mouseenter"+X,t).bind("mouseleave"+X,o),g.bind("mouseenter"+X,t).bind("mouseleave"+X,o),m.bind("mouseenter"+X,t).bind("mouseleave"+X,o),w.bind("mouseenter"+X,t).bind("mouseleave"+X,o),T.bind("mouseenter"+X,t).bind("mouseleave"+X,o)},n=function(){W=function(){var e={left:v+a.scrollLeft(),width:f};y?e.bottom=L:e.top=I,w.css(e);var t={top:b+a.scrollTop(),height:h};C?t.right=S:t.left=x,T.css(t),w.hide().show(),T.hide().show()}};6===t&&(o(),n())},G="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,J=function(){var e=navigator.userAgent.toLowerCase().match(/(msie) ([\w.]+)/);e&&"msie"===e[1]&&F(parseInt(e[2],10)),j(),R(),O(),q(),K(),B(),G&&Q(),l.useKeyboard&&H(),a.data("perfect-scrollbar",a),a.data("perfect-scrollbar-update",j),a.data("perfect-scrollbar-destroy",z)};return J(),a})}});var Base=function(){};Base.extend=function(t,i){"use strict";var e=Base.prototype.extend;Base._prototyping=!0;var n=new this;e.call(n,t),n.base=function(){},delete Base._prototyping;var s=n.constructor,o=n.constructor=function(){if(!Base._prototyping)if(this._constructing||this.constructor==o)this._constructing=!0,s.apply(this,arguments),delete this._constructing;else if(null!==arguments[0])return(arguments[0].extend||e).call(arguments[0],n)};return o.ancestor=this,o.extend=this.extend,o.forEach=this.forEach,o.implement=this.implement,o.prototype=n,o.toString=this.toString,o.valueOf=function(t){return"object"==t?o:s.valueOf()},e.call(o,i),"function"==typeof o.init&&o.init(),o},Base.prototype={extend:function(t,i){if(arguments.length>1){var e=this[t];if(e&&"function"==typeof i&&(!e.valueOf||e.valueOf()!=i.valueOf())&&/\bbase\b/.test(i)){var n=i.valueOf();i=function(){var t=this.base||Base.prototype.base;this.base=e;var i=n.apply(this,arguments);return this.base=t,i},i.valueOf=function(t){return"object"==t?i:n},i.toString=Base.toString}this[t]=i}else if(t){var s=Base.prototype.extend;Base._prototyping||"function"==typeof this||(s=this.extend||s);for(var o={toSource:null},a=["constructor","toString","valueOf"],c=Base._prototyping?0:1;r=a[c++];)t[r]!=o[r]&&s.call(this,r,t[r]);for(var r in t)o[r]||s.call(this,r,t[r])}return this}},Base=Base.extend({constructor:function(){this.extend(arguments[0])}},{ancestor:Object,version:"1.1",forEach:function(t,i,e){for(var n in t)void 0===this.prototype[n]&&i.call(e,t[n],n,t)},implement:function(){for(var t=0;t<arguments.length;t++)"function"==typeof arguments[t]?arguments[t](this.prototype):this.prototype.extend(arguments[t]);return this},toString:function(){return String(this.valueOf())}});var FlipClock;!function(t){"use strict";FlipClock=function(t,i,e){return"object"==typeof i&&(e=i,i=0),new FlipClock.Factory(t,i,e)},FlipClock.Lang={},FlipClock.Base=Base.extend({buildDate:"2014-06-03",version:"0.5.5",constructor:function(i,e){"object"!=typeof i&&(i={}),"object"!=typeof e&&(e={}),this.setOptions(t.extend(!0,{},i,e))},callback:function(t){if("function"==typeof t){for(var i=[],e=1;e<=arguments.length;e++)arguments[e]&&i.push(arguments[e]);t.apply(this,i)}},log:function(t){window.console&&console.log&&console.log(t)},getOption:function(t){return this[t]?this[t]:!1},getOptions:function(){return this},setOption:function(t,i){this[t]=i},setOptions:function(t){for(var i in t)"undefined"!=typeof t[i]&&this.setOption(i,t[i])}})}(jQuery),function(t){"use strict";FlipClock.Face=FlipClock.Base.extend({dividers:[],factory:!1,lists:[],constructor:function(t,i){this.dividers=[],this.lists=[],this.base(i),this.factory=t},build:function(){},createDivider:function(i,e,n){"boolean"!=typeof e&&e||(n=e,e=i);var s=['<span class="'+this.factory.classes.dot+' top"></span>','<span class="'+this.factory.classes.dot+' bottom"></span>'].join("");n&&(s=""),i=this.factory.localize(i);var o=['<span class="'+this.factory.classes.divider+" "+(e?e:"").toLowerCase()+'">','<span class="'+this.factory.classes.label+'">'+(i?i:"")+"</span>",s,"</span>"];return t(o.join(""))},createList:function(t,i){"object"==typeof t&&(i=t,t=0);var e=new FlipClock.List(this.factory,t,i);return this.lists.push(e),e},reset:function(){this.factory.time=new FlipClock.Time(this.factor,this.factory.original?Math.round(this.factory.original):0),this.flip(this.factory.original,!1)},addDigit:function(t){var i=this.createList(t,{classes:{active:this.factory.classes.active,before:this.factory.classes.before,flip:this.factory.classes.flip}});i.$el.append(this.factory.lists[this.factory.lists.length-1].$obj)},start:function(){},stop:function(){},autoIncrement:function(){this.factory.time.time instanceof Date||(this.factory.countdown?this.decrement():this.increment())},increment:function(){this.factory.time.addSecond()},decrement:function(){0==this.factory.time.getTimeSeconds()?this.factory.stop():this.factory.time.subSecond()},flip:function(i,e){var n=this;t.each(i,function(t,i){var s=n.lists[t];s?(e||i==s.digit||s.play(),s.select(i)):n.addDigit(i)})}})}(jQuery),function(t){"use strict";FlipClock.Factory=FlipClock.Base.extend({autoStart:!0,callbacks:{destroy:!1,create:!1,init:!1,interval:!1,start:!1,stop:!1,reset:!1},classes:{active:"flip-clock-active",before:"flip-clock-before",divider:"flip-clock-divider",dot:"flip-clock-dot",label:"flip-clock-label",flip:"flip",play:"play",wrapper:"flip-clock-wrapper"},clockFace:"HourlyCounter",countdown:!1,defaultClockFace:"HourlyCounter",defaultLanguage:"english",language:"english",lang:!1,original:!1,face:!0,running:!1,time:!1,timer:!1,lists:[],$el:!1,$wrapper:!1,constructor:function(i,e,n){n||(n={}),this.lists=[],this.running=!1,this.base(n),this.$el=t(i).addClass(this.classes.wrapper),this.$wrapper=this.$el,this.original=e instanceof Date?e:e?Math.round(e):0,this.time=new FlipClock.Time(this,this.original,{minimumDigits:n.minimumDigits?n.minimumDigits:0,animationRate:n.animationRate?n.animationRate:1e3}),this.timer=new FlipClock.Timer(this,n),this.lang=this.loadLanguage(this.language),this.face=this.loadClockFace(this.clockFace,n),this.autoStart&&this.start()},loadClockFace:function(t,i){var e,n="Face";return t=t.ucfirst()+n,e=FlipClock[t]?new FlipClock[t](this,i):new FlipClock[this.defaultClockFace+n](this,i),e.build(),e},loadLanguage:function(t){var i;return i=FlipClock.Lang[t.ucfirst()]?FlipClock.Lang[t.ucfirst()]:FlipClock.Lang[t]?FlipClock.Lang[t]:FlipClock.Lang[this.defaultLanguage]},localize:function(t,i){var e=this.lang;if(!t)return null;var n=t.toLowerCase();return"object"==typeof i&&(e=i),e&&e[n]?e[n]:t},start:function(t){var i=this;i.running||i.countdown&&!(i.countdown&&i.time.time>0)?i.log("Trying to start timer when countdown already at 0"):(i.face.start(i.time),i.timer.start(function(){i.flip(),"function"==typeof t&&t()}))},stop:function(t){this.face.stop(),this.timer.stop(t);for(var i in this.lists)this.lists.hasOwnProperty(i)&&this.lists[i].stop()},reset:function(t){this.timer.reset(t),this.face.reset()},setTime:function(t){this.time.time=t,this.flip(!0)},getTime:function(){return this.time},setCountdown:function(t){var i=this.running;this.countdown=t?!0:!1,i&&(this.stop(),this.start())},flip:function(t){this.face.flip(!1,t)}})}(jQuery),function(t){"use strict";FlipClock.List=FlipClock.Base.extend({digit:0,classes:{active:"flip-clock-active",before:"flip-clock-before",flip:"flip"},factory:!1,$el:!1,$obj:!1,items:[],lastDigit:0,minimumDigits:0,constructor:function(t,i){this.factory=t,this.digit=i,this.lastDigit=i,this.$el=this.createList(),this.$wrapper=this.$el,i>0&&this.select(i),this.factory.$el.append(this.$el)},select:function(t){if("undefined"==typeof t?t=this.digit:this.digit=t,this.digit!=this.lastDigit){var i=this.$el.find("."+this.classes.before).removeClass(this.classes.before);this.$el.find("."+this.classes.active).removeClass(this.classes.active).addClass(this.classes.before),this.appendListItem(this.classes.active,this.digit),i.remove(),this.lastDigit=this.digit}},play:function(){this.$el.addClass(this.factory.classes.play)},stop:function(){var t=this;setTimeout(function(){t.$el.removeClass(t.factory.classes.play)},this.factory.timer.interval)},createListItem:function(t,i){return['<li class="'+(t?t:"")+'">','<a href="#">','<div class="up">','<div class="shadow"></div>','<div class="inn">'+(i?i:"")+"</div>","</div>",'<div class="down">','<div class="shadow"></div>','<div class="inn">'+(i?i:"")+"</div>","</div>","</a>","</li>"].join("")},appendListItem:function(t,i){var e=this.createListItem(t,i);this.$el.append(e)},createList:function(){var i=this.getPrevDigit()?this.getPrevDigit():this.digit,e=t(['<ul class="'+this.classes.flip+" "+(this.factory.running?this.factory.classes.play:"")+'">',this.createListItem(this.classes.before,i),this.createListItem(this.classes.active,this.digit),"</ul>"].join(""));return e},getNextDigit:function(){return 9==this.digit?0:this.digit+1},getPrevDigit:function(){return 0==this.digit?9:this.digit-1}})}(jQuery),function(t){"use strict";String.prototype.ucfirst=function(){return this.substr(0,1).toUpperCase()+this.substr(1)},t.fn.FlipClock=function(i,e){return"object"==typeof i&&(e=i,i=0),new FlipClock(t(this),i,e)},t.fn.flipClock=function(i,e){return t.fn.FlipClock(i,e)}}(jQuery),function(t){"use strict";FlipClock.Time=FlipClock.Base.extend({time:0,factory:!1,minimumDigits:0,constructor:function(t,i,e){this.base(e),this.factory=t,i&&(this.time=i)},convertDigitsToArray:function(t){var i=[];t=t.toString();for(var e=0;e<t.length;e++)t[e].match(/^\d*$/g)&&i.push(t[e]);return i},digit:function(t){var i=this.toString(),e=i.length;return i[e-t]?i[e-t]:!1},digitize:function(i){var e=[];if(t.each(i,function(t,i){i=i.toString(),1==i.length&&(i="0"+i);for(var n=0;n<i.length;n++)e.push(i.charAt(n))}),e.length>this.minimumDigits&&(this.minimumDigits=e.length),this.minimumDigits>e.length)for(var n=e.length;n<this.minimumDigits;n++)e.unshift("0");return e},getDayCounter:function(t){var i=[this.getDays(),this.getHours(!0),this.getMinutes(!0)];return t&&i.push(this.getSeconds(!0)),this.digitize(i)},getDays:function(t){var i=this.getTimeSeconds()/60/60/24;return t&&(i%=7),Math.floor(i)},getHourCounter:function(){var t=this.digitize([this.getHours(),this.getMinutes(!0),this.getSeconds(!0)]);return t},getHourly:function(){return this.getHourCounter()},getHours:function(t){var i=this.getTimeSeconds()/60/60;return t&&(i%=24),Math.floor(i)},getMilitaryTime:function(){var t=new Date,i=this.digitize([t.getHours(),t.getMinutes(),t.getSeconds()]);return i},getMinutes:function(t){var i=this.getTimeSeconds()/60;return t&&(i%=60),Math.floor(i)},getMinuteCounter:function(){var t=this.digitize([this.getMinutes(),this.getSeconds(!0)]);return t},getTimeSeconds:function(){return this.time instanceof Date?this.factory.countdown?((new Date).getTime()>this.time.getTime()&&this.factory.stop(),Math.max(this.time.getTime()/1e3-(new Date).getTime()/1e3,0)):(new Date).getTime()/1e3-this.time.getTime()/1e3:this.time},getSeconds:function(t){var i=this.getTimeSeconds();return t&&(60==i?i=0:i%=60),Math.ceil(i)},getTime:function(){var t=new Date,i=t.getHours(),e=this.digitize([i>12?i-12:0===i?12:i,t.getMinutes(),t.getSeconds()]);return e},getWeeks:function(){var t=this.getTimeSeconds()/60/60/24/7;return mod&&(t%=52),Math.floor(t)},removeLeadingZeros:function(i,e){var n=0,s=[];return t.each(e,function(t){i>t?n+=parseInt(e[t],10):s.push(e[t])}),0===n?s:e},addSeconds:function(t){this.time+=t},addSecond:function(){this.addSeconds(1)},subSeconds:function(t){this.time-=t},subSecond:function(){this.subSeconds(1)},toString:function(){return this.getTimeSeconds().toString()}})}(jQuery),function(){"use strict";FlipClock.Timer=FlipClock.Base.extend({callbacks:{destroy:!1,create:!1,init:!1,interval:!1,start:!1,stop:!1,reset:!1},count:0,factory:!1,interval:1e3,animationRate:1e3,constructor:function(t,i){this.base(i),this.factory=t,this.callback(this.callbacks.init),this.callback(this.callbacks.create)},getElapsed:function(){return this.count*this.interval},getElapsedTime:function(){return new Date(this.time+this.getElapsed())},reset:function(t){clearInterval(this.timer),this.count=0,this._setInterval(t),this.callback(this.callbacks.reset)},start:function(t){this.factory.running=!0,this._createTimer(t),this.callback(this.callbacks.start)},stop:function(t){this.factory.running=!1,this._clearInterval(t),this.callback(this.callbacks.stop),this.callback(t)},_clearInterval:function(){clearInterval(this.timer)},_createTimer:function(t){this._setInterval(t)},_destroyTimer:function(t){this._clearInterval(),this.timer=!1,this.callback(t),this.callback(this.callbacks.destroy)},_interval:function(t){this.callback(this.callbacks.interval),this.callback(t),this.count++},_setInterval:function(t){var i=this;i._interval(t),i.timer=setInterval(function(){i._interval(t)},this.interval)}})}(jQuery),function(t){FlipClock.TwentyFourHourClockFace=FlipClock.Face.extend({constructor:function(t,i){t.countdown=!1,this.base(t,i)},build:function(i){var e=this,n=this.factory.$el.find("ul");i=i?i:this.factory.time.time||this.factory.time.getMilitaryTime(),i.length>n.length&&t.each(i,function(t,i){e.factory.lists.push(e.createList(i))}),this.dividers.push(this.createDivider()),this.dividers.push(this.createDivider()),t(this.dividers[0]).insertBefore(this.factory.lists[this.factory.lists.length-2].$el),t(this.dividers[1]).insertBefore(this.factory.lists[this.factory.lists.length-4].$el),this.autoStart&&this.start()},flip:function(t,i){t=t?t:this.factory.time.getMilitaryTime(),this.base(t,i)}})}(jQuery),function(t){FlipClock.CounterFace=FlipClock.Face.extend({minimumDigits:2,constructor:function(t,i){t.autoStart=i.autoStart?!0:!1,t.increment=function(){t.countdown=!1,t.setTime(t.getTime().getTimeSeconds()+1)},t.decrement=function(){t.countdown=!0;var i=t.getTime().getTimeSeconds();i>0&&t.setTime(i-1)},t.setValue=function(i){t.setTime(i)},t.setCounter=function(i){t.setTime(i)},this.base(t,i)},build:function(){var i=this,e=this.factory.$el.find("ul"),n=[],s=this.factory.getTime().digitize([this.factory.getTime().time]);s.length>e.length&&t.each(s,function(t,e){var s=i.createList(e,{minimumDigits:i.minimumDigits});s.select(e),n.push(s)}),t.each(n,function(t,i){i.play()}),this.factory.lists=n},flip:function(t,i){t||(t=this.factory.getTime().digitize([this.factory.getTime().time])),this.autoStart&&this.autoIncrement(),this.base(t,i)},reset:function(){this.factory.time=new FlipClock.Time(this.factor,this.factory.original?Math.round(this.factory.original):0),this.flip()}})}(jQuery),function(t){FlipClock.DailyCounterFace=FlipClock.Face.extend({showSeconds:!0,constructor:function(t,i){this.base(t,i)},build:function(i,e){var n=this,s=this.factory.$el.find("ul"),o=[],a=0;e=e?e:this.factory.time.getDayCounter(this.showSeconds),e.length>s.length&&t.each(e,function(t,i){o.push(n.createList(i))}),this.factory.lists=o,this.showSeconds?t(this.createDivider("Seconds")).insertBefore(this.factory.lists[this.factory.lists.length-2].$el):a=2,t(this.createDivider("Minutes")).insertBefore(this.factory.lists[this.factory.lists.length-4+a].$el),t(this.createDivider("Hours")).insertBefore(this.factory.lists[this.factory.lists.length-6+a].$el),t(this.createDivider("Days",!0)).insertBefore(this.factory.lists[0].$el),this.autoStart&&this.start()},flip:function(t,i){t||(t=this.factory.time.getDayCounter(this.showSeconds)),this.autoIncrement(),this.base(t,i)}})}(jQuery),function(t){FlipClock.HourlyCounterFace=FlipClock.Face.extend({constructor:function(t,i){this.base(t,i)},build:function(i,e){var n=this,s=this.factory.$el.find("ul"),o=[];e=e?e:this.factory.time.getHourCounter(),e.length>s.length&&t.each(e,function(t,i){o.push(n.createList(i))}),this.factory.lists=o,t(this.createDivider("Seconds")).insertBefore(this.factory.lists[this.factory.lists.length-2].$el),t(this.createDivider("Minutes")).insertBefore(this.factory.lists[this.factory.lists.length-4].$el),i||t(this.createDivider("Hours",!0)).insertBefore(this.factory.lists[0].$el),this.autoStart&&this.start()},flip:function(t,i){t||(t=this.factory.time.getHourCounter()),this.autoIncrement(),this.base(t,i)}})}(jQuery),function(){FlipClock.MinuteCounterFace=FlipClock.HourlyCounterFace.extend({clearExcessDigits:!1,constructor:function(t,i){this.base(t,i)},build:function(){this.base(!0,this.factory.time.getMinuteCounter())},flip:function(t,i){t||(t=this.factory.time.getMinuteCounter()),this.base(t,i)}})}(jQuery),function(t){FlipClock.TwelveHourClockFace=FlipClock.TwentyFourHourClockFace.extend({meridium:!1,meridiumText:"AM",build:function(i){i=i?i:this.factory.time.time?this.factory.time.time:this.factory.time.getTime(),this.base(i),this.meridiumText=this._isPM()?"PM":"AM",this.meridium=t(['<ul class="flip-clock-meridium">',"<li>",'<a href="#">'+this.meridiumText+"</a>","</li>","</ul>"].join("")),this.meridium.insertAfter(this.factory.lists[this.factory.lists.length-1].$el)},flip:function(t,i){this.meridiumText!=this._getMeridium()&&(this.meridiumText=this._getMeridium(),this.meridium.find("a").html(this.meridiumText)),this.base(this.factory.time.getTime(),i)},_getMeridium:function(){return(new Date).getHours()>=12?"PM":"AM"},_isPM:function(){return"PM"==this._getMeridium()?!0:!1}})}(jQuery),function(){FlipClock.Lang.Arabic={years:"سنوات",months:"شهور",days:"أيام",hours:"ساعات",minutes:"دقائق",seconds:"ثواني"},FlipClock.Lang.ar=FlipClock.Lang.Arabic,FlipClock.Lang["ar-ar"]=FlipClock.Lang.Arabic,FlipClock.Lang.arabic=FlipClock.Lang.Arabic}(jQuery),function(){FlipClock.Lang.Danish={years:"År",months:"Måneder",days:"Dage",hours:"Timer",minutes:"Minutter",seconds:"Sekunder"},FlipClock.Lang.da=FlipClock.Lang.Danish,FlipClock.Lang["da-dk"]=FlipClock.Lang.Danish,FlipClock.Lang.danish=FlipClock.Lang.Danish}(jQuery),function(){FlipClock.Lang.German={years:"Jahre",months:"Monate",days:"Tage",hours:"Stunden",minutes:"Minuten",seconds:"Sekunden"},FlipClock.Lang.de=FlipClock.Lang.German,FlipClock.Lang["de-de"]=FlipClock.Lang.German,FlipClock.Lang.german=FlipClock.Lang.German}(jQuery),function(){FlipClock.Lang.English={years:"Years",months:"Months",days:"Days",hours:"Hours",minutes:"Minutes",seconds:"Seconds"},FlipClock.Lang.en=FlipClock.Lang.English,FlipClock.Lang["en-us"]=FlipClock.Lang.English,FlipClock.Lang.english=FlipClock.Lang.English}(jQuery),function(){FlipClock.Lang.Spanish={years:"A&#241;os",months:"Meses",days:"D&#205;as",hours:"Horas",minutes:"Minutos",seconds:"Segundo"},FlipClock.Lang.es=FlipClock.Lang.Spanish,FlipClock.Lang["es-es"]=FlipClock.Lang.Spanish,FlipClock.Lang.spanish=FlipClock.Lang.Spanish}(jQuery),function(){FlipClock.Lang.Finnish={years:"Vuotta",months:"Kuukautta",days:"Päivää",hours:"Tuntia",minutes:"Minuuttia",seconds:"Sekuntia"},FlipClock.Lang.fi=FlipClock.Lang.Finnish,FlipClock.Lang["fi-fi"]=FlipClock.Lang.Finnish,FlipClock.Lang.finnish=FlipClock.Lang.Finnish}(jQuery),function(){FlipClock.Lang.French={years:"Ans",months:"Mois",days:"Jours",hours:"Heures",minutes:"Minutes",seconds:"Secondes"},FlipClock.Lang.fr=FlipClock.Lang.French,FlipClock.Lang["fr-ca"]=FlipClock.Lang.French,FlipClock.Lang.french=FlipClock.Lang.French}(jQuery),function(){FlipClock.Lang.Italian={years:"Anni",months:"Mesi",days:"Giorni",hours:"Ore",minutes:"Minuti",seconds:"Secondi"},FlipClock.Lang.it=FlipClock.Lang.Italian,FlipClock.Lang["it-it"]=FlipClock.Lang.Italian,FlipClock.Lang.italian=FlipClock.Lang.Italian}(jQuery),function(){FlipClock.Lang.Latvian={years:"Gadi",months:"Mēneši",days:"Dienas",hours:"Stundas",minutes:"Minūtes",seconds:"Sekundes"},FlipClock.Lang.lv=FlipClock.Lang.Latvian,FlipClock.Lang["lv-lv"]=FlipClock.Lang.Latvian,FlipClock.Lang.latvian=FlipClock.Lang.Latvian}(jQuery),function(){FlipClock.Lang.Dutch={years:"Jaren",months:"Maanden",days:"Dagen",hours:"Uren",minutes:"Minuten",seconds:"Seconden"},FlipClock.Lang.nl=FlipClock.Lang.Dutch,FlipClock.Lang["nl-be"]=FlipClock.Lang.Dutch,FlipClock.Lang.dutch=FlipClock.Lang.Dutch}(jQuery),function(){FlipClock.Lang.Norwegian={years:"År",months:"Måneder",days:"Dager",hours:"Timer",minutes:"Minutter",seconds:"Sekunder"},FlipClock.Lang.no=FlipClock.Lang.Norwegian,FlipClock.Lang.nb=FlipClock.Lang.Norwegian,FlipClock.Lang["no-nb"]=FlipClock.Lang.Norwegian,FlipClock.Lang.norwegian=FlipClock.Lang.Norwegian}(jQuery),function(){FlipClock.Lang.Portuguese={years:"Anos",months:"Meses",days:"Dias",hours:"Horas",minutes:"Minutos",seconds:"Segundos"},FlipClock.Lang.pt=FlipClock.Lang.Portuguese,FlipClock.Lang["pt-br"]=FlipClock.Lang.Portuguese,FlipClock.Lang.portuguese=FlipClock.Lang.Portuguese}(jQuery),function(){FlipClock.Lang.Russian={years:"лет",months:"месяцев",days:"дней",hours:"часов",minutes:"минут",seconds:"секунд"},FlipClock.Lang.ru=FlipClock.Lang.Russian,FlipClock.Lang["ru-ru"]=FlipClock.Lang.Russian,FlipClock.Lang.russian=FlipClock.Lang.Russian}(jQuery),function(){FlipClock.Lang.Swedish={years:"År",months:"Månader",days:"Dagar",hours:"Timmar",minutes:"Minuter",seconds:"Sekunder"},FlipClock.Lang.sv=FlipClock.Lang.Swedish,FlipClock.Lang["sv-se"]=FlipClock.Lang.Swedish,FlipClock.Lang.swedish=FlipClock.Lang.Swedish}(jQuery);var O3Global=new function(){};var AjaxCodeConfig=new function(){this.STRUCTURAL_NO_XML=1;this.STRUCTURAL_NO_JSON=1;this.STRUCTURAL_NO_CODE=2;this.EVERYTHING=42;this.OK=0;this.ERROR=10;this.NO_LOGIN=20};var Ozone=new function(){var e=0;this.BASE_LINK="/?module=";this.DEFAULT_MODULE="Layout.Main";this.LOGIN_MODULE="Homepage";function t(){return Math.round((new Date).getTime()/1e3)}function n(n){e=t()-n}function r(){return t()-e}n(1409069052);this.setServerTime=n;this.getServerTime=r};var O3Repository=new function(){var e=-1;var t=new Array;function n(n){t[++e]=n;return e}function r(e,n){var r=t[e];t[e]=n;return r}function a(e){return t[e]}function i(e){return r(e,null)}function o(){t=new Array;e=-1}this.add=n;this.put=r;this.get=a;this.remove=i;this.reset=o};var JSON;if(!JSON){JSON={}}(function(){"use strict";function f(e){return e<10?"0"+e:e}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(e){escapable.lastIndex=0;return escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t==="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,a,i,o=gap,l,f=t[e];if(f&&typeof f==="object"&&typeof f.toJSON==="function"){f=f.toJSON(e)}if(typeof rep==="function"){f=rep.call(t,e,f)}switch(typeof f){case"string":return quote(f);case"number":return isFinite(f)?String(f):"null";case"boolean":case"null":return String(f);case"object":if(!f){return"null"}gap+=indent;l=[];if(Object.prototype.toString.apply(f)==="[object Array]"){i=f.length;for(n=0;n<i;n+=1){l[n]=str(n,f)||"null"}a=l.length===0?"[]":gap?"[\n"+gap+l.join(",\n"+gap)+"\n"+o+"]":"["+l.join(",")+"]";gap=o;return a}if(rep&&typeof rep==="object"){i=rep.length;for(n=0;n<i;n+=1){if(typeof rep[n]==="string"){r=rep[n];a=str(r,f);if(a){l.push(quote(r)+(gap?": ":":")+a)}}}}else{for(r in f){if(Object.prototype.hasOwnProperty.call(f,r)){a=str(r,f);if(a){l.push(quote(r)+(gap?": ":":")+a)}}}}a=l.length===0?"{}":gap?"{\n"+gap+l.join(",\n"+gap)+"\n"+o+"}":"{"+l.join(",")+"}";gap=o;return a}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(e,t,n){var r;gap="";indent="";if(typeof n==="number"){for(r=0;r<n;r+=1){indent+=" "}}else if(typeof n==="string"){indent=n}rep=t;if(t&&typeof t!=="function"&&(typeof t!=="object"||typeof t.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":e})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(e,t){var n,r,a=e[t];if(a&&typeof a==="object"){for(n in a){if(Object.prototype.hasOwnProperty.call(a,n)){r=walk(a,n);if(r!==undefined){a[n]=r}else{delete a[n]}}}}return reviver.call(e,t,a)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}})();var O3AjaxHandler=new function(){var e=Array();var t=Array();var n=null;var r=null;function a(t,n){if(typeof e[t]=="function")e[t](n)}function i(e,n){if(typeof t[e]=="function")t[e](n)}function o(t,n){e[t]=n}function l(e,n){t[e]=n}function f(e){n=e}function s(e){r=e}function u(){if(typeof n=="function")n()}function d(){if(typeof r=="function")r()}this.preHandle=a;this.handle=i;this.setGlobalPreHandler=o;this.setGlobalHandler=l;this.setIncPendingHandler=f;this.setDecPendingHandler=s;this.incrementPending=u;this.decrementPending=d};if(AjaxCodeConfig.STRUCTURAL_NO_XML)O3AjaxHandler.setGlobalHandler(AjaxCodeConfig.STRUCTURAL_NO_XML,function(e){alert("Structural error: no XML")});if(AjaxCodeConfig.STRUCTURAL_NO_CODE)O3AjaxHandler.setGlobalHandler(AjaxCodeConfig.STRUCTURAL_NO_CODE,function(e){alert("Structural error: no Code")});if(AjaxCodeConfig.NO_LOGIN)O3AjaxHandler.setGlobalHandler(AjaxCodeConfig.NO_LOGIN,function(e){top.location=Ozone.BASE_LINK+Ozone.LOGIN_MODULE});if(AjaxCodeConfig.ERROR){var fncHandleError=function(e){var t=e.getElementsByTagName("message")[0].firstChild.data;alert(t)};O3AjaxHandler.setGlobalHandler(AjaxCodeConfig.ERROR,fncHandleError)}var O3JsonHandler=new function(){var e=Array();var t=Array();function n(t,n){if(typeof e[t]=="function")e[t](n)}function r(e,n){if(typeof t[e]=="function")t[e](n)}function a(t,n){e[t]=n}function i(e,n){t[e]=n}this.preHandle=n;this.handle=r;this.setGlobalPreHandler=a;this.setGlobalHandler=i};if(AjaxCodeConfig.STRUCTURAL_NO_JSON)O3JsonHandler.setGlobalHandler(AjaxCodeConfig.STRUCTURAL_NO_JSON,function(e){alert("Structural error: no JSON")});if(AjaxCodeConfig.STRUCTURAL_NO_CODE)O3JsonHandler.setGlobalHandler(AjaxCodeConfig.STRUCTURAL_NO_CODE,function(e){alert("Structural error: no Code")});if(AjaxCodeConfig.NO_LOGIN)O3JsonHandler.setGlobalHandler(AjaxCodeConfig.NO_LOGIN,function(e){top.location=Ozone.BASE_LINK+Ozone.LOGIN_MODULE});if(AjaxCodeConfig.ERROR){var fncHandleError=function(e){var t=e.message;alert(t)};O3JsonHandler.setGlobalHandler(AjaxCodeConfig.ERROR,fncHandleError)}function O3Ajax(){var e=null;var t=null;var n=null;var r=null;var a=null;var i="";var o=Array();function l(){if(window.XMLHttpRequest)e=new XMLHttpRequest;else if(window.ActiveXObject){try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}}else return false;if(e==null)return false;e.onreadystatechange=v;a=new Array;return true}function f(e){for(sKey in e)a[sKey]=e[sKey]}function s(e){i+="&"+e}function u(e,t){a[e]=t}function d(){a=new Array}function c(){var e="";for(var t in a){if(typeof a[t]=="function")continue;if(O3Global.Types.isArray(a[t])){for(var n in a[t]){if(typeof a[t][n]=="function")continue;e+=O3Global.Types.encodeURL(t)+"["+O3Global.Types.encodeURL(n)+"]="+O3Global.Types.encodeURL(a[t][n])+"&"}}else e+=O3Global.Types.encodeURL(t)+"="+O3Global.Types.encodeURL(a[t])+"&"}e+=i;return e}function p(e){r=e}function h(e){n=e}function v(){if(e.readyState==4&&(e.status==200||window.location.href.indexOf("http")==-1)){if(window.O3AjaxHandler)O3AjaxHandler.decrementPending();if(t)t()}}function O(){if(e.responseXML&&e.responseXML.documentElement&&e.responseXML.documentElement.attributes.getNamedItem("code")){g();return}if(r){var t=O3Global.DOM.getById(r);if(t){t.innerHTML=e.responseText;t.disabled=""}}if(n)n(e.responseText)}function g(){var t=e.responseXML;if(t)t=t.documentElement;var n=AjaxCodeConfig.OK;if(!t){n=AjaxCodeConfig.STRUCTURAL_NO_XML;alert(e.responseText)}else{var r=t.attributes.getNamedItem("code");if(!r)n=AjaxCodeConfig.STRUCTURAL_NO_CODE;else{n=r.value;var a=t.attributes.getNamedItem("time");if(a)Ozone.setServerTime(a.value);var i=t.getElementsByTagName("debug");if(i){i=i[0];if(i){var l=i.childNodes;for(var f=0;f<l.length;f++){var s=l[f];if(!s.firstChild)continue;alert("Debug:\n\n"+s.firstChild.data)}}}}}O3AjaxHandler.preHandle(n,t);if(typeof o[n]=="function"){if(!o[n](t))O3AjaxHandler.handle(n,t)}else O3AjaxHandler.handle(n,t)}function y(){var t=null;try{t=JSON.parse(e.responseText)}catch(n){}var r=AjaxCodeConfig.OK;if(!t){r=AjaxCodeConfig.STRUCTURAL_NO_JSON;alert(e.responseText)}else{r=t.code;if(typeof r==="undefined")r=AjaxCodeConfig.STRUCTURAL_NO_CODE;else{if(typeof t.time!=="undefined")Ozone.setServerTime(t.time);if(O3Global.Types.isArray(t.debug)){for(var a=0;a<t.debug.length;a++)alert("Debug:\n\n"+t.debug[a])}}}O3JsonHandler.preHandle(r,t?t.data:null);if(typeof o[r]=="function"){if(!o[r](t?t.data:null))O3JsonHandler.handle(r,t?t.data:null)}else O3JsonHandler.handle(r,t?t.data:null)}function m(){var t=e.responseXML;if(t)t=t.documentElement;if(!t){alert(e.responseText);return}var r=t.attributes.getNamedItem("occurred");var a=false;if(!r||r.value=="error"){alert("Error; could not start message pump. Live updates are disabled!");return}a=r.value=="yes";var i="";if(a){a=false;var o=t.getElementsByTagName("command");if(o&&o[0]&&o[0].firstChild){a=true;i=o[0].firstChild.data}}if(n)n(a,i)}function C(t,n){var r=Ozone.BASE_LINK+t+"&action="+n+"&O3Request="+(new Date).getTime();var a=c();e.open("POST",r,true);e.setRequestHeader("Content-Type","application/x-www-form-urlencoded");e.send(a);O3AjaxHandler.incrementPending()}function b(e,n){t=O;C(e,n)}function A(e,n){t=g;C(e,n)}function T(e,n){t=y;C(e,n)}function N(n){t=m;e.open("POST","http://"+n+"/event",true);e.send(null)}function L(e,t){o[e]=t}if(!l())alert("Could not create O3Ajax. Your browser does not support XMLHttpRequest.");this.addPostData=f;this.addRawPostData=s;this.addPostValue=u;this.clearPostData=d;this.setContainer=p;this.setCallback=h;this.requestPage=b;this.requestXML=A;this.requestJSON=T;this.requestEvent=N;this.setHandler=L}O3Global.DOM=new function(){function e(e){if(document.all){return document.all[e]}else if(document.layers){return document.layers[e]}else if(document.getElementById){var t=document.getElementById(e);if(t==null){if(document.getElementsByName&&document.getElementsByName(e)&&document.getElementsByName(e)[0]){t=document.getElementsByName(e);if(t.length==1)t=t[0]}}if(t==null){for(var n in document.forms){var r=document.forms[n];if(r.elements&&r.elements[e]){t=r.elements[e];break}}}return t}else{return null}}function t(t){var n=e(t);if(!n)return;if(O3Global.Ajax)O3Global.Ajax.clearEntry(t);n.innerHTML=""}function n(t){var n=e(t);if(n&&n.style)n.style.display=""}function r(t){var n=e(t);if(n&&n.style)n.style.display="none"}function a(t){var n=e(t);if(n&&n.parentElement)n.parentElement.removeChild(n)}function i(e){var t=e.offsetLeft;while(e.offsetParent!=null){e=e.offsetParent;t+=e.offsetLeft}return t}function o(e){var t=e.offsetTop;while(e.offsetParent!=null){e=e.offsetParent;t+=e.offsetTop}return t}function l(t,n){var r=e(t);if(!r)return;if(r.filters&&r.filters.alpha)r.filters.alpha.opacity=n*100;else{r.style.KHTMLOpacity=n;r.style.MozOpacity=n;r.style.opacity=n}}function f(t,n,r,a){var i=e(t);if(!i)return false;var o=i.getElementsByTagName("tbody")[0];if(!o){o=document.createElement("tbody");i.appendChild(o)}var l=document.createElement("tr");if(a)l.id=a;for(var f=0;f<n.length;f++){var s=document.createElement("td");s.innerHTML=n[f];l.appendChild(s)}var u=null;if(r)u=e(r);if(u)o.insertBefore(l,u);else o.appendChild(l);return true}function s(t,n){var r=e(t);if(!r)return false;var a=r.getElementsByTagName("tbody")[0];if(!a)return false;var i=e(n);if(!i)return false;a.removeChild(i);return true}function u(e,t){if(e.currentStyle)return e.currentStyle[t];else if(window.getComputedStyle)return document.defaultView.getComputedStyle(e,null).getPropertyValue(t);return null}function d(t,n){var r=e(t);if(!r)return false;var a=new Image;a.src=r.src;r.width=Math.round(a.width*n);r.height=Math.round(a.height*n);return true}function c(e,t){if(!e)return;var n=e.scrollLeft-t;if(n<0)n=0;else if(n>e.scrollWidth)n=e.scrollWidth;e.scrollLeft=n}function p(e,t){if(!e)return;var n=e.scrollTop-t;if(n<0)n=0;if(n>e.scrollHeight)n=e.scrollHeight;e.scrollTop=n}function h(t,n){var r=e(t);if(r)r.className=n}this.getById=e;this.clearDiv=t;this.showDiv=n;this.hideDiv=r;this.removeDiv=a;this.getAbsoluteLeft=i;this.getAbsoluteTop=o;this.insertRow=f;this.removeRow=s;this.getStyle=u;this.zoomImage=d;this.scrollHorizontal=c;this.scrollVertical=p;this.setClass=h;this.setImageOpacity=l};O3Global.Types=new function(){function e(e){var t=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;return t.test(e)}function t(e){if(e&&e.constructor&&e.constructor.toString().indexOf("Array")!=-1)return true;return false}function n(e,n,r){if(!t(e)||!t(n))return false;for(var a in e){if(e[a]!=n[a])return false}if(!r){for(var a in n){if(e[a]!=n[a])return false}}return true}function r(e){if(e==null)return false;e=""+e;var t="-0123456789";var n;for(var r=0;r<e.length;r++){n=e.charAt(r);if(t.indexOf(n)==-1)return false}return true}function a(e){e=""+e;var t="0123456789"+"ABCDEFGHIJKLMNOPQRSTUVWXYZ"+"abcdefghijklmnopqrstuvwxyz"+"-_.!~*'()";var n="0123456789ABCDEF";var r="";for(var a=0;a<e.length;a++){var i=e.charAt(a);if(i==" ")r+="+";else if(t.indexOf(i)!=-1)r+=i;else{var o=i.charCodeAt(0);if(o>255){alert("Unicode Character '"+i+"' cannot be encoded using standard URL encoding.\n"+"(URL encoding only supports 8-bit characters.)\n"+"A space (+) will be substituted.");r+="+"}else{r+="%";r+=n.charAt(o>>4&15);r+=n.charAt(o&15)}}}return r}this.validateEmail=e;this.isArray=t;this.arrayCompare=n;this.isNumeric=r;this.encodeURL=a};O3Global.Ajax=new function(){var aPages=new Array;function loadDiv(e,t,n,r,a,i){if(n=="topbar")Collapse.show(Collapse.TOP);if(n=="menu")Collapse.show(Collapse.LEFT);if(n=="right")Collapse.show(Collapse.RIGHT);if(n=="bottom")Collapse.show(Collapse.BOTTOM);if(!i){var o=aPages[n];if(o){if(o["module"]==e&&o["action"]==t&&(o["postdata"]==r||O3Global.Types.arrayCompare(o["postdata"],r))){if(a)a();return}}}aPages[n]=new Array;aPages[n]["module"]=e;aPages[n]["action"]=t;aPages[n]["postdata"]=r;var l=new O3Ajax;var f=O3Global.DOM.getById(n);if(r){if(O3Global.Types.isArray(r))l.addPostData(r);else l.addRawPostData(r)}if(a)l.setCallback(a);announceLoading(n);l.setContainer(n);l.requestPage(e,t)}function reloadDiv(e,t,n,r,a,i,o){var l=aPages[e];if(!l)return;if(!t)loadDiv(l["module"],l["action"],e,l["postdata"],a,true);else{if(l["module"]==t&&l["action"]==n&&(l["postdata"]==r||O3Global.Types.arrayCompare(r,l["postdata"],i))){if(o&&O3Global.Types.isArray(r)&&O3Global.Types.isArray(o)){for(var f in o)r[f]=o[f]}loadDiv(t,n,e,r,a,true)}}}function loadXML(e,t,n,r,a){var i=new O3Ajax;if(n){if(O3Global.Types.isArray(n))i.addPostData(n);else i.addRawPostData(n)}if(r)i.setHandler(AjaxCodeConfig.OK,r);if(a)i.setHandler(AjaxCodeConfig.ERROR,a);i.requestXML(e,t)}function loadJSON(e,t,n,r,a){var i=new O3Ajax;if(n){if(O3Global.Types.isArray(n))i.addPostData(n);else i.addRawPostData(n)}if(r)i.setHandler(AjaxCodeConfig.OK,r);if(a)i.setHandler(AjaxCodeConfig.ERROR,a);i.requestJSON(e,t)}function deserializeXML(oXML,oObject){var aNodes=oXML.childNodes;if(!aNodes||aNodes.length==0)return;for(var i=0;i<aNodes.length;i++){var oNode=aNodes[i];if(!oNode.firstChild)continue;var sName=oNode.nodeName;if(!sName||sName.length==0)continue;var fncSet=eval("oObject.set"+sName);if(typeof fncSet!="function")continue;fncSet(oNode.firstChild.data)}}function announceLoading(e){var t=O3Global.DOM.getById(e);if(t){var n=O3Global.DOM.getById("workingdata");var r=n?n.innerHTML:"";t.innerHTML=r;t.disabled=true}}function clearEntry(e){if(aPages[e])aPages[e]=null}this.loadDiv=loadDiv;this.reloadDiv=reloadDiv;this.loadXML=loadXML;this.loadJSON=loadJSON;this.deserializeXML=deserializeXML;this.clearEntry=clearEntry};O3Global.Forms=new function(){var e=0;var t=1;var n=2;var r=3;var a=4;var i=5;function o(o){if(!o)return null;var l=new Array;var f=new Array;for(var s in o.elements){var u=o.elements[s];if(u==null)continue;var d=e;if(u.type!=null){if(u.type=="text"||u.type=="textarea"||u.type=="hidden"||u.type=="password")d=t;else if(u.type=="radio")d=i;else if(u.type=="checkbox")d=r;else if(u.type=="select-one"||u.type=="select-multiple")d=a}if(u[0]!=null&&u[0].type=="radio")d=n;if(d==e)continue;if(u.disabled||d==n&&u[0].disabled)continue;if(d==i&&!u.checked)continue;if(u.name)s=u.name;else if(u[0].name)s=u[0].name;if(d==n){if(f[s])continue;else f[s]=true}switch(d){case n:for(var c=0;c<u.length;c++){if(u[c].checked){l[s]=u[c].value;break}}break;case r:if(u.checked)l[s]=u.value;break;default:l[s]=u.value;break}}return l}function l(e,t){if(!e)return;for(var n=0;n<e.elements.length;n++){var r=e.elements[n];if(r==null)continue;if(r.disabled!=null)r.disabled=t}}function f(e){l(e,false)}function s(e){l(e,true)}function u(e){if(e[0]){for(var t=0;t<e.length;t++){if(e[t].checked)return e[t].value}}else return e.value}this.serializeForm=o;this.enableForm=f;this.disableForm=s;this.getRadioValue=u};function ProgBar(sPBId){var sId="";var iMax=-1;var iWidth=100;var iValue=0;var iHeight=15;var sCaption=null;var iMinColor=25600;var iMaxColor=25600;var sBorder="1px solid black";var sDisplay="inline";var bAttach=false;var oBarSub=null;var oBarDiv=null;var oBarColor=null;var oBarWDiv=null;function construct(t){sId=t}function calculateColor(){var t=0;if(iMax!=0)t=1/iMax*iValue;var a=iMinColor&255;var i=(iMinColor&65280)>>8;var r=(iMinColor&16711680)>>16;var o=iMaxColor&255;var e=(iMaxColor&65280)>>8;var l=(iMaxColor&16711680)>>16;var n=Math.round(a+(o-a)*t);var s=Math.round(i+(e-i)*t);var d=Math.round(r+(l-r)*t);var u=d<<16|s<<8|n<<0;var h=u.toString(16);while(h.length<6)h="0"+h;return"#"+h}function create(){if(sId.length==0){alert("You need an ID to create a ProgBar");return}if(iMax<=0){alert("Max has to be > 0 to create a ProgBar");return}var t=0;if(iValue>=iMax)t=iWidth;else{var a=iMax*iValue;var t=0;if(a!=0)t=Math.round(iWidth/a)}var i=calculateColor();if(sCaption==null)sCaption=iValue;var r='<div id="jsprogbar_'+sId+'" style="display: '+sDisplay+';">\n'+'  <table cellpadding="0" cellspacing="0" style="border: '+sBorder+"; margin: 0px; padding: 0px; width: "+iWidth+'px;">\n'+"    <tr>\n"+'      <td style="text-align: left;">\n'+'        <div id="jsprogbar_div_'+sId+'" style="font-size: smaller; height: 15px; overflow: hidden; text-align: center; position: absolute; width: '+iWidth+'px;">'+sCaption+"</div>\n"+'        <table id="jsprogbar_sub_'+sId+'" cellpadding="0" cellspacing="0" style="font-size: smaller; height: '+iHeight+"px; width: "+t+'px;">\n'+"          <tr>\n"+'            <td id="jsprogbar_color_'+sId+'" nowrap style="background-color: '+i+';"><div id="jsprogbar_wdiv_'+sId+'" style="width: '+t+'px; overflow: hidden;">&nbsp;</div></td>\n'+"          </tr>\n"+"        </table>\n"+"      </td>\n"+"    </tr>\n"+"  </table>\n"+"</div>\n";return r}function attach(){if(sId.length==0){alert("You need an ID to attach a ProgBar");return}bAttach=true;var oValues=O3Global.DOM.getById("jsprogbar_values_"+sId);if(!oValues)return false;eval(oValues.innerHTML);bAttach=false;return true}function init(){if(bAttach){if(!attach())return false}oBarSub=O3Global.DOM.getById("jsprogbar_sub_"+sId);oBarDiv=O3Global.DOM.getById("jsprogbar_div_"+sId);oBarColor=O3Global.DOM.getById("jsprogbar_color_"+sId);oBarWDiv=O3Global.DOM.getById("jsprogbar_wdiv_"+sId);return oBarSub&&oBarDiv&&oBarColor&&oBarWDiv}function update(t,a){iValue=t*1;sCaption=a;if(!init())return false;if(iValue<0||iValue>iMax)return false;if(!sCaption)sCaption=iValue;var i=Math.round(iWidth/iMax*iValue);oBarWDiv.style.width=i+"px";oBarSub.style.width=i+"px";oBarDiv.innerHTML=sCaption;oBarColor.style.background=calculateColor();return true}function hide(){sDisplay="none";O3Global.DOM.hideDiv("jsprogbar_"+sId)}function show(){sDisplay="inline";O3Global.DOM.showDiv("jsprogbar_"+sId)}function setMax(t){iMax=t*1}function setWidth(t){iWidth=t*1}function setValue(t){iValue=t*1}function setHeight(t){iHeight=t*1}function setCaption(t){sCaption=t}function setColor(t){iMinColor=t*1;iMaxColor=t*1}function setMinColor(t){iMinColor=t*1}function setMaxColor(t){iMaxColor=t*1}function setBorder(t){sBorder=t}construct(sPBId);this.construct=construct;this.create=create;this.attach=attach;this.update=update;this.hide=hide;this.show=show;this.setMax=setMax;this.setWidth=setWidth;this.setValue=setValue;this.setHeight=setHeight;this.setCaption=setCaption;this.setColor=setColor;this.setMinColor=setMinColor;this.setMaxColor=setMaxColor;this.setBorder=setBorder}
(function(e){var t={initialized:false,element:null,open:false};var o={init:function(){if(t.initialized)return;e("body").append('<div id="omertabox_overlay"></div>');t.initialized=true},popup:function(){if(!t.initialized)o.init();if(t.open)t.element.hide();var i=e("body");t.element=this.first();if(t.element.data("fixed")!="y"){t.element.hide();t.element.css("position","absolute");t.element.css("z-index","1010");i.append(t.element);t.element.data("fixed","y")}var n=Math.round((e(window).width()-t.element.width())/2)+i.scrollLeft();var l=Math.round((e(window).height()-t.element.height())/2)+i.scrollTop();t.element.css("top",l+"px");t.element.css("left",n+"px");if(!t.open){e("#omertabox_overlay").height(e(document).height());e("#omertabox_overlay").fadeTo(0,0,function(){e("#omertabox_overlay").show();e("#omertabox_overlay").fadeTo(300,.65,function(){t.element.show();t.open=true})})}else{t.element.show()}return this},close:function(){t.element.hide();t.open=false;e("#omertabox_overlay").fadeTo(300,0,function(){e("#omertabox_overlay").hide()})}};e.fn.omertabox=function(t){if(o[t])return o[t].apply(this,Array.prototype.slice.call(arguments,1));else if(!t)return o.popup.apply(this,arguments);else e.error("Method "+t+" does not exist on jQuery.omertabox")}})(jQuery);(function(e,t,n){if(typeof module!=="undefined"&&module.exports){module.exports=n()}else if(typeof define==="function"&&define.amd){define(n)}else{t[e]=n()}})("Fingerprint",this,function(){"use strict";var e=function(e){var t,n;t=Array.prototype.forEach;n=Array.prototype.map;this.each=function(e,n,r){if(e===null){return}if(t&&e.forEach===t){e.forEach(n,r)}else if(e.length===+e.length){for(var i=0,a=e.length;i<a;i++){if(n.call(r,e[i],i,e)==={})return}}else{for(var o in e){if(e.hasOwnProperty(o)){if(n.call(r,e[o],o,e)==={})return}}}};this.map=function(e,t,r){var i=[];if(e==null)return i;if(n&&e.map===n)return e.map(t,r);this.each(e,function(e,n,a){i[i.length]=t.call(r,e,n,a)});return i};if(typeof e=="object"){this.hasher=e.hasher;this.screen_resolution=e.screen_resolution;this.canvas=e.canvas;this.ie_activex=e.ie_activex}else if(typeof e=="function"){this.hasher=e}};e.prototype={get:function(){var e=[];e.push(navigator.userAgent);e.push(navigator.language);e.push(screen.colorDepth);if(this.screen_resolution){var t=this.getScreenResolution();if(typeof t!=="undefined"){e.push(this.getScreenResolution().join("x"))}}e.push((new Date).getTimezoneOffset());e.push(this.hasSessionStorage());e.push(this.hasLocalStorage());e.push(!!window.indexedDB);if(document.body){e.push(typeof document.body.addBehavior)}else{e.push(typeof undefined)}e.push(typeof window.openDatabase);e.push(navigator.cpuClass);e.push(navigator.platform);e.push(navigator.doNotTrack);e.push(this.getPluginsString());if(this.canvas&&this.isCanvasSupported()){e.push(this.getCanvasFingerprint())}if(this.hasher){return this.hasher(e.join("###"),31)}else{return this.murmurhash3_32_gc(e.join("###"),31)}},murmurhash3_32_gc:function(e,t){var n,r,i,a,o,s,u,l;n=e.length&3;r=e.length-n;i=t;o=3432918353;s=461845907;l=0;while(l<r){u=e.charCodeAt(l)&255|(e.charCodeAt(++l)&255)<<8|(e.charCodeAt(++l)&255)<<16|(e.charCodeAt(++l)&255)<<24;++l;u=(u&65535)*o+(((u>>>16)*o&65535)<<16)&4294967295;u=u<<15|u>>>17;u=(u&65535)*s+(((u>>>16)*s&65535)<<16)&4294967295;i^=u;i=i<<13|i>>>19;a=(i&65535)*5+(((i>>>16)*5&65535)<<16)&4294967295;i=(a&65535)+27492+(((a>>>16)+58964&65535)<<16)}u=0;switch(n){case 3:u^=(e.charCodeAt(l+2)&255)<<16;case 2:u^=(e.charCodeAt(l+1)&255)<<8;case 1:u^=e.charCodeAt(l)&255;u=(u&65535)*o+(((u>>>16)*o&65535)<<16)&4294967295;u=u<<15|u>>>17;u=(u&65535)*s+(((u>>>16)*s&65535)<<16)&4294967295;i^=u}i^=e.length;i^=i>>>16;i=(i&65535)*2246822507+(((i>>>16)*2246822507&65535)<<16)&4294967295;i^=i>>>13;i=(i&65535)*3266489909+(((i>>>16)*3266489909&65535)<<16)&4294967295;i^=i>>>16;return i>>>0},hasLocalStorage:function(){try{return!!window.localStorage}catch(e){return true}},hasSessionStorage:function(){try{return!!window.sessionStorage}catch(e){return true}},isCanvasSupported:function(){var e=document.createElement("canvas");return!!(e.getContext&&e.getContext("2d"))},isIE:function(){if(navigator.appName==="Microsoft Internet Explorer"){return true}else if(navigator.appName==="Netscape"&&/Trident/.test(navigator.userAgent)){return true}return false},getPluginsString:function(){if(this.isIE()&&this.ie_activex){return this.getIEPluginsString()}else{return this.getRegularPluginsString()}},getRegularPluginsString:function(){return this.map(navigator.plugins,function(e){var t=this.map(e,function(e){return[e.type,e.suffixes].join("~")}).join(",");return[e.name,e.description,t].join("::")},this).join(";")},getIEPluginsString:function(){if(window.ActiveXObject){var e=["ShockwaveFlash.ShockwaveFlash","AcroPDF.PDF","PDF.PdfCtrl","QuickTime.QuickTime","rmocx.RealPlayer G2 Control","rmocx.RealPlayer G2 Control.1","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","RealVideo.RealVideo(tm) ActiveX Control (32-bit)","RealPlayer","SWCtl.SWCtl","WMPlayer.OCX","AgControl.AgControl","Skype.Detection"];return this.map(e,function(e){try{new ActiveXObject(e);return e}catch(t){return null}}).join(";")}else{return""}},getScreenResolution:function(){return[screen.height,screen.width]},getCanvasFingerprint:function(){var e=document.createElement("canvas");var t=e.getContext("2d");var n="http://valve.github.io";t.textBaseline="top";t.font="14px 'Arial'";t.textBaseline="alphabetic";t.fillStyle="#f60";t.fillRect(125,1,62,20);t.fillStyle="#069";t.fillText(n,2,15);t.fillStyle="rgba(102, 204, 0, 0.7)";t.fillText(n,4,17);return e.toDataURL()}};return e});(function(t,e){"object"===typeof exports?e(exports):"function"===typeof define&&define.amd?define(["exports"],e):e(t)})(this,function(t){function e(t){this._targetElement=t;this._options={nextLabel:"Next &rarr;",prevLabel:"&larr; Back",skipLabel:"Skip",doneLabel:"Done",tooltipPosition:"bottom",tooltipClass:"",highlightClass:"",exitOnEsc:!0,exitOnOverlayClick:!0,showStepNumbers:!0,keyboardNavigation:!0,showButtons:!0,showBullets:!0,showProgress:!1,scrollToElement:!0,overlayOpacity:.8,positionPrecedence:["bottom","top","right","left"],disableInteraction:!1}}function n(t){var e=[],n=this;if(this._options.steps)for(var l=[],a=0,l=this._options.steps.length;a<l;a++){var h=o(this._options.steps[a]);h.step=e.length+1;"string"===typeof h.element&&(h.element=document.querySelector(h.element));if("undefined"===typeof h.element||null==h.element){var p=document.querySelector(".introjsFloatingElement");null==p&&(p=document.createElement("div"),p.className="introjsFloatingElement",document.body.appendChild(p));h.element=p;h.position="floating"}null!=h.element&&e.push(h)}else{l=t.querySelectorAll("*[data-intro]");if(1>l.length)return!1;a=0;for(h=l.length;a<h;a++){var p=l[a],u=parseInt(p.getAttribute("data-step"),10);0<u&&(e[u-1]={element:p,intro:p.getAttribute("data-intro"),step:parseInt(p.getAttribute("data-step"),10),tooltipClass:p.getAttribute("data-tooltipClass"),highlightClass:p.getAttribute("data-highlightClass"),position:p.getAttribute("data-position")||this._options.tooltipPosition})}a=u=0;for(h=l.length;a<h;a++)if(p=l[a],null==p.getAttribute("data-step")){for(;"undefined"!=typeof e[u];)u++;e[u]={element:p,intro:p.getAttribute("data-intro"),step:u+1,tooltipClass:p.getAttribute("data-tooltipClass"),highlightClass:p.getAttribute("data-highlightClass"),position:p.getAttribute("data-position")||this._options.tooltipPosition}}}a=[];for(l=0;l<e.length;l++)e[l]&&a.push(e[l]);e=a;e.sort(function(t,e){return t.step-e.step});n._introItems=e;m.call(n,t)&&(i.call(n),t.querySelector(".introjs-skipbutton"),t.querySelector(".introjs-nextbutton"),n._onKeyDown=function(e){if(27===e.keyCode&&!0==n._options.exitOnEsc)s.call(n,t),void 0!=n._introExitCallback&&n._introExitCallback.call(n);else if(37===e.keyCode)r.call(n);else if(39===e.keyCode)i.call(n);else if(13===e.keyCode){var o=e.target||e.srcElement;o&&0<o.className.indexOf("introjs-prevbutton")?r.call(n):o&&0<o.className.indexOf("introjs-skipbutton")?s.call(n,t):i.call(n);e.preventDefault?e.preventDefault():e.returnValue=!1}},n._onResize=function(t){c.call(n,document.querySelector(".introjs-helperLayer"));c.call(n,document.querySelector(".introjs-tooltipReferenceLayer"))},window.addEventListener?(this._options.keyboardNavigation&&window.addEventListener("keydown",n._onKeyDown,!0),window.addEventListener("resize",n._onResize,!0)):document.attachEvent&&(this._options.keyboardNavigation&&document.attachEvent("onkeydown",n._onKeyDown),document.attachEvent("onresize",n._onResize)));return!1}function o(t){if(null==t||"object"!=typeof t||"undefined"!=typeof t.nodeType)return t;var e={},n;for(n in t)e[n]=o(t[n]);return e}function i(){this._direction="forward";"undefined"===typeof this._currentStep?this._currentStep=0:++this._currentStep;if(this._introItems.length<=this._currentStep)"function"===typeof this._introCompleteCallback&&this._introCompleteCallback.call(this),s.call(this,this._targetElement);else{var t=this._introItems[this._currentStep];"undefined"!==typeof this._introBeforeChangeCallback&&this._introBeforeChangeCallback.call(this,t.element);p.call(this,t)}}function r(){this._direction="backward";if(0===this._currentStep)return!1;var t=this._introItems[--this._currentStep];"undefined"!==typeof this._introBeforeChangeCallback&&this._introBeforeChangeCallback.call(this,t.element);p.call(this,t)}function s(t){var e=t.querySelector(".introjs-overlay");if(null!=e){e.style.opacity=0;setTimeout(function(){e.parentNode&&e.parentNode.removeChild(e)},500);var n=t.querySelector(".introjs-helperLayer");n&&n.parentNode.removeChild(n);(n=t.querySelector(".introjs-tooltipReferenceLayer"))&&n.parentNode.removeChild(n);(t=t.querySelector(".introjs-disableInteraction"))&&t.parentNode.removeChild(t);(t=document.querySelector(".introjsFloatingElement"))&&t.parentNode.removeChild(t);if(t=document.querySelector(".introjs-showElement"))t.className=t.className.replace(/introjs-[a-zA-Z]+/g,"").replace(/^\s+|\s+$/g,"");if((t=document.querySelectorAll(".introjs-fixParent"))&&0<t.length)for(n=t.length-1;0<=n;n--)t[n].className=t[n].className.replace(/introjs-fixParent/g,"").replace(/^\s+|\s+$/g,"");window.removeEventListener?window.removeEventListener("keydown",this._onKeyDown,!0):document.detachEvent&&document.detachEvent("onkeydown",this._onKeyDown);this._currentStep=void 0}}function l(t,e,n,o){var i="";e.style.top=null;e.style.right=null;e.style.bottom=null;e.style.left=null;e.style.marginLeft=null;e.style.marginTop=null;n.style.display="inherit";"undefined"!=typeof o&&null!=o&&(o.style.top=null,o.style.left=null);if(this._introItems[this._currentStep]){i=this._introItems[this._currentStep];i="string"===typeof i.tooltipClass?i.tooltipClass:this._options.tooltipClass;e.className=("introjs-tooltip "+i).replace(/^\s+|\s+$/g,"");currentTooltipPosition=this._introItems[this._currentStep].position;if(("auto"==currentTooltipPosition||"auto"==this._options.tooltipPosition)&&"floating"!=currentTooltipPosition){var i=currentTooltipPosition,r=this._options.positionPrecedence.slice(),s=d(),l=y(e).height+10,c=y(e).width+20,h=y(t),p="floating";h.left+c>s.width||0>h.left+h.width/2-c?(a(r,"bottom"),a(r,"top")):(h.height+h.top+l>s.height&&a(r,"bottom"),0>h.top-l&&a(r,"top"));h.width+h.left+c>s.width&&a(r,"right");0>h.left-c&&a(r,"left");0<r.length&&(p=r[0]);i&&"auto"!=i&&-1<r.indexOf(i)&&(p=i);currentTooltipPosition=p}i=y(t);r=y(e).height;s=d();switch(currentTooltipPosition){case"top":e.style.left="15px";e.style.top="-"+(r+10)+"px";n.className="introjs-arrow bottom";break;case"right":e.style.left=y(t).width+20+"px";i.top+r>s.height&&(n.className="introjs-arrow left-bottom",e.style.top="-"+(r-i.height-20)+"px");n.className="introjs-arrow left";break;case"left":!0==this._options.showStepNumbers&&(e.style.top="15px");i.top+r>s.height?(e.style.top="-"+(r-i.height-20)+"px",n.className="introjs-arrow right-bottom"):n.className="introjs-arrow right";e.style.right=i.width+20+"px";break;case"floating":n.style.display="none";t=y(e);e.style.left="50%";e.style.top="50%";e.style.marginLeft="-"+t.width/2+"px";e.style.marginTop="-"+t.height/2+"px";"undefined"!=typeof o&&null!=o&&(o.style.left="-"+(t.width/2+18)+"px",o.style.top="-"+(t.height/2+18)+"px");break;case"bottom-right-aligned":n.className="introjs-arrow top-right";e.style.right="0px";e.style.bottom="-"+(y(e).height+10)+"px";break;case"bottom-middle-aligned":o=y(t);t=y(e);n.className="introjs-arrow top-middle";e.style.left=o.width/2-t.width/2+"px";e.style.bottom="-"+(t.height+10)+"px";break;default:e.style.bottom="-"+(y(e).height+10)+"px",e.style.left=y(t).width/2-y(e).width/2+"px",n.className="introjs-arrow top"}}}function a(t,e){-1<t.indexOf(e)&&t.splice(t.indexOf(e),1)}function c(t){if(t&&this._introItems[this._currentStep]){var e=this._introItems[this._currentStep],n=y(e.element),o=10;"floating"==e.position&&(o=0);t.setAttribute("style","width: "+(n.width+o)+"px; height:"+(n.height+o)+"px; top:"+(n.top-5)+"px;left: "+(n.left-5)+"px;")}}function h(){var t=document.querySelector(".introjs-disableInteraction");null===t&&(t=document.createElement("div"),t.className="introjs-disableInteraction",this._targetElement.appendChild(t));c.call(this,t)}function p(t){"undefined"!==typeof this._introChangeCallback&&this._introChangeCallback.call(this,t.element);var e=this,n=document.querySelector(".introjs-helperLayer"),o=document.querySelector(".introjs-tooltipReferenceLayer"),a="introjs-helperLayer";y(t.element);"string"===typeof t.highlightClass&&(a+=" "+t.highlightClass);"string"===typeof this._options.highlightClass&&(a+=" "+this._options.highlightClass);if(null!=n){var p=o.querySelector(".introjs-helperNumberLayer"),m=o.querySelector(".introjs-tooltiptext"),b=o.querySelector(".introjs-arrow"),_=o.querySelector(".introjs-tooltip"),w=o.querySelector(".introjs-skipbutton"),v=o.querySelector(".introjs-prevbutton"),C=o.querySelector(".introjs-nextbutton");n.className=a;_.style.opacity=0;_.style.display="none";if(null!=p){var j=this._introItems[0<=t.step-2?t.step-2:0];if(null!=j&&"forward"==this._direction&&"floating"==j.position||"backward"==this._direction&&"floating"==t.position)p.style.opacity=0}c.call(e,n);c.call(e,o);if((j=document.querySelectorAll(".introjs-fixParent"))&&0<j.length)for(a=j.length-1;0<=a;a--)j[a].className=j[a].className.replace(/introjs-fixParent/g,"").replace(/^\s+|\s+$/g,"");j=document.querySelector(".introjs-showElement");j.className=j.className.replace(/introjs-[a-zA-Z]+/g,"").replace(/^\s+|\s+$/g,"");e._lastShowElementTimer&&clearTimeout(e._lastShowElementTimer);e._lastShowElementTimer=setTimeout(function(){null!=p&&(p.innerHTML=t.step);m.innerHTML=t.intro;_.style.display="block";l.call(e,t.element,_,b,p);o.querySelector(".introjs-bullets li > a.active").className="";o.querySelector('.introjs-bullets li > a[data-stepnumber="'+t.step+'"]').className="active";o.querySelector(".introjs-progress .introjs-progressbar").setAttribute("style","width:"+g.call(e)+"%;");_.style.opacity=1;p&&(p.style.opacity=1);-1===C.tabIndex?w.focus():C.focus()},350)}else{var x=document.createElement("div"),v=document.createElement("div"),n=document.createElement("div"),N=document.createElement("div"),S=document.createElement("div"),k=document.createElement("div"),E=document.createElement("div"),L=document.createElement("div");x.className=a;v.className="introjs-tooltipReferenceLayer";c.call(e,x);c.call(e,v);this._targetElement.appendChild(x);this._targetElement.appendChild(v);n.className="introjs-arrow";S.className="introjs-tooltiptext";S.innerHTML=t.intro;k.className="introjs-bullets";!1===this._options.showBullets&&(k.style.display="none");for(var x=document.createElement("ul"),a=0,I=this._introItems.length;a<I;a++){var T=document.createElement("li"),q=document.createElement("a");q.onclick=function(){e.goToStep(this.getAttribute("data-stepnumber"))};a===t.step-1&&(q.className="active");q.href="javascript:void(0);";q.innerHTML="&nbsp;";q.setAttribute("data-stepnumber",this._introItems[a].step);T.appendChild(q);x.appendChild(T)}k.appendChild(x);E.className="introjs-progress";!1===this._options.showProgress&&(E.style.display="none");a=document.createElement("div");a.className="introjs-progressbar";a.setAttribute("style","width:"+g.call(this)+"%;");E.appendChild(a);L.className="introjs-tooltipbuttons";!1===this._options.showButtons&&(L.style.display="none");N.className="introjs-tooltip";N.appendChild(S);N.appendChild(k);N.appendChild(E);!0==this._options.showStepNumbers&&(j=document.createElement("span"),j.className="introjs-helperNumberLayer",j.innerHTML=t.step,v.appendChild(j));N.appendChild(n);v.appendChild(N);C=document.createElement("a");C.onclick=function(){e._introItems.length-1!=e._currentStep&&i.call(e)};C.href="javascript:void(0);";C.innerHTML=this._options.nextLabel;v=document.createElement("a");v.onclick=function(){0!=e._currentStep&&r.call(e)};v.href="javascript:void(0);";v.innerHTML=this._options.prevLabel;w=document.createElement("a");w.className="introjs-button introjs-skipbutton";w.href="javascript:void(0);";w.innerHTML=this._options.skipLabel;w.onclick=function(){e._introItems.length-1==e._currentStep&&"function"===typeof e._introCompleteCallback&&e._introCompleteCallback.call(e);e._introItems.length-1!=e._currentStep&&"function"===typeof e._introExitCallback&&e._introExitCallback.call(e);s.call(e,e._targetElement)};L.appendChild(w);1<this._introItems.length&&(L.appendChild(v),L.appendChild(C));N.appendChild(L);l.call(e,t.element,N,n,j)}!0===this._options.disableInteraction&&h.call(e);v.removeAttribute("tabIndex");C.removeAttribute("tabIndex");0==this._currentStep&&1<this._introItems.length?(v.className="introjs-button introjs-prevbutton introjs-disabled",v.tabIndex="-1",C.className="introjs-button introjs-nextbutton",w.innerHTML=this._options.skipLabel):this._introItems.length-1==this._currentStep||1==this._introItems.length?(w.innerHTML=this._options.doneLabel,v.className="introjs-button introjs-prevbutton",C.className="introjs-button introjs-nextbutton introjs-disabled",C.tabIndex="-1"):(v.className="introjs-button introjs-prevbutton",C.className="introjs-button introjs-nextbutton",w.innerHTML=this._options.skipLabel);C.focus();t.element.className+=" introjs-showElement";j=u(t.element,"position");"absolute"!==j&&"relative"!==j&&(t.element.className+=" introjs-relativePosition");for(j=t.element.parentNode;null!=j&&"body"!==j.tagName.toLowerCase();){n=u(j,"z-index");N=parseFloat(u(j,"opacity"));L=u(j,"transform")||u(j,"-webkit-transform")||u(j,"-moz-transform")||u(j,"-ms-transform")||u(j,"-o-transform");if(/[0-9]+/.test(n)||1>N||"none"!==L)j.className+=" introjs-fixParent";j=j.parentNode}f(t.element)||!0!==this._options.scrollToElement||(N=t.element.getBoundingClientRect(),j=d().height,n=N.bottom-(N.bottom-N.top),N=N.bottom-j,0>n||t.element.clientHeight>j?window.scrollBy(0,n-30):window.scrollBy(0,N+100));"undefined"!==typeof this._introAfterChangeCallback&&this._introAfterChangeCallback.call(this,t.element)}function u(t,e){var n="";t.currentStyle?n=t.currentStyle[e]:document.defaultView&&document.defaultView.getComputedStyle&&(n=document.defaultView.getComputedStyle(t,null).getPropertyValue(e));return n&&n.toLowerCase?n.toLowerCase():n}function d(){if(void 0!=window.innerWidth)return{width:window.innerWidth,height:window.innerHeight};var t=document.documentElement;return{width:t.clientWidth,height:t.clientHeight}}function f(t){t=t.getBoundingClientRect();return 0<=t.top&&0<=t.left&&t.bottom+80<=window.innerHeight&&t.right<=window.innerWidth}function m(t){var e=document.createElement("div"),n="",o=this;e.className="introjs-overlay";if("body"===t.tagName.toLowerCase())n+="top: 0;bottom: 0; left: 0;right: 0;position: fixed;",e.setAttribute("style",n);else{var i=y(t);i&&(n+="width: "+i.width+"px; height:"+i.height+"px; top:"+i.top+"px;left: "+i.left+"px;",e.setAttribute("style",n))}t.appendChild(e);e.onclick=function(){!0==o._options.exitOnOverlayClick&&(s.call(o,t),void 0!=o._introExitCallback&&o._introExitCallback.call(o))};setTimeout(function(){n+="opacity: "+o._options.overlayOpacity.toString()+";";e.setAttribute("style",n)},10);return!0}function y(t){var e={};e.width=t.offsetWidth;e.height=t.offsetHeight;for(var n=0,o=0;t&&!isNaN(t.offsetLeft)&&!isNaN(t.offsetTop);)n+=t.offsetLeft,o+=t.offsetTop,t=t.offsetParent;e.top=o;e.left=n;return e}function g(){return 100*(parseInt(this._currentStep+1,10)/this._introItems.length)}var b=function(t){if("object"===typeof t)return new e(t);if("string"===typeof t){if(t=document.querySelector(t))return new e(t);throw Error("There is no element with given selector.")}return new e(document.body)};b.version="1.0.0";b.fn=e.prototype={clone:function(){return new e(this)},setOption:function(t,e){this._options[t]=e;return this},setOptions:function(t){var e=this._options,n={},o;for(o in e)n[o]=e[o];for(o in t)n[o]=t[o];this._options=n;return this},start:function(){n.call(this,this._targetElement);return this},goToStep:function(t){this._currentStep=t-2;"undefined"!==typeof this._introItems&&i.call(this);return this},nextStep:function(){i.call(this);return this},previousStep:function(){r.call(this);return this},exit:function(){s.call(this,this._targetElement);return this},refresh:function(){c.call(this,document.querySelector(".introjs-helperLayer"));c.call(this,document.querySelector(".introjs-tooltipReferenceLayer"));return this},onbeforechange:function(t){if("function"===typeof t)this._introBeforeChangeCallback=t;else throw Error("Provided callback for onbeforechange was not a function");return this},onchange:function(t){if("function"===typeof t)this._introChangeCallback=t;else throw Error("Provided callback for onchange was not a function.");return this},onafterchange:function(t){if("function"===typeof t)this._introAfterChangeCallback=t;else throw Error("Provided callback for onafterchange was not a function");return this},oncomplete:function(t){if("function"===typeof t)this._introCompleteCallback=t;else throw Error("Provided callback for oncomplete was not a function.");return this},onexit:function(t){if("function"===typeof t)this._introExitCallback=t;else throw Error("Provided callback for onexit was not a function.");return this}};return t.introJs=b});var omerta={timers:{},framework:{},core:{},model:{},services:{},modules:{},widgets:{},UI:{},popup:{},server:{clock:0},plugins:{},GUI:{},users:ko.observableArray(),roundVersion:ko.observable()};omerta.server={time:0,url:window.location.host,query:function(e,r,o,t,a){$.ajax({url:"/"+r,data:o,type:e,success:function(e){omerta.server.getCB(e,t,a)},error:a?a:omerta.server.error,dataType:"JSON"})},getCB:function(e,r,o){if(e.OK==undefined)r(e);else if(e.OK)r(e);else if(o)o(e,"ecallback defined");else omerta.server.error(e,"ecallback not defined")},error:function(e,r){console.error("Server request failed:",r,e)}};omerta.debug=function(e,r,a){var o={page:e,request:r,error:a};$.post("/ajax_debug.php",o)};if(typeof String.prototype.parseUsername==="undefined"){String.prototype.parseUsername=function(e){return this.replace(/[@]+[A-Za-z0-9-_]+/g,function(r){var t=r.replace("@","");return r.blankLink(e+t)})}}if(typeof String.prototype.parseHashtag==="undefined"){String.prototype.parseHashtag=function(e){return this.replace(/[#]+[A-Za-z0-9-_]+/g,function(r){var t=r.replace("#","");return r.blankLink(e+t)})}}if(typeof Number.prototype.format==="undefined"){Number.prototype.format=function(e,r){var t="\\d(?=(\\d{"+(r||3)+"})+"+(e>0?"\\.":"$")+")";return this.toFixed(Math.max(0,~~e)).replace(new RegExp(t,"g"),"$&,")}}
omerta.framework.GUI={name:"frameworksuper",link:"./main.php",module:"GamePanel.Main",action:null,load:function(a){$.get(a?a:this.link,$.proxy(this.load_cb,this))},load_cb:function(a){$("#game_"+this.name).html(a);omerta.GUI.loader.loaded(this.name)}};omerta.core.Module={id:"",bind:"",element:null,module:"",action:"",template:null,data:{},model:{},loading:ko.observable(false),init:function(e){this.template=$(e.template);this.data=e.data||{};this.module=e.request.module||"";this.action=e.request.action||"";this.loading(true);return this},show:function(){if(!this.module)return;if(!this.template.length)return;this.bind="modules."+this.module;this.id="module_"+this.module;var e=this.template.html();if(typeof this.prepareData==="function"){try{this.prepareData()}catch(t){e="<div class='popup-error'>Some error happened.</div>"}}$("#game_container").html($("<div></div>").attr({id:this.id,"data-bind":"with: "+this.bind}).html(e));this.element=$("#"+this.id);ko.applyBindings(omerta,this.element[0]);this.loading(false);$("#game_loading").fadeOut("fast");omerta.GUI.container.processHash=true;omerta.GUI.loader.loaded("container");$("#game_container_wrapper").perfectScrollbar("update");setTimeout(function(){var e=$("#game_container").outerHeight(true);var t=$("#game_wrapper").outerHeight(true);if(e>t)$("#game_wrapper_container").css({height:"99%"});else $("#game_wrapper_container").css({height:e+5+"px"})},100)},showAnim:function(){this.element.find(".core-popup-wrapper").animate({left:$("#animate").parent().width()/2-$("#animate").width()/2,top:$("#animate").parent().height()/2-$("#animate").height()/2,width:"75%",height:"75%",borderRadius:"5px"},750)},hide:function(){this.destroy()},destroy:function(){this.element.remove()}};omerta.core.Popup={id:"",bind:"",element:null,loading:ko.observable(false),show:function(){if(!this.template)return;var t=$("#"+this.template);if(!t.length)return;this.id="p_"+this.template;var e=t.html();$("body").append($("<div></div>").attr({id:this.id,"data-bind":"with: "+this.bind}).addClass("modal fade").html(e));this.element=$("#"+this.id);ko.applyBindings(omerta,this.element[0])},hide:function(){this.destroy()},destroy:function(){this.element.remove()}};omerta.framework.service={name:"servicesuper",service:"",interval:30,timer:null,data:{},load:function(){this.run()},run:function(){$.getJSON("/?module=Services."+this.service,$.proxy(this.run_cb,this))},rerun:function(){this.timer=setTimeout($.proxy(this.run,this),this.interval*1e3)},run_cb:function(t){try{this.data=t.data}catch(e){this.data=t}this.rerun()}};omerta.widgets=omerta.widgets||{};omerta.core.Widget={load:function(){},init:function(){}};omerta.GUI.game_bar={name:"header",load:function(){omerta.GUI.game_bar.cooldowns.load();setInterval(omerta.GUI.game_bar.cooldowns.tick,1e3);omerta.GUI.game_bar.clock();setInterval(omerta.GUI.game_bar.clock,1e3)},clock:function(){if(!omerta.server.clock)return;var t=omerta.server.clock.getUTCHours();var a=omerta.server.clock.getUTCMinutes();var o=omerta.server.clock.getUTCSeconds();omerta.server.clock.setSeconds(o+1);if(t<10)t="0"+t;if(a<10)a="0"+a;if(o<10)o="0"+o;$("#omerta_clock").text(t+":"+a+":"+o)},cooldowns:{load:function(){$("input[data-knob-timeleft]").knob({draw:omerta.GUI.helper.knobDraw,min:0,max:100});$('#game_bar .cooldown[id!="mobileMenu"]').tipsy({gravity:$.fn.tipsy.autoNS,html:true,title:function(){return"<b>"+$(this).attr("data-title")+"</b><br>"+($(this).attr("data-timeleft")<=0?$(this).attr("data-iready"):$(this).attr("data-icd"))}})},tick:function(){$("input[data-knob-timeleft]").each(function(){var t=parseInt($(this).attr("data-knob-timeleft")),a=parseInt($(this).attr("data-knob-timetotal")),o=$(this).closest("*[data-cooldown]").attr("data-cooldown");if(!t||!a||t<0)e=99;else{if(t==1){$('div.cooldown[data-cooldown="'+o+'"]').fadeTo("slow",1);$('div.cooldown[data-cooldown="'+o+'"]').addClass("fa-spin");setTimeout("$('div.cooldown[data-cooldown="+o+"]').removeClass('fa-spin')",2e3)}var e=parseInt((a-t)*100/a);if(e>=99){e=99}if(t>1){$('div.cooldown[data-cooldown="'+o+'"]').fadeTo("slow",.35)}$(this).attr("data-knob-timeleft",parseInt(t-1))}$(this).val(e).trigger("change")})}}};omerta.GUI.container=$.extend({},omerta.framework.GUI,{name:"container",module:"Home",action:null,processHash:false,current:"",title:ko.observable(""),subtitle:ko.observable(""),load:function(e){this.loadPage(e);omerta.GUI.scroll.build($("#game_container_wrapper"),{suppressScrollX:true});if(typeof $.fn.knob==="function"){$("#widget_avatar #knob").knob()}else{$("#widget_avatar").remove()}},loadPage:function(e){this.current=e;$("#game_loading").fadeIn("fast");var a=$.ajax({type:"GET",url:e,success:function(a,t,r){var o=false;try{o=$.parseJSON(a)}catch(n){}var i=false;if(typeof o==="object"&&typeof o.request!=="undefined"&&typeof o.template!=="undefined"){if(typeof omerta.modules[o.request.module]!=="undefined"){omerta.modules[o.request.module].init(o).show()}else{i=o.data.title||o.request.module;omerta.GUI.container.title(i);omerta.GUI.container.loadPageCB(o.template)}delete o}else{$.proxy(omerta.GUI.container.loadPageCB(a,t,r),this)}if(i===false){$("#game_menu .sublink").each(function(a,t){var r=$(t);if(r.attr("href").indexOf(e)!==-1){omerta.GUI.container.title(r.text());return false}})}},error:function(e){omerta.debug(omerta.GUI.container.current,"","GET error: "+thrownError);omerta.GUI.container.loadPageErr();omerta.GUI.loader.loaded("container")}});omerta.GUI.container.processHash=false;location.hash=e;return a},loadPageErr:function(){$("#game_loading").fadeIn("fast");$("#game_loading").html("<span style='color: red;'>There was an error while loading this page. A report was sent to our devs.</span>")},loadPageCB:function(e,a,t){$("#game_loading").fadeOut("fast");omerta.GUI.container.processHash=true;if(e.indexOf("<html")!=-1){omerta.GUI.container.loadPageErr();omerta.debug(this.current,"","html tag")}else{try{$("#game_container").html(e);$("#game_container_wrapper").perfectScrollbar("update");setTimeout(function(){var e=$("#game_container").outerHeight(true);var a=$("#game_wrapper").outerHeight(true);if(e>a)$("#game_wrapper_container").css({height:"99%"});else $("#game_wrapper_container").css({height:e+5+"px"})},100);$("#game_container td[align]").each(function(){$(this).css("text-align",$(this).prop("align"))});$("#game_container table").each(function(){if($(this).width()>$(window).width())$(this).attr("width","70%")});if($("#ver").length>0)$("#ver").focus()}catch(r){omerta.GUI.container.loadPageErr();omerta.debug(this.current,"","js error: "+r.message)}}omerta.GUI.loader.loaded("container");if(typeof _gaq!="undefined"){_gaq.push(["_trackPageview",this.current])}}});omerta.GUI.menu=$.extend({},omerta.framework.GUI,{name:"menu",module:"GamePanel.Menu",action:null,items:ko.observableArray([]),load_cb:function(e){try{var a=$.parseJSON(e)}catch(n){return false}omerta.GUI.menu.items(a[this.name]);omerta.GUI.loader.loaded(this.name)},afterRenderMenu:function(e,a){$("#game_menu a").tipsy({gravity:"w"});omerta.GUI.scroll.build($("#game_menu"),{suppressScrollX:true});var n=$("#game_menu [data-collapsed]");if(n.length>0){n.parent().next().hide()}},toggleMenuItem:function(e,a){var n=$("#game_menu");var t=$("."+e.item_class);var l=t.find("a");var r=t.closest("ul");var i=t.next("ul");if(i.length>0){n.find("ul > ul > ul").not(r).slideUp();i.stop().slideToggle();if(l.hasClass("link")){return}}n.find("ul > li > a").removeClass("active");l.not(".link").addClass("active");n.find("> ul > li").each(function(){var e=$(this);var a=e.next("ul").find("li > a.active");var n=e.find("a");if(a.length>0){n.addClass("active")}else{n.removeClass("active")}});return true}});omerta.GUI.helper={resize:function(){},refresh:function(o){if(o)$.prompt("The game has been updated, you need to refresh to play with new changes",{title:"Omerta update",buttons:{"Click here to refresh":1},submit:function(o,t,e,r){window.location.reload(true);event.preventDefault();return false}})},knobDraw:function(){var o=this.angle(this.cv),t=this.startAngle,e=this.startAngle,r,s=e+o,l=1;this.g.lineWidth=this.lineWidth;if(this.$.attr("shaded")){function a(o){o=o.toString(16);if(o.length<2){o="0"+o}return o}var i=l?this.o.fgColor:this.fgColor;var n=this.$.attr("shadeColor")?this.$.attr("shadeColor"):"#ffffff";var c=omerta.GUI.helper.getGradient(n,i);var h=parseInt(t*180/Math.PI%360);var f=parseInt(s*180/Math.PI%360);for(var p=h;p%360!=f;p++){e=p*(Math.PI/180);s=(p+2)*(Math.PI/180);if(c.color2[0]!=c.color1[0]&&(p+1)%c.steps[0]==0){c.color1[0]+=c.adder[0]}if(c.color2[1]!=c.color1[1]&&(p+1)%c.steps[1]==0){c.color1[1]+=c.adder[1]}if(c.color2[2]!=c.color1[2]&&(p+1)%c.steps[2]==0){c.color1[2]+=c.adder[2]}color="#"+a(c.color1[0])+a(c.color1[1])+a(c.color1[2]);this.g.beginPath();this.g.strokeStyle=color;this.g.arc(this.xy,this.xy,this.radius,e,s,false);this.g.stroke()}}else{this.g.beginPath();this.g.strokeStyle=l?this.o.fgColor:this.fgColor;this.g.arc(this.xy,this.xy,this.radius,e,s,false);this.g.stroke()}return false},getGradient:function(o,t){var e=new Object;e.color1=new Array;e.color2=new Array;e.steps=new Array;e.adder=new Array;o=o.replace("#","");e.color1[0]=parseInt(o.slice(0,2),16),e.color1[1]=parseInt(o.slice(2,4),16),e.color1[2]=parseInt(o.slice(4,6),16);t=t.replace("#","");e.color2[0]=parseInt(t.slice(0,2),16),e.color2[1]=parseInt(t.slice(2,4),16),e.color2[2]=parseInt(t.slice(4,6),16);e.steps[0]=e.color1[0]==e.color2[0]?0:parseInt(360/Math.abs(e.color1[0]-e.color2[0])),e.steps[1]=e.color1[1]==e.color2[1]?0:parseInt(360/Math.abs(e.color1[1]-e.color2[1])),e.steps[2]=e.color1[2]==e.color2[2]?0:parseInt(360/Math.abs(e.color1[2]-e.color2[2])),e.adder[0]=e.color1[0]>e.color2[0]?-1:1;e.adder[1]=e.color1[1]>e.color2[1]?-1:1;e.adder[2]=e.color1[2]>e.color2[2]?-1:1;return e},loading:{},logout:function(o){var t=$.prompt.getCurrentState();if(t.length>0){$.prompt.close()}setTimeout(function(){$.prompt("You've been logged out, since you've been inactive",{title:"Omerta logged you out",buttons:{"Go to the Homepage":1},submit:function(o,t,e,r){window.location.href="/logout.php";event.preventDefault();return false}})},500)}};omerta.GUI.loader={GUI:["menu","container"],GUI_loaded:[],GUI_setup:false,fp_id:0,dialog_loading_info:function(o){$("#dialog_loading_info").text(o)},ready:function(){},load:function(o){omerta.GUI.loader.dialog_loading_info("preparing framework");var e=window.location.hash;var a=e.replace("//","");if(a.length>4)a=a.substr(1);else a=o[2];omerta.GUI.omerta_bar.load();omerta.GUI.game_bar.load();omerta.GUI.menu.load(o[1]);omerta.GUI.container.load(a);for(i in omerta.services)omerta.services[i].load();for(i in omerta.modules)omerta.modules[i].load()},loaded:function(o){if($.inArray(o,omerta.GUI.loader.GUI)>-1){omerta.GUI.loader.GUI_loaded.push(o);omerta.GUI.loader.check()}},done:function(){if(!this.GUI_setup){this.GUI_setup=true;setTimeout(function(){$("#splash_loading").remove();$(document).trigger("omerta:loaded")},2e3)}},check:function(){var o=[];for(i in omerta.GUI.loader.GUI)if($.inArray(omerta.GUI.loader.GUI[i],omerta.GUI.loader.GUI_loaded)==-1)o.push(omerta.GUI.loader.GUI[i]);if(o.length==0)omerta.GUI.loader.done();else{var e=o.join(",");omerta.GUI.loader.dialog_loading_info("loading "+e)}}};omerta.GUI.omerta_bar={name:"header",load:function(){}};omerta.GUI.scroll={build:function(r,e){if(!(r instanceof jQuery)){return false}if(typeof e!=="object"){e={}}if(typeof Modernizr!=="object"){return omerta.GUI.scroll.buildForWeb(r,e)}if(Modernizr.touch){return omerta.GUI.scroll.buildForMobile(r,e)}return omerta.GUI.scroll.buildForWeb(r,e)},buildForWeb:function(r,e){return r.perfectScrollbar(e)},buildForMobile:function(r,e){return true}};function colorGetContrast50(r){return parseInt(r,16)>16777215/2?"black":"white"}function colorGetContrastYIQ(r){var t=parseInt(r.substr(0,2),16);var e=parseInt(r.substr(2,2),16);var s=parseInt(r.substr(4,2),16);var a=(t*299+e*587+s*114)/1e3;return a>=128?"black":"white"}function colorSupportsRGBA(){if(!("result"in arguments.callee)){var r=document.getElementsByTagName("script")[0];var t=r.style.color;var e="rgba(0, 0, 0, 0.5)";if(t==e){arguments.callee.result=true}else{try{r.style.color=e}catch(s){}arguments.callee.result=r.style.color!=t;r.style.color=t}}return arguments.callee.result}function colorSetHexaOpactiy(r,t){if(typeof t==="undefined"){t=1}var e=parseInt(r.substr(0,2),16);var s=parseInt(r.substr(2,2),16);var a=parseInt(r.substr(4,2),16);if(colorSupportsRGBA()){return"rgba("+e+", "+s+", "+a+", "+t+")"}return"rgb("+e+", "+s+", "+a+")"}
function number_format(e){e+="";x=e.split(".");x1=x[0];x2=x.length>1?"."+x[1]:"";var t=/(\d+)(\d{3})/;while(t.test(x1)){x1=x1.replace(t,"$1"+","+"$2")}return x1+x2}
omerta.plugins.popups={generateForm:function(t,o,a,e){var r={};r.title=a.title;r.buttons=a.buttons;if(a.pos)r.position=a.pos;if(a.focus)r.focus=a.focus;r.focus=1;if(a.html)r.html=a.html;r.submit=function(r,s,c,n){if(s==1){$("#jqistate_form .jqibuttons").html("<img style='margin-right: 15px;' src='/assets/omerta/main/layout/assets/img/icons/loading_bar.gif' />");var l={};if(e)l=e;for(i in n)l[i]=n[i];$.ajax({data:l,type:"POST",url:"/BeO/webroot/?module="+t+"&action="+o,timeout:2e4,dataType:"json",success:function(t,o){if(o=="success"){try{var e=t;if(t.data)e=t.data;if(a.callback)a.callback(e);else{try{$.prompt.goToState("formSuccess")}catch(r){$.prompt.close()}}}catch(r){$.prompt.close();omerta.GUI.container.loadPageErr()}}},error:function(t,o,a){$.prompt.close();omerta.GUI.container.loadPageErr()}});r.preventDefault();return false}};return r}};window.matchMedia=window.matchMedia||function(e){"use strict";var t,n=e.documentElement,a=n.firstElementChild||n.firstChild,s=e.createElement("body"),i=e.createElement("div");return i.id="mq-test-1",i.style.cssText="position:absolute;top:-100em",s.style.background="none",s.appendChild(i),function(e){return i.innerHTML='&shy;<style media="'+e+'"> #mq-test-1 { width: 42px; }</style>',n.insertBefore(s,a),t=42===i.offsetWidth,n.removeChild(s),{matches:t,media:e}}}(document);(function(e){"use strict";function t(){w(!0)}var n={};if(e.respond=n,n.update=function(){},n.mediaQueriesSupported=e.matchMedia&&e.matchMedia("only all").matches,!n.mediaQueriesSupported){var a,s,i,r=e.document,o=r.documentElement,l=[],d=[],m=[],h={},u=30,c=r.getElementsByTagName("head")[0]||o,p=r.getElementsByTagName("base")[0],f=c.getElementsByTagName("link"),y=[],v=function(){for(var t=0;f.length>t;t++){var n=f[t],a=n.href,s=n.media,i=n.rel&&"stylesheet"===n.rel.toLowerCase();a&&i&&!h[a]&&(n.styleSheet&&n.styleSheet.rawCssText?(x(n.styleSheet.rawCssText,a,s),h[a]=!0):(!/^([a-zA-Z:]*\/\/)/.test(a)&&!p||a.replace(RegExp.$1,"").split("/")[0]===e.location.host)&&y.push({href:a,media:s}))}g()},g=function(){if(y.length){var t=y.shift();T(t.href,function(n){x(n,t.href,t.media),h[t.href]=!0,e.setTimeout(function(){g()},0)})}},x=function(e,t,n){var a=e.match(/@media[^\{]+\{([^\{\}]*\{[^\}\{]*\})+/gi),s=a&&a.length||0;t=t.substring(0,t.lastIndexOf("/"));var i=function(e){return e.replace(/(url\()['"]?([^\/\)'"][^:\)'"]+)['"]?(\))/g,"$1"+t+"$2$3")},r=!s&&n;t.length&&(t+="/"),r&&(s=1);for(var o=0;s>o;o++){var m,h,u,c;r?(m=n,d.push(i(e))):(m=a[o].match(/@media *([^\{]+)\{([\S\s]+?)$/)&&RegExp.$1,d.push(RegExp.$2&&i(RegExp.$2))),u=m.split(","),c=u.length;for(var p=0;c>p;p++)h=u[p],l.push({media:h.split("(")[0].match(/(only\s+)?([a-zA-Z]+)\s?/)&&RegExp.$2||"all",rules:d.length-1,hasquery:h.indexOf("(")>-1,minw:h.match(/\(\s*min\-width\s*:\s*(\s*[0-9\.]+)(px|em)\s*\)/)&&parseFloat(RegExp.$1)+(RegExp.$2||""),maxw:h.match(/\(\s*max\-width\s*:\s*(\s*[0-9\.]+)(px|em)\s*\)/)&&parseFloat(RegExp.$1)+(RegExp.$2||"")})}w()},E=function(){var e,t=r.createElement("div"),n=r.body,a=!1;return t.style.cssText="position:absolute;font-size:1em;width:1em",n||(n=a=r.createElement("body"),n.style.background="none"),n.appendChild(t),o.insertBefore(n,o.firstChild),e=t.offsetWidth,a?o.removeChild(n):n.removeChild(t),e=i=parseFloat(e)},w=function(t){var n="clientWidth",h=o[n],p="CSS1Compat"===r.compatMode&&h||r.body[n]||h,y={},v=f[f.length-1],g=(new Date).getTime();if(t&&a&&u>g-a)return e.clearTimeout(s),s=e.setTimeout(w,u),void 0;a=g;for(var x in l)if(l.hasOwnProperty(x)){var T=l[x],C=T.minw,S=T.maxw,$=null===C,b=null===S,R="em";C&&(C=parseFloat(C)*(C.indexOf(R)>-1?i||E():1)),S&&(S=parseFloat(S)*(S.indexOf(R)>-1?i||E():1)),T.hasquery&&($&&b||!($||p>=C)||!(b||S>=p))||(y[T.media]||(y[T.media]=[]),y[T.media].push(d[T.rules]))}for(var M in m)m.hasOwnProperty(M)&&m[M]&&m[M].parentNode===c&&c.removeChild(m[M]);for(var O in y)if(y.hasOwnProperty(O)){var B=r.createElement("style"),L=y[O].join("\n");B.type="text/css",B.media=O,c.insertBefore(B,v.nextSibling),B.styleSheet?B.styleSheet.cssText=L:B.appendChild(r.createTextNode(L)),m.push(B)}},T=function(e,t){var n=C();n&&(n.open("GET",e,!0),n.onreadystatechange=function(){4!==n.readyState||200!==n.status&&304!==n.status||t(n.responseText)},4!==n.readyState&&n.send(null))},C=function(){var t=!1;try{t=new e.XMLHttpRequest}catch(n){t=new e.ActiveXObject("Microsoft.XMLHTTP")}return function(){return t}}();v(),n.update=v,e.addEventListener?e.addEventListener("resize",t,!1):e.attachEvent&&e.attachEvent("onresize",t)}})(this);function time_left(a,t){if(a<=0){if(t)return t();return 0}var e="";var r=Math.floor(a/86400);e+=r>0?r+"<span>D</span> ":"";var o=Math.floor((a-r*86400)/3600);e+=o>0?o+"<span>H</span> ":"";var n=Math.floor((a-r*86400-o*3600)/60);e+=n>0?n+"<span>M</span> ":"";var i=Math.floor(a-r*86400-o*3600-n*60);e+=i>0?i+"<span>S</span>":"";return e}omerta.timers.callback={sent_bodyguard:false,lackey:function(a){var t=$(a).attr("data-lackey");$(a).html('<img src="/assets/omerta/main/layout/assets/img/icons/loading_bar.gif" alt="loading" />');omerta.modules.Lackeys.update();$(a).attr("data-timeleft",parseInt($(a).attr("data-timeleft"))-1);return false},bodyguard:function(a){if(omerta.timers.callback.sent_bodyguard){return}omerta.timers.callback.sent_bodyguard=true;var t=omerta.GUI.container.loadPage("/BeO/webroot/index.php?module=Bodyguards");t.always(function(){omerta.timers.callback.sent_bodyguard=false})},cityRaid:function(a){omerta.modules.City.citySpotRaidLink(a)},popupButtonNow:function(a){var t=$("#popupButtonNow");if(t.length>0){t.removeAttr("disabled");t.removeClass("btn-grey").addClass("btn-danger");t.text(t.data("ready"))}$(a).text("Now");return 0}};function omerta_cooldown(a,t,e){var r=$("div[data-cooldown="+a+"] input[data-knob-timeleft]");var o=r.attr("data-knob-timeleft");if(r.length==0){return false}if(parseInt(o)>0){return false}if(_.isNumber(e)){e=parseInt(e)}else{e=0}r.attr("data-knob-timeleft",t);if(e>0){r.attr("data-knob-timetotal",e)}}function omerta_progressbar(a,t){$("*[data-pbar="+a+"]").attr("data-perc",t)}
$(document).ready(function(){omerta.GUI.loader.ready();omerta.clickEvent=function(){if(typeof Modernizr!=="object"){return"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch?"touchstart":"click"}if(Modernizr.touch){return"touchstart"}return"click"}();omerta.timers.countdowns=setInterval(function(){$("*[data-timeleft]").each(function(){if(!$(this).is(":visible"))return;var t=parseInt($(this).attr("data-timeleft"));if(t<0)return;var e;var a=true;if(t==0){if($(this).attr("data-timecb")){try{a=omerta.timers.callback[$(this).attr("data-timecb")](this)}catch(r){console.log("Timer callback not found:"+$(this).attr("data-timecb"))}}e=$(this).attr("data-timedone")?$(this).attr("data-timedone"):"Now"}else e=time_left($(this).attr("data-timeleft"));if(!a)return;if($(this).find(".label").length>0)$(this).find(".label").html(e);else $(this).html(e);$(this).attr("data-timeleft",t-1)})},1e3);$(window).bind("hashchange",function(){if(window.location.hash.length===0||window.location.hash==="undefined"){return false}if(window.location.hash=="#"||window.location.hash=="#undefined"){return false}if(omerta.GUI.container.processHash){omerta.GUI.container.loadPage(window.location.hash.substr(1))}});$(document).on("keyup","input[type=text][data-number]",function(t){var e=$(this).val().replace(/k/g,"000").replace(/m/g,"000000").replace(/[^0-9\.]+/g,"");$(this).val(e)});$(document).on("click","*[data-cooldown]",function(t){$("#game_menu a[data-menu='"+$(this).attr("data-cooldown")+"']").trigger("click")});$("#game_container").on("click","input[type=submit]",function(t){var e=$(this),a=$(this.form);if(a.length===0){return}if(a.attr("data-ajax")&&a.attr("data-ajax")==="false"){return true}if(e.attr("data-confirm")){var r=confirm(e.attr("data-confirm"));if(!r){return false}}var i=a.data("loading");if(i===true||i==="true"){t.preventDefault();return false}if(a.attr("target")!=="_blank"){if(!a.attr("action")||a.attr("action").length<3){omerta.GUI.container.loadPageErr();omerta.debug(window.location.hash,"","FORM no-action error");t.preventDefault();return false}var n=e.attr("name")+"="+$(this).val();var o="";o+=a.serialize();if(o.length>2)o+="&";o+=n;if(!a.attr("method")||a.attr("method").toUpperCase()=="POST"){a.data("loading",true);var l=$.ajax({data:o,type:"POST",url:a.attr("action"),timeout:2e4,dataType:"html"});l.success(function(t,e){if(e==="success"){var a=false;try{a=$.parseJSON(t)}catch(r){}var i=false;if(typeof a==="object"&&typeof a.request!=="undefined"&&typeof a.template!=="undefined"){if(typeof omerta.modules[a.request.module]!=="undefined"){omerta.modules[a.request.module].init(a).show()}else{i=a.data.title||a.request.module;omerta.GUI.container.title(i);omerta.GUI.container.loadPageCB(a.template)}delete a}else{omerta.GUI.container.loadPageCB(t)}}});l.always(function(){a.data("loading",false)})}else{omerta.GUI.container.loadPage(a.attr("action")+"?"+o)}t.preventDefault();return false}});$("#game_container, #game_menu").on("submit","form",function(t){if($(this).attr("data-ajax")&&$(this).attr("data-ajax")=="false"){return true}if($(this).attr("target")!="_blank"){if(!$(this).attr("action")||$(this).attr("action").length<3){omerta.GUI.container.loadPageErr();omerta.debug(window.location.hash,"","FORM no-action error");t.preventDefault();return false}if(!$(this).attr("method")||$(this).attr("method").toUpperCase()=="POST"){$.ajax({data:$(this).serialize(),type:"POST",url:$(this).attr("action"),timeout:2e4,dataType:"html",success:function(t,e){if(e=="success"){var a=false;try{a=$.parseJSON(t)}catch(r){}var i=false;if(typeof a==="object"&&typeof a.request!=="undefined"&&typeof a.template!=="undefined"){if(typeof omerta.modules[a.request.module]!=="undefined"){omerta.modules[a.request.module].init(a).show()}else{i=a.data.title||a.request.module;omerta.GUI.container.title(i);omerta.GUI.container.loadPageCB(a.template)}delete a}else{omerta.GUI.container.loadPageCB(t)}}}})}else{omerta.GUI.container.loadPage($(this).attr("action")+"?"+$(this).serialize())}t.preventDefault();return false}});$(document).on("click","*[data-box]",function(t){var e=$(this).next();if(e.is(":hidden")){e.slideDown("slow");$(this).find(".menu_closed").removeClass("menu_closed").addClass("menu_open")}else{e.slideUp("slow");$(this).find(".menu_open").removeClass("menu_open").addClass("menu_closed")}t.preventDefault();return false});$(document).on("click",'a[href!="#"]',function(t){var e=$(this),a=e.attr("href"),r=e.attr("target"),i=e.attr("data-confirm");if(typeof a==="undefined"){return}if(a){if(a.indexOf("javascript:")!==-1)return;if(a.indexOf("mailto:")!==-1)return}if($(this).attr("data-box"))return;if(i){var n=confirm(i);if(!n){return false}}if(r!="_blank"&&r!="_top"){t.preventDefault();if($("#mobileMenu").is(":visible")&&$("#game_menu").offset().left==0){$("#mobileMenu").trigger(omerta.clickEvent)}var o=omerta.GUI.container.loadPage($(this).attr("href"));if(e.closest("#selected").length>0){var l=e.data("page-title")||e.text()}o.success(function(t){var e=false;if(typeof t==="object"){e=t}else{try{e=$.parseJSON(t)}catch(a){}}if(typeof e==="object"&&typeof e.data==="object"&&typeof e.data.title==="string"){l=e.data.title}if(l)omerta.GUI.container.title(l);l=null});return false}});$("img[rel=tooltip]").tipsy({gravity:$.fn.tipsy.autoNS,html:true,live:true});$(document).on(omerta.clickEvent,"#mobileMenu",function(t){t.preventDefault();var e=$("#game_menu");if(e.offset().left<0){$("#game_wrapper").fadeTo("fast",.5);e.animate({left:0});$("#mobileMenu").animate({left:-8})}else{$("#game_wrapper").fadeTo("fast",1);e.animate({left:-200});$("#mobileMenu").animate({left:5})}});if(omerta.clickEvent=="touchstart"){$(document).on("touchend",function(t){var e=$(t.target);if(e.parents("#game_menu").length>0||e.attr("id")==="mobileMenu"){return}var a=$("#game_menu");if(a.offset().left>=0){$("#mobileMenu").trigger(omerta.clickEvent)}})}var t={event:"click touchend",target:".popup-box-wrapper"};if(omerta.clickEvent=="touchstart"){t.target=".popup-box-wrapper .foot .btn-action"}$("#game_wrapper").on("click touchstart",t.target,function(t){t.preventDefault();t.stopPropagation();if($(this).data("name")){var e=$(this)}else{var a=$(this);var e=a.find(".btn-action")}var r=e.data("name");var i=e.data("value");if(r.length===0){return null}$("#crimes-selected-option").attr("name",r);$("#crimes-selected-option").attr("value",i);$(".popup-place-wrapper").removeClass("active");$(e).parents(".popup-place-wrapper").addClass("active");$("form[name=doPopupAction]").submit()})});String.prototype.ucfirst=function(){return this.charAt(0).toUpperCase()+this.slice(1).toLowerCase()};omerta.services.account=$.extend({},omerta.framework.service,{name:"account",service:"Account",run_cb:function(t){this.data=t.data;if(typeof this.data.forward!=="undefined"){window.location=this.data.forward;return}if(this.data.logout){omerta.GUI.helper.logout();return}if(this.data.version!=omerta.version){omerta.GUI.helper.refresh(true);omerta={};return}$("#omerta_release").text(this.data.release);omerta.server.clock.setTime(parseInt(t.time)*1e3);for(i in this.data.cooldowns){if(this.data.cooldowns[i]>0){omerta_cooldown(i,this.data.cooldowns[i])}}omerta.widgets.sidebar.updateNotifications("inbox",this.data.messages.inbox,this.data.messages.counter.inbox);omerta.widgets.sidebar.updateNotifications("alert",this.data.messages.alert,this.data.messages.counter.alert);omerta.widgets.sidebar.updateNotifications("bugs",this.data.bugs,this.data.bugs.length);omerta.widgets.sidebar.updateNotifications("tickets",this.data.tickets,this.data.tickets.length);var e=$.prompt.getCurrentState();if(this.data.messages.counter.admin>0&&e.length===0){var a=this.data.messages.admin;$.prompt("You have received a message from an admin, please read it.",{buttons:{"Read It":1},title:"Admin message",submit:function(t,e,s,i){if(_.isUndefined(a[0])){return null}if(!_.isObject(a[0])){return null}omerta.GUI.container.loadPage("/?module=Mail&action=showMsg&iMsgId="+a[0].id)}})}var s=this.data.messages.news;if(s.length>0){var r=s.shift();$("#latest-new-link").attr("href",r.link).html("<b>News:&nbsp;</b>"+r.sbj)}else{$("#news-topbar-container").remove()}if(typeof omerta!=="undefined"&&typeof omerta.character!=="undefined"){omerta.character.progress.health(parseFloat(this.data.progressbars.health));omerta.character.progress.kill_skill(parseFloat(this.data.progressbars.killskill));omerta.character.progress.rank_progress(parseFloat(this.data.progressbars.rankprogress));omerta.character.game.city(this.data.city.name);omerta.character.info.family(this.data.family);$("#travel_cityname .title").text(this.data.city.name)}if(typeof this.data.widgets!=="undefined"&&typeof this.data.widgets.eog!=="undefined"&&typeof omerta.widgets.EOG!=="undefined"){omerta.widgets.EOG.init(this.data.widgets.eog)}if(_.isArray(this.data.users)){omerta.users(this.data.users)}this.rerun()}});(function(i,e,o){if(typeof module!=="undefined"&&module.exports){module.exports=o()}else if(typeof define==="function"&&define.amd){define(o)}else{e[i]=o()}})("oTracker",this,function(){"use strict";var i=function(i){this.oFingerPrint=new Fingerprint({canvas:true,ie_activex:true,screen_resolution:true});this.enabledFonts=[];this.localIps=[];this.fontsLoopFallback=0;if(!this.isFlashEnabled()){this.detectJsFonts()}};i.prototype={isFlashEnabled:function(){var i=false;try{var e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(e)i=true}catch(o){if(navigator.mimeTypes["application/x-shockwave-flash"]!=undefined)i=true}return i},getFingerprint:function(){return this.oFingerPrint.get()},getJsFonts:function(){var i=["Symbol","Arial","Courier New","Times New Roman","Georgia","Trebuchet MS","Verdana","Impact","Comic Sans MS","Webdings","Tahoma","Microsoft Sans Serif","Wingdings","Arial Black","Lucida Console","Marlett","Lucida Sans Unicode","Courier","Franklin Gothic Medium","Palatino Linotype","Sylfaen","Estrangelo Edessa","Tunga","Mangal","Raavi","Latha","Gautami","Shruti","MV Boli","Calibri","Cambria","Constantia","Candara","Corbel","Consolas","Cambria Math","Segoe UI","MS Mincho","Wingdings 2","Wingdings 3","Vrinda","Kartika","Century Gothic","Arial Narrow","Garamond","Book Antiqua","Bookman Old Style","MS Reference Sans Serif","MS Reference Specialty","Bookshelf Symbol 7","Monotype Corsiva","Meiryo","Arial Unicode MS","Century","Gabriola","Plantagenet Cherokee","Segoe Print","Segoe Script","Meiryo UI","MT Extra","SimSun","Batang","Gulim","MS PMincho","MS PGothic","MS Gothic","Mongolian Baiti","Microsoft Yi Baiti","PMingLiU","Microsoft Himalaya","SimHei","MingLiU","Segoe UI Light","Simplified Arabic","Cordia New","Miriam Fixed","EucrosiaUPC","Simplified Arabic Fixed","Rod","Angsana New","Narkisim","FrankRuehl","JasmineUPC","Dotum","DotumChe","IrisUPC","FreesiaUPC","GulimChe","LilyUPC","DilleniaUPC","Miriam","MS UI Gothic","Traditional Arabic","Levenim MT","David","KodchiangUPC","Iskoola Pota","SimSun-ExtB","BrowalliaUPC","Euphemia","CordiaUPC","Browallia New","AngsanaUPC","Nyala","NSimSun","Kalinga","GungsuhChe","MingLiU_HKSCS-ExtB","MingLiU_HKSCS","MingLiU-ExtB","PMingLiU-ExtB","BatangChe","Gungsuh","Aharoni","Andalus","Gisha","Microsoft Uighur","MoolBoran","DokChampa","DaunPenh","Microsoft Tai Le","Leelawadee","Malgun Gothic","Microsoft JhengHei","Microsoft YaHei","Arabic Typesetting","Segoe UI Semibold","Segoe UI Symbol","Ebrima","Khmer UI","Lao UI","FangSong","Microsoft New Tai Lue","KaiTi","Microsoft PhagsPa","Kokila","DFKai-SB","Sakkal Majalla","Utsaah","Shonar Bangla","Vani","Vijaya","Aparajita","Mistral","Haettenschweiler","MS Outlook","Lucida Sans","Lucida Handwriting","Lucida Bright","Freestyle Script","Juice ITC","Tempus Sans ITC","Kristen ITC","Stencil","Jokerman","Bell MT","Vivaldi","Cooper Black","Bauhaus 93","Harrington","Matura MT Script Capitals","Baskerville Old Face","Playbill","Modern No. 20","Colonna MT","Onyx","Britannic Bold","Bernard MT Condensed","Footlight MT Light","Papyrus","Wide Latin","Brush Script MT","Lucida Calligraphy","Lucida Fax","Centaur","Broadway","Californian FB","Berlin Sans FB Demi","Berlin Sans FB","Algerian","Old English Text MT","High Tower Text","Niagara Solid","Magneto","Poor Richard","Kunstler Script","Harlow Solid Italic","Viner Hand ITC","Informal Roman","Snap ITC","Bodoni MT Poster Compressed","Niagara Engraved","Showcard Gothic","Ravie","Parchment","Vladimir Script","Chiller","Century Schoolbook","Bradley Hand ITC","Franklin Gothic Book","French Script MT","Pristina","Copperplate Gothic Bold","Copperplate Gothic Light","Curlz MT","Edwardian Script ITC","Engravers MT","Rockwell","Rockwell Extra Bold","Perpetua","Arial Rounded MT Bold","Franklin Gothic Demi","Franklin Gothic Heavy","Franklin Gothic Demi Cond","Franklin Gothic Medium Cond","Gill Sans MT","Lucida Sans Typewriter","Felix Titling","Maiandra GD","Eras Light ITC","Goudy Old Style","Calisto MT","OCR A Extended","Blackadder ITC","Eras Demi ITC","Gloucester MT Extra Condensed","Imprint MT Shadow","Gill Sans Ultra Bold","Tw Cen MT","Perpetua Titling MT","Gigi","Agency FB","Script MT Bold","Gill Sans MT Condensed","Gill Sans MT Ext Condensed Bold","Elephant","Castellar","Goudy Stout","Eras Medium ITC","Bodoni MT Condensed","Bodoni MT","Bodoni MT Black","Gill Sans Ultra Bold Condensed","Forte","Eras Bold ITC","Rockwell Condensed","Tw Cen MT Condensed","Tw Cen MT Condensed Extra Bold","Rage Italic","Palace Script MT","System","Terminal","Fixedsys","MS Sans Serif","Small Fonts","MS Serif","Modern","Roman","Script","Courier New CE","Times New Roman CE","Times New Roman Greek","Courier New Baltic","Arial CYR","Arial CE","Times New Roman TUR","Courier New Greek","Arial Baltic","Courier New TUR","Times New Roman CYR","Arial Greek","Arial TUR","Times New Roman Baltic","Courier New CYR","Times New Roman Cyr","Courier New Cyr","Arial Cyr","Calibri Light","Myriad Pro","Hobo Std","Trajan Pro","Minion Pro","Giddyup Std","Adobe Caslon Pro","Blackoak Std","Chaparral Pro","OCR A Std","Birch Std","Adobe Garamond Pro","Tekton Pro","Adobe Caslon Pro Bold","Cooper Std Black","Myriad Pro Cond","Adobe Garamond Pro Bold","Kozuka Mincho Pro EL","Myriad Pro Light","Kozuka Mincho Pro B","Kozuka Mincho Pro L","Kozuka Mincho Pro M","Kozuka Gothic Pro B","Kozuka Gothic Pro R","Kozuka Gothic Pro L","Kozuka Gothic Pro M","Kozuka Gothic Pro H","Kozuka Gothic Pro EL","Poplar Std","Kozuka Mincho Pro R","Kozuka Mincho Pro H","Letter Gothic Std","Brush Script Std","Mesquite Std","Stencil Std","Orator Std","Charlemagne Std","Prestige Elite Std","Rosewood Std Regular","Minion Pro Med","Minion Pro SmBd","Lithos Pro Regular","Tekton Pro Ext","Nueva Std Cond","Tekton Pro Cond","Minion Pro Cond","Arabic Transparent","Adobe Ming Std L","Adobe Song Std L","Adobe Fangsong Std R","Adobe Myungjo Std M","Adobe Kaiti Std R","Adobe Heiti Std R","Kozuka Mincho Pr6N H","Kozuka Gothic Pr6N R","Kozuka Gothic Pr6N M","Kozuka Mincho Pr6N EL","Kozuka Mincho Pr6N L","Kozuka Mincho Pr6N R","Kozuka Mincho Pr6N M","Kozuka Gothic Pr6N L","Kozuka Mincho Pr6N B","Kozuka Gothic Pr6N H","Kozuka Gothic Pr6N B","Kozuka Gothic Pr6N EL","Adobe Fan Heiti Std B","Adobe Gothic Std B","Adobe Hebrew","Adobe Arabic","Swis721 BT","Swis721 Lt BT","Swis721 Blk BT","OCR-A BT","OCR-B 10 BT","Eccentric Std","Bell Gothic Std Light","Bell Gothic Std Black","WP CyrillicA","WP CyrillicB","Futura Md BT","Nueva Std","Adobe Devanagari","Myriad Hebrew","Myriad Arabic","Freehand521 BT","Adobe Naskh Medium","Chaparral Pro Light","Swis721 Hv BT","WP Greek Courier","WP Greek Century","DejaVu Sans","WP Greek Helve","WP MultinationalA Roman","WP MultinationalB Courier","WP MultinationalB Roman","DejaVu Sans Mono","WP MultinationalA Helve","WP MultinationalB Helve","WP MultinationalA Courier","DejaVu Serif","OpenSymbol","Swis721 Cn BT","DejaVu Sans Light","Swis721 LtEx BT","Swis721 BlkCn BT","DejaVu Sans Condensed","DejaVu Serif Condensed","WP ArabicScript Sihafa","Arno Pro","WP Arabic Sihafa","WP Hebrew David","Arno Pro Light Display","Arno Pro Display","Arno Pro Smbd Caption","Arno Pro Caption","Arno Pro Subhead","Arno Pro SmText","Arno Pro Smbd Display","Arno Pro Smbd SmText","Arno Pro Smbd","Arno Pro Smbd Subhead","Bickham Script Pro Regular","Bickham Script Pro Semibold","Garamond Premr Pro","Garamond Premr Pro Smbd","Gentium Book Basic","Gentium Basic","GothicI","GothicE","BankGothic Lt BT","BankGothic Md BT","Bickham Script Two","ISOCTEUR","ISOCPEUR","Dutch801 Rm BT","CommercialScript BT","ScriptS","TeamViewer8","Swis721 BlkEx BT","Swis721 BdCnOul BT","Monotxt","GothicG","Swis721 Ex BT","Swis721 LtCn BT","RomanD","Dutch801 XBd BT","Txt","Vineta BT","GreekS","Monospac821 BT","ScriptC","CountryBlueprint","Complex","Swis721 BlkOul BT","GreekC","Simplex","ISOCP2","Technic","ISOCP3","Swis721 BdOul BT","ISOCP","TechnicBold","RomanS","WST_Engl","TechnicLite","RomanT","Romantic","Symeteo","WST_Fren","CityBlueprint","ISOCT2","Symath","ISOCT3","GDT","Syastro","Symap","ISOCT","RomanC","ItalicC","SansSerif","EuroRoman","Symusic","ItalicT","CommercialPi BT","Proxy 1","Proxy 2","WST_Czec","Proxy 6","Proxy 5","Proxy 4","Proxy 3","PanRoman","Italic","Stylus BT","Proxy 9","Proxy 8","WST_Germ","Proxy 7","SuperFrench","UniversalMath1 BT","WST_Ital","WST_Swed","WST_Span","AmdtSymbols","AMGDT","AcadEref","AIGDT","ZWAdobeF","Bickham Script One","Microsoft JhengHei UI","Amadeus","Microsoft YaHei UI","Copyist","Gadugi","Nirmala UI","Segoe UI Semilight","Ariston","Heather Script One","Carolina","Myriad Web Pro","Alexandra Script","Square721 BT","AnastasiaScript","GENISO","Calligraph","Ouverture script","Decor","Helvetica","Annabelle","Clarendon Lt BT","Clarendon Blk BT","Liberation Sans Narrow","Clarendon BT","Ceremonious Two","Eurostile"];var e="";var o=new jsFontDetector;var a=[];for(e in i){var r=i[e];if(o.detect(r)){a.push(r)}}return a},detectJsFonts:function(){if(this.enabledFonts.length>0){return this.enabledFonts}this.enabledFonts=this.getJsFonts();return this.enabledFonts},getEnabledFonts:function(){return this.enabledFonts.sort()},getLocalIps:function(){var i=this.localIps;if(typeof i==="Array"||typeof i==="object"){return this.localIps.sort()}return 0},getBrowserData:function(){return{canvas:this.oFingerPrint.isCanvasSupported()?this.oFingerPrint.getCanvasFingerprint():"",plugins:this.oFingerPrint.getPluginsString(),screen_size:this.oFingerPrint.getScreenResolution(),timezone:(new Date).getTimezoneOffset(),user_agent:window.navigator.userAgent,cookie_enabled:window.navigator.cookieEnabled,local_ips:this.getLocalIps(),fonts:this.getEnabledFonts(),fonts_js:this.getJsFonts()}},isReadyToSend:function(){var i=this.getFingerprint();if(typeof i==="undefined"||i.length===0){return false}var e=this.getEnabledFonts();if(e.length===0&&this.fontsLoopFallback<5){this.fontsLoopFallback+=1;return false}else{e=this.detectJsFonts()}if(typeof this.localIps==="Array"||typeof this.localIps==="object"){if(this.localIps.length===0){return false}}return true},send:function(i){var e=-1;var o=function(){if(window.oTrack==="undefined"){return false}if(!window.oTrack.isReadyToSend()){return false}var o={fp_code:window.oTrack.getFingerprint(),fp_data:window.oTrack.getBrowserData()};var a=$.post(i,o);a.always(function(){var i=$("#font-detect-swf");if(i.length>0){i.remove()}});clearInterval(e)};e=setInterval(o,500)}};return i});(function(i,e,o){if(typeof module!=="undefined"&&module.exports){module.exports=o()}else if(typeof define==="function"&&define.amd){define(o)}else{e[i]=o()}})("oTracker",this,function(){"use strict";var i=function(i){this.oFingerPrint=new Fingerprint({canvas:true,ie_activex:true,screen_resolution:true});this.enabledFonts=[];this.localIps=[];this.fontsLoopFallback=0;if(!this.isFlashEnabled()){this.detectJsFonts()}};i.prototype={isFlashEnabled:function(){var i=false;try{var e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(e)i=true}catch(o){if(navigator.mimeTypes["application/x-shockwave-flash"]!=undefined)i=true}return i},getFingerprint:function(){return this.oFingerPrint.get()},getJsFonts:function(){var i=["Symbol","Arial","Courier New","Times New Roman","Georgia","Trebuchet MS","Verdana","Impact","Comic Sans MS","Webdings","Tahoma","Microsoft Sans Serif","Wingdings","Arial Black","Lucida Console","Marlett","Lucida Sans Unicode","Courier","Franklin Gothic Medium","Palatino Linotype","Sylfaen","Estrangelo Edessa","Tunga","Mangal","Raavi","Latha","Gautami","Shruti","MV Boli","Calibri","Cambria","Constantia","Candara","Corbel","Consolas","Cambria Math","Segoe UI","MS Mincho","Wingdings 2","Wingdings 3","Vrinda","Kartika","Century Gothic","Arial Narrow","Garamond","Book Antiqua","Bookman Old Style","MS Reference Sans Serif","MS Reference Specialty","Bookshelf Symbol 7","Monotype Corsiva","Meiryo","Arial Unicode MS","Century","Gabriola","Plantagenet Cherokee","Segoe Print","Segoe Script","Meiryo UI","MT Extra","SimSun","Batang","Gulim","MS PMincho","MS PGothic","MS Gothic","Mongolian Baiti","Microsoft Yi Baiti","PMingLiU","Microsoft Himalaya","SimHei","MingLiU","Segoe UI Light","Simplified Arabic","Cordia New","Miriam Fixed","EucrosiaUPC","Simplified Arabic Fixed","Rod","Angsana New","Narkisim","FrankRuehl","JasmineUPC","Dotum","DotumChe","IrisUPC","FreesiaUPC","GulimChe","LilyUPC","DilleniaUPC","Miriam","MS UI Gothic","Traditional Arabic","Levenim MT","David","KodchiangUPC","Iskoola Pota","SimSun-ExtB","BrowalliaUPC","Euphemia","CordiaUPC","Browallia New","AngsanaUPC","Nyala","NSimSun","Kalinga","GungsuhChe","MingLiU_HKSCS-ExtB","MingLiU_HKSCS","MingLiU-ExtB","PMingLiU-ExtB","BatangChe","Gungsuh","Aharoni","Andalus","Gisha","Microsoft Uighur","MoolBoran","DokChampa","DaunPenh","Microsoft Tai Le","Leelawadee","Malgun Gothic","Microsoft JhengHei","Microsoft YaHei","Arabic Typesetting","Segoe UI Semibold","Segoe UI Symbol","Ebrima","Khmer UI","Lao UI","FangSong","Microsoft New Tai Lue","KaiTi","Microsoft PhagsPa","Kokila","DFKai-SB","Sakkal Majalla","Utsaah","Shonar Bangla","Vani","Vijaya","Aparajita","Mistral","Haettenschweiler","MS Outlook","Lucida Sans","Lucida Handwriting","Lucida Bright","Freestyle Script","Juice ITC","Tempus Sans ITC","Kristen ITC","Stencil","Jokerman","Bell MT","Vivaldi","Cooper Black","Bauhaus 93","Harrington","Matura MT Script Capitals","Baskerville Old Face","Playbill","Modern No. 20","Colonna MT","Onyx","Britannic Bold","Bernard MT Condensed","Footlight MT Light","Papyrus","Wide Latin","Brush Script MT","Lucida Calligraphy","Lucida Fax","Centaur","Broadway","Californian FB","Berlin Sans FB Demi","Berlin Sans FB","Algerian","Old English Text MT","High Tower Text","Niagara Solid","Magneto","Poor Richard","Kunstler Script","Harlow Solid Italic","Viner Hand ITC","Informal Roman","Snap ITC","Bodoni MT Poster Compressed","Niagara Engraved","Showcard Gothic","Ravie","Parchment","Vladimir Script","Chiller","Century Schoolbook","Bradley Hand ITC","Franklin Gothic Book","French Script MT","Pristina","Copperplate Gothic Bold","Copperplate Gothic Light","Curlz MT","Edwardian Script ITC","Engravers MT","Rockwell","Rockwell Extra Bold","Perpetua","Arial Rounded MT Bold","Franklin Gothic Demi","Franklin Gothic Heavy","Franklin Gothic Demi Cond","Franklin Gothic Medium Cond","Gill Sans MT","Lucida Sans Typewriter","Felix Titling","Maiandra GD","Eras Light ITC","Goudy Old Style","Calisto MT","OCR A Extended","Blackadder ITC","Eras Demi ITC","Gloucester MT Extra Condensed","Imprint MT Shadow","Gill Sans Ultra Bold","Tw Cen MT","Perpetua Titling MT","Gigi","Agency FB","Script MT Bold","Gill Sans MT Condensed","Gill Sans MT Ext Condensed Bold","Elephant","Castellar","Goudy Stout","Eras Medium ITC","Bodoni MT Condensed","Bodoni MT","Bodoni MT Black","Gill Sans Ultra Bold Condensed","Forte","Eras Bold ITC","Rockwell Condensed","Tw Cen MT Condensed","Tw Cen MT Condensed Extra Bold","Rage Italic","Palace Script MT","System","Terminal","Fixedsys","MS Sans Serif","Small Fonts","MS Serif","Modern","Roman","Script","Courier New CE","Times New Roman CE","Times New Roman Greek","Courier New Baltic","Arial CYR","Arial CE","Times New Roman TUR","Courier New Greek","Arial Baltic","Courier New TUR","Times New Roman CYR","Arial Greek","Arial TUR","Times New Roman Baltic","Courier New CYR","Times New Roman Cyr","Courier New Cyr","Arial Cyr","Calibri Light","Myriad Pro","Hobo Std","Trajan Pro","Minion Pro","Giddyup Std","Adobe Caslon Pro","Blackoak Std","Chaparral Pro","OCR A Std","Birch Std","Adobe Garamond Pro","Tekton Pro","Adobe Caslon Pro Bold","Cooper Std Black","Myriad Pro Cond","Adobe Garamond Pro Bold","Kozuka Mincho Pro EL","Myriad Pro Light","Kozuka Mincho Pro B","Kozuka Mincho Pro L","Kozuka Mincho Pro M","Kozuka Gothic Pro B","Kozuka Gothic Pro R","Kozuka Gothic Pro L","Kozuka Gothic Pro M","Kozuka Gothic Pro H","Kozuka Gothic Pro EL","Poplar Std","Kozuka Mincho Pro R","Kozuka Mincho Pro H","Letter Gothic Std","Brush Script Std","Mesquite Std","Stencil Std","Orator Std","Charlemagne Std","Prestige Elite Std","Rosewood Std Regular","Minion Pro Med","Minion Pro SmBd","Lithos Pro Regular","Tekton Pro Ext","Nueva Std Cond","Tekton Pro Cond","Minion Pro Cond","Arabic Transparent","Adobe Ming Std L","Adobe Song Std L","Adobe Fangsong Std R","Adobe Myungjo Std M","Adobe Kaiti Std R","Adobe Heiti Std R","Kozuka Mincho Pr6N H","Kozuka Gothic Pr6N R","Kozuka Gothic Pr6N M","Kozuka Mincho Pr6N EL","Kozuka Mincho Pr6N L","Kozuka Mincho Pr6N R","Kozuka Mincho Pr6N M","Kozuka Gothic Pr6N L","Kozuka Mincho Pr6N B","Kozuka Gothic Pr6N H","Kozuka Gothic Pr6N B","Kozuka Gothic Pr6N EL","Adobe Fan Heiti Std B","Adobe Gothic Std B","Adobe Hebrew","Adobe Arabic","Swis721 BT","Swis721 Lt BT","Swis721 Blk BT","OCR-A BT","OCR-B 10 BT","Eccentric Std","Bell Gothic Std Light","Bell Gothic Std Black","WP CyrillicA","WP CyrillicB","Futura Md BT","Nueva Std","Adobe Devanagari","Myriad Hebrew","Myriad Arabic","Freehand521 BT","Adobe Naskh Medium","Chaparral Pro Light","Swis721 Hv BT","WP Greek Courier","WP Greek Century","DejaVu Sans","WP Greek Helve","WP MultinationalA Roman","WP MultinationalB Courier","WP MultinationalB Roman","DejaVu Sans Mono","WP MultinationalA Helve","WP MultinationalB Helve","WP MultinationalA Courier","DejaVu Serif","OpenSymbol","Swis721 Cn BT","DejaVu Sans Light","Swis721 LtEx BT","Swis721 BlkCn BT","DejaVu Sans Condensed","DejaVu Serif Condensed","WP ArabicScript Sihafa","Arno Pro","WP Arabic Sihafa","WP Hebrew David","Arno Pro Light Display","Arno Pro Display","Arno Pro Smbd Caption","Arno Pro Caption","Arno Pro Subhead","Arno Pro SmText","Arno Pro Smbd Display","Arno Pro Smbd SmText","Arno Pro Smbd","Arno Pro Smbd Subhead","Bickham Script Pro Regular","Bickham Script Pro Semibold","Garamond Premr Pro","Garamond Premr Pro Smbd","Gentium Book Basic","Gentium Basic","GothicI","GothicE","BankGothic Lt BT","BankGothic Md BT","Bickham Script Two","ISOCTEUR","ISOCPEUR","Dutch801 Rm BT","CommercialScript BT","ScriptS","TeamViewer8","Swis721 BlkEx BT","Swis721 BdCnOul BT","Monotxt","GothicG","Swis721 Ex BT","Swis721 LtCn BT","RomanD","Dutch801 XBd BT","Txt","Vineta BT","GreekS","Monospac821 BT","ScriptC","CountryBlueprint","Complex","Swis721 BlkOul BT","GreekC","Simplex","ISOCP2","Technic","ISOCP3","Swis721 BdOul BT","ISOCP","TechnicBold","RomanS","WST_Engl","TechnicLite","RomanT","Romantic","Symeteo","WST_Fren","CityBlueprint","ISOCT2","Symath","ISOCT3","GDT","Syastro","Symap","ISOCT","RomanC","ItalicC","SansSerif","EuroRoman","Symusic","ItalicT","CommercialPi BT","Proxy 1","Proxy 2","WST_Czec","Proxy 6","Proxy 5","Proxy 4","Proxy 3","PanRoman","Italic","Stylus BT","Proxy 9","Proxy 8","WST_Germ","Proxy 7","SuperFrench","UniversalMath1 BT","WST_Ital","WST_Swed","WST_Span","AmdtSymbols","AMGDT","AcadEref","AIGDT","ZWAdobeF","Bickham Script One","Microsoft JhengHei UI","Amadeus","Microsoft YaHei UI","Copyist","Gadugi","Nirmala UI","Segoe UI Semilight","Ariston","Heather Script One","Carolina","Myriad Web Pro","Alexandra Script","Square721 BT","AnastasiaScript","GENISO","Calligraph","Ouverture script","Decor","Helvetica","Annabelle","Clarendon Lt BT","Clarendon Blk BT","Liberation Sans Narrow","Clarendon BT","Ceremonious Two","Eurostile"];var e="";var o=new jsFontDetector;var a=[];for(e in i){var r=i[e];if(o.detect(r)){a.push(r)}}return a},detectJsFonts:function(){if(this.enabledFonts.length>0){return this.enabledFonts}this.enabledFonts=this.getJsFonts();return this.enabledFonts},getEnabledFonts:function(){return this.enabledFonts.sort()},getLocalIps:function(){var i=this.localIps;if(typeof i==="Array"||typeof i==="object"){return this.localIps.sort()}return 0},getBrowserData:function(){return{canvas:this.oFingerPrint.isCanvasSupported()?this.oFingerPrint.getCanvasFingerprint():"",plugins:this.oFingerPrint.getPluginsString(),screen_size:this.oFingerPrint.getScreenResolution(),timezone:(new Date).getTimezoneOffset(),user_agent:window.navigator.userAgent,cookie_enabled:window.navigator.cookieEnabled,local_ips:this.getLocalIps(),fonts:this.getEnabledFonts(),fonts_js:this.getJsFonts()}},isReadyToSend:function(){var i=this.getFingerprint();if(typeof i==="undefined"||i.length===0){return false}var e=this.getEnabledFonts();if(e.length===0&&this.fontsLoopFallback<5){this.fontsLoopFallback+=1;return false}else{e=this.detectJsFonts()}if(typeof this.localIps==="Array"||typeof this.localIps==="object"){if(this.localIps.length===0){return false}}return true},send:function(i){var e=-1;var o=function(){if(window.oTrack==="undefined"){return false}if(!window.oTrack.isReadyToSend()){return false}var o={fp_code:window.oTrack.getFingerprint(),fp_data:window.oTrack.getBrowserData()};var a=$.post(i,o);a.always(function(){var i=$("#font-detect-swf");if(i.length>0){i.remove()}});clearInterval(e)};e=setInterval(o,500)}};return i});var jsFontDetector=function(){var e=["monospace","sans-serif","serif"];var t="mmmmmmmmmmlli";var n="72px";var i=document.getElementsByTagName("body")[0];var o=document.createElement("span");o.style.fontSize=n;o.innerHTML=t;var s={};var r={};for(var a in e){o.style.fontFamily=e[a];i.appendChild(o);s[e[a]]=o.offsetWidth;r[e[a]]=o.offsetHeight;i.removeChild(o)}function c(t){var n=false;for(var a in e){o.style.fontFamily=t+","+e[a];i.appendChild(o);var c=o.offsetWidth!=s[e[a]]||o.offsetHeight!=r[e[a]];i.removeChild(o);n=n||c}return n}this.detect=c};var FontDetect=function(e,t,n){this._swfId=e;this._swfObjectId=e;this._swfLocation=t;this._onReady=n;this._fallbackWidthCache=null;this.loadSWF()};var FontDetectGlobal=function(){var e={};return{register:function(t,n){e[t]=n},remove:function(t){var n=e[t];e[t]=null;return n}}}();FontDetect.prototype={loadSWF:function(){var e={onReady:"onFontDetectReady",swfObjectId:this._swfObjectId};var t={allowScriptAccess:"always",menu:"false"};var n={id:this._swfObjectId,name:this._swfObjectId};swfobject.embedSWF(this._swfLocation,this._swfId,"1","1","9.0.0",false,e,t,n);FontDetectGlobal.register(this._swfObjectId,this);$(document).bind("swfLoaded",function(e,t){var n=FontDetectGlobal.remove(t);n._onReady(n)})},checkOffsetWidth:function(e,t){var n=document.createElement("p");$(n).css("font-family",e);$(n).css("font-size",t);$(n).css("display","inline");$(n).addClass("font-test");$(n).css("visibility","hidden");$(n).css("top","0");$(n).css("left","0");$(n).css("position","absolute");$(n).html("mmmmmmmmml");$("body").append(n);var i=n.offsetWidth;$(n).remove();return i},fallbackWidth:function(){if(!this._fallbackWidthCache)this._fallbackWidthCache=this.checkOffsetWidth("Times New Roman","120px");return this._fallbackWidthCache},checkFont:function(e){if(e=="Times New Roman")return true;if(/\d+pt\s*$/.test(e))return false;var t=this.checkOffsetWidth("'"+e+"', Times New Roman","120px");return t!=this.fallbackWidth()},filterFonts:function(e){var t=[];for(var n=0,i=e.length;n<i;n++){if(this.checkFont(e[n].fontName))t.push(e[n])}return t},fonts:function(){var e=document.getElementById(this._swfObjectId);var t=e.fonts();return this.filterFonts(t)}};var onFontDetectReady=function(e){$(document).trigger("swfLoaded",[e])};function TaskController(e,t){this.numConcurrent=e;this.onDone=t||function(){};this.pending=0;this.queued=[];this.checkTimer=-1}TaskController.prototype.deferCheck=function(){if(this.checkTimer!=-1)return;this.checkTimer=setTimeout(function(){this.checkTimer=-1;this.check()}.bind(this),0)};TaskController.prototype.check=function(){if(this.pending<1&&this.queued.length==0)return this.onDone();while(this.pending<this.numConcurrent&&this.queued.length>0){try{this.pending+=1;setTimeout(function(e){e(function(){this.pending-=1;this.deferCheck()}.bind(this))}.bind(this,this.queued.shift()),0)}catch(e){this.pending-=1;this.deferCheck()}}};TaskController.prototype.queue=function(e){this.queued.push(e);this.deferCheck()};function probeIp(e,t,n){var i=Date.now();var o=false;var s=document.createElement("img");var r=function(){if(!s)return;document.body.removeChild(s);s=null};var a=function(s){if(o)return;o=true;r();n(e,Date.now()-i<t)};document.body.appendChild(s);s.style.display="none";s.onload=function(){a(true)};s.onerror=function(){a(false)};s.src="https://"+e+":"+~~(1024+1024*Math.random())+"/I_DO_NOT_EXIST?"+Math.random();setTimeout(function(){if(s)s.src=""},t+500)}function probeNet(e,t,n){e=e.replace(/(\d+\.\d+\.\d+)\.\d+/,"$1.");var i=5e3;var o=false;var s=[];var r=new TaskController(5,n);for(var a=1;a<256;++a){r.queue(function(n,o){probeIp(e+n,i,function(e,n){if(n)t(e);o()})}.bind(this,a))}}function enumLocalIPs(e){var t=window.webkitRTCPeerConnection||window.mozRTCPeerConnection;if(t)(function(){var n=new t({iceServers:[]});if(1||window.mozRTCPeerConnection){n.createDataChannel("",{reliable:false})}n.onicecandidate=function(e){if(e.candidate)s("a="+e.candidate.candidate)};setTimeout(function(){n.createOffer(function(e){s(e.sdp);n.setLocalDescription(e)},function(e){})},500);var i=Object.create(null);i["0.0.0.0"]=false;function o(t){if(t in i)return;else i[t]=true;var n=Object.keys(i).filter(function(e){return i[e]});e(t)}function s(e){var t=[];e.split("\r\n").forEach(function(e){if(~e.indexOf("a=candidate")){var t=e.split(" "),n=t[4],i=t[7];if(i==="host")o(n)}else if(~e.indexOf("c=")){var t=e.split(" "),n=t[2];o(n)}})}})()}$(document).ready(function(){window.oTrack=new oTracker;var e=$("<object></object>").attr("id","font-detect-swf");$("body").append(e);var t=new FontDetect("font-detect-swf","/assets/vendor/assets/FontList.swf",function(e){var t=e.fonts();for(var n=0,i=t.length;n<i;n++){window.oTrack.enabledFonts.push(t[n].fontName)}});enumLocalIPs(function(e){window.oTrack.localIps.push(e)});window.oTrack.send("/index.php?module=Services.Status")});omerta.services.security={load:function(){},render:function(e){if(typeof grecaptcha==="undefined"){return null}grecaptcha.render("recaptcha-container",{sitekey:e,theme:"dark",callback:omerta.services.security.check})},check:function(e){var r=$.ajax({url:"/?module=Services.Security",type:"POST",dataType:"json",data:{response:e}});r.done(function(e){if(typeof e.code==="undefined"){return false}var r=parseInt(e.code);if(r!=0){return false}$("#recaptcha-popup").fadeOut("slow",function(){$("#recaptcha-popup").remove()})})}};omerta.character={HTML_WIDGET_LABEL:'<div class="tcontainer"><b class="tlabel"> {TLABEL} </b > <span class="tvalue">{TVALUE}</span></div>',info:{name:ko.observable(),gender:ko.observable(),avatar:ko.observable(),family:ko.observable()},game:{city:ko.observable("")},progress:{health:ko.observable(100),rank:ko.observable("Empty Suit"),rank_progress:ko.observable(0),kill_skill:ko.observable(0),kill:ko.observable(0),leader_points:ko.observable(0),leader_points_percentage:ko.observable(0),position:ko.observable("")},widgets:{avatar:{selected:ko.observable("health")}}};omerta.character.city=ko.computed(function(){return omerta.character.game.city()});omerta.character.progress.getTipForHealth=ko.computed(function(){var r=omerta.character.progress.health()+"%";return omerta.character.HTML_WIDGET_LABEL.replace("{TLABEL}","Health:").replace("{TVALUE}",r)});omerta.character.progress.getTipForRankProgress=ko.computed(function(){var r=omerta.character.progress.rank_progress()+"%";return omerta.character.HTML_WIDGET_LABEL.replace("{TLABEL}","Rank Progress:").replace("{TVALUE}",r)});omerta.character.progress.getTipForKillSkill=ko.computed(function(){var r=omerta.character.progress.kill_skill()+"%";return omerta.character.HTML_WIDGET_LABEL.replace("{TLABEL}","Killing Skill:").replace("{TVALUE}",r)});omerta.character.progress.getTipForPoints=ko.computed(function(){var r=omerta.character.progress.leader_points();var e=omerta.character.progress.position();var a=omerta.character.HTML_WIDGET_LABEL.replace("{TLABEL}","Points:").replace("{TVALUE}",r);var a=a+"<br/>"+omerta.character.HTML_WIDGET_LABEL.replace("{TLABEL}","Position:").replace("{TVALUE}",e);return a});omerta.character.selectKnob=function(r,e){$("#widget_avatar").find(".selected").removeClass("selected");$(r).addClass("selected");omerta.character.widgets.avatar.selected(e);omerta.character.updateKnob(e)};omerta.character.updateKnob=function(r){var e="";if(typeof r==="string"&&r.length>0){e=r}else{e=omerta.character.widgets.avatar.selected()}var a=$("#widget_avatar #knob");var t=false;var c=false;switch(e){case"health":t="#960302";c=omerta.character.progress.health();break;case"rank_progress":t="#9ECB2D";c=omerta.character.progress.rank_progress();break;case"kill_skill":t="#1E3570";c=omerta.character.progress.kill_skill();break;case"ladder_points":t="#D89922";c=omerta.character.progress.leader_points_percentage();break}if(t!==false){a.trigger("configure",{fgColor:t}).val(c).trigger("change")}};omerta.character.progress.health.subscribe(function(r){omerta.character.updateKnob()});omerta.character.progress.kill_skill.subscribe(function(r){omerta.character.updateKnob()});omerta.character.progress.rank_progress.subscribe(function(r){omerta.character.updateKnob()});omerta.character.progress.leader_points_percentage.subscribe(function(r){omerta.character.updateKnob()});omerta.character.info.avatarBackground=ko.computed(function(){return"url("+omerta.character.info.avatar()+")"});omerta.GUI.container.getBackground=ko.computed(function(){var r=omerta.character.game.city()||"";r=r.replace(" ","");r=r.toLowerCase();return"url('/assets/omerta/main/layout/assets/img/city/backgrounds/"+r+".jpg')"},omerta.GUI.container);omerta.widgets.sidebar=$.extend({},omerta.framework.GUI,{name:"right_sidebar",load:function(){this.initSidebar();omerta.GUI.loader.loaded("right_sidebar")},initSidebar:function(){$("a[data-wtip]").tipsy({trigger:"hover",live:true,title:"data-wtip",gravity:"e",html:true,opacity:"1"})},updateNotifications:function(e,t,a){var i=$("[data-wtype="+e+"]");if(typeof i==="undefined"){return false}if(i.size()===0){return false}var r=i.find(".sidebar-bubble-number");var d=i.find(".sm-img-icon");if(t.length==0){r.addClass("hidden").removeClass("bubble-animated").text(0);if(i.hasClass("top-button")){i.removeClass("active")}return true}var s=r.text();r.text(a).removeClass("hidden");if(s!=a){r.addClass("bubble-animated")}if(i.hasClass("top-button")){i.addClass("active")}setTimeout(function(){r.removeClass("bubble-animated")},1e3)}});omerta.widgets.sidebar.load();omerta.chat={connection:null,buffer:ko.observable(""),nick:"",muc_domain:"",show:ko.observable(true),selected:ko.observable(""),windowStatus:ko.observable(2),model:{},utils:{}};omerta.chat.config={window:{STATUS_CLOSED:0,STATUS_MINIMIZED:1,STATUS_MAXIMIZED:2,HEIGHT:168,VISIBLE_USERLIST:false},user:{ROLE_MODERATOR:"moderator",ROLE_NONE:"none",ROLE_PARTICIPANT:"participant",ROLE_VISITOR:"visitor",AFF_OWNER:"owner",AFF_ADMIN:"admin",AFF_MEMBER:"member",AFF_OUTCAST:"outcast",AFF_NONE:"none"},channel:{CHAN_GENERAL:"general"}};omerta.chat.Parser=function(e){var r=$(e);this.parsePresence=function(){var e={};e.stanza="presence";var t=r.find("x item").first();var o=r.attr("from");var a=t.attr("jid");var i=r.attr("to");e.from={jid:o,domain:Strophe.getDomainFromJid(o),node:Strophe.getNodeFromJid(o),resource:Strophe.getResourceFromJid(o),bare:Strophe.getBareJidFromJid(o)};e.real={jid:a,domain:Strophe.getDomainFromJid(a),node:Strophe.getNodeFromJid(a),resource:Strophe.getResourceFromJid(a),bare:Strophe.getBareJidFromJid(a)};e.type=r.attr("type")||null;e.to={jid:i,domain:Strophe.getDomainFromJid(i),node:Strophe.getNodeFromJid(i),resource:Strophe.getResourceFromJid(i),bare:Strophe.getBareJidFromJid(o)};e.status=r.find("show").first().text();e.role=t.attr("role").toLowerCase()||null;e.affiliation=t.attr("affiliation").toLowerCase()||null;return e};this.parseMessage=function(){var e={};e.stanza="message";e.jid=r.attr("from");e.type=r.attr("type")||null;e.content=r.find("body").first().text();var t=r.attr("from");var o=r.attr("to");var a=r.find("delay");if(a.length>0){e.date=new Date(a.attr("stamp"));e.delayed=true}else{e.date=new Date;e.delayed=false}e.from={jid:t,domain:Strophe.getDomainFromJid(t),node:Strophe.getNodeFromJid(t),resource:Strophe.getResourceFromJid(t),bare:Strophe.getBareJidFromJid(t)};e.to={jid:o,domain:Strophe.getDomainFromJid(o),node:Strophe.getNodeFromJid(o),resource:Strophe.getResourceFromJid(o),bare:Strophe.getBareJidFromJid(t)};return e};this.parseIQ=function(){};if(r.is("presense"))return this.parsePresence();if(r.is("message"))return this.parseMessage();if(r.is("iq"))return this.parseIQ()};omerta.chat.UI={newMessage:ko.observable(false),isScrolledToBottom:function(t){if(t.scrollTop()>=t.prop("scrollHeight")-t.height()){return true}return false},updateScrollStatus:function(t){var o=$(this);if(omerta.chat.UI.isScrolledToBottom(o)&&o.is(":visible")){omerta.chat.UI.newMessage(false)}},notifyNewMessage:function(t){var o=$("#omerta_chat_room > div[data-room='"+t+"']");if(!o.length)return;if(omerta.chat.UI.isScrolledToBottom(o)){omerta.chat.utils.scrollChat(t,true,true)}omerta.chat.UI.newMessage(true)},windowIsMaximized:function(){return omerta.chat.windowStatus()===omerta.chat.config.window.STATUS_MAXIMIZED},windowIsMinimized:function(){return omerta.chat.windowStatus()===omerta.chat.config.window.STATUS_MINIMIZED},windowIsClosed:function(){return omerta.chat.windowStatus()===omerta.chat.config.window.STATUS_CLOSED}};omerta.chat.utils.oLastToggledDate=false;omerta.chat.utils.console_log=function(){this.console_log.force_output=this.console_log.force_output||false;this.console_log.history=this.console_log.history||[];this.console_log.history.push(arguments);if(chat.DEBUG===false&&this.console_log.force_output===false){this.console_log.history=this.console_log.history.slice(-20);return null}if(typeof console==="undefined"){return null}if(typeof console.log==="undefined"){return null}console.log(Array.prototype.slice.call(arguments))};omerta.chat.storeGet=function(t){$.cookie.json=true;var e=$.cookie("ochat");$.cookie.json=false;if(typeof t!=="undefined"&&typeof e==="object"){if(typeof e[t]==="undefined"){return null}return e[t]}return e||{}};omerta.chat.storeSet=function(t,e){var o=omerta.chat.storeGet();o[t]=e;$.cookie.json=true;$.cookie("ochat",o,{path:"/"});$.cookie.json=false;if(typeof localStorage==="object"){localStorage.setItem("omerta:chat:"+t,e.toString())}return true};omerta.chat.utils.get_port_string=function(t){if(!t){return""}return":"+t};omerta.chat.utils.getConferenceUrl=function(t){t=t.toLowerCase();return t+"@"+omerta.chat.muc_domain};omerta.chat.utils.toggleChat=function(t){if(typeof t==="object"&&typeof omerta.chat.utils.oLastToggledDate==="object"){var e=(new Date).getTime()-omerta.chat.utils.oLastToggledDate.getTime();if(e<=1500){return false}}var o=omerta.chat.show();if(o){if(omerta.chat.UI.windowIsMaximized()){omerta.chat.config.window.HEIGHT=$("#omerta_chat").height()}omerta.chat.show(false);omerta.chat.storeSet("visible",false)}else{omerta.chat.show(true);omerta.chat.storeSet("visible",true)}omerta.chat.utils.oLastToggledDate=new Date};omerta.chat.utils.scrolls={room:[],users:null};omerta.chat.utils.scrollChat=function(t,e,o){if(typeof t!=="string"){t=Strophe.getNodeFromJid(omerta.chat.data.selected());e=true;o=true}var r=$("#omerta_chat_room > div[data-room='"+t+"']");if(!r.length)return;omerta.chat.utils.scroll("room",t,r,e,o)};omerta.chat.utils.scrollUser=function(t){$el=$(".chat-active-users[data-room='"+t+"']");if(!$el.length)return;if(!$el.data("perfectScrollbar"))$el.perfectScrollbar({suppressScrollX:true,includePadding:true});else $el.perfectScrollbar("update")};omerta.chat.utils.scroll=function(t,e,o,r,a){if(omerta.chat.utils.scrolls[t][e])clearTimeout(omerta.chat.utils.scrolls[t][e]);omerta.chat.utils.scrolls[t][e]=setTimeout(function(){if(o.data("perfectScrollbar")){var t=o[0].scrollHeight;if(r){if(a)o.animate({scrollTop:t},"slow");else o.scrollTop(t)}o.perfectScrollbar("update")}else{o.perfectScrollbar({suppressScrollX:true,includePadding:true});o.scroll(omerta.chat.UI.updateScrollStatus)}omerta.chat.UI.newMessage(false)}.bind(o,r,a),250)};omerta.chat.utils.hasUrls=function(t){var e=/(https?:\/\/[^\s]+)/g;var o=new RegExp(e);return o.test(t)};omerta.chat.model.Component=function(e,t,r,n,o){var e=e;var t=t+"";var n=n||{};var o=o||new Date;var r=ko.observableArray([]);var s=ko.observableArray([]);this.events={presence:function(e){var t=omerta.chat.Parser(e);if(t.real===null)return;this.addUser(new omerta.chat.model.User(t.from.jid,t.from.node,t.status,t.role,t.affiliation));return true},message:function(e){return true}};this.getJid=function(){return e};this.getName=function(){return t};this.getUsers=function(){return r};this.getMessages=function(){return s};this.getSettings=function(){return n};this.getJoinedDate=function(){return o};this.getUserCount=function(){return this.getUsers().length};this.addUser=function(e){if(typeof e==omerta.chat.model.User)r.push(e)};this.removeUser=function(e,t){r.remove(function(t){return t.getName()==e});if(t)s.remove(function(t){return t.from.getName()==e})};this.removeMessage=function(e){s.remove(function(t){return t.getId()==e})};this.findUser=function(e){for(i in this.getUsers()())if(r[i].getName()==e)return r[i]}};omerta.chat.model.Message=function(e,t,a,r,o,s){var e=e;var i=r+"";var t=t;var a=a||null;var o=o||0;var s=s||false;this.getType=function(){return e};this.getMessage=function(){return i};this.getFrom=function(){return t};this.getTo=function(){return a};this.getDate=function(){return o};this.isDelayed=function(){return s};this.getDateString=function(){return this.getDate()==0?"":this.getDate().toDateString()};this.toHTML=function(){var e={};if(!this.getFrom().nick){e.name=this.getFrom().ucfirst();e.role="offline"}else{e.name=this.getFrom().nick.ucfirst();e.role=this.getFrom().role.toLowerCase();if(e.role==omerta.chat.config.user.ROLE_MODERATOR)e.role+="-"+this.getFrom().affiliation.toLowerCase()}var t={};t.body=this.getMessage();t.time=this.getDateString();e.gameRole="";e.gameTextColor="gray";e.gameNicknameColor=false;switch(e.role){case omerta.chat.config.user.ROLE_MODERATOR+"-"+omerta.chat.config.user.AFF_ADMIN:case omerta.chat.config.user.ROLE_MODERATOR+"-"+omerta.chat.config.user.AFF_OWNER:e.gameRole="[ADMIN] ";e.gameTextColor="ffffff";break;case omerta.chat.config.user.ROLE_PARTICIPANT:case omerta.chat.config.user.ROLE_VISITOR:case omerta.chat.config.user.ROLE_NONE:var a=0;var r=omerta.users();var o={};for(a in r){if(r[a].name.toLowerCase()===e.name.toLowerCase()){o=r[a];if(o.dc_status>0){e.gameTextColor=o.dc_status>=2?"dabf27":"ececec"}break}}if(typeof o.family!=="undefined"&&_.isObject(o.family)){e.gameRole=o.family.role==="Member"?"":o.family.role+" ";e.gameNicknameColor=o.family.color}break}var s=$(document.createElement("div"));var i=$(document.createElement("a")).attr("href","/user.php?name="+e.name).addClass("chat-sender-"+e.role).text(e.gameRole+e.name);if(e.gameNicknameColor){i.addClass("label-background");i.css("backgroundColor",colorSetHexaOpactiy(e.gameNicknameColor,.75));i.css("color",colorGetContrastYIQ(e.gameNicknameColor))}s.append(i);s.append($(document.createElement("span")).addClass("chat-message-text").text(": "+this.getMessage()).css("color","#"+e.gameTextColor));return s.html()}};omerta.chat.model.Private=function(e,t,n,o){var a=new omerta.chat.model.Component(e,t.settings,o);a.addMessage=function(e,t,n,o,a){return true};a.sendMessage=function(e){omerta.chat.connection.muc.send(a.getJid(),e)};return a};omerta.chat.model.Room=function(e){var e=e;var r=Strophe.getNodeFromJid(e);var t=ko.observableArray([]);var a=ko.observableArray([]);var o=false;this.getJid=function(){return e};this.getName=function(){return r};this.getUsers=function(){return t};this.getMessages=function(){return a};this.toHTML=function(){if(e===omerta.chat.utils.getConferenceUrl(omerta.chat.config.channel.CHAN_GENERAL)){return'<img src="/assets/omerta/main/layout/assets/img/chat/omerta.png" />'}var t=r.substr(7);return $("<div></div>").text(t).html()};this.events={message:function(e,r){var t=new omerta.chat.Parser(e);if(t.from.resource){var o=r.roster[t.from.resource]||t.from.resource;a.push(new omerta.chat.model.Message("groupchat",o,t.to,t.content,t.date,t.delayed))}return true},roster:function(e,r){var a=[];for(i in e){var o=0;var n=omerta.users();var s={};for(o in n){if(n[o].name.toLowerCase()===i.toLowerCase()){s=n[o];break}}var f="transparent";var c="FFFFFF";var l="";var u=false;if(typeof s.family!=="undefined"&&_.isObject(s.family)){l=s.family.role==="Member"?"":s.family.role+" ";f=s.family.color;c=colorGetContrastYIQ(f);u=true}if(e[i].affiliation.toLowerCase()===omerta.chat.config.user.AFF_ADMIN||e[i].affiliation.toLowerCase()===omerta.chat.config.user.AFF_OWNER){l="[ADMIN] "}var m=e[i].affiliation.toLowerCase();var h="chat-sender-"+e[i].role.toLowerCase()+"-"+m;if(u){h+=" label-background"}a.push({gameRole:l,name:i.ucfirst(),role:e[i].role.toLowerCase(),affiliation:m,className:h,hasFamily:u,gameContrastColor:c,gameColor:colorSetHexaOpactiy(f,.75)})}a.sort(function(e,r){if(e.role==r.role&&e.affiliation==r.affiliation)return e.name<r.name?-1:1;if(e.role==omerta.chat.config.user.ROLE_MODERATOR&&r.role==e.role){if(e.affiliation==omerta.chat.config.user.AFF_OWNER)return-1;if(r.affiliation==omerta.chat.config.user.AFF_OWNER)return 1;if(e.affiliation==omerta.chat.config.user.AFF_ADMIN)return-1;if(r.affiliation==omerta.chat.config.user.AFF_ADMIN)return 1;if(e.affiliation==omerta.chat.config.user.AFF_MEMBER)return-1;if(r.affiliation==omerta.chat.config.user.AFF_MEMBER)return 1;return 1}return e.role==omerta.chat.config.user.ROLE_MODERATOR?-1:1});t(a);return true}};omerta.chat.connection.muc.join(e,omerta.chat.nick,this.events.message,null,this.events.roster);t.subscribe(function(){if(e===omerta.chat.data.selected()){omerta.chat.utils.scrollUser(r)}});a.subscribe(function(t){if(e!==omerta.chat.data.selected()){return null}if(t.length===0){return null}var a=t[t.length-1];if(a===o){return null}if(o){if(o.getDate().getTime()===a.getDate().getTime()){return null}}o=a;var i=o.getFrom();var n=typeof i==="object"&&i.nick.toLocaleString()===omerta.chat.nick.toLowerCase();if(o.isDelayed()===true||n){omerta.chat.utils.scrollChat(r,true,true)}else{omerta.chat.UI.notifyNewMessage(r)}})};omerta.chat.model.User=function(t,n,r,e,i){var t=t;var n=n+"";var u=r;var a="";var e=e;var i=i;this.getJid=function(){return t};this.getName=function(){return n};this.getStatus=function(){return u};this.getRole=function(){return e};this.getAffiliation=function(){return i}};omerta.chat.Parser=function(e){var r=$(e);this.parsePresence=function(){var e={};e.stanza="presence";var t=r.find("x item").first();var o=r.attr("from");var a=t.attr("jid");var i=r.attr("to");e.from={jid:o,domain:Strophe.getDomainFromJid(o),node:Strophe.getNodeFromJid(o),resource:Strophe.getResourceFromJid(o),bare:Strophe.getBareJidFromJid(o)};e.real={jid:a,domain:Strophe.getDomainFromJid(a),node:Strophe.getNodeFromJid(a),resource:Strophe.getResourceFromJid(a),bare:Strophe.getBareJidFromJid(a)};e.type=r.attr("type")||null;e.to={jid:i,domain:Strophe.getDomainFromJid(i),node:Strophe.getNodeFromJid(i),resource:Strophe.getResourceFromJid(i),bare:Strophe.getBareJidFromJid(o)};e.status=r.find("show").first().text();e.role=t.attr("role").toLowerCase()||null;e.affiliation=t.attr("affiliation").toLowerCase()||null;return e};this.parseMessage=function(){var e={};e.stanza="message";e.jid=r.attr("from");e.type=r.attr("type")||null;e.content=r.find("body").first().text();var t=r.attr("from");var o=r.attr("to");var a=r.find("delay");if(a.length>0){e.date=new Date(a.attr("stamp"));e.delayed=true}else{e.date=new Date;e.delayed=false}e.from={jid:t,domain:Strophe.getDomainFromJid(t),node:Strophe.getNodeFromJid(t),resource:Strophe.getResourceFromJid(t),bare:Strophe.getBareJidFromJid(t)};e.to={jid:o,domain:Strophe.getDomainFromJid(o),node:Strophe.getNodeFromJid(o),resource:Strophe.getResourceFromJid(o),bare:Strophe.getBareJidFromJid(t)};return e};this.parseIQ=function(){};if(r.is("presense"))return this.parsePresence();if(r.is("message"))return this.parseMessage();if(r.is("iq"))return this.parseIQ()};omerta.chat.UI={newMessage:ko.observable(false),isScrolledToBottom:function(t){if(t.scrollTop()>=t.prop("scrollHeight")-t.height()){return true}return false},updateScrollStatus:function(t){var o=$(this);if(omerta.chat.UI.isScrolledToBottom(o)&&o.is(":visible")){omerta.chat.UI.newMessage(false)}},notifyNewMessage:function(t){var o=$("#omerta_chat_room > div[data-room='"+t+"']");if(!o.length)return;if(omerta.chat.UI.isScrolledToBottom(o)){omerta.chat.utils.scrollChat(t,true,true)}omerta.chat.UI.newMessage(true)},windowIsMaximized:function(){return omerta.chat.windowStatus()===omerta.chat.config.window.STATUS_MAXIMIZED},windowIsMinimized:function(){return omerta.chat.windowStatus()===omerta.chat.config.window.STATUS_MINIMIZED},windowIsClosed:function(){return omerta.chat.windowStatus()===omerta.chat.config.window.STATUS_CLOSED}};omerta.chat.utils.oLastToggledDate=false;omerta.chat.utils.console_log=function(){this.console_log.force_output=this.console_log.force_output||false;this.console_log.history=this.console_log.history||[];this.console_log.history.push(arguments);if(chat.DEBUG===false&&this.console_log.force_output===false){this.console_log.history=this.console_log.history.slice(-20);return null}if(typeof console==="undefined"){return null}if(typeof console.log==="undefined"){return null}console.log(Array.prototype.slice.call(arguments))};omerta.chat.storeGet=function(t){$.cookie.json=true;var e=$.cookie("ochat");$.cookie.json=false;if(typeof t!=="undefined"&&typeof e==="object"){if(typeof e[t]==="undefined"){return null}return e[t]}return e||{}};omerta.chat.storeSet=function(t,e){var o=omerta.chat.storeGet();o[t]=e;$.cookie.json=true;$.cookie("ochat",o,{path:"/"});$.cookie.json=false;if(typeof localStorage==="object"){localStorage.setItem("omerta:chat:"+t,e.toString())}return true};omerta.chat.utils.get_port_string=function(t){if(!t){return""}return":"+t};omerta.chat.utils.getConferenceUrl=function(t){t=t.toLowerCase();return t+"@"+omerta.chat.muc_domain};omerta.chat.utils.toggleChat=function(t){if(typeof t==="object"&&typeof omerta.chat.utils.oLastToggledDate==="object"){var e=(new Date).getTime()-omerta.chat.utils.oLastToggledDate.getTime();if(e<=1500){return false}}var o=omerta.chat.show();if(o){if(omerta.chat.UI.windowIsMaximized()){omerta.chat.config.window.HEIGHT=$("#omerta_chat").height()}omerta.chat.show(false);omerta.chat.storeSet("visible",false)}else{omerta.chat.show(true);omerta.chat.storeSet("visible",true)}omerta.chat.utils.oLastToggledDate=new Date};omerta.chat.utils.scrolls={room:[],users:null};omerta.chat.utils.scrollChat=function(t,e,o){if(typeof t!=="string"){t=Strophe.getNodeFromJid(omerta.chat.data.selected());e=true;o=true}var r=$("#omerta_chat_room > div[data-room='"+t+"']");if(!r.length)return;omerta.chat.utils.scroll("room",t,r,e,o)};omerta.chat.utils.scrollUser=function(t){$el=$(".chat-active-users[data-room='"+t+"']");if(!$el.length)return;if(!$el.data("perfectScrollbar"))$el.perfectScrollbar({suppressScrollX:true,includePadding:true});else $el.perfectScrollbar("update")};omerta.chat.utils.scroll=function(t,e,o,r,a){if(omerta.chat.utils.scrolls[t][e])clearTimeout(omerta.chat.utils.scrolls[t][e]);omerta.chat.utils.scrolls[t][e]=setTimeout(function(){if(o.data("perfectScrollbar")){var t=o[0].scrollHeight;if(r){if(a)o.animate({scrollTop:t},"slow");else o.scrollTop(t)}o.perfectScrollbar("update")}else{o.perfectScrollbar({suppressScrollX:true,includePadding:true});o.scroll(omerta.chat.UI.updateScrollStatus)}omerta.chat.UI.newMessage(false)}.bind(o,r,a),250)};omerta.chat.utils.hasUrls=function(t){var e=/(https?:\/\/[^\s]+)/g;var o=new RegExp(e);return o.test(t)};omerta.chat.init=function(){omerta.chat.init.isChatEnabled=omerta.chat.storeGet("visible");if(omerta.chat.init.isChatEnabled===false){omerta.chat.utils.toggleChat()}window.addEventListener("storage",omerta.chat.events.storageGet,false);omerta.chat.data.connect()};omerta.chat.events={connect:function(t){omerta.chat.data.status(t);if(t===Strophe.Status.CONNECTED||t===Strophe.Status.ATTACHED){if(omerta.chat.init.isChatEnabled!==false){omerta.chat.data.join(omerta.chat.utils.getConferenceUrl(omerta.chat.config.channel.CHAN_GENERAL))}omerta.chat.connection.addHandler(omerta.chat.events.message,null,"message",null,null,null)}},roomMessage:function(t){return true},roomPresence:function(t){return false},presence:function(t){return true},message:function(t){return true},storageGet:function(t){if(t.newValue!=="undefined"){switch(t.key){case"omerta:chat:visible":var e=t.newValue=="true"?true:false;omerta.chat.show(e);break}}}};omerta.chat.data={status:ko.observable(Strophe.Status.CONNECTING),input:ko.observable(""),components:ko.observableArray(),selected:ko.observable(""),connect:function(){var t=$.ajax("/",{dataType:"json",data:{module:"Chat",action:"Prebind"}});t.success(function(t){if(t.refresh_page)return location.reload();if(t.success!==true)return false;omerta.chat.nick=t.fullname;omerta.chat.muc_domain=t.muc_domain;omerta.chat.connection=new Strophe.Connection("/chat");omerta.chat.connection.attach(t.jid,t.sid,parseInt(t.rid,10),omerta.chat.events.connect)});t.fail(function(){$(".omerta-chat-loading, .omerta-chat-menu-item").hide()})},disconnect:function(){if(!omerta.chat.connection)return;omerta.chat.connection.sync=true;omerta.chat.connection.flush();omerta.chat.connection.disconnect()},join:function(t,e){var a=Strophe.getNodeFromJid(t);var o=omerta.chat.data.findComponent(t);if(o){return true}omerta.chat.data.components.push(new omerta.chat.model.Room(t,a,{}));if(!e)omerta.chat.data.selected(t)},part:function(t){var e=omerta.chat.data.components();if(e.length===0){return}var a=0;for(a in e){if(e[a].getJid()===t){omerta.chat.connection.muc.leave(t,omerta.chat.nick,function(t){},"Closed web client");setTimeout(function(){omerta.chat.data.components.remove(function(e){return e.getJid()==t})},500);break}}},send:function(){var t=omerta.chat.data.input();if(t.length===0){return null}if(omerta.chat.utils.hasUrls(t)){alert("Message must not contain URLs");return false}omerta.chat.connection.muc.groupchat(omerta.chat.data.selected(),t,null);omerta.chat.data.input("")},controls:{scrollBot:function(){},userlist:function(t,e){if(typeof e==="object"){e.preventDefault()}var a=$("#userlist"),o=$(".chat-user-container");if(a.is(":animated")){a.stop()}if(a.is(":visible")){o.hide();$("#userlist").show("slow").animate({left:"0px",width:"0px"},function(){$(this).hide()})}else{$("#userlist").show("slow").animate({left:"-104px",width:"100px"},function(){o.fadeIn(400,function(){$("#userlist .chat-user-container > .chat-active-users:visible").perfectScrollbar("update")})})}return true},minimize:function(t,e){if(typeof e==="object"){e.preventDefault()}var a=function(){var t=$("#omerta_chat");t.animate({height:"18px"});omerta.chat.windowStatus(omerta.chat.config.window.STATUS_MINIMIZED);omerta.chat.config.window.HEIGHT=t.height()};var o=$("#userlist");if(o.is(":visible")){$(".chat-user-container").hide();o.show("slow").animate({left:"0px",width:"0px"},function(){$(this).hide();a();omerta.chat.config.window.VISIBLE_USERLIST=true})}else{a();omerta.chat.config.window.VISIBLE_USERLIST=false}},maximize:function(t,e){if(typeof e==="object"){e.preventDefault()}var a=$("#omerta_chat");a.animate({height:omerta.chat.config.window.HEIGHT+"px"},function(){if(omerta.chat.config.window.VISIBLE_USERLIST){omerta.chat.data.controls.userlist(t,e)}});omerta.chat.windowStatus(omerta.chat.config.window.STATUS_MAXIMIZED);omerta.chat.config.window.HEIGHT=a.height()}},findComponent:function(t){var e=omerta.chat.data.components();var a=0;for(a in e){if(e[a].getJid()===t)return e[a]}}};omerta.chat.data.getActiveTabMessages=function(){if(omerta.chat.data.selected()==="")return[];return omerta.chat.data.findComponent(omerta.chat.data.selected()).getMessages()};omerta.chat.loading=ko.computed(function(){return this.data.status()!=Strophe.Status.ATTACHED&&this.data.status()!=Strophe.Status.CONNECTED},omerta.chat);omerta.chat.show.subscribe(function(t){if(t){omerta.chat.data.join(omerta.chat.utils.getConferenceUrl(omerta.chat.config.channel.CHAN_GENERAL));omerta.chat.utils.scrollChat();omerta.chat.data.controls.maximize()}else{omerta.chat.data.part(omerta.chat.utils.getConferenceUrl(omerta.chat.config.channel.CHAN_GENERAL));omerta.chat.windowStatus(omerta.chat.config.window.STATUS_CLOSED)}});omerta.chat.data.selected.subscribe(function(t){var e=Strophe.getNodeFromJid(t);omerta.chat.utils.scrollChat(e);omerta.chat.utils.scrollUser(e)});jQuery(document).ready(function(t){t(document).on("click tap",".toggler-action",omerta.chat.utils.toggleChat);t(window).unload(omerta.chat.data.disconnect);omerta.chat.init()});omerta.widgets.EOG=_.extend(omerta.core.Widget,{showWidget:ko.observable(false),data:ko.observable({city:-1,cityname:"",family:0,familyname:"",percentage:0,status:"",reset_since:0}),element:null,clock:null,init:function(e){if(typeof e!=="object"){this.showWidget(false);return}this.element=$("#countdown");e.timeleft=parseInt(e.timeleft)||0;e.reset_since=parseInt(e.reset_since)||0;if(e.status==="dead"&&e.reset_since==0){this.showWidget(false);return}if(e.status==="alive"&&e.percentage<100&&e.timeleft==0){this.showWidget(false);return}if(e.reset_since==0){if(_.isNull(this.clock)){this.clock=$("#reset-clock").FlipClock(e.timeleft,{clockFace:"hourlycounter",countdown:true,showSeconds:true})}else{this.clock.setTime(e.timeleft)}}this.data(e);this.showWidget(true)},roundVersion:function(){return omerta.roundVersion()},enableDetails:function(){this.element.stop().animate({top:"0px"},"slow")},disableDetails:function(){this.element.stop().animate({top:"-51px"},"slow")},redirectToMap:function(){omerta.GUI.container.loadPage("/?module=City&eog_city=true")},redirectToFamily:function(){omerta.GUI.container.loadPage("/family.php?fam="+this.data().family)}});omerta.widgets.EOG.getClass=ko.computed(function(){if(typeof omerta.widgets.EOG.data().city==="undefined"){return"city"}var e=omerta.widgets.EOG.data().city;return"city cd-"+e},omerta.widgets.EOG);omerta.modules.Detectives={load:function(){$(document).on("submit","form[data-shoot]",function(e){var t=$(this).attr("data-action");var o=$(this).serialize();$("#game_container").animate({scrollTop:0},"fast","swing",function(){omerta.modules.Detectives.GUI.form[t](o)});e.preventDefault();return false});$(document).on("submit","form[data-backfire]",function(e){var t=$(this).attr("data-action");var o=$(this).serialize();$("#game_container").animate({scrollTop:0},"fast","swing",function(){omerta.modules.Detectives.GUI.form[t](o)});e.preventDefault();return false});$(document).on("submit","#detectives-search-div",function(e){var t=$(this).attr("data-action");var o=$(this).serialize();$("#game_container").animate({scrollTop:0},"fast","swing",function(){omerta.modules.Detectives.GUI.form[t](o)});e.preventDefault();return false});$(document).on("click","[name^='dets']",function(e){var t=$(this).attr("data-action");var o="id="+$(this).attr("data-id");if(t=="fire"){omerta.modules.Detectives.GUI.events[t](o)}e.preventDefault();return false});$(document).on("keyup","#detectives-minutes-input",function(e){var t=parseInt($(this).val(),10);omerta.modules.Detectives.GUI.events["shcost"](t);e.preventDefault();return false});$(document).on("submit","#detectives-safehouse-form",function(e){var t=$(this).attr("data-action");var o=$(this).serialize();if(t=="safehouse"){omerta.modules.Detectives.GUI.form[t](o)}e.preventDefault();return false});$(document).on("click","#detectives-remove-button",function(e){var t=$(this).attr("data-action");var o="sessionToken="+$(this).attr("data-session");if(t=="fireAll"){omerta.modules.Detectives.GUI.events[t](o)}e.preventDefault();return false})},GUI:{events:{fire:function(e){$.post("/BeO/webroot/?module=Detectives&action=fire",e,function(e){var t=e.data;omerta.modules.Detectives.GUI.events.fireCB(t)},"json")},fireCB:function(e){var t=omerta.modules.Detectives.GUI.form.popupPos();var o;if(e.status!="OK"){o=e.message;$.prompt({message:{title:"Error",html:o,position:t,buttons:{OK:0}}})}else{omerta.GUI.container.loadPage("/BeO/webroot/?module=Detectives&action=display")}},fireAll:function(e){$.post("/BeO/webroot/?module=Detectives&action=fireAll",e,function(e){var t=e.data;omerta.modules.Detectives.GUI.events.fireAllCB(t)},"json")},fireAllCB:function(e){var t=omerta.modules.Detectives.GUI.form.popupPos();var o;if(e.status!="OK"){o=e.message;$.prompt({message:{title:"Error",html:o,position:t,buttons:{OK:0}}})}else{omerta.GUI.container.loadPage("/BeO/webroot/?module=Detectives&action=display")}},shcost:function(e){var t=$("#detectives-shcost-label");var o=e*e*100;t.text("$"+(isNaN(o)?0:o))}},form:{backfire:function(e){$.post("/BeO/webroot/?module=Detectives&action=backfire",e,function(e){var t=e.data;omerta.modules.Detectives.GUI.form.backfireCB(t)},"json")},backfireCB:function(e){var t=omerta.modules.Detectives.GUI.form.popupPos();var o=e.message;$.prompt({message:{title:"Backfire",html:o,position:t,buttons:{OK:0}}})},hire:function(e){},hireCB:function(e){if(e.status=="OK"){var t=$.prompt.getStateContent("Hired");$(t).find(".jqimessage").text(e.message);$.prompt.goToState("Hired");omerta.GUI.container.loadPage("/BeO/webroot/?module=Detectives&action=display")}else{var t=$.prompt.getStateContent("message");$(t).find(".jqimessage").text(e.message);$.prompt.goToState("message")}},popupPos:function(){var e={container:"",x:0,y:0,width:350,arrow:0};return e},search:function(e){$.post("/BeO/webroot/?module=Detectives&action=search",e,function(e){var t=e.data;omerta.modules.Detectives.GUI.form.searchCB(t)},"json")},searchCB:function(e){var t=omerta.modules.Detectives.GUI.form.popupPos();var o;if(e.status!="OK"){o=e.message;$.prompt({message:{title:"Error",html:o,position:t,buttons:{OK:0}}})}else{$.prompt({form:omerta.plugins.popups.generateForm("Detectives","hire",{title:"Hire Detectives",buttons:{Cancel:0,Hire:1},pos:{container:"",x:0,y:0,width:350},html:e.content,callback:omerta.modules.Detectives.GUI.form.hireCB}),message:{title:"Error",html:"",buttons:{OK:0},position:{container:"",x:0,y:0,width:350}},Hired:{title:"Hired",html:"",buttons:{OK:0},position:{container:"",x:0,y:0,width:350}}});var a=$("#totalAmount");var s=$("input[name^='detectives']");var i=e.price;var r=$("select[name^='hours']");var n=$("#allCityHours");var c=$("#allCities");function m(){var e=0;s.each(function(t){e+=parseInt($(this).val()*i*r.eq(t).val(),10)});a.text(e)}function u(){var e=0;r.each(function(t){e+=parseInt(s.eq(t).val()*i*$(this).val(),10)});a.text(e)}function l(){var e=0;s.each(function(t){s.val(c.val());e+=parseInt(c.val()*i*r.eq(t).val(),10)});a.text(e)}function v(){var e=0;r.each(function(t){r.val(n.val());e+=parseInt(n.val()*i*s.eq(t).val(),10)});a.text(e)}s.change(m);r.change(u);c.change(l);n.change(v)}},safehouse:function(e){$.post("/BeO/webroot/?module=Detectives&action=safehouse",e,function(e){var t=e.data;omerta.modules.Detectives.GUI.form.safehouseCB(t)},"json")},safehouseCB:function(e){if(e.status!="OK"){var t=omerta.modules.Detectives.GUI.form.popupPos();var o=e.message;$.prompt({message:{title:"Safehouse",html:o,position:t,buttons:{OK:0}}})}else{omerta.GUI.container.loadPage("/bank.php")}},shoot:function(e){$.post("/BeO/webroot/?module=Detectives&action=shoot",e,function(e){var t=e.data;omerta.modules.Detectives.GUI.form.shootCB(t)},"json")},shootCB:function(e){var t=omerta.modules.Detectives.GUI.form.popupPos();var o;if(e.status!="OK"){o=e.message;$.prompt({message:{title:"Error",html:o,position:t,buttons:{OK:0}}});$("#ver").val("");$("#imgcode").click()}else{o=e.message;$.prompt({message:{title:"Outcome",html:o,position:t,buttons:{OK:0}}});omerta.GUI.container.loadPage("/BeO/webroot/?module=Detectives&action=display")}}}}};omerta.modules.Lackeys={config:{1:{name:"Spats",pos:{x:170,y:10,arrow:"lt"}},2:{name:"Noodles",pos:{x:-225,y:15,arrow:"rt"}},3:{name:"O'Rourke",pos:{x:-250,y:0,arrow:"rt"}},4:{name:"Freekowtski",pos:{x:-250,y:10,arrow:"rt"}},5:{name:"Keaton",pos:{x:150,y:5,arrow:"lt"}},6:{name:"Sluggs",pos:{x:250,y:30,arrow:"lt"}}},input:{l_credits:100,l_money:0},data:{updating:false},load:function(){$(document).on("submit","form[data-lackey]",function(e){var t=$(this).attr("data-action");var a=$(this).attr("data-lackey");var o=$(this).serialize();$("#game_container").animate({scrollTop:0},"fast","swing",function(){omerta.modules.Lackeys.GUI.form[t](a,o)});e.preventDefault();return false});$(document).on("click","input[data-lackey]",function(e){var t=$(this).attr("data-action");var a=$(this).attr("data-lackey");if(t=="items_selectAll"){var o=this.checked;$("input[data-lackeyItem]").attr("checked",o)}if(a=="user"){if(t=="addCredits"){omerta.modules.Lackeys.GUI.form[t]()}}else{if(t=="hire"||t=="fire"||t=="send"||t=="buyout"){$parentDiv=$("#game_container");var s=$parentDiv.scrollTop()+$(this).position().top-$parentDiv.height()/2+$(this).height()/2;$parentDiv.animate({scrollTop:s},"fast","swing",function(){omerta.modules.Lackeys.GUI.form[t](a)})}}})},update:function(e){if(!e)if(omerta.modules.Lackeys.data.updating)return;omerta.modules.Lackeys.data.updating=true;var t="";if($("table[data-info=log][data-lackey]").length==1){var a=$("table[data-info=log][data-lackey]").attr("data-lackey");var o=$("table[data-info=log][data-lackey]").find("tr:first").attr("data-logid");t="&lackey="+a+"&log="+o}$.getJSON("/BeO/webroot/?module=Lackeys&action=status"+t,null,omerta.modules.Lackeys.updateCB)},updateCB:function(e){var t=e.data;var a=true;for(lackey in t){if(!t[lackey].change){a=false;continue}omerta.modules.Lackeys.GUI.events.update(lackey,t[lackey])}if(!a){omerta.timers.lackeys=setTimeout(function(){omerta.modules.Lackeys.update(true)},5e3);return}omerta.modules.Lackeys.data.updating=false},GUI:{events:{fired:function(e){omerta.GUI.container.loadPage("/BeO/webroot/?module=Lackeys&action=tab&type="+e)},hired:function(e){$("*[data-lackey="+e+"][data-hired=true]").show();$("*[data-lackey="+e+"][data-hired=false]").hide();omerta.modules.Lackeys.GUI.events.freed(e)},jail:function(e){$("*[data-lackey="+e+"][data-jail=true]").show();$("*[data-lackey="+e+"][data-jail=false]").hide()},freed:function(e){$("*[data-lackey="+e+"][data-jail=true]").hide();$("*[data-lackey="+e+"][data-jail=false]").show()},update:function(e,a){if(!a)return;if(a.status)if(a.status.fired)return omerta.modules.Lackeys.GUI.events.fired(e);if(a.status.jail)omerta.modules.Lackeys.GUI.events.jail(e);else omerta.modules.Lackeys.GUI.events.freed(e);for(i in a.stats)$("*[data-lackey="+e+"][data-info="+i+"]").text(a.stats[i]);for(t in a.timers)$("*[data-lackey="+e+"][data-info=time_"+t+"]").attr("data-timeleft",a.timers[t]);if(a.log){var o=$("table[data-info=log][data-lackey="+e+"]");for(lg in a.log){var s=lg;var r=a.log[lg].time;var n=a.log[lg].entry;var l='<tr data-logid="'+s+'">\n'+"  <td>"+r+"</td>\n"+"  <td>"+n+"</td>\n"+"</tr>";o.find("tr:first").before(l)}}}},form:{popupPos:function(e){var t={container:"*[data-lackey="+e+'][data-info="face"]',x:omerta.modules.Lackeys.config[e].pos.x,y:omerta.modules.Lackeys.config[e].pos.y,width:350,arrow:omerta.modules.Lackeys.config[e].pos.arrow};return t},addCredits:function(){$.prompt({form:omerta.plugins.popups.generateForm("Lackeys","add_credits",{title:"Add credits",buttons:{Cancel:0,Add:1},pos:{container:"#lackey_credits_available",x:150,y:0,width:350},html:"Enter the donate codes you want to trade for action credits here.<br> Only one per line and 2 at once allowed.<br><br>"+"Each donate code is worth 5000 action credits.<br><br>"+"<sup><b>Note</b>: Once you have used a donate code for Lackey credits, you cannot use it for DC or DC+ status, or SMS credits</sup><br />"+'<label><textarea data-number=true rows="5"  style="resize: none; width: 100%;" name="dcs"></textarea></label><br />',callback:omerta.modules.Lackeys.GUI.form.addCreditsCB}),message:{title:"Add credits",html:"",buttons:{OK:0},position:{container:"#lackey_credits_available",x:150,y:0,width:350}}})},addCreditsCB:function(e){var t=$.prompt.getStateContent("message");$(t).find(".jqimessage").text(e.message);$.prompt.goToState("message");if(e.credits){$("#lackey_credits_available").text(e.credits)}else{$("#lackey_credits_available").text("0")}},hire:function(e){var t=omerta.modules.Lackeys.GUI.form.popupPos(e);$.prompt({hello:{title:omerta.modules.Lackeys.config[e].name,html:"I heard you were looking for me...<br /><br />"+"Now that you found me... <br />"+"What do you have to offer?<br />",buttons:{Nothing:0,Offer:1},position:t,focus:1,submit:function(e,t,a,o){if(t==1){$.prompt.goToState("form");e.preventDefault();return false}}},form:omerta.plugins.popups.generateForm("Lackeys","hire",{title:"Your offer for "+omerta.modules.Lackeys.config[e].name,buttons:{Cancel:0,Hire:1},html:"So... You want to hire me? What is your offer?<br />"+'<label><span style="width: 125px; float: left; clear: both;">Credits</span> <input size="4"     value="'+omerta.modules.Lackeys.input.l_credits+'"    type="text" data-number=true name="l_credits" value=""></label><br />'+'<label><span style="width: 115px; float: left; clear: both;">Money</span>   $ <input size="10"  value="'+omerta.modules.Lackeys.input.l_money+'"      type="text" data-number=true name="l_money"   value=""></label><br />',pos:t,callback:omerta.modules.Lackeys.GUI.form.hireCB},{lackey:e}),formSuccess:{title:omerta.modules.Lackeys.config[e].name,html:"Hey there, Boss!<br />"+"I'm starting to work right now.<br /><br>"+"<sub>(To change "+omerta.modules.Lackeys.config[e].name+" settings, navigate on menu: Lackeys)</sub><br />",buttons:{OK:0},position:t},message:{title:omerta.modules.Lackeys.config[e].name,html:"",position:t,buttons:{OK:0}}})},hireCB:function(e){if(e.status!="OK"){var t=$.prompt.getStateContent("message");$(t).find(".jqimessage").text(e.message);$.prompt.goToState("message")}else if(e.status=="OK"){$.prompt.goToState("formSuccess");omerta.modules.Lackeys.input.l_credits=e.input.l_credits;omerta.modules.Lackeys.input.l_money=e.input.l_money;omerta.modules.Lackeys.GUI.events.update(e.lackey,e);omerta.modules.Lackeys.GUI.events.hired(e.lackey)}},fire:function(e){var t=omerta.modules.Lackeys.GUI.form.popupPos(e);$.prompt({form:omerta.plugins.popups.generateForm("Lackeys","fire",{title:"Fire "+omerta.modules.Lackeys.config[e].name,html:"Are you sure you want to fire me, Boss?",buttons:{No:0,Yes:1},pos:t,callback:omerta.modules.Lackeys.GUI.form.fireCB},{lackey:e}),message:{title:omerta.modules.Lackeys.config[e].name,html:"",position:t,buttons:{OK:0}}})},fireCB:function(e){if(e.status!="OK"){var t=$.prompt.getStateContent("message");$(t).find(".jqimessage").text(e.message);$.prompt.goToState("message")}else if(e.status=="OK"){$.prompt.close();omerta.modules.Lackeys.GUI.events.fired(e.lackey)}},settings:function(e,t){$.post("/BeO/webroot/?module=Lackeys&action=save_settings",t,function(t){var a=t.data;omerta.modules.Lackeys.GUI.form.settingsCB(e,a)},"json")},settingsCB:function(e,t){var a=omerta.modules.Lackeys.GUI.form.popupPos(e);a.width=150;if(a.x<0)a.x+=150;var o;if(t.status!="OK")o=t.message;else if(t.status=="OK"){o="Got it, Boss!"}$.prompt({message:{title:omerta.modules.Lackeys.config[e].name,html:o,position:a,buttons:{OK:0}}})},transferCars:function(e,t){var a=new Array;$("input[name=items_selected]:checked").each(function(){a.push($(this).val())});var o="items_selected="+a.join(",");$.post("/BeO/webroot/?module=Lackeys&action=transfer_car",o,function(t){var a=t.data;omerta.modules.Lackeys.GUI.form.transferCarsCB(e,a)},"json")},transferCarsCB:function(e,t){var a=omerta.modules.Lackeys.GUI.form.popupPos(e);var o;if(t.status!="OK")o=t.message;else if(t.status=="OK"){o="Here they are...<br>"+t.cars+" new cars in your garage, Boss.";$("input[name=items_selected]:checked").each(function(){$(this).parent().parent().remove()})}$.prompt({message:{title:omerta.modules.Lackeys.config[e].name,html:o,position:a,buttons:{OK:0}}})},send:function(e){var t=omerta.modules.Lackeys.GUI.form.popupPos(e);$.prompt({form:omerta.plugins.popups.generateForm("Lackeys","send",{title:"Send stuff to "+omerta.modules.Lackeys.config[e].name,buttons:{Cancel:0,Send:1},html:"I might need some investment to start my work, Boss.<br />"+"Let me know what you have.<br />"+'<label><span style="width: 125px; float: left; clear: both;">Credits</span> <input size="4"     value="'+omerta.modules.Lackeys.input.l_credits+'"    type="text" data-number=true name="l_credits" value=""></label><br />'+'<label><span style="width: 115px; float: left; clear: both;">Money</span>   $ <input size="10"  value="'+omerta.modules.Lackeys.input.l_money+'"      type="text" data-number=true name="l_money"   value=""></label><br />',pos:t,callback:omerta.modules.Lackeys.GUI.form.sendCB},{lackey:e}),message:{title:omerta.modules.Lackeys.config[e].name,html:"",position:t,buttons:{OK:0}}})},sendCB:function(e){if(e.status!="OK"){var t=$.prompt.getStateContent("message");$(t).find(".jqimessage").text(e.message);$.prompt.goToState("message")}else if(e.status=="OK"){$.prompt.close();omerta.modules.Lackeys.input.l_credits=e.input.l_credits;omerta.modules.Lackeys.input.l_money=e.input.l_money;omerta.modules.Lackeys.GUI.events.update(e.lackey,e)}},buyout:function(e){var t=omerta.modules.Lackeys.GUI.form.popupPos(e);var a="$"+$("span[data-lackey="+e+"][data-info='buyout']").text();$.prompt({form:omerta.plugins.popups.generateForm("Lackeys","buyout",{title:"Buy "+omerta.modules.Lackeys.config[e].name+" out of jail",html:"This will cost you "+a+"<br />"+"Are you sure you want to buy me out, Boss?",buttons:{No:0,Yes:1},pos:t,callback:omerta.modules.Lackeys.GUI.form.buyoutCB},{lackey:e}),message:{title:omerta.modules.Lackeys.config[e].name,html:"",position:t,buttons:{OK:0}}})},buyoutCB:function(e){if(e.status!="OK"){var t=$.prompt.getStateContent("message");$(t).find(".jqimessage").text(e.message);$.prompt.goToState("message")}else if(e.status=="OK"){$.prompt.close();omerta.modules.Lackeys.GUI.events.update(e.lackey,e)}}}}};omerta.modules.Spots={load:function(){$(document).on("click","button[data-spotInfo]",function(t){var o=$(this).attr("data-spotInfo");var a=$(this).attr("data-spotid");if(o=="buy")omerta.modules.Spots.GUI.square.buy(a);else if(o=="raid")omerta.GUI.container.loadPage("/BeO/webroot/index.php?module=Spots");else if(o=="toggle")omerta.GUI.container.loadPage("/BeO/webroot/index.php?module=City&action=toggle&id="+a)});$(document).on("click","div[data-spot]",function(t){var o=$(this).attr("data-spot");omerta.modules.Spots.GUI.square.info(o)})},GUI:{events:{},square:{info:function(t){var o=omerta.spot[t];if(!o)return;var a=omerta.server.clock.getTime()/1e3;o.raid_nextTime=o.raid_next-a;$accommodationscontainer=$("#spotAccommodations");$accommodationscontainer.html("").hide();$("*[data-spotInfo='spot_position']").text(o.pos_y+o.pos_x);$("*[data-spotInfo='spot_type']").text(o.type);$("*[data-spotInfo='spot_name']").text(o.spotName);$("*[data-spotInfo='raid_protection']").find(".percent").next().css("width",o.raid_protection+"%");$("*[data-spotInfo='raid_protection']").find(".percent").text(o.raid_protection+"%");$("*[data-spotInfo='buy'], *[data-spotInfo='toggle']").attr("data-spotid",t);if(o.raid_icon){$("*[data-spotInfo='spot_icon']").show().attr("src","/assets/images/gfx/maps/icons/"+o.raid_icon+".png")}else{$("*[data-spotInfo='spot_icon']").hide()}$("*[data-spotInfo='owner_name']").text(o.ownerName);$("*[data-spotInfo='owner_rank']").text(o.ownerRank);$("*[data-spotInfo='owner_family']").text(o.ownerFamily);$("a[data-spotInfo='owner_family']").attr("href","/family.php?fam="+o.family);$("a[data-spotInfo='owner_name']").attr("href","/user.php?idn="+o.owner);$housesContainer=$("#hspot-"+t+"");if($housesContainer.size()>0){$accommodationscontainer.html($housesContainer.html()).show()}if(o.closed!=""){$("*[data-spotInfo='spot_profit']").css("color","red");$("*[data-spotInfo='spot_profit']").text(o.closed=="BR"?"Bankrupt":"Out of business");$("*[data-spotInfo='raid_protection']").find(".progressbar").hide();$("*[data-spotInfo='raid_next']").attr("data-timeleft",-1);$("*[data-spotInfo='raid_next']").text("-")}else{$("*[data-spotInfo='raid_protection']").find(".progressbar").show();$("*[data-spotInfo='spot_profit']").text("$ "+o.profitFormat);if(o.spot_profit>0)$("*[data-spotInfo='spot_profit']").css("color","green");else if(o.spot_profit==0)$("*[data-spotInfo='spot_profit']").css("color","black");else $("*[data-spotInfo='spot_profit']").css("color","red");if(o.raid_nextTime>0)$("*[data-spotInfo='raid_next']").attr("data-timeleft",o.raid_nextTime);else $("*[data-spotInfo='raid_next']").attr("data-timeleft",0).text("Now")}if(o.can_buy)$("*[data-spotInfo='buy']").show();else $("*[data-spotInfo='buy']").hide();if(o.can_raid)$("*[data-spotInfo='raid']").show();else $("*[data-spotInfo='raid']").hide();if(o.cane==="1")$("*[data-spotCane='toggle']").show();else $("*[data-spotCane='toggle']").hide();$("#spot_welcome").fadeOut("fast",function(){$("#spot_details").fadeIn("fast")})},buy:function(t){omerta.GUI.container.loadPage("/BeO/webroot/index.php?module=Family&action=create&familySpot="+t)}}}};omerta.modules.User={load:function(){},UserfileUpload:function(e,t,n){var a=document.createElement("iframe");a.setAttribute("id","upload_iframe");a.setAttribute("name","upload_iframe");a.setAttribute("width","0");a.setAttribute("height","0");a.setAttribute("border","0");a.setAttribute("style","width: 0; height: 0; border: none;");e.parentNode.appendChild(a);window.frames["upload_iframe"].name="upload_iframe";iframeId=document.getElementById("upload_iframe");var i=function(){if(iframeId.detachEvent)iframeId.detachEvent("onload",i);else iframeId.removeEventListener("load",i,false);if(iframeId.contentDocument){content=iframeId.contentDocument.body.innerHTML}else if(iframeId.contentWindow){content=iframeId.contentWindow.document.body.innerHTML}else if(iframeId.document){content=iframeId.document.body.innerHTML}document.getElementById(n).innerHTML=content;setTimeout("iframeId.parentNode.removeChild(iframeId)",250)};if(iframeId.addEventListener)iframeId.addEventListener("load",i,true);if(iframeId.attachEvent)iframeId.attachEvent("onload",i);e.setAttribute("target","upload_iframe");e.setAttribute("action",t);e.setAttribute("method","post");e.setAttribute("enctype","multipart/form-data");e.setAttribute("encoding","multipart/form-data");$(e).on("submit",function(e){e.preventDefault()});e.submit();document.getElementById(n).innerHTML="Uploading..."},CheckLen:function(e){var t=$(e).data("maxlength");var n=e.value.length;if(n==1&&e.value.substring(0,1)==" "){e.value="";n=0}if(n>t){e.value=e.value.substring(0,t);CharsLeft=0}else{CharsLeft=t-n}document.quoteform.Charleft.value=CharsLeft}};omerta.modules.City=_.extend(omerta.core.Module,{TAB_FAM:"families",TAB_SPOT:"spot",tab:ko.observable("families"),spots:ko.observableArray(),top_families:ko.observableArray(),families:ko.observableArray(),houses:ko.observable(),visibleSpotContent:ko.observable("spot"),city_name:ko.observable(),selectedSpot:ko.observable(),load:function(){},prepareData:function(){this.selectedSpot(null);this.tab("families");this.visibleSpotContent("spot");this.houses({});this.top_families([]);this.families([]);this.spots([]);if(this.__initSpots(this.data.spots)===false){throw"Empty spots"}if(this.__initFamilies(this.data.families)===false){throw"Empty Families"}this.__initHouses(this.data.houses);this.city_name(this.data.city_name);this.selectedSpot.subscribe(this.renderSelectedSpot);this.__initGameIntro(this.data.game_intro);delete this.data},__initSpots:function(e){if(_.isArray(e)===false&&_.isObject(e)===false){return false}if(_.isEmpty(e)){return true}this.spots([]);var t=0;for(t in e){e[t].key=t;this.spots.push(new omerta.modules.City.model.Spot(e[t]))}return true},__initFamilies:function(e){if(_.isArray(e)===false&&_.isObject(e)===false){return false}if(_.isEmpty(e)){return true}this.families([]);this.top_families([]);var t=0;for(t in e){var i=new omerta.modules.City.model.Family(e[t]);if(t<3){this.top_families.push(i)}else{this.families.push(i)}}return true},__initHouses:function(e){if(_.isArray(e)===false&&_.isObject(e)===false){return false}if(_.isEmpty(e)){return true}var t=0;var i=0;for(t in e){var s=[];for(i in e[t]){s.push(new omerta.modules.City.model.House(e[t][i]))}e[t]=s}this.houses(e);return true},__initGameIntro:function(e){if(typeof omerta.modules.GameIntro==="undefined"){return false}if(_.isObject(e)===false){return false}if(_.isEmpty(e)){return true}if(typeof GameIntroOptions!=="undefined"&&typeof GameIntroOptions.shown!=="undefined"&&GameIntroOptions.shown===false){return false}setTimeout(function(){var t=omerta.modules.GameIntro.display(e);if(t===false){return false}},500)},renderSelectedSpot:function(e){omerta.modules.City.tab(omerta.modules.City.TAB_SPOT)},getUserCity:function(){var e=this.city_name();if(typeof e==="undefined"||e.length===0){return omerta.character.game.city()}return e},getLinkFamily:function(e,t){var i="/family.php?fam="+e;return'<a href="[LINK]">[NAME]</a>'.replace("[LINK]",i).replace("[NAME]",t)},getLinkUser:function(e){var t="/user.php?name="+e;return'<a href="[LINK]">[INGAME]</a>'.replace("[LINK]",t).replace("[INGAME]",e)},buySpot:function(){var e=this.selectedSpot();if(typeof e==="undefined"){return false}omerta.GUI.container.loadPage("/BeO/webroot/index.php?module=Family&action=create&familySpot="+e.ID())},toggleSpotInformation:function(e,t){var i=this.selectedSpot();if(typeof i==="undefined"){return false}var s=e.visibleSpotContent();if(s!=="spot"){var a="spot"}else{var a="houses"}e.visibleSpotContent(a)},calculatePercentage:function(e,t,i){t=parseInt(t);e=parseInt(e);i=Math.abs(parseInt(i))||0;if(t===0){return 0}var s=e*100/t;return Math.round(s,i)},citySpotRaidLink:function(e){var t=this.selectedSpot();if(typeof t==="undefined"){return false}var i=$(e);if(i.data("loaded-link")){return}var s=i.text();i.data("loaded-link",true);var a=parseInt(omerta.character.info.family());if(a===0){return}i.html('<a href="/BeO/webroot/index.php?module=Spots" class="raidActionLink">'+s+"</a>")}});omerta.modules.City.model.Family=function(t){var n=parseInt(function(){return t.id||0}());var i=parseInt(function(){return t.bossid||0}());this.name=function(){return t.name||""}().toString();this.color=function(){return t.color||""}().toString();this.worth=parseInt(function(){return t.worth||0}());this.city=parseInt(function(){return t.city||0}());this.num_spots=parseInt(function(){return t.family_spots||0}());this.num_users=parseInt(function(){return t.users||0}());this.donName=function(){return t.boss||""}().toString();this.imageUrl=function(t){t=t||"medium";return"/family_image.php?family="+n.toString()+"&size="+t};this.ribbonVisible=function(t){return n>0};this.ribbonUrl=function(t){t=parseInt(t)||1;return"/assets/omerta/modules/City/assets/img/ribbon-"+t+".png"};this.getFamilyId=function(){return n};this.getFamilyLink=function(){if(n<=0){return this.name}return omerta.modules.City.getLinkFamily(n,this.name)};this.getDonLink=function(){if(this.donName==="Local Gangster"){return this.donName}return omerta.modules.City.getLinkUser(this.donName)};this.getTerritoriesPercentage=function(){return omerta.modules.City.calculatePercentage(this.num_spots,omerta.modules.City.spots().length)}};omerta.modules.City.model.House=function(n){var e=function(){return n.urls||{}}();this.owner_name=function(){return n.owner_name||"Local Mob"}().toString();this.owner_id=parseInt(function(){return n.owner_id||0}());this.type=parseInt(function(){return n.house_type||0}());this.name=function(){return n.name||""}().toString();this.can_rent=Boolean(function(){return n.can_rent||false}());this.getOwnerLink=function(){var n=this.owner_name;if(this.owner_id===0){return n}return omerta.modules.City.getLinkUser(n)};this.getActionLink=function(){var n=omerta.character.info.name().toLowerCase()===this.owner_name.toLowerCase();if(n){return'<a class="house-action h-owned" href="'+e.mine+'">Owned</a>'}if(this.owner_id>0){return'<span class="house-action h-occupied">Occupied</span>'}if(this.can_rent===false){return'<span class="house-action h-disabled">Can\'t Rent</span>'}return'<a class="house-action h-rent" href="'+e.rent+'">Rent</a>'}};omerta.modules.City.model.Spot=function(t){var r=t.buyable||false;var e=t.can_buy||false;var i=t.can_e||false;var n=t.cdtc||"";var o=t.cid||0;var s=t.closed||"";var a=t.closed_reason||"";var u=t.closed_times||0;var f=t.color||"c6c6c6";var c=t.family||0;var h=t.owner||0;var l=t.ownerFamily||"Local Mob";var g=t.ownerName||"Local Gangster";var m=t.ownerRank||0;var p=t.pos_x||"";var v=t.pos_y||"";var y=t.profitFormat||0;var d=t.raid_last||0;var C=t.raid_next||0;var S=t.raid_protection||0;var w=t.spotName||"";var I=t.spot_profit||0;var F=t.type||"HQ";var N=t.key||0;this.ID=function(){return o};this.getPosX=function(){return parseInt(p)};this.getPosY=function(){return v};this.getSpotType=function(){return F};this.isBuyable=function(){return Boolean(e)};this.isClosed=function(){return a.length!==0};this.getSpotName=function(){return w.toString()};this.getOwnerID=function(){return parseInt(h)};this.getFamilyID=function(){return parseInt(c)};this.getOwnerName=function(){return g.toString()};this.getOwnerLink=function(){var t=this.getOwnerName();if(this.getOwnerID()===0){return t}return omerta.modules.City.getLinkUser(t)};this.getOwnerRank=function(){if(this.getOwnerID()===0){return 0}return m};this.getFamilyLink=function(){var t=this.getFamilyID();if(t===0){return this.getFamilyName()}return omerta.modules.City.getLinkFamily(t,this.getFamilyName())};this.getFamilyName=function(){return l.toString()};this.getSpotProfit=function(){if(this.isClosed()){return 0}return parseInt(I)};this.formatSpotProfit=function(){var t=this.getSpotProfit();if(this.isClosed()){return a==="BR"?"Bankrupt":"Out of business"}return"$ "+t.format()};this.getProtection=function(){if(this.isClosed()){return 0}return S};this.colorBarProtection=function(){var t=this.getProtection();if(t<=0){return"transparent"}if(t<=20){return"#B41313"}if(t>20&&t<50){return"#C98B19"}return"#588527"};this.getFamilyColor=function(){if(c){return"#"+f}return false};this.getNextRaid=function(){var t=omerta.server.clock.getTime()/1e3;var r=C-t;if(r<0){return 0}return r};this.getSpotColor=function(){if(c){return"customColor"}if(this.isBuyable()===false){return"gray"}return"green"};this.getClassName=function(){var t=["hq_box","row"+this.getPosY(),"column"+this.getPosX()];t.push(this.getSpotColor());if(this.isClosed()){t.push("closed")}if(this.getSpotType()!=="HQ"){t.push("spotWithImage")}t.push("spotType"+this.getSpotType());t.push("spotKey"+N);return t.join(" ")};this.getAccomodations=function(){var t=omerta.modules.City.houses();if(_.isObject(t)===false){return[]}if(_.isEmpty(t)){return[]}var r=t[this.ID()];if(_.isUndefined(r)){return[]}r.sort(function(t,r){return t.type-r.type}).reverse();return r}};omerta.modules.Desk={loader:'<div><i class="icon-spinner icon-spin icon-large">&nbsp;</i>&nbsp;Loading ...</div>',load:function(){$(document).on("change","#desk-ticket-category",function(){omerta.modules.Desk.toggleOptions(this)})},loadPopup:function(e,t){t.preventDefault();var o=$.ajax({url:"/?module=Desk&rt="+Math.random(),type:"GET",dataType:"json"});var a=$.prompt.getCurrentState();if(a.length>0){return false}$.prompt(omerta.modules.Desk.loader,{title:"Help & Support",buttons:{Cancel:false,Submit:true},submit:omerta.modules.Desk.createTicket,loaded:function(){$("#jqi_state0_buttonSubmit").hide();$(".jqimessage ").addClass("desk-popup")}});o.done(omerta.modules.Desk.renderPopup)},renderPopup:function(e,t){if(!_.isObject(e)){return false}if(typeof e.template==="undefined"){return false}if(_.isNull(e.template)){return false}$(".jqimessage").html(e.template);$(".desk-input-autofocus").focus();omerta.modules.Desk.toggleOptions($("#desk-ticket-category"))},createTicket:function(e,t,o,a){if(t==false){return null}e.preventDefault();$(".jqimessage").html(omerta.modules.Desk.loader);$("#jqi_state0_buttonSubmit").hide();var s=$.ajax({url:"/?module=Desk&action=create&rt="+Math.random(),type:"POST",dataType:"json",data:a});s.done(function(e){$(".jqimessage").html(e.template);if(e.data.success){$("#jqi_state0_buttonSubmit").remove()}else{omerta.modules.Desk.toggleOptions($("#desk-ticket-category"))}})},toggleOptions:function(e){var t=$(e);var o=t.val();var a=$(".desk-ticket-fields-wrapper");if(o.length>0){a.slideDown();$("#jqi_state0_buttonSubmit").show()}else{a.slideUp();$("#jqi_state0_buttonSubmit").hide()}}};omerta.modules.GameIntro={oIntro:null,load:function(){$(document).bind("omerta:loaded",function(){omerta.modules.GameIntro.displayFromBody()})},displayFromBody:function(){if(typeof GameIntroOptions==="undefined"){return false}if(!_.isObject(GameIntroOptions)){return false}if(typeof Modernizr!=="undefined"){if(Modernizr.mq("only screen and (min-width: 320px) and (max-width: 1024px)")){return false}}return omerta.modules.GameIntro.display(GameIntroOptions)},display:function(o){if(typeof introJs!=="function"){throw"Vendor IntroJS not loaded"}var e={steps:[]};$.extend(e,o);if(e.steps.length==0){return false}omerta.modules.GameIntro.oIntro=introJs();omerta.modules.GameIntro.oIntro.setOptions(e);omerta.modules.GameIntro.oIntro.start();omerta.modules.GameIntro.oIntro.oncomplete(function(o){$(document).trigger("omerta:intro:completed")});omerta.modules.GameIntro.oIntro.onexit(function(o){$(document).trigger("omerta:intro:closed")});omerta.modules.GameIntro.oIntro.onafterchange(function(o){$(document).trigger("omerta:intro:afterchange")});omerta.modules.GameIntro.oIntro.onchange(function(o){$(document).trigger("omerta:intro:change")});omerta.modules.GameIntro.oIntro.onbeforechange(function(o){$(document).trigger("omerta:intro:beforechange")});$(document).trigger("omerta:intro:created");return omerta.modules.GameIntro.oIntro}};omerta.modules.Develop={load:function(){},loadPopup:function(e,t){t.preventDefault();var o=$.ajax({url:"/?module=Develop&rt="+Math.random(),type:"GET",dataType:"json"});o.done(omerta.modules.Develop.renderPopup)},renderPopup:function(e,t){if(!_.isObject(e)){return false}if(typeof e.template==="undefined"){return false}if(_.isNull(e.template)){return false}var o=$.prompt.getCurrentState();if(o.length>0){return false}$.prompt(e.template,{title:"Develop toolbox",buttons:{Cancel:false,Setup:true},submit:omerta.modules.Develop.setupAccount})},setupAccount:function(e,t,o,a){if(t==false){return null}e.preventDefault();var l=$.ajax({url:"/?module=Develop&action=Save&rt="+Math.random(),type:"GET",dataType:"json",data:a});l.done(function(){$.prompt.close()})}};