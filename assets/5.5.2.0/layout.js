(function(){var n=this,t=n._,r={},e=Array.prototype,u=Object.prototype,i=Function.prototype,a=e.push,o=e.slice,c=e.concat,l=u.toString,f=u.hasOwnProperty,s=e.forEach,p=e.map,h=e.reduce,v=e.reduceRight,g=e.filter,d=e.every,m=e.some,y=e.indexOf,b=e.lastIndexOf,x=Array.isArray,w=Object.keys,_=i.bind,j=function(n){return n instanceof j?n:this instanceof j?void(this._wrapped=n):new j(n)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=j),exports._=j):n._=j,j.VERSION="1.6.0";var A=j.each=j.forEach=function(n,t,e){if(null==n)return n;if(s&&n.forEach===s)n.forEach(t,e);else if(n.length===+n.length){for(var u=0,i=n.length;i>u;u++)if(t.call(e,n[u],u,n)===r)return}else for(var a=j.keys(n),u=0,i=a.length;i>u;u++)if(t.call(e,n[a[u]],a[u],n)===r)return;return n};j.map=j.collect=function(n,t,r){var e=[];return null==n?e:p&&n.map===p?n.map(t,r):(A(n,function(n,u,i){e.push(t.call(r,n,u,i))}),e)};var O="Reduce of empty array with no initial value";j.reduce=j.foldl=j.inject=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),h&&n.reduce===h)return e&&(t=j.bind(t,e)),u?n.reduce(t,r):n.reduce(t);if(A(n,function(n,i,a){u?r=t.call(e,r,n,i,a):(r=n,u=!0)}),!u)throw new TypeError(O);return r},j.reduceRight=j.foldr=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),v&&n.reduceRight===v)return e&&(t=j.bind(t,e)),u?n.reduceRight(t,r):n.reduceRight(t);var i=n.length;if(i!==+i){var a=j.keys(n);i=a.length}if(A(n,function(o,c,l){c=a?a[--i]:--i,u?r=t.call(e,r,n[c],c,l):(r=n[c],u=!0)}),!u)throw new TypeError(O);return r},j.find=j.detect=function(n,t,r){var e;return k(n,function(n,u,i){return t.call(r,n,u,i)?(e=n,!0):void 0}),e},j.filter=j.select=function(n,t,r){var e=[];return null==n?e:g&&n.filter===g?n.filter(t,r):(A(n,function(n,u,i){t.call(r,n,u,i)&&e.push(n)}),e)},j.reject=function(n,t,r){return j.filter(n,function(n,e,u){return!t.call(r,n,e,u)},r)},j.every=j.all=function(n,t,e){t||(t=j.identity);var u=!0;return null==n?u:d&&n.every===d?n.every(t,e):(A(n,function(n,i,a){return(u=u&&t.call(e,n,i,a))?void 0:r}),!!u)};var k=j.some=j.any=function(n,t,e){t||(t=j.identity);var u=!1;return null==n?u:m&&n.some===m?n.some(t,e):(A(n,function(n,i,a){return u||(u=t.call(e,n,i,a))?r:void 0}),!!u)};j.contains=j.include=function(n,t){return null==n?!1:y&&n.indexOf===y?n.indexOf(t)!=-1:k(n,function(n){return n===t})},j.invoke=function(n,t){var r=o.call(arguments,2),e=j.isFunction(t);return j.map(n,function(n){return(e?t:n[t]).apply(n,r)})},j.pluck=function(n,t){return j.map(n,j.property(t))},j.where=function(n,t){return j.filter(n,j.matches(t))},j.findWhere=function(n,t){return j.find(n,j.matches(t))},j.max=function(n,t,r){if(!t&&j.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.max.apply(Math,n);var e=-1/0,u=-1/0;return A(n,function(n,i,a){var o=t?t.call(r,n,i,a):n;o>u&&(e=n,u=o)}),e},j.min=function(n,t,r){if(!t&&j.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.min.apply(Math,n);var e=1/0,u=1/0;return A(n,function(n,i,a){var o=t?t.call(r,n,i,a):n;u>o&&(e=n,u=o)}),e},j.shuffle=function(n){var t,r=0,e=[];return A(n,function(n){t=j.random(r++),e[r-1]=e[t],e[t]=n}),e},j.sample=function(n,t,r){return null==t||r?(n.length!==+n.length&&(n=j.values(n)),n[j.random(n.length-1)]):j.shuffle(n).slice(0,Math.max(0,t))};var E=function(n){return null==n?j.identity:j.isFunction(n)?n:j.property(n)};j.sortBy=function(n,t,r){return t=E(t),j.pluck(j.map(n,function(n,e,u){return{value:n,index:e,criteria:t.call(r,n,e,u)}}).sort(function(n,t){var r=n.criteria,e=t.criteria;if(r!==e){if(r>e||r===void 0)return 1;if(e>r||e===void 0)return-1}return n.index-t.index}),"value")};var F=function(n){return function(t,r,e){var u={};return r=E(r),A(t,function(i,a){var o=r.call(e,i,a,t);n(u,o,i)}),u}};j.groupBy=F(function(n,t,r){j.has(n,t)?n[t].push(r):n[t]=[r]}),j.indexBy=F(function(n,t,r){n[t]=r}),j.countBy=F(function(n,t){j.has(n,t)?n[t]++:n[t]=1}),j.sortedIndex=function(n,t,r,e){r=E(r);for(var u=r.call(e,t),i=0,a=n.length;a>i;){var o=i+a>>>1;r.call(e,n[o])<u?i=o+1:a=o}return i},j.toArray=function(n){return n?j.isArray(n)?o.call(n):n.length===+n.length?j.map(n,j.identity):j.values(n):[]},j.size=function(n){return null==n?0:n.length===+n.length?n.length:j.keys(n).length},j.first=j.head=j.take=function(n,t,r){return null==n?void 0:null==t||r?n[0]:0>t?[]:o.call(n,0,t)},j.initial=function(n,t,r){return o.call(n,0,n.length-(null==t||r?1:t))},j.last=function(n,t,r){return null==n?void 0:null==t||r?n[n.length-1]:o.call(n,Math.max(n.length-t,0))},j.rest=j.tail=j.drop=function(n,t,r){return o.call(n,null==t||r?1:t)},j.compact=function(n){return j.filter(n,j.identity)};var M=function(n,t,r){return t&&j.every(n,j.isArray)?c.apply(r,n):(A(n,function(n){j.isArray(n)||j.isArguments(n)?t?a.apply(r,n):M(n,t,r):r.push(n)}),r)};j.flatten=function(n,t){return M(n,t,[])},j.without=function(n){return j.difference(n,o.call(arguments,1))},j.partition=function(n,t){var r=[],e=[];return A(n,function(n){(t(n)?r:e).push(n)}),[r,e]},j.uniq=j.unique=function(n,t,r,e){j.isFunction(t)&&(e=r,r=t,t=!1);var u=r?j.map(n,r,e):n,i=[],a=[];return A(u,function(r,e){(t?e&&a[a.length-1]===r:j.contains(a,r))||(a.push(r),i.push(n[e]))}),i},j.union=function(){return j.uniq(j.flatten(arguments,!0))},j.intersection=function(n){var t=o.call(arguments,1);return j.filter(j.uniq(n),function(n){return j.every(t,function(t){return j.contains(t,n)})})},j.difference=function(n){var t=c.apply(e,o.call(arguments,1));return j.filter(n,function(n){return!j.contains(t,n)})},j.zip=function(){for(var n=j.max(j.pluck(arguments,"length").concat(0)),t=new Array(n),r=0;n>r;r++)t[r]=j.pluck(arguments,""+r);return t},j.object=function(n,t){if(null==n)return{};for(var r={},e=0,u=n.length;u>e;e++)t?r[n[e]]=t[e]:r[n[e][0]]=n[e][1];return r},j.indexOf=function(n,t,r){if(null==n)return-1;var e=0,u=n.length;if(r){if("number"!=typeof r)return e=j.sortedIndex(n,t),n[e]===t?e:-1;e=0>r?Math.max(0,u+r):r}if(y&&n.indexOf===y)return n.indexOf(t,r);for(;u>e;e++)if(n[e]===t)return e;return-1},j.lastIndexOf=function(n,t,r){if(null==n)return-1;var e=null!=r;if(b&&n.lastIndexOf===b)return e?n.lastIndexOf(t,r):n.lastIndexOf(t);for(var u=e?r:n.length;u--;)if(n[u]===t)return u;return-1},j.range=function(n,t,r){arguments.length<=1&&(t=n||0,n=0),r=arguments[2]||1;for(var e=Math.max(Math.ceil((t-n)/r),0),u=0,i=new Array(e);e>u;)i[u++]=n,n+=r;return i};var R=function(){};j.bind=function(n,t){var r,e;if(_&&n.bind===_)return _.apply(n,o.call(arguments,1));if(!j.isFunction(n))throw new TypeError;return r=o.call(arguments,2),e=function(){if(!(this instanceof e))return n.apply(t,r.concat(o.call(arguments)));R.prototype=n.prototype;var u=new R;R.prototype=null;var i=n.apply(u,r.concat(o.call(arguments)));return Object(i)===i?i:u}},j.partial=function(n){var t=o.call(arguments,1);return function(){for(var r=0,e=t.slice(),u=0,i=e.length;i>u;u++)e[u]===j&&(e[u]=arguments[r++]);for(;r<arguments.length;)e.push(arguments[r++]);return n.apply(this,e)}},j.bindAll=function(n){var t=o.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return A(t,function(t){n[t]=j.bind(n[t],n)}),n},j.memoize=function(n,t){var r={};return t||(t=j.identity),function(){var e=t.apply(this,arguments);return j.has(r,e)?r[e]:r[e]=n.apply(this,arguments)}},j.delay=function(n,t){var r=o.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},t)},j.defer=function(n){return j.delay.apply(j,[n,1].concat(o.call(arguments,1)))},j.throttle=function(n,t,r){var e,u,i,a=null,o=0;r||(r={});var c=function(){o=r.leading===!1?0:j.now(),a=null,i=n.apply(e,u),e=u=null};return function(){var l=j.now();o||r.leading!==!1||(o=l);var f=t-(l-o);return e=this,u=arguments,0>=f?(clearTimeout(a),a=null,o=l,i=n.apply(e,u),e=u=null):a||r.trailing===!1||(a=setTimeout(c,f)),i}},j.debounce=function(n,t,r){var e,u,i,a,o,c=function(){var l=j.now()-a;t>l?e=setTimeout(c,t-l):(e=null,r||(o=n.apply(i,u),i=u=null))};return function(){i=this,u=arguments,a=j.now();var l=r&&!e;return e||(e=setTimeout(c,t)),l&&(o=n.apply(i,u),i=u=null),o}},j.once=function(n){var t,r=!1;return function(){return r?t:(r=!0,t=n.apply(this,arguments),n=null,t)}},j.wrap=function(n,t){return j.partial(t,n)},j.compose=function(){var n=arguments;return function(){for(var t=arguments,r=n.length-1;r>=0;r--)t=[n[r].apply(this,t)];return t[0]}},j.after=function(n,t){return function(){return--n<1?t.apply(this,arguments):void 0}},j.keys=function(n){if(!j.isObject(n))return[];if(w)return w(n);var t=[];for(var r in n)j.has(n,r)&&t.push(r);return t},j.values=function(n){for(var t=j.keys(n),r=t.length,e=new Array(r),u=0;r>u;u++)e[u]=n[t[u]];return e},j.pairs=function(n){for(var t=j.keys(n),r=t.length,e=new Array(r),u=0;r>u;u++)e[u]=[t[u],n[t[u]]];return e},j.invert=function(n){for(var t={},r=j.keys(n),e=0,u=r.length;u>e;e++)t[n[r[e]]]=r[e];return t},j.functions=j.methods=function(n){var t=[];for(var r in n)j.isFunction(n[r])&&t.push(r);return t.sort()},j.extend=function(n){return A(o.call(arguments,1),function(t){if(t)for(var r in t)n[r]=t[r]}),n},j.pick=function(n){var t={},r=c.apply(e,o.call(arguments,1));return A(r,function(r){r in n&&(t[r]=n[r])}),t},j.omit=function(n){var t={},r=c.apply(e,o.call(arguments,1));for(var u in n)j.contains(r,u)||(t[u]=n[u]);return t},j.defaults=function(n){return A(o.call(arguments,1),function(t){if(t)for(var r in t)n[r]===void 0&&(n[r]=t[r])}),n},j.clone=function(n){return j.isObject(n)?j.isArray(n)?n.slice():j.extend({},n):n},j.tap=function(n,t){return t(n),n};var S=function(n,t,r,e){if(n===t)return 0!==n||1/n==1/t;if(null==n||null==t)return n===t;n instanceof j&&(n=n._wrapped),t instanceof j&&(t=t._wrapped);var u=l.call(n);if(u!=l.call(t))return!1;switch(u){case"[object String]":return n==String(t);case"[object Number]":return n!=+n?t!=+t:0==n?1/n==1/t:n==+t;case"[object Date]":case"[object Boolean]":return+n==+t;case"[object RegExp]":return n.source==t.source&&n.global==t.global&&n.multiline==t.multiline&&n.ignoreCase==t.ignoreCase}if("object"!=typeof n||"object"!=typeof t)return!1;for(var i=r.length;i--;)if(r[i]==n)return e[i]==t;var a=n.constructor,o=t.constructor;if(a!==o&&!(j.isFunction(a)&&a instanceof a&&j.isFunction(o)&&o instanceof o)&&"constructor"in n&&"constructor"in t)return!1;r.push(n),e.push(t);var c=0,f=!0;if("[object Array]"==u){if(c=n.length,f=c==t.length)for(;c--&&(f=S(n[c],t[c],r,e)););}else{for(var s in n)if(j.has(n,s)&&(c++,!(f=j.has(t,s)&&S(n[s],t[s],r,e))))break;if(f){for(s in t)if(j.has(t,s)&&!c--)break;f=!c}}return r.pop(),e.pop(),f};j.isEqual=function(n,t){return S(n,t,[],[])},j.isEmpty=function(n){if(null==n)return!0;if(j.isArray(n)||j.isString(n))return 0===n.length;for(var t in n)if(j.has(n,t))return!1;return!0},j.isElement=function(n){return!(!n||1!==n.nodeType)},j.isArray=x||function(n){return"[object Array]"==l.call(n)},j.isObject=function(n){return n===Object(n)},A(["Arguments","Function","String","Number","Date","RegExp"],function(n){j["is"+n]=function(t){return l.call(t)=="[object "+n+"]"}}),j.isArguments(arguments)||(j.isArguments=function(n){return!(!n||!j.has(n,"callee"))}),"function"!=typeof/./&&(j.isFunction=function(n){return"function"==typeof n}),j.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},j.isNaN=function(n){return j.isNumber(n)&&n!=+n},j.isBoolean=function(n){return n===!0||n===!1||"[object Boolean]"==l.call(n)},j.isNull=function(n){return null===n},j.isUndefined=function(n){return n===void 0},j.has=function(n,t){return f.call(n,t)},j.noConflict=function(){return n._=t,this},j.identity=function(n){return n},j.constant=function(n){return function(){return n}},j.property=function(n){return function(t){return t[n]}},j.matches=function(n){return function(t){if(t===n)return!0;for(var r in n)if(n[r]!==t[r])return!1;return!0}},j.times=function(n,t,r){for(var e=Array(Math.max(0,n)),u=0;n>u;u++)e[u]=t.call(r,u);return e},j.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))},j.now=Date.now||function(){return(new Date).getTime()};var T={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};T.unescape=j.invert(T.escape);var I={escape:new RegExp("["+j.keys(T.escape).join("")+"]","g"),unescape:new RegExp("("+j.keys(T.unescape).join("|")+")","g")};j.each(["escape","unescape"],function(n){j[n]=function(t){return null==t?"":(""+t).replace(I[n],function(t){return T[n][t]})}}),j.result=function(n,t){if(null==n)return void 0;var r=n[t];return j.isFunction(r)?r.call(n):r},j.mixin=function(n){A(j.functions(n),function(t){var r=j[t]=n[t];j.prototype[t]=function(){var n=[this._wrapped];return a.apply(n,arguments),z.call(this,r.apply(j,n))}})};var N=0;j.uniqueId=function(n){var t=++N+"";return n?n+t:t},j.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var q=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},D=/\\|'|\r|\n|\t|\u2028|\u2029/g;j.template=function(n,t,r){var e;r=j.defaults({},r,j.templateSettings);var u=new RegExp([(r.escape||q).source,(r.interpolate||q).source,(r.evaluate||q).source].join("|")+"|$","g"),i=0,a="__p+='";n.replace(u,function(t,r,e,u,o){return a+=n.slice(i,o).replace(D,function(n){return"\\"+B[n]}),r&&(a+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'"),e&&(a+="'+\n((__t=("+e+"))==null?'':__t)+\n'"),u&&(a+="';\n"+u+"\n__p+='"),i=o+t.length,t}),a+="';\n",r.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{e=new Function(r.variable||"obj","_",a)}catch(o){throw o.source=a,o}if(t)return e(t,j);var c=function(n){return e.call(this,n,j)};return c.source="function("+(r.variable||"obj")+"){\n"+a+"}",c},j.chain=function(n){return j(n).chain()};var z=function(n){return this._chain?j(n).chain():n};j.mixin(j),A(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var t=e[n];j.prototype[n]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!=n&&"splice"!=n||0!==r.length||delete r[0],z.call(this,r)}}),A(["concat","join","slice"],function(n){var t=e[n];j.prototype[n]=function(){return z.call(this,t.apply(this._wrapped,arguments))}}),j.extend(j.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return j})}).call(this);(function(){(function(e){var n=this||(0,eval)("this"),t=n.document,r=n.navigator,a=n.jQuery,i=n.JSON;(function(e){"function"===typeof require&&"object"===typeof exports&&"object"===typeof module?e(module.exports||exports,require):"function"===typeof define&&define.amd?define(["exports","require"],e):e(n.ko={})})(function(o,u){function c(e,n){return null===e||typeof e in d?e===n:!1}function s(n,t){var r;return function(){r||(r=setTimeout(function(){r=e;n()},t))}}function f(e,n){var t;return function(){clearTimeout(t);t=setTimeout(e,n)}}function l(e,n,t,r){p.d[e]={init:function(e,a,i,o,u){var c,s;p.s(function(){var i=p.a.c(a()),o=!t!==!i,f=!s;if(f||n||o!==c)f&&p.Y.la()&&(s=p.a.ia(p.f.childNodes(e),!0)),o?(f||p.f.T(e,p.a.ia(s)),p.Ca(r?r(u,i):u,e)):p.f.ja(e),c=o},null,{o:e});return{controlsDescendantBindings:!0}}};p.h.ha[e]=!1;p.f.Q[e]=!0}var p="undefined"!==typeof o?o:{};p.b=function(e,n){for(var t=e.split("."),r=p,a=0;a<t.length-1;a++)r=r[t[a]];r[t[t.length-1]]=n};p.A=function(e,n,t){e[n]=t};p.version="3.2.0";p.b("version",p.version);p.a=function(){function o(e,n){for(var t in e)e.hasOwnProperty(t)&&n(t,e[t])}function u(e,n){if(n)for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e}function c(e,n){e.__proto__=n;return e}var s={__proto__:[]}instanceof Array,f={},l={};f[r&&/Firefox\/2/i.test(r.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"];f.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" ");o(f,function(e,n){if(n.length)for(var t=0,r=n.length;t<r;t++)l[n[t]]=e});var d={propertychange:!0},h=t&&function(){for(var n=3,r=t.createElement("div"),a=r.getElementsByTagName("i");r.innerHTML="<!--[if gt IE "+ ++n+"]><i></i><![endif]-->",a[0];);return 4<n?n:e}();return{vb:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],u:function(e,n){for(var t=0,r=e.length;t<r;t++)n(e[t],t)},m:function(e,n){if("function"==typeof Array.prototype.indexOf)return Array.prototype.indexOf.call(e,n);for(var t=0,r=e.length;t<r;t++)if(e[t]===n)return t;return-1},qb:function(e,n,t){for(var r=0,a=e.length;r<a;r++)if(n.call(t,e[r],r))return e[r];return null},ua:function(e,n){var t=p.a.m(e,n);0<t?e.splice(t,1):0===t&&e.shift()},rb:function(e){e=e||[];for(var n=[],t=0,r=e.length;t<r;t++)0>p.a.m(n,e[t])&&n.push(e[t]);return n},Da:function(e,n){e=e||[];for(var t=[],r=0,a=e.length;r<a;r++)t.push(n(e[r],r));return t},ta:function(e,n){e=e||[];for(var t=[],r=0,a=e.length;r<a;r++)n(e[r],r)&&t.push(e[r]);return t},ga:function(e,n){if(n instanceof Array)e.push.apply(e,n);else for(var t=0,r=n.length;t<r;t++)e.push(n[t]);return e},ea:function(e,n,t){var r=p.a.m(p.a.Xa(e),n);0>r?t&&e.push(n):t||e.splice(r,1)},xa:s,extend:u,za:c,Aa:s?c:u,G:o,na:function(e,n){if(!e)return e;var t={},r;for(r in e)e.hasOwnProperty(r)&&(t[r]=n(e[r],r,e));return t},Ka:function(e){for(;e.firstChild;)p.removeNode(e.firstChild)},oc:function(e){e=p.a.S(e);for(var n=t.createElement("div"),r=0,a=e.length;r<a;r++)n.appendChild(p.R(e[r]));return n},ia:function(e,n){for(var t=0,r=e.length,a=[];t<r;t++){var i=e[t].cloneNode(!0);a.push(n?p.R(i):i)}return a},T:function(e,n){p.a.Ka(e);if(n)for(var t=0,r=n.length;t<r;t++)e.appendChild(n[t])},Lb:function(e,n){var t=e.nodeType?[e]:e;if(0<t.length){for(var r=t[0],a=r.parentNode,i=0,o=n.length;i<o;i++)a.insertBefore(n[i],r);i=0;for(o=t.length;i<o;i++)p.removeNode(t[i])}},ka:function(e,n){if(e.length){for(n=8===n.nodeType&&n.parentNode||n;e.length&&e[0].parentNode!==n;)e.shift();if(1<e.length){var t=e[0],r=e[e.length-1];for(e.length=0;t!==r;)if(e.push(t),t=t.nextSibling,!t)return;e.push(r)}}return e},Nb:function(e,n){7>h?e.setAttribute("selected",n):e.selected=n},cb:function(n){return null===n||n===e?"":n.trim?n.trim():n.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},vc:function(e,n){e=e||"";return n.length>e.length?!1:e.substring(0,n.length)===n},cc:function(e,n){if(e===n)return!0;if(11===e.nodeType)return!1;if(n.contains)return n.contains(3===e.nodeType?e.parentNode:e);if(n.compareDocumentPosition)return 16==(n.compareDocumentPosition(e)&16);for(;e&&e!=n;)e=e.parentNode;return!!e},Ja:function(e){return p.a.cc(e,e.ownerDocument.documentElement)},ob:function(e){return!!p.a.qb(e,p.a.Ja)},t:function(e){return e&&e.tagName&&e.tagName.toLowerCase()},n:function(e,n,t){var r=h&&d[n];if(!r&&a)a(e).bind(n,t);else if(r||"function"!=typeof e.addEventListener)if("undefined"!=typeof e.attachEvent){var i=function(n){t.call(e,n)},o="on"+n;e.attachEvent(o,i);p.a.w.da(e,function(){e.detachEvent(o,i)})}else throw Error("Browser doesn't support addEventListener or attachEvent");else e.addEventListener(n,t,!1)},oa:function(e,r){if(!e||!e.nodeType)throw Error("element must be a DOM node when calling triggerEvent");var i;"input"===p.a.t(e)&&e.type&&"click"==r.toLowerCase()?(i=e.type,i="checkbox"==i||"radio"==i):i=!1;if(a&&!i)a(e).trigger(r);else if("function"==typeof t.createEvent)if("function"==typeof e.dispatchEvent)i=t.createEvent(l[r]||"HTMLEvents"),i.initEvent(r,!0,!0,n,0,0,0,0,0,!1,!1,!1,!1,0,e),e.dispatchEvent(i);else throw Error("The supplied element doesn't support dispatchEvent");else if(i&&e.click)e.click();else if("undefined"!=typeof e.fireEvent)e.fireEvent("on"+r);else throw Error("Browser doesn't support triggering events")},c:function(e){return p.C(e)?e():e},Xa:function(e){return p.C(e)?e.v():e},Ba:function(e,n,t){if(n){var r=/\S+/g,a=e.className.match(r)||[];p.a.u(n.match(r),function(e){p.a.ea(a,e,t)});e.className=a.join(" ")}},bb:function(n,t){var r=p.a.c(t);if(null===r||r===e)r="";var a=p.f.firstChild(n);!a||3!=a.nodeType||p.f.nextSibling(a)?p.f.T(n,[n.ownerDocument.createTextNode(r)]):a.data=r;p.a.fc(n)},Mb:function(e,n){e.name=n;if(7>=h)try{e.mergeAttributes(t.createElement("<input name='"+e.name+"'/>"),!1)}catch(r){}},fc:function(e){9<=h&&(e=1==e.nodeType?e:e.parentNode,e.style&&(e.style.zoom=e.style.zoom))},dc:function(e){if(h){var n=e.style.width;e.style.width=0;e.style.width=n}},sc:function(e,n){e=p.a.c(e);n=p.a.c(n);for(var t=[],r=e;r<=n;r++)t.push(r);return t},S:function(e){for(var n=[],t=0,r=e.length;t<r;t++)n.push(e[t]);return n},yc:6===h,zc:7===h,L:h,xb:function(e,n){for(var t=p.a.S(e.getElementsByTagName("input")).concat(p.a.S(e.getElementsByTagName("textarea"))),r="string"==typeof n?function(e){return e.name===n}:function(e){return n.test(e.name)},a=[],i=t.length-1;0<=i;i--)r(t[i])&&a.push(t[i]);return a},pc:function(e){return"string"==typeof e&&(e=p.a.cb(e))?i&&i.parse?i.parse(e):new Function("return "+e)():null},eb:function(e,n,t){if(!i||!i.stringify)throw Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return i.stringify(p.a.c(e),n,t)},qc:function(e,n,r){r=r||{};var a=r.params||{},i=r.includeFields||this.vb,u=e;if("object"==typeof e&&"form"===p.a.t(e))for(var u=e.action,c=i.length-1;0<=c;c--)for(var s=p.a.xb(e,i[c]),f=s.length-1;0<=f;f--)a[s[f].name]=s[f].value;n=p.a.c(n);var l=t.createElement("form");l.style.display="none";l.action=u;l.method="post";for(var d in n)e=t.createElement("input"),e.type="hidden",e.name=d,e.value=p.a.eb(p.a.c(n[d])),l.appendChild(e);o(a,function(e,n){var r=t.createElement("input");r.type="hidden";r.name=e;r.value=n;l.appendChild(r)});t.body.appendChild(l);r.submitter?r.submitter(l):l.submit();setTimeout(function(){l.parentNode.removeChild(l)},0)}}}();p.b("utils",p.a);p.b("utils.arrayForEach",p.a.u);p.b("utils.arrayFirst",p.a.qb);p.b("utils.arrayFilter",p.a.ta);p.b("utils.arrayGetDistinctValues",p.a.rb);p.b("utils.arrayIndexOf",p.a.m);p.b("utils.arrayMap",p.a.Da);p.b("utils.arrayPushAll",p.a.ga);p.b("utils.arrayRemoveItem",p.a.ua);p.b("utils.extend",p.a.extend);p.b("utils.fieldsIncludedWithJsonPost",p.a.vb);p.b("utils.getFormFields",p.a.xb);p.b("utils.peekObservable",p.a.Xa);p.b("utils.postJson",p.a.qc);p.b("utils.parseJson",p.a.pc);p.b("utils.registerEventHandler",p.a.n);p.b("utils.stringifyJson",p.a.eb);p.b("utils.range",p.a.sc);p.b("utils.toggleDomNodeCssClass",p.a.Ba);p.b("utils.triggerEvent",p.a.oa);p.b("utils.unwrapObservable",p.a.c);p.b("utils.objectForEach",p.a.G);p.b("utils.addOrRemoveItem",p.a.ea);p.b("unwrap",p.a.c);Function.prototype.bind||(Function.prototype.bind=function(e){var n=this,t=Array.prototype.slice.call(arguments);e=t.shift();return function(){return n.apply(e,t.concat(Array.prototype.slice.call(arguments)))}});p.a.e=new function(){function n(n,i){var o=n[r];if(!o||"null"===o||!a[o]){if(!i)return e;o=n[r]="ko"+t++;a[o]={}}return a[o]}var t=0,r="__ko__"+(new Date).getTime(),a={};return{get:function(t,r){var a=n(t,!1);return a===e?e:a[r]},set:function(t,r,a){if(a!==e||n(t,!1)!==e)n(t,!0)[r]=a},clear:function(e){var n=e[r];return n?(delete a[n],e[r]=null,!0):!1},F:function(){return t++ +r}}};p.b("utils.domData",p.a.e);p.b("utils.domData.clear",p.a.e.clear);p.a.w=new function(){function n(n,t){var a=p.a.e.get(n,r);a===e&&t&&(a=[],p.a.e.set(n,r,a));return a}function t(e){var r=n(e,!1);if(r)for(var r=r.slice(0),a=0;a<r.length;a++)r[a](e);p.a.e.clear(e);p.a.w.cleanExternalData(e);if(o[e.nodeType])for(r=e.firstChild;e=r;)r=e.nextSibling,8===e.nodeType&&t(e)}var r=p.a.e.F(),i={1:!0,8:!0,9:!0},o={1:!0,9:!0};return{da:function(e,t){if("function"!=typeof t)throw Error("Callback must be a function");n(e,!0).push(t)},Kb:function(t,a){var i=n(t,!1);i&&(p.a.ua(i,a),0==i.length&&p.a.e.set(t,r,e))},R:function(e){if(i[e.nodeType]&&(t(e),o[e.nodeType])){var n=[];p.a.ga(n,e.getElementsByTagName("*"));for(var r=0,a=n.length;r<a;r++)t(n[r])}return e},removeNode:function(e){p.R(e);e.parentNode&&e.parentNode.removeChild(e)},cleanExternalData:function(e){a&&"function"==typeof a.cleanData&&a.cleanData([e])}}};p.R=p.a.w.R;p.removeNode=p.a.w.removeNode;p.b("cleanNode",p.R);p.b("removeNode",p.removeNode);p.b("utils.domNodeDisposal",p.a.w);p.b("utils.domNodeDisposal.addDisposeCallback",p.a.w.da);p.b("utils.domNodeDisposal.removeDisposeCallback",p.a.w.Kb);(function(){p.a.ba=function(e){var r;if(a)if(a.parseHTML)r=a.parseHTML(e)||[];else{if((r=a.clean([e]))&&r[0]){for(e=r[0];e.parentNode&&11!==e.parentNode.nodeType;)e=e.parentNode;e.parentNode&&e.parentNode.removeChild(e)}}else{var i=p.a.cb(e).toLowerCase();r=t.createElement("div");i=i.match(/^<(thead|tbody|tfoot)/)&&[1,"<table>","</table>"]||!i.indexOf("<tr")&&[2,"<table><tbody>","</tbody></table>"]||(!i.indexOf("<td")||!i.indexOf("<th"))&&[3,"<table><tbody><tr>","</tr></tbody></table>"]||[0,"",""];e="ignored<div>"+i[1]+e+i[2]+"</div>";for("function"==typeof n.innerShiv?r.appendChild(n.innerShiv(e)):r.innerHTML=e;i[0]--;)r=r.lastChild;r=p.a.S(r.lastChild.childNodes)}return r};p.a.$a=function(n,t){p.a.Ka(n);t=p.a.c(t);if(null!==t&&t!==e)if("string"!=typeof t&&(t=t.toString()),a)a(n).html(t);else for(var r=p.a.ba(t),i=0;i<r.length;i++)n.appendChild(r[i])}})();p.b("utils.parseHtmlFragment",p.a.ba);p.b("utils.setHtml",p.a.$a);p.D=function(){function n(e,t){if(e)if(8==e.nodeType){var r=p.D.Gb(e.nodeValue);null!=r&&t.push({bc:e,mc:r})}else if(1==e.nodeType)for(var r=0,a=e.childNodes,i=a.length;r<i;r++)n(a[r],t)}var t={};return{Ua:function(e){if("function"!=typeof e)throw Error("You can only pass a function to ko.memoization.memoize()");var n=(4294967296*(1+Math.random())|0).toString(16).substring(1)+(4294967296*(1+Math.random())|0).toString(16).substring(1);t[n]=e;return"<!--[ko_memo:"+n+"]-->"},Rb:function(n,r){var a=t[n];if(a===e)throw Error("Couldn't find any memo with ID "+n+". Perhaps it's already been unmemoized.");try{return a.apply(null,r||[]),!0}finally{delete t[n]}},Sb:function(e,t){var r=[];n(e,r);for(var a=0,i=r.length;a<i;a++){var o=r[a].bc,u=[o];t&&p.a.ga(u,t);p.D.Rb(r[a].mc,u);o.nodeValue="";o.parentNode&&o.parentNode.removeChild(o)}},Gb:function(e){return(e=e.match(/^\[ko_memo\:(.*?)\]$/))?e[1]:null}}}();p.b("memoization",p.D);p.b("memoization.memoize",p.D.Ua);p.b("memoization.unmemoize",p.D.Rb);p.b("memoization.parseMemoText",p.D.Gb);p.b("memoization.unmemoizeDomNodeAndDescendants",p.D.Sb);p.La={throttle:function(e,n){e.throttleEvaluation=n;var t=null;return p.j({read:e,write:function(r){clearTimeout(t);t=setTimeout(function(){e(r)},n)}})},rateLimit:function(e,n){var t,r,a;"number"==typeof n?t=n:(t=n.timeout,r=n.method);a="notifyWhenChangesStop"==r?f:s;e.Ta(function(e){return a(e,t)})},notify:function(e,n){e.equalityComparer="always"==n?null:c}};var d={undefined:1,"boolean":1,number:1,string:1};p.b("extenders",p.La);p.Pb=function(e,n,t){this.target=e;this.wa=n;this.ac=t;this.Cb=!1;p.A(this,"dispose",this.K)};p.Pb.prototype.K=function(){this.Cb=!0;this.ac()};p.P=function(){p.a.Aa(this,p.P.fn);this.M={}};var h="change",b={U:function(e,n,t){var r=this;t=t||h;var a=new p.Pb(r,n?e.bind(n):e,function(){p.a.ua(r.M[t],a);r.nb&&r.nb()});r.va&&r.va(t);r.M[t]||(r.M[t]=[]);r.M[t].push(a);return a},notifySubscribers:function(e,n){n=n||h;if(this.Ab(n))try{p.k.Ea();for(var t=this.M[n].slice(0),r=0,a;a=t[r];++r)a.Cb||a.wa(e)}finally{p.k.end()}},Ta:function(e){var n=this,t=p.C(n),r,a,i;n.qa||(n.qa=n.notifySubscribers,n.notifySubscribers=function(e,t){t&&t!==h?"beforeChange"===t?n.kb(e):n.qa(e,t):n.lb(e)});var o=e(function(){t&&i===n&&(i=n());r=!1;n.Pa(a,i)&&n.qa(a=i)});n.lb=function(e){r=!0;i=e;o()};n.kb=function(e){r||(a=e,n.qa(e,"beforeChange"))}},Ab:function(e){return this.M[e]&&this.M[e].length},yb:function(){var e=0;p.a.G(this.M,function(n,t){e+=t.length});return e},Pa:function(e,n){return!this.equalityComparer||!this.equalityComparer(e,n)},extend:function(e){var n=this;e&&p.a.G(e,function(e,t){var r=p.La[e];"function"==typeof r&&(n=r(n,t)||n)});return n}};p.A(b,"subscribe",b.U);p.A(b,"extend",b.extend);p.A(b,"getSubscriptionsCount",b.yb);p.a.xa&&p.a.za(b,Function.prototype);p.P.fn=b;p.Db=function(e){return null!=e&&"function"==typeof e.U&&"function"==typeof e.notifySubscribers};p.b("subscribable",p.P);p.b("isSubscribable",p.Db);p.Y=p.k=function(){function e(e){t.push(r);r=e}function n(){r=t.pop()}var t=[],r,a=0;return{Ea:e,end:n,Jb:function(e){if(r){if(!p.Db(e))throw Error("Only subscribable things can act as dependencies");r.wa(e,e.Vb||(e.Vb=++a))}},B:function(t,r,a){try{return e(),t.apply(r,a||[])}finally{n()}},la:function(){if(r)return r.s.la()},ma:function(){if(r)return r.ma}}}();p.b("computedContext",p.Y);p.b("computedContext.getDependenciesCount",p.Y.la);p.b("computedContext.isInitial",p.Y.ma);p.b("computedContext.isSleeping",p.Y.Ac);p.p=function(e){function n(){if(0<arguments.length)return n.Pa(t,arguments[0])&&(n.X(),t=arguments[0],n.W()),this;p.k.Jb(n);return t}var t=e;p.P.call(n);p.a.Aa(n,p.p.fn);n.v=function(){return t};n.W=function(){n.notifySubscribers(t)};n.X=function(){n.notifySubscribers(t,"beforeChange")};p.A(n,"peek",n.v);p.A(n,"valueHasMutated",n.W);p.A(n,"valueWillMutate",n.X);return n};p.p.fn={equalityComparer:c};var m=p.p.rc="__ko_proto__";p.p.fn[m]=p.p;p.a.xa&&p.a.za(p.p.fn,p.P.fn);p.Ma=function(n,t){return null===n||n===e||n[m]===e?!1:n[m]===t?!0:p.Ma(n[m],t)};p.C=function(e){return p.Ma(e,p.p)};p.Ra=function(e){return"function"==typeof e&&e[m]===p.p||"function"==typeof e&&e[m]===p.j&&e.hc?!0:!1};p.b("observable",p.p);p.b("isObservable",p.C);p.b("isWriteableObservable",p.Ra);p.b("isWritableObservable",p.Ra);p.aa=function(e){e=e||[];if("object"!=typeof e||!("length"in e))throw Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");e=p.p(e);p.a.Aa(e,p.aa.fn);return e.extend({trackArrayChanges:!0})};p.aa.fn={remove:function(e){for(var n=this.v(),t=[],r="function"!=typeof e||p.C(e)?function(n){return n===e}:e,a=0;a<n.length;a++){var i=n[a];r(i)&&(0===t.length&&this.X(),t.push(i),n.splice(a,1),a--)}t.length&&this.W();return t},removeAll:function(n){if(n===e){var t=this.v(),r=t.slice(0);this.X();t.splice(0,t.length);this.W();return r}return n?this.remove(function(e){return 0<=p.a.m(n,e)}):[]},destroy:function(e){var n=this.v(),t="function"!=typeof e||p.C(e)?function(n){return n===e}:e;this.X();for(var r=n.length-1;0<=r;r--)t(n[r])&&(n[r]._destroy=!0);this.W()},destroyAll:function(n){return n===e?this.destroy(function(){return!0}):n?this.destroy(function(e){return 0<=p.a.m(n,e)}):[]},indexOf:function(e){var n=this();return p.a.m(n,e)},replace:function(e,n){var t=this.indexOf(e);0<=t&&(this.X(),this.v()[t]=n,this.W())}};p.a.u("pop push reverse shift sort splice unshift".split(" "),function(e){p.aa.fn[e]=function(){var n=this.v();this.X();this.sb(n,e,arguments);n=n[e].apply(n,arguments);this.W();return n}});p.a.u(["slice"],function(e){p.aa.fn[e]=function(){var n=this();return n[e].apply(n,arguments)}});p.a.xa&&p.a.za(p.aa.fn,p.p.fn);p.b("observableArray",p.aa);var g="arrayChange";p.La.trackArrayChanges=function(e){function n(){if(!t){t=!0;var n=e.notifySubscribers;e.notifySubscribers=function(e,t){t&&t!==h||++a;return n.apply(this,arguments)};var i=[].concat(e.v()||[]);r=null;e.U(function(n){n=[].concat(n||[]);if(e.Ab(g)){var t;if(!r||1<a)r=p.a.Fa(i,n,{sparse:!0});t=r;t.length&&e.notifySubscribers(t,g)}i=n;r=null;a=0})}}if(!e.sb){var t=!1,r=null,a=0,i=e.U;e.U=e.subscribe=function(e,t,r){r===g&&n();return i.apply(this,arguments)};e.sb=function(e,n,i){function o(e,n,t){return u[u.length]={status:e,value:n,index:t}}if(t&&!a){var u=[],c=e.length,s=i.length,f=0;switch(n){case"push":f=c;case"unshift":for(n=0;n<s;n++)o("added",i[n],f+n);break;case"pop":f=c-1;case"shift":c&&o("deleted",e[f],f);break;case"splice":n=Math.min(Math.max(0,0>i[0]?c+i[0]:i[0]),c);for(var c=1===s?c:Math.min(n+(i[1]||0),c),s=n+s-2,f=Math.max(c,s),l=[],d=[],h=2;n<f;++n,++h)n<c&&d.push(o("deleted",e[n],n)),n<s&&l.push(o("added",i[h],n));p.a.wb(d,l);break;default:return}r=u}}}};p.s=p.j=function(n,t,r){function a(){p.a.G(C,function(e,n){n.K()});C={}}function i(){a();N=0;m=!0;d=!1}function o(){var e=c.throttleEvaluation;e&&0<=e?(clearTimeout(S),S=setTimeout(u,e)):c.ib?c.ib():u()}function u(n){if(h){if(v)throw Error("A 'pure' computed must not be called recursively")}else if(!m){if(E&&E()){if(!b){T();return}}else b=!1;h=!0;if(y)try{var r={};p.k.Ea({wa:function(e,n){r[n]||(r[n]=1,++N)},s:c,ma:e});N=0;l=g.call(t)}finally{p.k.end(),h=!1}else try{var a=C,i=N;p.k.Ea({wa:function(e,n){m||(i&&a[n]?(C[n]=a[n],++N,delete a[n],--i):C[n]||(C[n]=e.U(o),++N))},s:c,ma:v?e:!N});C={};N=0;try{var u=t?g.call(t):g()}finally{p.k.end(),i&&p.a.G(a,function(e,n){n.K()}),d=!1}c.Pa(l,u)&&(c.notifySubscribers(l,"beforeChange"),l=u,!0!==n&&c.notifySubscribers(l))}finally{h=!1}N||T()}}function c(){if(0<arguments.length){if("function"===typeof w)w.apply(t,arguments);else throw Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");return this}p.k.Jb(c);d&&u(!0);return l}function s(){d&&!N&&u(!0);return l}function f(){return d||0<N}var l,d=!0,h=!1,b=!1,m=!1,g=n,v=!1,y=!1;g&&"object"==typeof g?(r=g,g=r.read):(r=r||{},g||(g=r.read));if("function"!=typeof g)throw Error("Pass a function that returns the value of the ko.computed");var w=r.write,x=r.disposeWhenNodeIsRemoved||r.o||null,k=r.disposeWhen||r.Ia,E=k,T=i,C={},N=0,S=null;t||(t=r.owner);p.P.call(c);p.a.Aa(c,p.j.fn);c.v=s;c.la=function(){return N};c.hc="function"===typeof r.write;c.K=function(){T()};c.Z=f;var _=c.Ta;c.Ta=function(e){_.call(c,e);c.ib=function(){c.kb(l);d=!0;c.lb(c)}};r.pure?(y=v=!0,c.va=function(){y&&(y=!1,u(!0))},c.nb=function(){c.yb()||(a(),y=d=!0)}):r.deferEvaluation&&(c.va=function(){s();delete c.va});p.A(c,"peek",c.v);p.A(c,"dispose",c.K);p.A(c,"isActive",c.Z);p.A(c,"getDependenciesCount",c.la);x&&(b=!0,x.nodeType&&(E=function(){return!p.a.Ja(x)||k&&k()}));y||r.deferEvaluation||u();x&&f()&&x.nodeType&&(T=function(){p.a.w.Kb(x,T);i()},p.a.w.da(x,T));return c};p.jc=function(e){return p.Ma(e,p.j)};b=p.p.rc;p.j[b]=p.p;p.j.fn={equalityComparer:c};p.j.fn[b]=p.j;p.a.xa&&p.a.za(p.j.fn,p.P.fn);p.b("dependentObservable",p.j);p.b("computed",p.j);p.b("isComputed",p.jc);p.Ib=function(e,n){if("function"===typeof e)return p.s(e,n,{pure:!0});e=p.a.extend({},e);e.pure=!0;return p.s(e,n)};p.b("pureComputed",p.Ib);(function(){function n(a,i,o){o=o||new r;a=i(a);if("object"!=typeof a||null===a||a===e||a instanceof Date||a instanceof String||a instanceof Number||a instanceof Boolean)return a;var u=a instanceof Array?[]:{};o.save(a,u);t(a,function(t){var r=i(a[t]);switch(typeof r){case"boolean":case"number":case"string":case"function":u[t]=r;break;case"object":case"undefined":var c=o.get(r);u[t]=c!==e?c:n(r,i,o)}});return u}function t(e,n){if(e instanceof Array){for(var t=0;t<e.length;t++)n(t);"function"==typeof e.toJSON&&n("toJSON")}else for(t in e)n(t)}function r(){this.keys=[];this.hb=[]}p.Qb=function(e){if(0==arguments.length)throw Error("When calling ko.toJS, pass the object you want to convert.");return n(e,function(e){for(var n=0;p.C(e)&&10>n;n++)e=e();return e})};p.toJSON=function(e,n,t){e=p.Qb(e);return p.a.eb(e,n,t)};r.prototype={save:function(e,n){var t=p.a.m(this.keys,e);0<=t?this.hb[t]=n:(this.keys.push(e),this.hb.push(n))},get:function(n){n=p.a.m(this.keys,n);return 0<=n?this.hb[n]:e}}})();p.b("toJS",p.Qb);p.b("toJSON",p.toJSON);(function(){p.i={q:function(n){switch(p.a.t(n)){case"option":return!0===n.__ko__hasDomDataOptionValue__?p.a.e.get(n,p.d.options.Va):7>=p.a.L?n.getAttributeNode("value")&&n.getAttributeNode("value").specified?n.value:n.text:n.value;case"select":return 0<=n.selectedIndex?p.i.q(n.options[n.selectedIndex]):e;default:return n.value}},ca:function(n,t,r){switch(p.a.t(n)){case"option":switch(typeof t){case"string":p.a.e.set(n,p.d.options.Va,e);"__ko__hasDomDataOptionValue__"in n&&delete n.__ko__hasDomDataOptionValue__;n.value=t;break;default:p.a.e.set(n,p.d.options.Va,t),n.__ko__hasDomDataOptionValue__=!0,n.value="number"===typeof t?t:""}break;case"select":if(""===t||null===t)t=e;for(var a=-1,i=0,o=n.options.length,u;i<o;++i)if(u=p.i.q(n.options[i]),u==t||""==u&&t===e){a=i;break}if(r||0<=a||t===e&&1<n.size)n.selectedIndex=a;break;default:if(null===t||t===e)t="";n.value=t}}}})();p.b("selectExtensions",p.i);p.b("selectExtensions.readValue",p.i.q);p.b("selectExtensions.writeValue",p.i.ca);p.h=function(){function e(e){e=p.a.cb(e);123===e.charCodeAt(0)&&(e=e.slice(1,-1));var n=[],t=e.match(r),o,u,c=0;if(t){t.push(",");for(var s=0,f;f=t[s];++s){var l=f.charCodeAt(0);if(44===l){if(0>=c){o&&n.push(u?{key:o,value:u.join("")}:{unknown:o});o=u=c=0;continue}}else if(58===l){if(!u)continue}else if(47===l&&s&&1<f.length)(l=t[s-1].match(a))&&!i[l[0]]&&(e=e.substr(e.indexOf(f)+1),t=e.match(r),t.push(","),s=-1,f="/");else if(40===l||123===l||91===l)++c;else if(41===l||125===l||93===l)--c;else if(!o&&!u){o=34===l||39===l?f.slice(1,-1):f;continue}u?u.push(f):u=[f]}}return n}var n=["true","false","null","undefined"],t=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,r=RegExp("\"(?:[^\"\\\\]|\\\\.)*\"|'(?:[^'\\\\]|\\\\.)*'|/(?:[^/\\\\]|\\\\.)*/w*|[^\\s:,/][^,\"'{}()/:[\\]]*[^\\s,\"'{}()/:[\\]]|[^\\s]","g"),a=/[\])"'A-Za-z0-9_$]+$/,i={"in":1,"return":1,"typeof":1},o={};return{ha:[],V:o,Wa:e,ya:function(r,a){function i(e,r){var a;if(!f){var l=p.getBindingHandler(e);if(l&&l.preprocess&&!(r=l.preprocess(r,e,i)))return;if(l=o[e])a=r,0<=p.a.m(n,a)?a=!1:(l=a.match(t),a=null===l?!1:l[1]?"Object("+l[1]+")"+l[2]:a),l=a;l&&c.push("'"+e+"':function(_z){"+a+"=_z}")}s&&(r="function(){return "+r+" }");u.push("'"+e+"':"+r)}a=a||{};var u=[],c=[],s=a.valueAccessors,f=a.bindingParams,l="string"===typeof r?e(r):r;p.a.u(l,function(e){i(e.key||e.unknown,e.value)});c.length&&i("_ko_property_writers","{"+c.join(",")+" }");return u.join(",")},lc:function(e,n){for(var t=0;t<e.length;t++)if(e[t].key==n)return!0;return!1},pa:function(e,n,t,r,a){if(e&&p.C(e))!p.Ra(e)||a&&e.v()===r||e(r);else if((e=n.get("_ko_property_writers"))&&e[t])e[t](r)}}}();p.b("expressionRewriting",p.h);p.b("expressionRewriting.bindingRewriteValidators",p.h.ha);p.b("expressionRewriting.parseObjectLiteral",p.h.Wa);p.b("expressionRewriting.preProcessBindings",p.h.ya);p.b("expressionRewriting._twoWayBindings",p.h.V);p.b("jsonExpressionRewriting",p.h);p.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",p.h.ya);(function(){function e(e){return 8==e.nodeType&&o.test(i?e.text:e.nodeValue)}function n(e){return 8==e.nodeType&&u.test(i?e.text:e.nodeValue)}function r(t,r){for(var a=t,i=1,o=[];a=a.nextSibling;){if(n(a)&&(i--,0===i))return o;o.push(a);e(a)&&i++}if(!r)throw Error("Cannot find closing comment tag to match: "+t.nodeValue);return null}function a(e,n){var t=r(e,n);return t?0<t.length?t[t.length-1].nextSibling:e.nextSibling:null}var i=t&&"<!--test-->"===t.createComment("test").text,o=i?/^\x3c!--\s*ko(?:\s+([\s\S]+))?\s*--\x3e$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,u=i?/^\x3c!--\s*\/ko\s*--\x3e$/:/^\s*\/ko\s*$/,c={ul:!0,ol:!0};p.f={Q:{},childNodes:function(n){return e(n)?r(n):n.childNodes},ja:function(n){if(e(n)){n=p.f.childNodes(n);for(var t=0,r=n.length;t<r;t++)p.removeNode(n[t])}else p.a.Ka(n)},T:function(n,t){if(e(n)){p.f.ja(n);for(var r=n.nextSibling,a=0,i=t.length;a<i;a++)r.parentNode.insertBefore(t[a],r)}else p.a.T(n,t)},Hb:function(n,t){e(n)?n.parentNode.insertBefore(t,n.nextSibling):n.firstChild?n.insertBefore(t,n.firstChild):n.appendChild(t)},Bb:function(n,t,r){r?e(n)?n.parentNode.insertBefore(t,r.nextSibling):r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):p.f.Hb(n,t)},firstChild:function(t){return e(t)?!t.nextSibling||n(t.nextSibling)?null:t.nextSibling:t.firstChild},nextSibling:function(t){e(t)&&(t=a(t));return t.nextSibling&&n(t.nextSibling)?null:t.nextSibling},gc:e,xc:function(e){return(e=(i?e.text:e.nodeValue).match(o))?e[1]:null},Fb:function(t){if(c[p.a.t(t)]){var r=t.firstChild;if(r){do if(1===r.nodeType){var i;i=r.firstChild;var o=null;if(i){do if(o)o.push(i);else if(e(i)){var u=a(i,!0);u?i=u:o=[i]}else n(i)&&(o=[i]);while(i=i.nextSibling)}if(i=o)for(o=r.nextSibling,u=0;u<i.length;u++)o?t.insertBefore(i[u],o):t.appendChild(i[u])}while(r=r.nextSibling)}}}}})();p.b("virtualElements",p.f);p.b("virtualElements.allowedBindings",p.f.Q);p.b("virtualElements.emptyNode",p.f.ja);p.b("virtualElements.insertAfter",p.f.Bb);p.b("virtualElements.prepend",p.f.Hb);p.b("virtualElements.setDomNodeChildren",p.f.T);(function(){p.J=function(){this.Yb={}};p.a.extend(p.J.prototype,{nodeHasBindings:function(e){switch(e.nodeType){case 1:return null!=e.getAttribute("data-bind")||p.g.getComponentNameForNode(e);case 8:return p.f.gc(e);default:return!1}},getBindings:function(e,n){var t=this.getBindingsString(e,n),t=t?this.parseBindingsString(t,n,e):null;return p.g.mb(t,e,n,!1)},getBindingAccessors:function(e,n){var t=this.getBindingsString(e,n),t=t?this.parseBindingsString(t,n,e,{valueAccessors:!0}):null;return p.g.mb(t,e,n,!0)},getBindingsString:function(e){switch(e.nodeType){case 1:return e.getAttribute("data-bind");case 8:return p.f.xc(e);default:return null}},parseBindingsString:function(e,n,t,r){try{var a=this.Yb,i=e+(r&&r.valueAccessors||""),o;if(!(o=a[i])){var u,c="with($context){with($data||{}){return{"+p.h.ya(e,r)+"}}}";u=new Function("$context","$element",c);o=a[i]=u}return o(n,t)}catch(s){throw s.message="Unable to parse bindings.\nBindings value: "+e+"\nMessage: "+s.message,s}}});p.J.instance=new p.J})();p.b("bindingProvider",p.J);(function(){function t(e){return function(){return e}}function r(e){return e()}function i(e){return p.a.na(p.k.B(e),function(n,t){return function(){return e()[t]}})}function o(e,n){return i(this.getBindings.bind(this,e,n))}function u(e,n,t){var r,a=p.f.firstChild(n),i=p.J.instance,o=i.preprocessNode;if(o){for(;r=a;)a=p.f.nextSibling(r),o.call(i,r);a=p.f.firstChild(n)}for(;r=a;)a=p.f.nextSibling(r),c(e,r,t)}function c(e,n,t){var r=!0,a=1===n.nodeType;a&&p.f.Fb(n);if(a&&t||p.J.instance.nodeHasBindings(n))r=f(n,null,e,t).shouldBindDescendants;r&&!d[p.a.t(n)]&&u(e,n,!a)}function s(e){var n=[],t={},r=[];p.a.G(e,function a(i){if(!t[i]){var o=p.getBindingHandler(i);o&&(o.after&&(r.push(i),p.a.u(o.after,function(n){if(e[n]){if(-1!==p.a.m(r,n))throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+r.join(", "));a(n)}}),r.length--),n.push({key:i,zb:o}));t[i]=!0}});return n}function f(n,t,a,i){var u=p.a.e.get(n,h);if(!t){if(u)throw Error("You cannot apply bindings multiple times to the same element.");p.a.e.set(n,h,!0)}!u&&i&&p.Ob(n,a);var c;if(t&&"function"!==typeof t)c=t;else{var f=p.J.instance,l=f.getBindingAccessors||o,d=p.j(function(){(c=t?t(a,n):l.call(f,n,a))&&a.I&&a.I();return c},null,{o:n});c&&d.Z()||(d=null)}var b;if(c){var m=d?function(e){return function(){return r(d()[e])}}:function(e){return c[e]},g=function(){return p.a.na(d?d():c,r)};g.get=function(e){return c[e]&&r(m(e))};g.has=function(e){return e in c};i=s(c);p.a.u(i,function(t){var r=t.zb.init,i=t.zb.update,o=t.key;if(8===n.nodeType&&!p.f.Q[o])throw Error("The binding '"+o+"' cannot be used with virtual elements");try{"function"==typeof r&&p.k.B(function(){var t=r(n,m(o),g,a.$data,a);if(t&&t.controlsDescendantBindings){if(b!==e)throw Error("Multiple bindings ("+b+" and "+o+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");b=o}}),"function"==typeof i&&p.j(function(){i(n,m(o),g,a.$data,a)},null,{o:n})}catch(u){throw u.message='Unable to process binding "'+o+": "+c[o]+'"\nMessage: '+u.message,u}})}return{shouldBindDescendants:b===e}}function l(e){return e&&e instanceof p.N?e:new p.N(e)}p.d={};var d={script:!0};p.getBindingHandler=function(e){return p.d[e]};p.N=function(n,t,r,a){var i=this,o="function"==typeof n&&!p.C(n),u,c=p.j(function(){var e=o?n():n,u=p.a.c(e);t?(t.I&&t.I(),p.a.extend(i,t),c&&(i.I=c)):(i.$parents=[],i.$root=u,i.ko=p);i.$rawData=e;i.$data=u;r&&(i[r]=u);a&&a(i,t,u);return i.$data},null,{Ia:function(){return u&&!p.a.ob(u)},o:!0});c.Z()&&(i.I=c,c.equalityComparer=null,u=[],c.Tb=function(n){u.push(n);p.a.w.da(n,function(n){p.a.ua(u,n);u.length||(c.K(),i.I=c=e)})})};p.N.prototype.createChildContext=function(e,n,t){return new p.N(e,this,n,function(e,n){e.$parentContext=n;e.$parent=n.$data;e.$parents=(n.$parents||[]).slice(0);e.$parents.unshift(e.$parent);t&&t(e)})};p.N.prototype.extend=function(e){return new p.N(this.I||this.$data,this,null,function(n,t){n.$rawData=t.$rawData;p.a.extend(n,"function"==typeof e?e():e)})};var h=p.a.e.F(),b=p.a.e.F();p.Ob=function(e,n){if(2==arguments.length)p.a.e.set(e,b,n),n.I&&n.I.Tb(e);else return p.a.e.get(e,b)};p.ra=function(e,n,t){1===e.nodeType&&p.f.Fb(e);return f(e,n,l(t),!0)};p.Wb=function(e,n,r){r=l(r);return p.ra(e,"function"===typeof n?i(n.bind(null,r,e)):p.a.na(n,t),r)};p.Ca=function(e,n){1!==n.nodeType&&8!==n.nodeType||u(l(e),n,!0)};p.pb=function(e,t){!a&&n.jQuery&&(a=n.jQuery);if(t&&1!==t.nodeType&&8!==t.nodeType)throw Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");t=t||n.document.body;c(l(e),t,!0)};p.Ha=function(n){switch(n.nodeType){case 1:case 8:var t=p.Ob(n);if(t)return t;if(n.parentNode)return p.Ha(n.parentNode)}return e};p.$b=function(n){return(n=p.Ha(n))?n.$data:e};p.b("bindingHandlers",p.d);p.b("applyBindings",p.pb);p.b("applyBindingsToDescendants",p.Ca);p.b("applyBindingAccessorsToNode",p.ra);p.b("applyBindingsToNode",p.Wb);p.b("contextFor",p.Ha);p.b("dataFor",p.$b)})();(function(e){function n(n,r){var o=a.hasOwnProperty(n)?a[n]:e,u;o||(o=a[n]=new p.P,t(n,function(e){i[n]=e;delete a[n];u?o.notifySubscribers(e):setTimeout(function(){o.notifySubscribers(e)},0)}),u=!0);o.U(r)}function t(e,n){r("getConfig",[e],function(t){t?r("loadComponent",[e,t],function(e){n(e)}):n(null)})}function r(n,t,a,i){i||(i=p.g.loaders.slice(0));var o=i.shift();if(o){var u=o[n];if(u){var c=!1;if(u.apply(o,t.concat(function(e){c?a(null):null!==e?a(e):r(n,t,a,i)}))!==e&&(c=!0,!o.suppressLoaderExceptions))throw Error("Component loaders must supply values by invoking the callback, not by returning values synchronously.")}else r(n,t,a,i)}else a(null)}var a={},i={};p.g={get:function(t,r){var a=i.hasOwnProperty(t)?i[t]:e;a?setTimeout(function(){r(a)},0):n(t,r)},tb:function(e){delete i[e]},jb:r};p.g.loaders=[];p.b("components",p.g);p.b("components.get",p.g.get);p.b("components.clearCachedDefinition",p.g.tb)})();(function(){function e(e,n,t,r){function a(){0===--u&&r(i)}var i={},u=2,c=t.template;t=t.viewModel;c?o(n,c,function(n){p.g.jb("loadTemplate",[e,n],function(e){i.template=e;a()})}):a();t?o(n,t,function(n){p.g.jb("loadViewModel",[e,n],function(e){i[f]=e;a()})}):a()}function r(e,n,t){if("function"===typeof n)t(function(e){return new n(e)});else if("function"===typeof n[f])t(n[f]);else if("instance"in n){var a=n.instance;t(function(){return a})}else"viewModel"in n?r(e,n.viewModel,t):e("Unknown viewModel value: "+n)}function a(e){switch(p.a.t(e)){case"script":return p.a.ba(e.text);case"textarea":return p.a.ba(e.value);case"template":if(i(e.content))return p.a.ia(e.content.childNodes)}return p.a.ia(e.childNodes)}function i(e){return n.DocumentFragment?e instanceof DocumentFragment:e&&11===e.nodeType}function o(e,t,r){"string"===typeof t.require?u||n.require?(u||n.require)([t.require],r):e("Uses require, but no AMD loader is present"):r(t)}function c(e){return function(n){throw Error("Component '"+e+"': "+n)}}var s={};p.g.tc=function(e,n){if(!n)throw Error("Invalid configuration for "+e);if(p.g.Qa(e))throw Error("Component "+e+" is already registered");s[e]=n};p.g.Qa=function(e){return e in s};p.g.wc=function(e){delete s[e];p.g.tb(e)};p.g.ub={getConfig:function(e,n){n(s.hasOwnProperty(e)?s[e]:null)},loadComponent:function(n,t,r){var a=c(n);o(a,t,function(t){e(n,a,t,r)})},loadTemplate:function(e,r,o){e=c(e);if("string"===typeof r)o(p.a.ba(r));else if(r instanceof Array)o(r);else if(i(r))o(p.a.S(r.childNodes));else if(r.element)if(r=r.element,n.HTMLElement?r instanceof HTMLElement:r&&r.tagName&&1===r.nodeType)o(a(r));else if("string"===typeof r){var u=t.getElementById(r);u?o(a(u)):e("Cannot find element with ID "+r)}else e("Unknown element type: "+r);else e("Unknown template value: "+r)},loadViewModel:function(e,n,t){r(c(e),n,t)}};var f="createViewModel";p.b("components.register",p.g.tc);p.b("components.isRegistered",p.g.Qa);p.b("components.unregister",p.g.wc);p.b("components.defaultLoader",p.g.ub);p.g.loaders.push(p.g.ub);p.g.Ub=s})();(function(){function e(e,t){var r=e.getAttribute("params");if(r){var r=n.parseBindingsString(r,t,e,{valueAccessors:!0,bindingParams:!0}),r=p.a.na(r,function(n){return p.s(n,null,{o:e})}),a=p.a.na(r,function(n){return n.Z()?p.s(function(){return p.a.c(n())},null,{o:e}):n.v()});a.hasOwnProperty("$raw")||(a.$raw=r);return a}return{$raw:{}}}p.g.getComponentNameForNode=function(e){e=p.a.t(e);return p.g.Qa(e)&&e};p.g.mb=function(n,t,r,a){if(1===t.nodeType){var i=p.g.getComponentNameForNode(t);if(i){n=n||{};if(n.component)throw Error('Cannot use the "component" binding on a custom element matching a component');var o={name:i,params:e(t,r)};n.component=a?function(){return o}:o}}return n};var n=new p.J;9>p.a.L&&(p.g.register=function(e){return function(n){t.createElement(n);return e.apply(this,arguments)}}(p.g.register),t.createDocumentFragment=function(e){return function(){var n=e(),t=p.g.Ub,r;for(r in t)t.hasOwnProperty(r)&&n.createElement(r);return n}}(t.createDocumentFragment))})();(function(){var e=0;p.d.component={init:function(n,t,r,a,i){function o(){var e=u&&u.dispose;"function"===typeof e&&e.call(u);c=null}var u,c;p.a.w.da(n,o);p.s(function(){var r=p.a.c(t()),a,s;"string"===typeof r?a=r:(a=p.a.c(r.name),s=p.a.c(r.params));if(!a)throw Error("No component name specified");var f=c=++e;p.g.get(a,function(e){if(c===f){o();if(!e)throw Error("Unknown component '"+a+"'");var t=e.template;if(!t)throw Error("Component '"+a+"' has no template");t=p.a.ia(t);p.f.T(n,t);var t=s,r=e.createViewModel;e=r?r.call(e,t,{element:n}):t;t=i.createChildContext(e);u=e;p.Ca(t,n)}})},null,{o:n});return{controlsDescendantBindings:!0}}};p.f.Q.component=!0})();var v={"class":"className","for":"htmlFor"};p.d.attr={update:function(n,t){var r=p.a.c(t())||{};p.a.G(r,function(t,r){r=p.a.c(r);var a=!1===r||null===r||r===e;a&&n.removeAttribute(t);8>=p.a.L&&t in v?(t=v[t],a?n.removeAttribute(t):n[t]=r):a||n.setAttribute(t,r.toString());"name"===t&&p.a.Mb(n,a?"":r.toString())})}};(function(){p.d.checked={after:["value","attr"],init:function(n,t,r){function a(){var e=n.checked,a=l?o():e;if(!p.Y.ma()&&(!c||e)){var i=p.k.B(t);s?f!==a?(e&&(p.a.ea(i,a,!0),p.a.ea(i,f,!1)),f=a):p.a.ea(i,a,e):p.h.pa(i,r,"checked",a,!0)}}function i(){var e=p.a.c(t());n.checked=s?0<=p.a.m(e,o()):u?e:o()===e}var o=p.Ib(function(){return r.has("checkedValue")?p.a.c(r.get("checkedValue")):r.has("value")?p.a.c(r.get("value")):n.value}),u="checkbox"==n.type,c="radio"==n.type;if(u||c){var s=u&&p.a.c(t())instanceof Array,f=s?o():e,l=c||s;c&&!n.name&&p.d.uniqueName.init(n,function(){return!0});p.s(a,null,{o:n});p.a.n(n,"click",a);p.s(i,null,{o:n})}}};p.h.V.checked=!0;p.d.checkedValue={update:function(e,n){e.value=p.a.c(n())}}})();p.d.css={update:function(e,n){var t=p.a.c(n());"object"==typeof t?p.a.G(t,function(n,t){t=p.a.c(t);p.a.Ba(e,n,t)}):(t=String(t||""),p.a.Ba(e,e.__ko__cssValue,!1),e.__ko__cssValue=t,p.a.Ba(e,t,!0))}};p.d.enable={update:function(e,n){var t=p.a.c(n());t&&e.disabled?e.removeAttribute("disabled"):t||e.disabled||(e.disabled=!0)}};p.d.disable={update:function(e,n){p.d.enable.update(e,function(){return!p.a.c(n())})}};p.d.event={init:function(e,n,t,r,a){var i=n()||{};p.a.G(i,function(i){"string"==typeof i&&p.a.n(e,i,function(e){var o,u=n()[i];if(u){try{var c=p.a.S(arguments);r=a.$data;c.unshift(r);o=u.apply(r,c)}finally{!0!==o&&(e.preventDefault?e.preventDefault():e.returnValue=!1)}!1===t.get(i+"Bubble")&&(e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation())}})})}};p.d.foreach={Eb:function(e){return function(){var n=e(),t=p.a.Xa(n);if(!t||"number"==typeof t.length)return{foreach:n,templateEngine:p.O.Oa};p.a.c(n);return{foreach:t.data,as:t.as,includeDestroyed:t.includeDestroyed,afterAdd:t.afterAdd,beforeRemove:t.beforeRemove,afterRender:t.afterRender,beforeMove:t.beforeMove,afterMove:t.afterMove,templateEngine:p.O.Oa}}},init:function(e,n){return p.d.template.init(e,p.d.foreach.Eb(n))},update:function(e,n,t,r,a){return p.d.template.update(e,p.d.foreach.Eb(n),t,r,a)}};p.h.ha.foreach=!1;p.f.Q.foreach=!0;p.d.hasfocus={init:function(e,n,t){function r(r){e.__ko_hasfocusUpdating=!0;var a=e.ownerDocument;if("activeElement"in a){var i;try{i=a.activeElement}catch(o){i=a.body}r=i===e}a=n();p.h.pa(a,t,"hasfocus",r,!0);e.__ko_hasfocusLastValue=r;e.__ko_hasfocusUpdating=!1}var a=r.bind(null,!0),i=r.bind(null,!1);p.a.n(e,"focus",a);p.a.n(e,"focusin",a);p.a.n(e,"blur",i);p.a.n(e,"focusout",i)},update:function(e,n){var t=!!p.a.c(n());e.__ko_hasfocusUpdating||e.__ko_hasfocusLastValue===t||(t?e.focus():e.blur(),p.k.B(p.a.oa,null,[e,t?"focusin":"focusout"]))}};p.h.V.hasfocus=!0;p.d.hasFocus=p.d.hasfocus;p.h.V.hasFocus=!0;p.d.html={init:function(){return{controlsDescendantBindings:!0}},update:function(e,n){p.a.$a(e,n())}};l("if");l("ifnot",!1,!0);l("with",!0,!1,function(e,n){return e.createChildContext(n)});var y={};p.d.options={init:function(e){if("select"!==p.a.t(e))throw Error("options binding applies only to SELECT elements");for(;0<e.length;)e.remove(0);return{controlsDescendantBindings:!0}},update:function(n,t,r){function a(){return p.a.ta(n.options,function(e){return e.selected})}function i(e,n,t){var r=typeof n;return"function"==r?n(e):"string"==r?e[n]:t}function o(e,t){if(l.length){var r=0<=p.a.m(l,p.i.q(t[0]));p.a.Nb(t[0],r);d&&!r&&p.k.B(p.a.oa,null,[n,"change"])}}var u=0!=n.length&&n.multiple?n.scrollTop:null,c=p.a.c(t()),s=r.get("optionsIncludeDestroyed");t={};var f,l;l=n.multiple?p.a.Da(a(),p.i.q):0<=n.selectedIndex?[p.i.q(n.options[n.selectedIndex])]:[];c&&("undefined"==typeof c.length&&(c=[c]),f=p.a.ta(c,function(n){return s||n===e||null===n||!p.a.c(n._destroy)}),r.has("optionsCaption")&&(c=p.a.c(r.get("optionsCaption")),null!==c&&c!==e&&f.unshift(y)));var d=!1;t.beforeRemove=function(e){n.removeChild(e)};c=o;r.has("optionsAfterRender")&&(c=function(n,t){o(0,t);p.k.B(r.get("optionsAfterRender"),null,[t[0],n!==y?n:e])});p.a.Za(n,f,function(t,a,o){o.length&&(l=o[0].selected?[p.i.q(o[0])]:[],d=!0);a=n.ownerDocument.createElement("option");t===y?(p.a.bb(a,r.get("optionsCaption")),p.i.ca(a,e)):(o=i(t,r.get("optionsValue"),t),p.i.ca(a,p.a.c(o)),t=i(t,r.get("optionsText"),o),p.a.bb(a,t));return[a]},t,c);p.k.B(function(){r.get("valueAllowUnset")&&r.has("value")?p.i.ca(n,p.a.c(r.get("value")),!0):(n.multiple?l.length&&a().length<l.length:l.length&&0<=n.selectedIndex?p.i.q(n.options[n.selectedIndex])!==l[0]:l.length||0<=n.selectedIndex)&&p.a.oa(n,"change")});p.a.dc(n);u&&20<Math.abs(u-n.scrollTop)&&(n.scrollTop=u)}};p.d.options.Va=p.a.e.F();p.d.selectedOptions={after:["options","foreach"],init:function(e,n,t){p.a.n(e,"change",function(){var r=n(),a=[];p.a.u(e.getElementsByTagName("option"),function(e){e.selected&&a.push(p.i.q(e))});p.h.pa(r,t,"selectedOptions",a)})},update:function(e,n){if("select"!=p.a.t(e))throw Error("values binding applies only to SELECT elements");var t=p.a.c(n());t&&"number"==typeof t.length&&p.a.u(e.getElementsByTagName("option"),function(e){var n=0<=p.a.m(t,p.i.q(e));p.a.Nb(e,n)})}};p.h.V.selectedOptions=!0;p.d.style={update:function(n,t){var r=p.a.c(t()||{});p.a.G(r,function(t,r){r=p.a.c(r);if(null===r||r===e||!1===r)r="";n.style[t]=r})}};p.d.submit={init:function(e,n,t,r,a){if("function"!=typeof n())throw Error("The value for a submit binding must be a function");p.a.n(e,"submit",function(t){var r,i=n();try{r=i.call(a.$data,e)}finally{!0!==r&&(t.preventDefault?t.preventDefault():t.returnValue=!1)}})}};p.d.text={init:function(){return{controlsDescendantBindings:!0}},update:function(e,n){p.a.bb(e,n())}};p.f.Q.text=!0;(function(){if(n&&n.navigator)var t=function(e){if(e)return parseFloat(e[1])},r=n.opera&&n.opera.version&&parseInt(n.opera.version()),a=n.navigator.userAgent,i=t(a.match(/^(?:(?!chrome).)*version\/([^ ]*) safari/i)),o=t(a.match(/Firefox\/([^ ]*)/));if(10>p.a.L)var u=p.a.e.F(),c=p.a.e.F(),s=function(e){var n=this.activeElement;(n=n&&p.a.e.get(n,c))&&n(e)},f=function(e,n){var t=e.ownerDocument;p.a.e.get(t,u)||(p.a.e.set(t,u,!0),p.a.n(t,"selectionchange",s));p.a.e.set(e,c,n)};p.d.textInput={init:function(n,t,a){function u(e,t){p.a.n(n,e,t)}function c(){var r=p.a.c(t());if(null===r||r===e)r="";b!==e&&r===b?setTimeout(c,4):n.value!==r&&(d=r,n.value=r)}function s(){h||(b=n.value,h=setTimeout(l,4))}function l(){clearTimeout(h);b=h=e;var r=n.value;d!==r&&(d=r,p.h.pa(t(),a,"textInput",r))}var d=n.value,h,b;10>p.a.L?(u("propertychange",function(e){"value"===e.propertyName&&l()}),8==p.a.L&&(u("keyup",l),u("keydown",l)),8<=p.a.L&&(f(n,l),u("dragend",s))):(u("input",l),5>i&&"textarea"===p.a.t(n)?(u("keydown",s),u("paste",s),u("cut",s)):11>r?u("keydown",s):4>o&&(u("DOMAutoComplete",l),u("dragdrop",l),u("drop",l)));u("change",l);p.s(c,null,{o:n})}};p.h.V.textInput=!0;p.d.textinput={preprocess:function(e,n,t){t("textInput",e)}}})();p.d.uniqueName={init:function(e,n){if(n()){var t="ko_unique_"+ ++p.d.uniqueName.Zb;p.a.Mb(e,t)}}};p.d.uniqueName.Zb=0;p.d.value={after:["options","foreach"],init:function(e,n,t){if("input"!=e.tagName.toLowerCase()||"checkbox"!=e.type&&"radio"!=e.type){var r=["change"],a=t.get("valueUpdate"),i=!1,o=null;a&&("string"==typeof a&&(a=[a]),p.a.ga(r,a),r=p.a.rb(r));var u=function(){o=null;i=!1;var r=n(),a=p.i.q(e);p.h.pa(r,t,"value",a)};!p.a.L||"input"!=e.tagName.toLowerCase()||"text"!=e.type||"off"==e.autocomplete||e.form&&"off"==e.form.autocomplete||-1!=p.a.m(r,"propertychange")||(p.a.n(e,"propertychange",function(){i=!0}),p.a.n(e,"focus",function(){i=!1}),p.a.n(e,"blur",function(){i&&u()}));p.a.u(r,function(n){var t=u;p.a.vc(n,"after")&&(t=function(){o=p.i.q(e);setTimeout(u,0)},n=n.substring(5));p.a.n(e,n,t)});var c=function(){var r=p.a.c(n()),a=p.i.q(e);if(null!==o&&r===o)setTimeout(c,0);else if(r!==a)if("select"===p.a.t(e)){var i=t.get("valueAllowUnset"),a=function(){p.i.ca(e,r,i)};a();i||r===p.i.q(e)?setTimeout(a,0):p.k.B(p.a.oa,null,[e,"change"])}else p.i.ca(e,r)};p.s(c,null,{o:e})}else p.ra(e,{checkedValue:n})},update:function(){}};p.h.V.value=!0;p.d.visible={update:function(e,n){var t=p.a.c(n()),r="none"!=e.style.display;t&&!r?e.style.display="":!t&&r&&(e.style.display="none")}};(function(e){p.d[e]={init:function(n,t,r,a,i){return p.d.event.init.call(this,n,function(){var n={};n[e]=t();return n},r,a,i)}}})("click");p.H=function(){};p.H.prototype.renderTemplateSource=function(){throw Error("Override renderTemplateSource")};p.H.prototype.createJavaScriptEvaluatorBlock=function(){throw Error("Override createJavaScriptEvaluatorBlock")};p.H.prototype.makeTemplateSource=function(e,n){if("string"==typeof e){n=n||t;var r=n.getElementById(e);if(!r)throw Error("Cannot find template with ID "+e);return new p.r.l(r)}if(1==e.nodeType||8==e.nodeType)return new p.r.fa(e);throw Error("Unknown template type: "+e)};p.H.prototype.renderTemplate=function(e,n,t,r){e=this.makeTemplateSource(e,r);return this.renderTemplateSource(e,n,t)};p.H.prototype.isTemplateRewritten=function(e,n){return!1===this.allowTemplateRewriting?!0:this.makeTemplateSource(e,n).data("isRewritten")};p.H.prototype.rewriteTemplate=function(e,n,t){e=this.makeTemplateSource(e,t);n=n(e.text());e.text(n);e.data("isRewritten",!0)};p.b("templateEngine",p.H);p.fb=function(){function e(e,n,t,r){e=p.h.Wa(e);for(var a=p.h.ha,i=0;i<e.length;i++){var o=e[i].key;if(a.hasOwnProperty(o)){var u=a[o];if("function"===typeof u){if(o=u(e[i].value))throw Error(o)}else if(!u)throw Error("This template engine does not support the '"+o+"' binding within its templates")}}t="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+p.h.ya(e,{valueAccessors:!0})+" } })()},'"+t.toLowerCase()+"')";return r.createJavaScriptEvaluatorBlock(t)+n}var n=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,t=/\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g;return{ec:function(e,n,t){n.isTemplateRewritten(e,t)||n.rewriteTemplate(e,function(e){return p.fb.nc(e,n)},t)},nc:function(r,a){return r.replace(n,function(n,t,r,i,o){return e(o,t,r,a)}).replace(t,function(n,t){return e(t,"<!-- ko -->","#comment",a)})},Xb:function(e,n){return p.D.Ua(function(t,r){var a=t.nextSibling;a&&a.nodeName.toLowerCase()===n&&p.ra(a,e,r)})}}}();p.b("__tr_ambtns",p.fb.Xb);(function(){p.r={};p.r.l=function(e){this.l=e};p.r.l.prototype.text=function(){var e=p.a.t(this.l),e="script"===e?"text":"textarea"===e?"value":"innerHTML";if(0==arguments.length)return this.l[e];var n=arguments[0];"innerHTML"===e?p.a.$a(this.l,n):this.l[e]=n};var n=p.a.e.F()+"_";p.r.l.prototype.data=function(e){if(1===arguments.length)return p.a.e.get(this.l,n+e);p.a.e.set(this.l,n+e,arguments[1])};var t=p.a.e.F();p.r.fa=function(e){this.l=e};p.r.fa.prototype=new p.r.l;p.r.fa.prototype.text=function(){if(0==arguments.length){var n=p.a.e.get(this.l,t)||{};n.gb===e&&n.Ga&&(n.gb=n.Ga.innerHTML);return n.gb}p.a.e.set(this.l,t,{gb:arguments[0]})};p.r.l.prototype.nodes=function(){if(0==arguments.length)return(p.a.e.get(this.l,t)||{}).Ga;p.a.e.set(this.l,t,{Ga:arguments[0]})};p.b("templateSources",p.r);p.b("templateSources.domElement",p.r.l);p.b("templateSources.anonymousTemplate",p.r.fa)})();(function(){function n(e,n,t){var r;for(n=p.f.nextSibling(n);e&&(r=e)!==n;)e=p.f.nextSibling(r),t(r,e)}function t(e,t){if(e.length){var r=e[0],a=e[e.length-1],i=r.parentNode,o=p.J.instance,u=o.preprocessNode;if(u){n(r,a,function(e,n){var t=e.previousSibling,i=u.call(o,e);i&&(e===r&&(r=i[0]||n),e===a&&(a=i[i.length-1]||t))});e.length=0;if(!r)return;r===a?e.push(r):(e.push(r,a),p.a.ka(e,i))}n(r,a,function(e){1!==e.nodeType&&8!==e.nodeType||p.pb(t,e)});n(r,a,function(e){1!==e.nodeType&&8!==e.nodeType||p.D.Sb(e,[t])});p.a.ka(e,i)}}function r(e){return e.nodeType?e:0<e.length?e[0]:null}function a(e,n,a,o,u){u=u||{};var c=e&&r(e),c=c&&c.ownerDocument,s=u.templateEngine||i;p.fb.ec(a,s,c);a=s.renderTemplate(a,o,u,c);if("number"!=typeof a.length||0<a.length&&"number"!=typeof a[0].nodeType)throw Error("Template engine must return an array of DOM nodes");c=!1;switch(n){case"replaceChildren":p.f.T(e,a);c=!0;break;case"replaceNode":p.a.Lb(e,a);c=!0;break;case"ignoreTargetNode":break;default:throw Error("Unknown renderMode: "+n)}c&&(t(a,o),u.afterRender&&p.k.B(u.afterRender,null,[a,o.$data]));return a}var i;p.ab=function(n){if(n!=e&&!(n instanceof p.H))throw Error("templateEngine must inherit from ko.templateEngine");i=n};p.Ya=function(n,t,o,u,c){o=o||{};if((o.templateEngine||i)==e)throw Error("Set a template engine before calling renderTemplate");c=c||"replaceChildren";if(u){var s=r(u);return p.j(function(){var e=t&&t instanceof p.N?t:new p.N(p.a.c(t)),i=p.C(n)?n():"function"===typeof n?n(e.$data,e):n,e=a(u,c,i,e,o);"replaceNode"==c&&(u=e,s=r(u))},null,{Ia:function(){return!s||!p.a.Ja(s)},o:s&&"replaceNode"==c?s.parentNode:s})}return p.D.Ua(function(e){p.Ya(n,t,o,e,"replaceNode")})};p.uc=function(n,r,i,o,u){function c(e,n){t(n,f);i.afterRender&&i.afterRender(n,e)}function s(e,t){f=u.createChildContext(e,i.as,function(e){e.$index=t});var r=p.C(n)?n():"function"===typeof n?n(e,f):n;return a(null,"ignoreTargetNode",r,f,i)}var f;return p.j(function(){var n=p.a.c(r)||[];"undefined"==typeof n.length&&(n=[n]);n=p.a.ta(n,function(n){return i.includeDestroyed||n===e||null===n||!p.a.c(n._destroy)});p.k.B(p.a.Za,null,[o,n,s,i,c])},null,{o:o})};var o=p.a.e.F();p.d.template={init:function(e,n){var t=p.a.c(n());"string"==typeof t||t.name?p.f.ja(e):(t=p.f.childNodes(e),t=p.a.oc(t),new p.r.fa(e).nodes(t));return{controlsDescendantBindings:!0}},update:function(n,t,r,a,i){var u=t(),c;t=p.a.c(u);r=!0;a=null;"string"==typeof t?t={}:(u=t.name,"if"in t&&(r=p.a.c(t["if"])),r&&"ifnot"in t&&(r=!p.a.c(t.ifnot)),c=p.a.c(t.data));"foreach"in t?a=p.uc(u||n,r&&t.foreach||[],t,n,i):r?(i="data"in t?i.createChildContext(c,t.as):i,a=p.Ya(u||n,i,t,n)):p.f.ja(n);i=a;(c=p.a.e.get(n,o))&&"function"==typeof c.K&&c.K();p.a.e.set(n,o,i&&i.Z()?i:e)}};p.h.ha.template=function(e){e=p.h.Wa(e);return 1==e.length&&e[0].unknown||p.h.lc(e,"name")?null:"This template engine does not support anonymous templates nested within its templates"};p.f.Q.template=!0})();p.b("setTemplateEngine",p.ab);p.b("renderTemplate",p.Ya);p.a.wb=function(e,n,t){if(e.length&&n.length){var r,a,i,o,u;for(r=a=0;(!t||r<t)&&(o=e[a]);++a){for(i=0;u=n[i];++i)if(o.value===u.value){o.moved=u.index;u.moved=o.index;n.splice(i,1);r=i=0;break}r+=i}}};p.a.Fa=function(){function e(e,n,t,r,a){var i=Math.min,o=Math.max,u=[],c,s=e.length,f,l=n.length,d=l-s||1,h=s+l+1,b,m,g;for(c=0;c<=s;c++)for(m=b,u.push(b=[]),g=i(l,c+d),f=o(0,c-1);f<=g;f++)b[f]=f?c?e[c-1]===n[f-1]?m[f-1]:i(m[f]||h,b[f-1]||h)+1:f+1:c+1;i=[];o=[];d=[];c=s;for(f=l;c||f;)l=u[c][f]-1,f&&l===u[c][f-1]?o.push(i[i.length]={status:t,value:n[--f],index:f}):c&&l===u[c-1][f]?d.push(i[i.length]={status:r,value:e[--c],index:c}):(--f,--c,a.sparse||i.push({status:"retained",value:n[f]}));p.a.wb(o,d,10*s);return i.reverse()}return function(n,t,r){r="boolean"===typeof r?{dontLimitMoves:r}:r||{};n=n||[];t=t||[];return n.length<=t.length?e(n,t,"added","deleted",r):e(t,n,"deleted","added",r)}}();p.b("utils.compareArrays",p.a.Fa);(function(){function n(n,t,r,a,i){var o=[],u=p.j(function(){var e=t(r,i,p.a.ka(o,n))||[];0<o.length&&(p.a.Lb(o,e),a&&p.k.B(a,null,[r,e,i]));o.length=0;p.a.ga(o,e)},null,{o:n,Ia:function(){return!p.a.ob(o)}});return{$:o,j:u.Z()?u:e}}var t=p.a.e.F();p.a.Za=function(r,a,i,o,u){function c(e,n){x=l[n];g!==n&&(w[e]=x);x.Na(g++);p.a.ka(x.$,r);b.push(x);y.push(x)}function s(e,n){if(e)for(var t=0,r=n.length;t<r;t++)n[t]&&p.a.u(n[t].$,function(r){e(r,t,n[t].sa)})}a=a||[];o=o||{};var f=p.a.e.get(r,t)===e,l=p.a.e.get(r,t)||[],d=p.a.Da(l,function(e){return e.sa}),h=p.a.Fa(d,a,o.dontLimitMoves),b=[],m=0,g=0,v=[],y=[];a=[];for(var w=[],d=[],x,k=0,E,T;E=h[k];k++)switch(T=E.moved,E.status){case"deleted":T===e&&(x=l[m],x.j&&x.j.K(),v.push.apply(v,p.a.ka(x.$,r)),o.beforeRemove&&(a[k]=x,y.push(x)));m++;break;case"retained":c(k,m++);break;case"added":T!==e?c(k,T):(x={sa:E.value,Na:p.p(g++)},b.push(x),y.push(x),f||(d[k]=x))}s(o.beforeMove,w);p.a.u(v,o.beforeRemove?p.R:p.removeNode);for(var k=0,f=p.f.firstChild(r),C;x=y[k];k++){x.$||p.a.extend(x,n(r,i,x.sa,u,x.Na));for(m=0;h=x.$[m];f=h.nextSibling,C=h,m++)h!==f&&p.f.Bb(r,h,C);!x.ic&&u&&(u(x.sa,x.$,x.Na),x.ic=!0)}s(o.beforeRemove,a);s(o.afterMove,w);s(o.afterAdd,d);p.a.e.set(r,t,b)}})();p.b("utils.setDomNodeChildrenFromArrayMapping",p.a.Za);p.O=function(){this.allowTemplateRewriting=!1};p.O.prototype=new p.H;p.O.prototype.renderTemplateSource=function(e){var n=(9>p.a.L?0:e.nodes)?e.nodes():null;if(n)return p.a.S(n.cloneNode(!0).childNodes);e=e.text();return p.a.ba(e)};p.O.Oa=new p.O;p.ab(p.O.Oa);p.b("nativeTemplateEngine",p.O);(function(){p.Sa=function(){var e=this.kc=function(){if(!a||!a.tmpl)return 0;try{if(0<=a.tmpl.tag.tmpl.open.toString().indexOf("__"))return 2}catch(e){}return 1}();this.renderTemplateSource=function(n,r,i){i=i||{};if(2>e)throw Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.");var o=n.data("precompiled");o||(o=n.text()||"",o=a.template(null,"{{ko_with $item.koBindingContext}}"+o+"{{/ko_with}}"),n.data("precompiled",o));n=[r.$data];r=a.extend({koBindingContext:r},i.templateOptions);r=a.tmpl(o,n,r);r.appendTo(t.createElement("div"));a.fragments={};return r};this.createJavaScriptEvaluatorBlock=function(e){return"{{ko_code ((function() { return "+e+" })()) }}"};this.addTemplate=function(e,n){t.write("<script type='text/html' id='"+e+"'>"+n+"</script>")};0<e&&(a.tmpl.tag.ko_code={open:"__.push($1 || '');"},a.tmpl.tag.ko_with={open:"with($1) {",close:"} "})};p.Sa.prototype=new p.H;var e=new p.Sa;0<e.kc&&p.ab(e);p.b("jqueryTmplTemplateEngine",p.Sa)})()})})()})();window.kojqui={version:"2.0.0"},function(e,t){"use strict";e.kojqui.utils=t(e.jQuery,e.ko,e.jQuery.ui.core)}(this,function(e,t){"use strict";var i,o,s,n;return i=(e.ui.version||"").match(/^(\d)\.(\d+)/),o=i?{major:parseInt(i[1],10),minor:parseInt(i[2],10)}:null,s=Object.create||function(e){function t(){}return t.prototype=e,new t},n=function(e){var i=new e;t.bindingHandlers[i.widgetName]={init:i.init.bind(i),update:i.update.bind(i)}},{uiVersion:o,createObject:s,register:n}}),function(e,t){"use strict";e.kojqui.BindingHandler=t(e.jQuery,e.ko,e.jQuery.ui.widget)}(this,function(e,t){"use strict";var i,o,s,n;return i="__kojqui_options",o=function(e,i){var o={};return t.utils.arrayForEach(i,function(i){void 0!==e[i]&&(o[i]=t.utils.unwrapObservable(e[i]))}),o},s=function(i,o,s){t.isObservable(s.refreshOn)&&t.computed({read:function(){s.refreshOn(),e(o)[i]("refresh")},disposeWhenNodeIsRemoved:o})},n=function(e){this.widgetName=e,this.widgetEventPrefix=e,this.options=[],this.events=[],this.hasRefresh=!1},n.prototype.init=function(n,r,a,u,c){var l,p,h,d;return l=this.widgetName,p=r(),h=o(p,this.options),d=o(p,this.events),t.applyBindingsToDescendants(c,n),t.utils.domData.set(n,i,h),e.each(d,function(e,t){d[e]=t.bind(u)}),e(n)[l](t.utils.extend(h,d)),this.hasRefresh&&s(l,n,p),t.isWriteableObservable(p.widget)&&p.widget(e(n)),t.utils.domNodeDisposal.addDisposeCallback(n,function(){e(n)[l]("destroy")}),{controlsDescendantBindings:!0}},n.prototype.update=function(s,n){var r,a,u,c;r=this.widgetName,a=n(),u=t.utils.domData.get(s,i),c=o(a,this.options),e.each(c,function(t,i){i!==u[t]&&e(s)[r]("option",t,c[t])}),t.utils.domData.set(s,i,c)},n.prototype.on=function(i,o,s){var n;n=o===this.widgetEventPrefix?o:this.widgetEventPrefix+o,n=[n.toLowerCase(),".",this.widgetName].join(""),e(i).on(n,s),t.utils.domNodeDisposal.addDisposeCallback(i,function(){e(i).off(n)})},n}),function(e,t){"use strict";e.kojqui.Accordion=t(e.jQuery,e.ko,e.kojqui.utils,e.kojqui.BindingHandler,e.jQuery.ui.accordion)}(this,function(e,t,i,o){"use strict";var s=function(){o.call(this,"accordion"),1===i.uiVersion.major&&8===i.uiVersion.minor?(this.options=["active","animated","autoHeight","clearStyle","collapsible","disabled","event","fillSpace","header","icons","navigation","navigationFilter"],this.events=["change","changestart","create"],this.hasRefresh=!1,this.eventToWatch="change"):(this.options=["active","animate","collapsible","disabled","event","header","heightStyle","icons"],this.events=["activate","beforeActivate","create"],this.hasRefresh=!0,this.eventToWatch="activate")};return s.prototype=i.createObject(o.prototype),s.prototype.constructor=s,s.prototype.init=function(i,s){var n,r;return n=this.widgetName,r=s(),o.prototype.init.apply(this,arguments),t.isWriteableObservable(r.active)&&this.on(i,this.eventToWatch,function(){r.active(e(i)[n]("option","active"))}),{controlsDescendantBindings:!0}},i.register(s),s}),function(e,t){"use strict";e.kojqui.Autocomplete=t(e.kojqui.BindingHandler,e.kojqui.utils,e.jQuery.ui.autocomplete)}(this,function(e,t){"use strict";var i=function(){e.call(this,"autocomplete"),this.options=["appendTo","autoFocus","delay","disabled","minLength","position","source"],this.events=1===t.uiVersion.major&&8===t.uiVersion.minor?["change","close","create","focus","open","search","select"]:["change","close","create","focus","open","response","search","select"]};return i.prototype=t.createObject(e.prototype),i.prototype.constructor=i,t.register(i),i}),function(e,t){"use strict";e.kojqui.Button=t(e.kojqui.BindingHandler,e.kojqui.utils,e.jQuery.ui.button)}(this,function(e,t){"use strict";var i=function(){e.call(this,"button"),this.options=["disabled","icons","label","text"],this.events=["create"],this.hasRefresh=!0};return i.prototype=t.createObject(e.prototype),i.prototype.constructor=i,t.register(i),i}),function(e,t){"use strict";e.kojqui.Buttonset=t(e.kojqui.BindingHandler,e.kojqui.utils,e.jQuery.ui.button)}(this,function(e,t){"use strict";var i=function(){e.call(this,"buttonset"),this.options=["items","disabled"],this.events=["create"],this.hasRefresh=!0};return i.prototype=t.createObject(e.prototype),i.prototype.constructor=i,t.register(i),i}),function(e,t){"use strict";e.kojqui.Datepicker=t(e.jQuery,e.ko,e.kojqui.BindingHandler,e.kojqui.utils,e.jQuery.ui.datepicker)}(this,function(e,t,i,o){"use strict";var s=function(){i.call(this,"datepicker"),this.options=["altField","altFormat","appendText","autoSize","buttonImage","buttonImageOnly","buttonText","calculateWeek","changeMonth","changeYear","closeText","constrainInput","currentText","dateFormat","dayNames","dayNamesMin","dayNamesShort","defaultDate","duration","firstDay","gotoCurrent","hideIfNoPrevNext","isRTL","maxDate","minDate","monthNames","monthNamesShort","navigationAsDateFormat","nextText","numberOfMonths","prevText","selectOtherMonths","shortYearCutoff","showAnim","showButtonPanel","showCurrentAtPos","showMonthAfterYear","showOn","showOptions","showOtherMonths","showWeek","stepMonths","weekHeader","yearRange","yearSuffix","beforeShow","beforeShowDay","onChangeMonthYear","onClose","onSelect"],this.hasRefresh=!0};return s.prototype=o.createObject(i.prototype),s.prototype.constructor=s,s.prototype.init=function(o,s){var n,r,a,u,c;return i.prototype.init.apply(this,arguments),n=this.widgetName,r=s(),a=t.utils.unwrapObservable(r.value),a&&e(o)[n]("setDate",a),t.isObservable(r.value)&&(u=r.value.subscribe(function(t){e(o)[n]("setDate",t)}),t.utils.domNodeDisposal.addDisposeCallback(o,function(){u.dispose()})),t.isWriteableObservable(r.value)&&(c=e(o)[n]("option","onSelect"),e(o)[n]("option","onSelect",function(t){var i,s;i=e(o)[n]("option","dateFormat"),s=e.datepicker.parseDate(i,t),r.value(s),"function"==typeof c&&c.apply(this,Array.prototype.slice.call(arguments))})),{controlsDescendantBindings:!0}},o.register(s),s}),function(e,t){"use strict";e.kojqui.Dialog=t(e.jQuery,e.ko,e.kojqui.BindingHandler,e.kojqui.utils,e.jQuery.ui.dialog)}(this,function(e,t,i,o){"use strict";var s=function(){i.call(this,"dialog"),1===o.uiVersion.major&&8===o.uiVersion.minor?(this.options=["autoOpen","buttons","closeOnEscape","closeText","dialogClass","disabled","draggable","height","maxHeight","maxWidth","minHeight","minWidth","modal","position","resizable","show","stack","title","width","zIndex"],this.events=["beforeClose","create","open","focus","dragStart","drag","dragStop","resizeStart","resize","resizeStop","close"]):1===o.uiVersion.major&&9===o.uiVersion.minor?(this.options=["autoOpen","buttons","closeOnEscape","closeText","dialogClass","draggable","height","hide","maxHeight","maxWidth","minHeight","minWidth","modal","position","resizable","show","stack","title","width","zIndex"],this.events=["beforeClose","create","open","focus","dragStart","drag","dragStop","resizeStart","resize","resizeStop","close"]):(this.options=["appendTo","autoOpen","buttons","closeOnEscape","closeText","dialogClass","draggable","height","hide","maxHeight","maxWidth","minHeight","minWidth","modal","position","resizable","show","title","width"],this.events=["beforeClose","create","open","focus","dragStart","drag","dragStop","resizeStart","resize","resizeStop","close"])};return s.prototype=o.createObject(i.prototype),s.prototype.constructor=s,s.prototype.init=function(o,s){var n,r;return n=document.createElement("DIV"),n.style.display="none",o.parentNode.insertBefore(n,o),t.utils.domNodeDisposal.addDisposeCallback(n,function(){t.removeNode(o)}),i.prototype.init.apply(this,arguments),r=s(),r.isOpen&&t.computed({read:function(){t.utils.unwrapObservable(r.isOpen)?e(o)[this.widgetName]("open"):e(o)[this.widgetName]("close")},disposeWhenNodeIsRemoved:o,owner:this}),t.isWriteableObservable(r.isOpen)&&(this.on(o,"open",function(){r.isOpen(!0)}),this.on(o,"close",function(){r.isOpen(!1)})),t.isWriteableObservable(r.width)&&this.on(o,"resizestop",function(e,t){r.width(Math.round(t.size.width))}),t.isWriteableObservable(r.height)&&this.on(o,"resizestop",function(e,t){r.height(Math.round(t.size.height))}),{controlsDescendantBindings:!0}},o.register(s),s}),function(e,t){"use strict";e.kojqui.Menu=t(e.kojqui.BindingHandler,e.kojqui.utils,e.jQuery.ui.menu)}(this,function(e,t){"use strict";var i=function(){e.call(this,"menu"),this.options=1===t.uiVersion.major&&t.uiVersion.minor<11?["disabled","icons","menus","position","role"]:["disabled","icons","items","menus","position","role"],this.events=["blur","create","focus","select"],this.hasRefresh=!0};return i.prototype=t.createObject(e.prototype),i.prototype.constructor=i,t.register(i),i}),function(e,t){"use strict";e.kojqui.Progressbar=t(e.kojqui.BindingHandler,e.kojqui.utils,e.jQuery.ui.progressbar)}(this,function(e,t){"use strict";var i=function(){e.call(this,"progressbar"),this.events=["change","create","complete"],this.hasRefresh=!0,this.options=1===t.uiVersion.major&&8===t.uiVersion.minor?["disabled","value"]:["disabled","max","value"]};return i.prototype=t.createObject(e.prototype),i.prototype.constructor=i,t.register(i),i}),function(e,t){"use strict";e.kojqui.Selectmenu=t(e.jQuery,e.ko,e.kojqui.BindingHandler,e.kojqui.utils,e.jQuery.ui.selectmenu)}(this,function(e,t,i,o){"use strict";var s=function(){i.call(this,"selectmenu"),this.options=["appendTo","disabled","icons","position","width"],this.events=["change","close","create","focus","open","select"],this.hasRefresh=!0};return s.prototype=o.createObject(i.prototype),s.prototype.constructor=s,s.prototype.init=function(o,s){var n=s();return i.prototype.init.apply(this,arguments),n.isOpen&&t.computed({read:function(){t.utils.unwrapObservable(n.isOpen)?e(o)[this.widgetName]("open"):e(o)[this.widgetName]("close")},disposeWhenNodeIsRemoved:o,owner:this}),t.isWriteableObservable(n.isOpen)&&(this.on(o,"open",function(){n.isOpen(!0)}),this.on(o,"close",function(){n.isOpen(!1)})),{controlsDescendantBindings:!0}},o.register(s),s}),function(e,t){"use strict";e.kojqui.Slider=t(e.jQuery,e.ko,e.kojqui.BindingHandler,e.kojqui.utils,e.jQuery.ui.slider)}(this,function(e,t,i,o){"use strict";var s,n;return s="__kojqui_options",n=function(){i.call(this,"slider"),this.widgetEventPrefix="slide",this.options=["animate","disabled","max","min","orientation","range","step","value","values"],this.events=["create","start","slide","change","stop"]},n.prototype=o.createObject(i.prototype),n.prototype.constructor=n,n.prototype.init=function(o,n){var r,a;return i.prototype.init.apply(this,arguments),r=n(),a=r.realtime?"slide":"change",t.isWriteableObservable(r.value)&&this.on(o,a,function(i,n){var a=e(o).find(".ui-slider-handle").index(n.handle);0===a&&(t.utils.domData.get(o,s).value=n.value,r.value(n.value))}),t.isWriteableObservable(r.values)&&this.on(o,a,function(e,i){t.utils.domData.get(o,s).value=i.values,r.values(i.values)}),{controlsDescendantBindings:!0}},o.register(n),n}),function(e,t){"use strict";e.kojqui.Spinner=t(e.jQuery,e.ko,e.kojqui.BindingHandler,e.kojqui.utils,e.jQuery.ui.spinner)}(this,function(e,t,i,o){"use strict";var s=function(){i.call(this,"spinner"),this.widgetEventPrefix="spin",this.options=["culture","disabled","icons","incremental","max","min","numberFormat","page","step"],this.events=["create","start","spin","stop","change"]};return s.prototype=o.createObject(i.prototype),s.prototype.constructor=s,s.prototype.init=function(o,s,n){var r,a;return i.prototype.init.apply(this,arguments),r=this.widgetName,a=s(),a.value&&t.computed({read:function(){e(o)[r]("value",t.utils.unwrapObservable(a.value))},disposeWhenNodeIsRemoved:o}),t.isWriteableObservable(a.value)&&(n().valueUpdate?this.on(o,"spin",function(e,t){a.value(t.value)}):this.on(o,"change",function(){a.value(e(o)[r]("value"))})),{controlsDescendantBindings:!0}},o.register(s),s}),function(e,t){"use strict";e.kojqui.Tabs=t(e.jQuery,e.ko,e.kojqui.BindingHandler,e.kojqui.utils,e.jQuery.ui.tabs)}(this,function(e,t,i,o){"use strict";var s,n,r;return s=function(i,o){var s=o();t.isWriteableObservable(s.selected)&&this.on(i,"show",function(t,o){e(i)[0]===t.target&&s.selected(o.index)})},n=function(i,o){var s=o();t.isWriteableObservable(s.active)&&this.on(i,"activate",function(t,o){e(i)[0]===t.target&&s.active(o.newTab.index())})},r=function(){i.call(this,"tabs"),this.version=o.uiVersion,1===this.version.major&&8===this.version.minor?(this.options=["ajaxOptions","cache","collapsible","cookie","disabled","event","fx","idPrefix","panelTemplate","selected","spinner","tabTemplate"],this.events=["add","create","disable","enable","load","remove","select","show"],this.hasRefresh=!1):(this.options=["active","collapsible","disabled","event","heightStyle","hide","show"],this.events=["activate","beforeActivate","beforeLoad","create","load"],this.hasRefresh=!0)},r.prototype=o.createObject(i.prototype),r.prototype.constructor=r,r.prototype.init=function(e,t){return i.prototype.init.apply(this,arguments),1===this.version.major&&8===this.version.minor?s.call(this,e,t):n.call(this,e,t),{controlsDescendantBindings:!0}},o.register(r),r}),function(e,t){"use strict";e.kojqui.Tooltip=t(e.jQuery,e.ko,e.kojqui.BindingHandler,e.kojqui.utils,e.jQuery.ui.tooltip)}(this,function(e,t,i,o){"use strict";var s=function(){i.call(this,"tooltip"),this.options=["content","disabled","hide","items","position","show","tooltipClass","track"],this.events=["create","open","close"]};return s.prototype=o.createObject(i.prototype),s.prototype.constructor=s,s.prototype.init=function(o,s){var n=s();return i.prototype.init.apply(this,arguments),n.isOpen&&t.computed({read:function(){t.utils.unwrapObservable(n.isOpen)?e(o)[this.widgetName]("open"):e(o)[this.widgetName]("close")},disposeWhenNodeIsRemoved:o,owner:this}),t.isWriteableObservable(n.isOpen)&&(this.on(o,"open",function(){n.isOpen(!0)}),this.on(o,"close",function(){n.isOpen(!1)})),{controlsDescendantBindings:!0}},o.register(s),s});var Base64=function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var t={encode:function(t){var n="";var s,i,r;var a,o,h,l;var c=0;do{s=t.charCodeAt(c++);i=t.charCodeAt(c++);r=t.charCodeAt(c++);a=s>>2;o=(s&3)<<4|i>>4;h=(i&15)<<2|r>>6;l=r&63;if(isNaN(i)){h=l=64}else if(isNaN(r)){l=64}n=n+e.charAt(a)+e.charAt(o)+e.charAt(h)+e.charAt(l)}while(c<t.length);return n},decode:function(t){var n="";var s,i,r;var a,o,h,l;var c=0;t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{a=e.indexOf(t.charAt(c++));o=e.indexOf(t.charAt(c++));h=e.indexOf(t.charAt(c++));l=e.indexOf(t.charAt(c++));s=a<<2|o>>4;i=(o&15)<<4|h>>2;r=(h&3)<<6|l;n=n+String.fromCharCode(s);if(h!=64){n=n+String.fromCharCode(i)}if(l!=64){n=n+String.fromCharCode(r)}}while(c<t.length);return n}};return t}();function b64_sha1(e){return binb2b64(core_sha1(str2binb(e),e.length*8))}function str_sha1(e){return binb2str(core_sha1(str2binb(e),e.length*8))}function b64_hmac_sha1(e,t){return binb2b64(core_hmac_sha1(e,t))}function str_hmac_sha1(e,t){return binb2str(core_hmac_sha1(e,t))}function core_sha1(e,t){e[t>>5]|=128<<24-t%32;e[(t+64>>9<<4)+15]=t;var n=new Array(80);var s=1732584193;var i=-271733879;var r=-1732584194;var a=271733878;var o=-1009589776;var h,l,c,u,d,f,_,m;for(h=0;h<e.length;h+=16){u=s;d=i;f=r;_=a;m=o;for(l=0;l<80;l++){if(l<16){n[l]=e[h+l]}else{n[l]=rol(n[l-3]^n[l-8]^n[l-14]^n[l-16],1)}c=safe_add(safe_add(rol(s,5),sha1_ft(l,i,r,a)),safe_add(safe_add(o,n[l]),sha1_kt(l)));o=a;a=r;r=rol(i,30);i=s;s=c}s=safe_add(s,u);i=safe_add(i,d);r=safe_add(r,f);a=safe_add(a,_);o=safe_add(o,m)}return[s,i,r,a,o]}function sha1_ft(e,t,n,s){if(e<20){return t&n|~t&s}if(e<40){return t^n^s}if(e<60){return t&n|t&s|n&s}return t^n^s}function sha1_kt(e){return e<20?1518500249:e<40?1859775393:e<60?-1894007588:-899497514}function core_hmac_sha1(e,t){var n=str2binb(e);if(n.length>16){n=core_sha1(n,e.length*8)}var s=new Array(16),i=new Array(16);for(var r=0;r<16;r++){s[r]=n[r]^909522486;i[r]=n[r]^1549556828}var a=core_sha1(s.concat(str2binb(t)),512+t.length*8);return core_sha1(i.concat(a),512+160)}function safe_add(e,t){var n=(e&65535)+(t&65535);var s=(e>>16)+(t>>16)+(n>>16);return s<<16|n&65535}function rol(e,t){return e<<t|e>>>32-t}function str2binb(e){var t=[];var n=255;for(var s=0;s<e.length*8;s+=8){t[s>>5]|=(e.charCodeAt(s/8)&n)<<24-s%32}return t}function binb2str(e){var t="";var n=255;for(var s=0;s<e.length*32;s+=8){t+=String.fromCharCode(e[s>>5]>>>24-s%32&n)}return t}function binb2b64(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var n="";var s,i;for(var r=0;r<e.length*4;r+=3){s=(e[r>>2]>>8*(3-r%4)&255)<<16|(e[r+1>>2]>>8*(3-(r+1)%4)&255)<<8|e[r+2>>2]>>8*(3-(r+2)%4)&255;for(i=0;i<4;i++){if(r*8+i*6>e.length*32){n+="="}else{n+=t.charAt(s>>6*(3-i)&63)}}}return n}var MD5=function(){var e=function(e,t){var n=(e&65535)+(t&65535);var s=(e>>16)+(t>>16)+(n>>16);return s<<16|n&65535};var t=function(e,t){return e<<t|e>>>32-t};var n=function(e){var t=[];for(var n=0;n<e.length*8;n+=8){t[n>>5]|=(e.charCodeAt(n/8)&255)<<n%32}return t};var s=function(e){var t="";for(var n=0;n<e.length*32;n+=8){t+=String.fromCharCode(e[n>>5]>>>n%32&255)}return t};var i=function(e){var t="0123456789abcdef";var n="";for(var s=0;s<e.length*4;s++){n+=t.charAt(e[s>>2]>>s%4*8+4&15)+t.charAt(e[s>>2]>>s%4*8&15)}return n};var r=function(n,s,i,r,a,o){return e(t(e(e(s,n),e(r,o)),a),i)};var a=function(e,t,n,s,i,a,o){return r(t&n|~t&s,e,t,i,a,o)};var o=function(e,t,n,s,i,a,o){return r(t&s|n&~s,e,t,i,a,o)};var h=function(e,t,n,s,i,a,o){return r(t^n^s,e,t,i,a,o)};var l=function(e,t,n,s,i,a,o){return r(n^(t|~s),e,t,i,a,o)};var c=function(t,n){t[n>>5]|=128<<n%32;t[(n+64>>>9<<4)+14]=n;var s=1732584193;var i=-271733879;var r=-1732584194;var c=271733878;var u,d,f,_;for(var m=0;m<t.length;m+=16){u=s;d=i;f=r;_=c;s=a(s,i,r,c,t[m+0],7,-680876936);c=a(c,s,i,r,t[m+1],12,-389564586);r=a(r,c,s,i,t[m+2],17,606105819);i=a(i,r,c,s,t[m+3],22,-1044525330);s=a(s,i,r,c,t[m+4],7,-176418897);c=a(c,s,i,r,t[m+5],12,1200080426);r=a(r,c,s,i,t[m+6],17,-1473231341);i=a(i,r,c,s,t[m+7],22,-45705983);s=a(s,i,r,c,t[m+8],7,1770035416);c=a(c,s,i,r,t[m+9],12,-1958414417);r=a(r,c,s,i,t[m+10],17,-42063);i=a(i,r,c,s,t[m+11],22,-1990404162);s=a(s,i,r,c,t[m+12],7,1804603682);c=a(c,s,i,r,t[m+13],12,-40341101);r=a(r,c,s,i,t[m+14],17,-1502002290);i=a(i,r,c,s,t[m+15],22,1236535329);s=o(s,i,r,c,t[m+1],5,-165796510);c=o(c,s,i,r,t[m+6],9,-1069501632);r=o(r,c,s,i,t[m+11],14,643717713);i=o(i,r,c,s,t[m+0],20,-373897302);s=o(s,i,r,c,t[m+5],5,-701558691);c=o(c,s,i,r,t[m+10],9,38016083);r=o(r,c,s,i,t[m+15],14,-660478335);i=o(i,r,c,s,t[m+4],20,-405537848);s=o(s,i,r,c,t[m+9],5,568446438);c=o(c,s,i,r,t[m+14],9,-1019803690);r=o(r,c,s,i,t[m+3],14,-187363961);i=o(i,r,c,s,t[m+8],20,1163531501);s=o(s,i,r,c,t[m+13],5,-1444681467);c=o(c,s,i,r,t[m+2],9,-51403784);r=o(r,c,s,i,t[m+7],14,1735328473);i=o(i,r,c,s,t[m+12],20,-1926607734);s=h(s,i,r,c,t[m+5],4,-378558);c=h(c,s,i,r,t[m+8],11,-2022574463);r=h(r,c,s,i,t[m+11],16,1839030562);i=h(i,r,c,s,t[m+14],23,-35309556);s=h(s,i,r,c,t[m+1],4,-1530992060);c=h(c,s,i,r,t[m+4],11,1272893353);r=h(r,c,s,i,t[m+7],16,-155497632);i=h(i,r,c,s,t[m+10],23,-1094730640);s=h(s,i,r,c,t[m+13],4,681279174);c=h(c,s,i,r,t[m+0],11,-358537222);r=h(r,c,s,i,t[m+3],16,-722521979);i=h(i,r,c,s,t[m+6],23,76029189);s=h(s,i,r,c,t[m+9],4,-640364487);c=h(c,s,i,r,t[m+12],11,-421815835);r=h(r,c,s,i,t[m+15],16,530742520);i=h(i,r,c,s,t[m+2],23,-995338651);s=l(s,i,r,c,t[m+0],6,-198630844);c=l(c,s,i,r,t[m+7],10,1126891415);r=l(r,c,s,i,t[m+14],15,-1416354905);i=l(i,r,c,s,t[m+5],21,-57434055);s=l(s,i,r,c,t[m+12],6,1700485571);c=l(c,s,i,r,t[m+3],10,-1894986606);r=l(r,c,s,i,t[m+10],15,-1051523);i=l(i,r,c,s,t[m+1],21,-2054922799);s=l(s,i,r,c,t[m+8],6,1873313359);c=l(c,s,i,r,t[m+15],10,-30611744);r=l(r,c,s,i,t[m+6],15,-1560198380);i=l(i,r,c,s,t[m+13],21,1309151649);s=l(s,i,r,c,t[m+4],6,-145523070);c=l(c,s,i,r,t[m+11],10,-1120210379);r=l(r,c,s,i,t[m+2],15,718787259);i=l(i,r,c,s,t[m+9],21,-343485551);s=e(s,u);i=e(i,d);r=e(r,f);c=e(c,_)}return[s,i,r,c]};var u={hexdigest:function(e){return i(c(n(e),e.length*8))},hash:function(e){return s(c(n(e),e.length*8))}};return u}();if(!Function.prototype.bind){Function.prototype.bind=function(e){var t=this;var n=Array.prototype.slice;var s=Array.prototype.concat;var i=n.call(arguments,1);return function(){return t.apply(e?e:this,s.call(i,n.call(arguments,0)))}}}(function(e){var t;function n(e,n){return new t.Builder(e,n)}function s(e){return new t.Builder("message",e)}function i(e){return new t.Builder("iq",e)}function r(e){return new t.Builder("presence",e)}t={VERSION:"1.1.3",NS:{HTTPBIND:"http://jabber.org/protocol/httpbind",BOSH:"urn:xmpp:xbosh",CLIENT:"jabber:client",AUTH:"jabber:iq:auth",ROSTER:"jabber:iq:roster",PROFILE:"jabber:iq:profile",DISCO_INFO:"http://jabber.org/protocol/disco#info",DISCO_ITEMS:"http://jabber.org/protocol/disco#items",MUC:"http://jabber.org/protocol/muc",SASL:"urn:ietf:params:xml:ns:xmpp-sasl",STREAM:"http://etherx.jabber.org/streams",BIND:"urn:ietf:params:xml:ns:xmpp-bind",SESSION:"urn:ietf:params:xml:ns:xmpp-session",VERSION:"jabber:iq:version",STANZAS:"urn:ietf:params:xml:ns:xmpp-stanzas",XHTML_IM:"http://jabber.org/protocol/xhtml-im",XHTML:"http://www.w3.org/1999/xhtml"},XHTML:{tags:["a","blockquote","br","cite","em","img","li","ol","p","span","strong","ul","body"],attributes:{a:["href"],blockquote:["style"],br:[],cite:["style"],em:[],img:["src","alt","style","height","width"],li:["style"],ol:["style"],p:["style"],span:["style"],strong:[],ul:["style"],body:[]},css:["background-color","color","font-family","font-size","font-style","font-weight","margin-left","margin-right","text-align","text-decoration"],validTag:function(e){for(var n=0;n<t.XHTML.tags.length;n++){if(e==t.XHTML.tags[n]){return true}}return false},validAttribute:function(e,n){if(typeof t.XHTML.attributes[e]!=="undefined"&&t.XHTML.attributes[e].length>0){for(var s=0;s<t.XHTML.attributes[e].length;s++){if(n==t.XHTML.attributes[e][s]){return true}}}return false},validCSS:function(e){for(var n=0;n<t.XHTML.css.length;n++){if(e==t.XHTML.css[n]){return true}}return false}},Status:{ERROR:0,CONNECTING:1,CONNFAIL:2,AUTHENTICATING:3,AUTHFAIL:4,CONNECTED:5,DISCONNECTED:6,DISCONNECTING:7,ATTACHED:8},LogLevel:{DEBUG:0,INFO:1,WARN:2,ERROR:3,FATAL:4},ElementType:{NORMAL:1,TEXT:3,CDATA:4,FRAGMENT:11},TIMEOUT:1.1,SECONDARY_TIMEOUT:.1,addNamespace:function(e,n){t.NS[e]=n},forEachChild:function(e,n,s){var i,r;for(i=0;i<e.childNodes.length;i++){r=e.childNodes[i];if(r.nodeType==t.ElementType.NORMAL&&(!n||this.isTagEqual(r,n))){s(r)}}},isTagEqual:function(e,t){return e.tagName.toLowerCase()==t.toLowerCase()},_xmlGenerator:null,_makeGenerator:function(){var e;if(document.implementation.createDocument===undefined||document.implementation.createDocument&&document.documentMode&&document.documentMode<10){e=this._getIEXmlDom();e.appendChild(e.createElement("strophe"))}else{e=document.implementation.createDocument("jabber:client","strophe",null)}return e},xmlGenerator:function(){if(!t._xmlGenerator){t._xmlGenerator=t._makeGenerator()}return t._xmlGenerator},_getIEXmlDom:function(){var e=null;var t=["Msxml2.DOMDocument.6.0","Msxml2.DOMDocument.5.0","Msxml2.DOMDocument.4.0","MSXML2.DOMDocument.3.0","MSXML2.DOMDocument","MSXML.DOMDocument","Microsoft.XMLDOM"];for(var n=0;n<t.length;n++){if(e===null){try{e=new ActiveXObject(t[n])}catch(s){e=null}}else{break}}return e},xmlElement:function(e){if(!e){return null}var n=t.xmlGenerator().createElement(e);var s,i,r;for(s=1;s<arguments.length;s++){if(!arguments[s]){continue}if(typeof arguments[s]=="string"||typeof arguments[s]=="number"){n.appendChild(t.xmlTextNode(arguments[s]))}else if(typeof arguments[s]=="object"&&typeof arguments[s].sort=="function"){for(i=0;i<arguments[s].length;i++){if(typeof arguments[s][i]=="object"&&typeof arguments[s][i].sort=="function"){n.setAttribute(arguments[s][i][0],arguments[s][i][1])}}}else if(typeof arguments[s]=="object"){for(r in arguments[s]){if(arguments[s].hasOwnProperty(r)){n.setAttribute(r,arguments[s][r])}}}}return n},xmlescape:function(e){e=e.replace(/\&/g,"&amp;");e=e.replace(/</g,"&lt;");e=e.replace(/>/g,"&gt;");e=e.replace(/'/g,"&apos;");e=e.replace(/"/g,"&quot;");return e},xmlTextNode:function(e){return t.xmlGenerator().createTextNode(e)},xmlHtmlNode:function(e){var t;if(window.DOMParser){var n=new DOMParser;t=n.parseFromString(e,"text/xml")}else{t=new ActiveXObject("Microsoft.XMLDOM");t.async="false";t.loadXML(e)}return t},getText:function(e){if(!e){return null}var n="";if(e.childNodes.length===0&&e.nodeType==t.ElementType.TEXT){n+=e.nodeValue}for(var s=0;s<e.childNodes.length;s++){if(e.childNodes[s].nodeType==t.ElementType.TEXT){n+=e.childNodes[s].nodeValue}}return t.xmlescape(n)},copyElement:function(e){var n,s;if(e.nodeType==t.ElementType.NORMAL){s=t.xmlElement(e.tagName);for(n=0;n<e.attributes.length;n++){s.setAttribute(e.attributes[n].nodeName.toLowerCase(),e.attributes[n].value)}for(n=0;n<e.childNodes.length;n++){s.appendChild(t.copyElement(e.childNodes[n]))}}else if(e.nodeType==t.ElementType.TEXT){s=t.xmlGenerator().createTextNode(e.nodeValue)}return s},createHtml:function(e){var n,s,i,r,a,o,h,l,c,u,d;if(e.nodeType==t.ElementType.NORMAL){r=e.nodeName.toLowerCase();if(t.XHTML.validTag(r)){try{s=t.xmlElement(r);for(n=0;n<t.XHTML.attributes[r].length;n++){a=t.XHTML.attributes[r][n];o=e.getAttribute(a);if(typeof o=="undefined"||o===null||o===""||o===false||o===0){continue}if(a=="style"&&typeof o=="object"){if(typeof o.cssText!="undefined"){o=o.cssText}}if(a=="style"){h=[];l=o.split(";");for(i=0;i<l.length;i++){c=l[i].split(":");u=c[0].replace(/^\s*/,"").replace(/\s*$/,"").toLowerCase();if(t.XHTML.validCSS(u)){d=c[1].replace(/^\s*/,"").replace(/\s*$/,"");h.push(u+": "+d)}}if(h.length>0){o=h.join("; ");s.setAttribute(a,o)}}else{s.setAttribute(a,o)}}for(n=0;n<e.childNodes.length;n++){s.appendChild(t.createHtml(e.childNodes[n]))}}catch(f){s=t.xmlTextNode("")}}else{s=t.xmlGenerator().createDocumentFragment();for(n=0;n<e.childNodes.length;n++){s.appendChild(t.createHtml(e.childNodes[n]))}}}else if(e.nodeType==t.ElementType.FRAGMENT){s=t.xmlGenerator().createDocumentFragment();for(n=0;n<e.childNodes.length;n++){s.appendChild(t.createHtml(e.childNodes[n]))}}else if(e.nodeType==t.ElementType.TEXT){s=t.xmlTextNode(e.nodeValue)}return s},escapeNode:function(e){return e.replace(/^\s+|\s+$/g,"").replace(/\\/g,"\\5c").replace(/ /g,"\\20").replace(/\"/g,"\\22").replace(/\&/g,"\\26").replace(/\'/g,"\\27").replace(/\//g,"\\2f").replace(/:/g,"\\3a").replace(/</g,"\\3c").replace(/>/g,"\\3e").replace(/@/g,"\\40")},unescapeNode:function(e){return e.replace(/\\20/g," ").replace(/\\22/g,'"').replace(/\\26/g,"&").replace(/\\27/g,"'").replace(/\\2f/g,"/").replace(/\\3a/g,":").replace(/\\3c/g,"<").replace(/\\3e/g,">").replace(/\\40/g,"@").replace(/\\5c/g,"\\")},getNodeFromJid:function(e){if(e.indexOf("@")<0){return null}return e.split("@")[0]},getDomainFromJid:function(e){var n=t.getBareJidFromJid(e);if(n.indexOf("@")<0){return n}else{var s=n.split("@");s.splice(0,1);return s.join("@")}},getResourceFromJid:function(e){var t=e.split("/");if(t.length<2){return null}t.splice(0,1);return t.join("/")},getBareJidFromJid:function(e){return e?e.split("/")[0]:null},log:function(e,t){return},debug:function(e){this.log(this.LogLevel.DEBUG,e)},info:function(e){this.log(this.LogLevel.INFO,e)},warn:function(e){this.log(this.LogLevel.WARN,e)},error:function(e){this.log(this.LogLevel.ERROR,e)},fatal:function(e){this.log(this.LogLevel.FATAL,e)},serialize:function(e){var n;if(!e){return null}if(typeof e.tree==="function"){e=e.tree()}var s=e.nodeName;var i,r;if(e.getAttribute("_realname")){s=e.getAttribute("_realname")}n="<"+s;for(i=0;i<e.attributes.length;i++){if(e.attributes[i].nodeName!="_realname"){n+=" "+e.attributes[i].nodeName.toLowerCase()+"='"+e.attributes[i].value.replace(/&/g,"&amp;").replace(/\'/g,"&apos;").replace(/>/g,"&gt;").replace(/</g,"&lt;")+"'"}}if(e.childNodes.length>0){n+=">";for(i=0;i<e.childNodes.length;i++){r=e.childNodes[i];switch(r.nodeType){case t.ElementType.NORMAL:n+=t.serialize(r);break;case t.ElementType.TEXT:n+=t.xmlescape(r.nodeValue);break;case t.ElementType.CDATA:n+="<![CDATA["+r.nodeValue+"]]>"}}n+="</"+s+">"}else{n+="/>"}return n},_requestId:0,_connectionPlugins:{},addConnectionPlugin:function(e,n){t._connectionPlugins[e]=n}};t.Builder=function(e,n){if(e=="presence"||e=="message"||e=="iq"){if(n&&!n.xmlns){n.xmlns=t.NS.CLIENT}else if(!n){n={xmlns:t.NS.CLIENT}}}this.nodeTree=t.xmlElement(e,n);this.node=this.nodeTree};t.Builder.prototype={tree:function(){return this.nodeTree},toString:function(){return t.serialize(this.nodeTree)},up:function(){this.node=this.node.parentNode;return this},attrs:function(e){for(var t in e){if(e.hasOwnProperty(t)){this.node.setAttribute(t,e[t])}}return this},c:function(e,n,s){var i=t.xmlElement(e,n,s);this.node.appendChild(i);if(!s){this.node=i}return this},cnode:function(e){var n;var s=t.xmlGenerator();try{n=s.importNode!==undefined}catch(i){n=false}var r=n?s.importNode(e,true):t.copyElement(e);this.node.appendChild(r);this.node=r;return this},t:function(e){var n=t.xmlTextNode(e);this.node.appendChild(n);return this},h:function(e){var n=document.createElement("body");n.innerHTML=e;var s=t.createHtml(n);while(s.childNodes.length>0){this.node.appendChild(s.childNodes[0])}return this}};t.Handler=function(e,n,s,i,r,a,o){this.handler=e;this.ns=n;this.name=s;this.type=i;this.id=r;this.options=o||{matchBare:false};if(!this.options.matchBare){this.options.matchBare=false}if(this.options.matchBare){this.from=a?t.getBareJidFromJid(a):null}else{this.from=a}this.user=true};t.Handler.prototype={isMatch:function(e){var n;var s=null;if(this.options.matchBare){s=t.getBareJidFromJid(e.getAttribute("from"))}else{s=e.getAttribute("from")}n=false;if(!this.ns){n=true}else{var i=this;t.forEachChild(e,null,function(e){if(e.getAttribute("xmlns")==i.ns){n=true}});n=n||e.getAttribute("xmlns")==this.ns}if(n&&(!this.name||t.isTagEqual(e,this.name))&&(!this.type||e.getAttribute("type")==this.type)&&(!this.id||e.getAttribute("id")==this.id)&&(!this.from||s==this.from)){return true}return false},run:function(e){var n=null;try{n=this.handler(e)}catch(s){if(s.sourceURL){t.fatal("error: "+this.handler+" "+s.sourceURL+":"+s.line+" - "+s.name+": "+s.message)}else if(s.fileName){if(typeof console!="undefined"){console.trace();console.error(this.handler," - error - ",s,s.message)}t.fatal("error: "+this.handler+" "+s.fileName+":"+s.lineNumber+" - "+s.name+": "+s.message)}else{t.fatal("error: "+s.message+"\n"+s.stack)}throw s}return n},toString:function(){return"{Handler: "+this.handler+"("+this.name+","+this.id+","+this.ns+")}"}};t.TimedHandler=function(e,t){this.period=e;this.handler=t;this.lastCalled=(new Date).getTime();this.user=true};t.TimedHandler.prototype={run:function(){this.lastCalled=(new Date).getTime();return this.handler()},reset:function(){this.lastCalled=(new Date).getTime()},toString:function(){return"{TimedHandler: "+this.handler+"("+this.period+")}"}};t.Connection=function(e,n){this.service=e;this.options=n||{};var s=this.options.protocol||"";if(e.indexOf("ws:")===0||e.indexOf("wss:")===0||s.indexOf("ws")===0){this._proto=new t.Websocket(this)}else{this._proto=new t.Bosh(this)}this.jid="";this.domain=null;this.features=null;this._sasl_data={};this.do_session=false;this.do_bind=false;this.timedHandlers=[];this.handlers=[];this.removeTimeds=[];this.removeHandlers=[];this.addTimeds=[];this.addHandlers=[];this._authentication={};this._idleTimeout=null;this._disconnectTimeout=null;this.do_authentication=true;this.authenticated=false;this.disconnecting=false;this.connected=false;this.errors=0;this.paused=false;this._data=[];this._uniqueId=0;this._sasl_success_handler=null;this._sasl_failure_handler=null;this._sasl_challenge_handler=null;this.maxRetries=5;this._idleTimeout=setTimeout(this._onIdle.bind(this),100);for(var i in t._connectionPlugins){if(t._connectionPlugins.hasOwnProperty(i)){var r=t._connectionPlugins[i];var a=function(){};a.prototype=r;this[i]=new a;this[i].init(this)}}};t.Connection.prototype={reset:function(){this._proto._reset();this.do_session=false;this.do_bind=false;this.timedHandlers=[];this.handlers=[];this.removeTimeds=[];this.removeHandlers=[];this.addTimeds=[];this.addHandlers=[];this._authentication={};this.authenticated=false;this.disconnecting=false;this.connected=false;this.errors=0;this._requests=[];this._uniqueId=0},pause:function(){this.paused=true},resume:function(){this.paused=false},getUniqueId:function(e){if(typeof e=="string"||typeof e=="number"){return++this._uniqueId+":"+e}else{return++this._uniqueId+""}},connect:function(e,n,s,i,r,a){this.jid=e;this.authzid=t.getBareJidFromJid(this.jid);this.authcid=t.getNodeFromJid(this.jid);this.pass=n;this.servtype="xmpp";this.connect_callback=s;this.disconnecting=false;this.connected=false;this.authenticated=false;this.errors=0;this.domain=t.getDomainFromJid(this.jid);this._changeConnectStatus(t.Status.CONNECTING,null);this._proto._connect(i,r,a)},attach:function(e,t,n,s,i,r,a){this._proto._attach(e,t,n,s,i,r,a)},xmlInput:function(e){return},xmlOutput:function(e){return},rawInput:function(e){return},rawOutput:function(e){return},send:function(e){if(e===null){return}if(typeof e.sort==="function"){for(var t=0;t<e.length;t++){this._queueData(e[t])}}else if(typeof e.tree==="function"){this._queueData(e.tree())}else{this._queueData(e)}this._proto._send()},flush:function(){clearTimeout(this._idleTimeout);this._onIdle()},sendIQ:function(e,t,n,s){var i=null;var r=this;if(typeof e.tree==="function"){e=e.tree()}var a=e.getAttribute("id");if(!a){a=this.getUniqueId("sendIQ");e.setAttribute("id",a)}var o=this.addHandler(function(e){if(i){r.deleteTimedHandler(i)}var s=e.getAttribute("type");if(s=="result"){if(t){t(e)}}else if(s=="error"){if(n){n(e)}}else{throw{name:"StropheError",message:"Got bad IQ type of "+s}}},null,"iq",null,a);if(s){i=this.addTimedHandler(s,function(){r.deleteHandler(o);if(n){n(null)}return false})}this.send(e);return a},_queueData:function(e){if(e===null||!e.tagName||!e.childNodes){throw{name:"StropheError",message:"Cannot queue non-DOMElement."}}this._data.push(e)},_sendRestart:function(){this._data.push("restart");this._proto._sendRestart();this._idleTimeout=setTimeout(this._onIdle.bind(this),100)},addTimedHandler:function(e,n){var s=new t.TimedHandler(e,n);this.addTimeds.push(s);return s},deleteTimedHandler:function(e){this.removeTimeds.push(e)},addHandler:function(e,n,s,i,r,a,o){var h=new t.Handler(e,n,s,i,r,a,o);this.addHandlers.push(h);return h},deleteHandler:function(e){this.removeHandlers.push(e)},disconnect:function(e){this._changeConnectStatus(t.Status.DISCONNECTING,e);t.info("Disconnect was called because: "+e);if(this.connected){var n=false;this.disconnecting=true;if(this.authenticated){n=r({xmlns:t.NS.CLIENT,type:"unavailable"})}this._disconnectTimeout=this._addSysTimedHandler(3e3,this._onDisconnectTimeout.bind(this));this._proto._disconnect(n)}},_changeConnectStatus:function(e,n){for(var s in t._connectionPlugins){if(t._connectionPlugins.hasOwnProperty(s)){var i=this[s];if(i.statusChanged){try{i.statusChanged(e,n)}catch(r){t.error(""+s+" plugin caused an exception "+"changing status: "+r)}}}}if(this.connect_callback){try{this.connect_callback(e,n)}catch(a){t.error("User connection callback caused an "+"exception: "+a)}}},_doDisconnect:function(){if(this._disconnectTimeout!==null){this.deleteTimedHandler(this._disconnectTimeout);this._disconnectTimeout=null}t.info("_doDisconnect was called");this._proto._doDisconnect();this.authenticated=false;this.disconnecting=false;this.handlers=[];this.timedHandlers=[];this.removeTimeds=[];this.removeHandlers=[];this.addTimeds=[];this.addHandlers=[];this._changeConnectStatus(t.Status.DISCONNECTED,null);this.connected=false},_dataRecv:function(e,n){t.info("_dataRecv called");var s=this._proto._reqToData(e);if(s===null){return}if(this.xmlInput!==t.Connection.prototype.xmlInput){if(s.nodeName===this._proto.strip&&s.childNodes.length){this.xmlInput(s.childNodes[0])}else{this.xmlInput(s)}}if(this.rawInput!==t.Connection.prototype.rawInput){if(n){this.rawInput(n)}else{this.rawInput(t.serialize(s))}}var i,r;while(this.removeHandlers.length>0){r=this.removeHandlers.pop();i=this.handlers.indexOf(r);if(i>=0){this.handlers.splice(i,1)}}while(this.addHandlers.length>0){this.handlers.push(this.addHandlers.pop())}if(this.disconnecting&&this._proto._emptyQueue()){this._doDisconnect();return}var a=s.getAttribute("type");var o,h;if(a!==null&&a=="terminate"){if(this.disconnecting){return}o=s.getAttribute("condition");h=s.getElementsByTagName("conflict");if(o!==null){if(o=="remote-stream-error"&&h.length>0){o="conflict"}this._changeConnectStatus(t.Status.CONNFAIL,o)}else{this._changeConnectStatus(t.Status.CONNFAIL,"unknown")}this.disconnect("unknown stream-error");return}var l=this;t.forEachChild(s,null,function(e){var n,s;s=l.handlers;l.handlers=[];for(n=0;n<s.length;n++){var i=s[n];try{if(i.isMatch(e)&&(l.authenticated||!i.user)){if(i.run(e)){l.handlers.push(i)}}else{l.handlers.push(i)}}catch(r){t.warn("Removing Strophe handlers due to uncaught exception: "+r.message)}}})},mechanisms:{},_connect_cb:function(e,n,s){t.info("_connect_cb was called");this.connected=true;var i=this._proto._reqToData(e);if(!i){return}if(this.xmlInput!==t.Connection.prototype.xmlInput){if(i.nodeName===this._proto.strip&&i.childNodes.length){this.xmlInput(i.childNodes[0])}else{this.xmlInput(i)}}if(this.rawInput!==t.Connection.prototype.rawInput){if(s){this.rawInput(s)}else{this.rawInput(t.serialize(i))}}var r=this._proto._connect_cb(i);if(r===t.Status.CONNFAIL){return}this._authentication.sasl_scram_sha1=false;this._authentication.sasl_plain=false;this._authentication.sasl_digest_md5=false;this._authentication.sasl_anonymous=false;this._authentication.legacy_auth=false;var a=i.getElementsByTagName("stream:features").length>0;if(!a){a=i.getElementsByTagName("features").length>0}var o=i.getElementsByTagName("mechanism");var h=[];var l,c,u=false;if(!a){this._proto._no_auth_received(n);return}if(o.length>0){for(l=0;l<o.length;l++){c=t.getText(o[l]);if(this.mechanisms[c])h.push(this.mechanisms[c])}}this._authentication.legacy_auth=i.getElementsByTagName("auth").length>0;u=this._authentication.legacy_auth||h.length>0;if(!u){this._proto._no_auth_received(n);return}if(this.do_authentication!==false)this.authenticate(h)},authenticate:function(e){var s;for(s=0;s<e.length-1;++s){var r=s;for(var a=s+1;a<e.length;++a){if(e[a].prototype.priority>e[r].prototype.priority){r=a}}if(r!=s){var o=e[s];e[s]=e[r];e[r]=o}}var h=false;for(s=0;s<e.length;++s){if(!e[s].test(this))continue;this._sasl_success_handler=this._addSysHandler(this._sasl_success_cb.bind(this),null,"success",null,null);this._sasl_failure_handler=this._addSysHandler(this._sasl_failure_cb.bind(this),null,"failure",null,null);this._sasl_challenge_handler=this._addSysHandler(this._sasl_challenge_cb.bind(this),null,"challenge",null,null);this._sasl_mechanism=new e[s];this._sasl_mechanism.onStart(this);var l=n("auth",{xmlns:t.NS.SASL,mechanism:this._sasl_mechanism.name});if(this._sasl_mechanism.isClientFirst){var c=this._sasl_mechanism.onChallenge(this,null);l.t(Base64.encode(c))}this.send(l.tree());h=true;break}if(!h){if(t.getNodeFromJid(this.jid)===null){this._changeConnectStatus(t.Status.CONNFAIL,"x-strophe-bad-non-anon-jid");this.disconnect("x-strophe-bad-non-anon-jid")}else{this._changeConnectStatus(t.Status.AUTHENTICATING,null);this._addSysHandler(this._auth1_cb.bind(this),null,null,null,"_auth_1");this.send(i({type:"get",to:this.domain,id:"_auth_1"}).c("query",{xmlns:t.NS.AUTH}).c("username",{}).t(t.getNodeFromJid(this.jid)).tree())}}},_sasl_challenge_cb:function(e){var s=Base64.decode(t.getText(e));var i=this._sasl_mechanism.onChallenge(this,s);var r=n("response",{xmlns:t.NS.SASL});if(i!==""){r.t(Base64.encode(i))}this.send(r.tree());return true},_auth1_cb:function(e){var n=i({type:"set",id:"_auth_2"}).c("query",{xmlns:t.NS.AUTH}).c("username",{}).t(t.getNodeFromJid(this.jid)).up().c("password").t(this.pass);if(!t.getResourceFromJid(this.jid)){this.jid=t.getBareJidFromJid(this.jid)+"/strophe"}n.up().c("resource",{}).t(t.getResourceFromJid(this.jid));this._addSysHandler(this._auth2_cb.bind(this),null,null,null,"_auth_2");this.send(n.tree());return false},_sasl_success_cb:function(e){if(this._sasl_data["server-signature"]){var n;var s=Base64.decode(t.getText(e));var i=/([a-z]+)=([^,]+)(,|$)/;var r=s.match(i);if(r[1]=="v"){n=r[2]}if(n!=this._sasl_data["server-signature"]){this.deleteHandler(this._sasl_failure_handler);this._sasl_failure_handler=null;if(this._sasl_challenge_handler){this.deleteHandler(this._sasl_challenge_handler);this._sasl_challenge_handler=null}this._sasl_data={};return this._sasl_failure_cb(null)}}t.info("SASL authentication succeeded.");if(this._sasl_mechanism)this._sasl_mechanism.onSuccess();this.deleteHandler(this._sasl_failure_handler);this._sasl_failure_handler=null;if(this._sasl_challenge_handler){this.deleteHandler(this._sasl_challenge_handler);this._sasl_challenge_handler=null}this._addSysHandler(this._sasl_auth1_cb.bind(this),null,"stream:features",null,null);this._sendRestart();return false},_sasl_auth1_cb:function(e){this.features=e;var n,s;for(n=0;n<e.childNodes.length;n++){s=e.childNodes[n];if(s.nodeName=="bind"){this.do_bind=true}if(s.nodeName=="session"){this.do_session=true}}if(!this.do_bind){this._changeConnectStatus(t.Status.AUTHFAIL,null);return false}else{this._addSysHandler(this._sasl_bind_cb.bind(this),null,null,null,"_bind_auth_2");var r=t.getResourceFromJid(this.jid);if(r){this.send(i({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:t.NS.BIND}).c("resource",{}).t(r).tree())}else{this.send(i({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:t.NS.BIND}).tree())}}return false},_sasl_bind_cb:function(e){if(e.getAttribute("type")=="error"){t.info("SASL binding failed.");var n=e.getElementsByTagName("conflict"),s;if(n.length>0){s="conflict"}this._changeConnectStatus(t.Status.AUTHFAIL,s);return false}var r=e.getElementsByTagName("bind");var a;if(r.length>0){a=r[0].getElementsByTagName("jid");if(a.length>0){this.jid=t.getText(a[0]);if(this.do_session){this._addSysHandler(this._sasl_session_cb.bind(this),null,null,null,"_session_auth_2");this.send(i({type:"set",id:"_session_auth_2"}).c("session",{xmlns:t.NS.SESSION}).tree())}else{this.authenticated=true;this._changeConnectStatus(t.Status.CONNECTED,null)}}}else{t.info("SASL binding failed.");this._changeConnectStatus(t.Status.AUTHFAIL,null);return false}},_sasl_session_cb:function(e){if(e.getAttribute("type")=="result"){this.authenticated=true;this._changeConnectStatus(t.Status.CONNECTED,null)}else if(e.getAttribute("type")=="error"){t.info("Session creation failed.");this._changeConnectStatus(t.Status.AUTHFAIL,null);return false}return false},_sasl_failure_cb:function(e){if(this._sasl_success_handler){this.deleteHandler(this._sasl_success_handler);this._sasl_success_handler=null}if(this._sasl_challenge_handler){this.deleteHandler(this._sasl_challenge_handler);this._sasl_challenge_handler=null}if(this._sasl_mechanism)this._sasl_mechanism.onFailure();this._changeConnectStatus(t.Status.AUTHFAIL,null);return false},_auth2_cb:function(e){if(e.getAttribute("type")=="result"){this.authenticated=true;this._changeConnectStatus(t.Status.CONNECTED,null)}else if(e.getAttribute("type")=="error"){this._changeConnectStatus(t.Status.AUTHFAIL,null);this.disconnect("authentication failed")}return false},_addSysTimedHandler:function(e,n){var s=new t.TimedHandler(e,n);s.user=false;this.addTimeds.push(s);return s},_addSysHandler:function(e,n,s,i,r){var a=new t.Handler(e,n,s,i,r);a.user=false;this.addHandlers.push(a);return a},_onDisconnectTimeout:function(){t.info("_onDisconnectTimeout was called");this._proto._onDisconnectTimeout();this._doDisconnect();return false},_onIdle:function(){var e,t,n,s;while(this.addTimeds.length>0){this.timedHandlers.push(this.addTimeds.pop())}while(this.removeTimeds.length>0){t=this.removeTimeds.pop();e=this.timedHandlers.indexOf(t);if(e>=0){this.timedHandlers.splice(e,1)}}var i=(new Date).getTime();s=[];for(e=0;e<this.timedHandlers.length;e++){t=this.timedHandlers[e];if(this.authenticated||!t.user){n=t.lastCalled+t.period;if(n-i<=0){if(t.run()){s.push(t)}}else{s.push(t)}}}this.timedHandlers=s;clearTimeout(this._idleTimeout);this._proto._onIdle();if(this.connected){this._idleTimeout=setTimeout(this._onIdle.bind(this),100)}}};if(e){e(t,n,s,i,r)}t.SASLMechanism=function(e,t,n){this.name=e;this.isClientFirst=t;this.priority=n};t.SASLMechanism.prototype={test:function(e){return true},onStart:function(e){this._connection=e},onChallenge:function(e,t){throw new Error("You should implement challenge handling!")},onFailure:function(){this._connection=null},onSuccess:function(){this._connection=null}};t.SASLAnonymous=function(){};t.SASLAnonymous.prototype=new t.SASLMechanism("ANONYMOUS",false,10);t.SASLAnonymous.test=function(e){return e.authcid===null};t.Connection.prototype.mechanisms[t.SASLAnonymous.prototype.name]=t.SASLAnonymous;t.SASLPlain=function(){};t.SASLPlain.prototype=new t.SASLMechanism("PLAIN",true,20);t.SASLPlain.test=function(e){return e.authcid!==null};t.SASLPlain.prototype.onChallenge=function(e){var t=e.authzid;t=t+"\x00";t=t+e.authcid;t=t+"\x00";t=t+e.pass;return t};t.Connection.prototype.mechanisms[t.SASLPlain.prototype.name]=t.SASLPlain;t.SASLSHA1=function(){};t.SASLSHA1.prototype=new t.SASLMechanism("SCRAM-SHA-1",true,40);t.SASLSHA1.test=function(e){return e.authcid!==null};t.SASLSHA1.prototype.onChallenge=function(e,t,n){var s=n||MD5.hexdigest(Math.random()*1234567890);var i="n="+e.authcid;i+=",r=";i+=s;e._sasl_data.cnonce=s;e._sasl_data["client-first-message-bare"]=i;i="n,,"+i;this.onChallenge=function(e,t){var n,s,i,r,a,o,h,l;var c,u,d;var f="c=biws,";var _=e._sasl_data["client-first-message-bare"]+","+t+",";var m=e._sasl_data.cnonce;var p=/([a-z]+)=([^,]+)(,|$)/;while(t.match(p)){var g=t.match(p);t=t.replace(g[0],"");switch(g[1]){case"r":n=g[2];break;case"s":s=g[2];break;case"i":i=g[2];break}}if(n.substr(0,m.length)!==m){e._sasl_data={};return e._sasl_failure_cb()}f+="r="+n;_+=f;s=Base64.decode(s);s+="\x00\x00\x00";r=o=core_hmac_sha1(e.pass,s);for(h=1;h<i;h++){a=core_hmac_sha1(e.pass,binb2str(o));for(l=0;l<5;l++){r[l]^=a[l]}o=a}r=binb2str(r);c=core_hmac_sha1(r,"Client Key");u=str_hmac_sha1(r,"Server Key");d=core_hmac_sha1(str_sha1(binb2str(c)),_);e._sasl_data["server-signature"]=b64_hmac_sha1(u,_);for(l=0;l<5;l++){c[l]^=d[l]}f+=",p="+Base64.encode(binb2str(c));return f}.bind(this);return i};t.Connection.prototype.mechanisms[t.SASLSHA1.prototype.name]=t.SASLSHA1;t.SASLMD5=function(){};t.SASLMD5.prototype=new t.SASLMechanism("DIGEST-MD5",false,30);t.SASLMD5.test=function(e){return e.authcid!==null};t.SASLMD5.prototype._quote=function(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'};t.SASLMD5.prototype.onChallenge=function(e,t,n){var s=/([a-z]+)=("[^"]+"|[^,"]+)(?:,|$)/;var i=n||MD5.hexdigest(""+Math.random()*1234567890);var r="";var a=null;var o="";var h="";var l;while(t.match(s)){l=t.match(s);t=t.replace(l[0],"");l[2]=l[2].replace(/^"(.+)"$/,"$1");switch(l[1]){case"realm":r=l[2];break;case"nonce":o=l[2];break;case"qop":h=l[2];break;case"host":a=l[2];break}}var c=e.servtype+"/"+e.domain;if(a!==null){c=c+"/"+a}var u=MD5.hash(e.authcid+":"+r+":"+this._connection.pass)+":"+o+":"+i;var d="AUTHENTICATE:"+c;var f="";f+="charset=utf-8,";f+="username="+this._quote(e.authcid)+",";f+="realm="+this._quote(r)+",";f+="nonce="+this._quote(o)+",";f+="nc=00000001,";f+="cnonce="+this._quote(i)+",";f+="digest-uri="+this._quote(c)+",";f+="response="+MD5.hexdigest(MD5.hexdigest(u)+":"+o+":00000001:"+i+":auth:"+MD5.hexdigest(d))+",";f+="qop=auth";this.onChallenge=function(){return""}.bind(this);return f};t.Connection.prototype.mechanisms[t.SASLMD5.prototype.name]=t.SASLMD5})(function(){window.Strophe=arguments[0];window.$build=arguments[1];window.$msg=arguments[2];window.$iq=arguments[3];window.$pres=arguments[4]});Strophe.Request=function(e,t,n,s){this.id=++Strophe._requestId;this.xmlData=e;this.data=Strophe.serialize(e);this.origFunc=t;this.func=t;this.rid=n;this.date=NaN;this.sends=s||0;this.abort=false;this.dead=null;this.age=function(){if(!this.date){return 0}var e=new Date;return(e-this.date)/1e3};this.timeDead=function(){if(!this.dead){return 0}var e=new Date;return(e-this.dead)/1e3};this.xhr=this._newXHR()};Strophe.Request.prototype={getResponse:function(){var e=null;if(this.xhr.responseXML&&this.xhr.responseXML.documentElement){e=this.xhr.responseXML.documentElement;if(e.tagName=="parsererror"){Strophe.error("invalid response received");Strophe.error("responseText: "+this.xhr.responseText);Strophe.error("responseXML: "+Strophe.serialize(this.xhr.responseXML));throw"parsererror"}}else if(this.xhr.responseText){Strophe.error("invalid response received");Strophe.error("responseText: "+this.xhr.responseText);Strophe.error("responseXML: "+Strophe.serialize(this.xhr.responseXML))}return e},_newXHR:function(){var e=null;if(window.XMLHttpRequest){e=new XMLHttpRequest;if(e.overrideMimeType){e.overrideMimeType("text/xml")}}else if(window.ActiveXObject){e=new ActiveXObject("Microsoft.XMLHTTP")}e.onreadystatechange=this.func.bind(null,this);return e}};Strophe.Bosh=function(e){this._conn=e;this.rid=Math.floor(Math.random()*4294967295);this.sid=null;this.hold=1;this.wait=60;this.window=5;this._requests=[]};Strophe.Bosh.prototype={strip:null,_buildBody:function(){var e=$build("body",{rid:this.rid++,xmlns:Strophe.NS.HTTPBIND});if(this.sid!==null){e.attrs({sid:this.sid})}return e},_reset:function(){this.rid=Math.floor(Math.random()*4294967295);this.sid=null},_connect:function(e,t,n){this.wait=e||this.wait;this.hold=t||this.hold;var s=this._buildBody().attrs({to:this._conn.domain,"xml:lang":"en",wait:this.wait,hold:this.hold,content:"text/xml; charset=utf-8",ver:"1.6","xmpp:version":"1.0","xmlns:xmpp":Strophe.NS.BOSH});if(n){s.attrs({route:n})}var i=this._conn._connect_cb;this._requests.push(new Strophe.Request(s.tree(),this._onRequestStateChange.bind(this,i.bind(this._conn)),s.tree().getAttribute("rid")));this._throttledRequestHandler()},_attach:function(e,t,n,s,i,r,a){this._conn.jid=e;this.sid=t;this.rid=n;this._conn.connect_callback=s;this._conn.domain=Strophe.getDomainFromJid(this._conn.jid);this._conn.authenticated=true;this._conn.connected=true;this.wait=i||this.wait;this.hold=r||this.hold;this.window=a||this.window;this._conn._changeConnectStatus(Strophe.Status.ATTACHED,null)},_connect_cb:function(e){var t=e.getAttribute("type");var n,s;if(t!==null&&t=="terminate"){Strophe.error("BOSH-Connection failed: "+n);n=e.getAttribute("condition");s=e.getElementsByTagName("conflict");if(n!==null){if(n=="remote-stream-error"&&s.length>0){n="conflict"}this._conn._changeConnectStatus(Strophe.Status.CONNFAIL,n)}else{this._conn._changeConnectStatus(Strophe.Status.CONNFAIL,"unknown")}this._conn._doDisconnect();return Strophe.Status.CONNFAIL}if(!this.sid){this.sid=e.getAttribute("sid")}var i=e.getAttribute("requests");if(i){this.window=parseInt(i,10)}var r=e.getAttribute("hold");if(r){this.hold=parseInt(r,10)}var a=e.getAttribute("wait");if(a){this.wait=parseInt(a,10)}},_disconnect:function(e){this._sendTerminate(e)},_doDisconnect:function(){this.sid=null;this.rid=Math.floor(Math.random()*4294967295)},_emptyQueue:function(){return this._requests.length===0},_hitError:function(e){this.errors++;Strophe.warn("request errored, status: "+e+", number of errors: "+this.errors);if(this.errors>4){this._onDisconnectTimeout()}},_no_auth_received:function(e){if(e){e=e.bind(this._conn)}else{e=this._conn._connect_cb.bind(this._conn)}var t=this._buildBody();this._requests.push(new Strophe.Request(t.tree(),this._onRequestStateChange.bind(this,e.bind(this._conn)),t.tree().getAttribute("rid")));this._throttledRequestHandler()},_onDisconnectTimeout:function(){var e;while(this._requests.length>0){e=this._requests.pop();e.abort=true;e.xhr.abort();e.xhr.onreadystatechange=function(){}}},_onIdle:function(){var e=this._conn._data;if(this._conn.authenticated&&this._requests.length===0&&e.length===0&&!this._conn.disconnecting){Strophe.info("no requests during idle cycle, sending "+"blank request");e.push(null)}if(this._requests.length<2&&e.length>0&&!this._conn.paused){var t=this._buildBody();for(var n=0;n<e.length;n++){if(e[n]!==null){if(e[n]==="restart"){t.attrs({to:this._conn.domain,"xml:lang":"en","xmpp:restart":"true","xmlns:xmpp":Strophe.NS.BOSH})}else{t.cnode(e[n]).up()}}}delete this._conn._data;this._conn._data=[];this._requests.push(new Strophe.Request(t.tree(),this._onRequestStateChange.bind(this,this._conn._dataRecv.bind(this._conn)),t.tree().getAttribute("rid")));this._processRequest(this._requests.length-1)}if(this._requests.length>0){var s=this._requests[0].age();if(this._requests[0].dead!==null){if(this._requests[0].timeDead()>Math.floor(Strophe.SECONDARY_TIMEOUT*this.wait)){this._throttledRequestHandler()}}if(s>Math.floor(Strophe.TIMEOUT*this.wait)){Strophe.warn("Request "+this._requests[0].id+" timed out, over "+Math.floor(Strophe.TIMEOUT*this.wait)+" seconds since last activity");this._throttledRequestHandler()}}},_onRequestStateChange:function(e,t){Strophe.debug("request id "+t.id+"."+t.sends+" state changed to "+t.xhr.readyState);if(t.abort){t.abort=false;return}var n;if(t.xhr.readyState==4){n=0;try{n=t.xhr.status}catch(s){}if(typeof n=="undefined"){n=0}if(this.disconnecting){if(n>=400){this._hitError(n);return}}var i=this._requests[0]==t;var r=this._requests[1]==t;if(n>0&&n<500||t.sends>5){this._removeRequest(t);Strophe.debug("request id "+t.id+" should now be removed")}if(n==200){if(r||i&&this._requests.length>0&&this._requests[0].age()>Math.floor(Strophe.SECONDARY_TIMEOUT*this.wait)){this._restartRequest(0)}Strophe.debug("request id "+t.id+"."+t.sends+" got 200");e(t);this.errors=0}else{Strophe.error("request id "+t.id+"."+t.sends+" error "+n+" happened");if(n===0||n>=400&&n<600||n>=12e3){this._hitError(n);if(n>=400&&n<500){this._conn._changeConnectStatus(Strophe.Status.DISCONNECTING,null);this._conn._doDisconnect()}}}if(!(n>0&&n<500||t.sends>5)){this._throttledRequestHandler()}}},_processRequest:function(e){var t=this;var n=this._requests[e];var s=-1;try{if(n.xhr.readyState==4){s=n.xhr.status}}catch(i){Strophe.error("caught an error in _requests["+e+"], reqStatus: "+s)}if(typeof s=="undefined"){s=-1}if(n.sends>this.maxRetries){this._onDisconnectTimeout();return}var r=n.age();var a=!isNaN(r)&&r>Math.floor(Strophe.TIMEOUT*this.wait);var o=n.dead!==null&&n.timeDead()>Math.floor(Strophe.SECONDARY_TIMEOUT*this.wait);var h=n.xhr.readyState==4&&(s<1||s>=500);if(a||o||h){if(o){Strophe.error("Request "+this._requests[e].id+" timed out (secondary), restarting")}n.abort=true;n.xhr.abort();n.xhr.onreadystatechange=function(){};this._requests[e]=new Strophe.Request(n.xmlData,n.origFunc,n.rid,n.sends);n=this._requests[e]}if(n.xhr.readyState===0){Strophe.debug("request id "+n.id+"."+n.sends+" posting");try{n.xhr.open("POST",this._conn.service,this._conn.options.sync?false:true)}catch(l){Strophe.error("XHR open failed.");if(!this._conn.connected){this._conn._changeConnectStatus(Strophe.Status.CONNFAIL,"bad-service")}this._conn.disconnect();return}var c=function(){n.date=new Date;if(t._conn.options.customHeaders){var e=t._conn.options.customHeaders;for(var s in e){if(e.hasOwnProperty(s)){n.xhr.setRequestHeader(s,e[s])}}}n.xhr.send(n.data)};if(n.sends>1){var u=Math.min(Math.floor(Strophe.TIMEOUT*this.wait),Math.pow(n.sends,3))*1e3;setTimeout(c,u)}else{c()}n.sends++;if(this._conn.xmlOutput!==Strophe.Connection.prototype.xmlOutput){if(n.xmlData.nodeName===this.strip&&n.xmlData.childNodes.length){this._conn.xmlOutput(n.xmlData.childNodes[0])}else{this._conn.xmlOutput(n.xmlData)}}if(this._conn.rawOutput!==Strophe.Connection.prototype.rawOutput){this._conn.rawOutput(n.data)}}else{Strophe.debug("_processRequest: "+(e===0?"first":"second")+" request has readyState of "+n.xhr.readyState)}},_removeRequest:function(e){Strophe.debug("removing request");var t;for(t=this._requests.length-1;t>=0;t--){if(e==this._requests[t]){this._requests.splice(t,1)}}e.xhr.onreadystatechange=function(){};this._throttledRequestHandler()},_restartRequest:function(e){var t=this._requests[e];if(t.dead===null){t.dead=new Date}this._processRequest(e)},_reqToData:function(e){try{return e.getResponse()}catch(t){if(t!="parsererror"){throw t}this._conn.disconnect("strophe-parsererror")}},_sendTerminate:function(e){Strophe.info("_sendTerminate was called");var t=this._buildBody().attrs({type:"terminate"});if(e){t.cnode(e.tree())}var n=new Strophe.Request(t.tree(),this._onRequestStateChange.bind(this,this._conn._dataRecv.bind(this._conn)),t.tree().getAttribute("rid"));this._requests.push(n);this._throttledRequestHandler()},_send:function(){clearTimeout(this._conn._idleTimeout);this._throttledRequestHandler();this._conn._idleTimeout=setTimeout(this._conn._onIdle.bind(this._conn),100)},_sendRestart:function(){this._throttledRequestHandler();clearTimeout(this._conn._idleTimeout)},_throttledRequestHandler:function(){if(!this._requests){Strophe.debug("_throttledRequestHandler called with "+"undefined requests")}else{Strophe.debug("_throttledRequestHandler called with "+this._requests.length+" requests")}if(!this._requests||this._requests.length===0){return}if(this._requests.length>0){this._processRequest(0)}if(this._requests.length>1&&Math.abs(this._requests[0].rid-this._requests[1].rid)<this.window){this._processRequest(1)}}};Strophe.Websocket=function(e){this._conn=e;this.strip="stream:stream";var t=e.service;if(t.indexOf("ws:")!==0&&t.indexOf("wss:")!==0){var n="";if(e.options.protocol==="ws"&&window.location.protocol!=="https:"){n+="ws"}else{n+="wss"}n+="://"+window.location.host;if(t.indexOf("/")!==0){n+=window.location.pathname+t}else{n+=t}e.service=n}};Strophe.Websocket.prototype={_buildStream:function(){return $build("stream:stream",{to:this._conn.domain,xmlns:Strophe.NS.CLIENT,"xmlns:stream":Strophe.NS.STREAM,version:"1.0"})},_check_streamerror:function(e,t){var n=e.getElementsByTagName("stream:error");if(n.length===0){return false}var s=n[0];var i="";var r="";var a="urn:ietf:params:xml:ns:xmpp-streams";for(var o=0;o<s.childNodes.length;o++){var h=s.childNodes[o];if(h.getAttribute("xmlns")!==a){break}if(h.nodeName==="text"){r=h.textContent}else{i=h.nodeName}}var l="WebSocket stream error: ";if(i){l+=i}else{l+="unknown"}if(r){l+=" - "+i}Strophe.error(l);this._conn._changeConnectStatus(t,i);this._conn._doDisconnect();return true},_reset:function(){return},_connect:function(){this._closeSocket();this.socket=new WebSocket(this._conn.service,"xmpp");this.socket.onopen=this._onOpen.bind(this);this.socket.onerror=this._onError.bind(this);this.socket.onclose=this._onClose.bind(this);this.socket.onmessage=this._connect_cb_wrapper.bind(this)},_connect_cb:function(e){var t=this._check_streamerror(e,Strophe.Status.CONNFAIL);if(t){return Strophe.Status.CONNFAIL}},_handleStreamStart:function(e){var t=false;var n=e.getAttribute("xmlns");if(typeof n!=="string"){t="Missing xmlns in stream:stream"}else if(n!==Strophe.NS.CLIENT){t="Wrong xmlns in stream:stream: "+n}var s=e.namespaceURI;if(typeof s!=="string"){t="Missing xmlns:stream in stream:stream"}else if(s!==Strophe.NS.STREAM){t="Wrong xmlns:stream in stream:stream: "+s}var i=e.getAttribute("version");if(typeof i!=="string"){t="Missing version in stream:stream"}else if(i!=="1.0"){t="Wrong version in stream:stream: "+i}if(t){this._conn._changeConnectStatus(Strophe.Status.CONNFAIL,t);this._conn._doDisconnect();return false}return true},_connect_cb_wrapper:function(e){if(e.data.indexOf("<stream:stream ")===0||e.data.indexOf("<?xml")===0){var t=e.data.replace(/^(<\?.*?\?>\s*)*/,"");if(t==="")return;t=e.data.replace(/<stream:stream (.*[^\/])>/,"<stream:stream $1/>");var n=(new DOMParser).parseFromString(t,"text/xml").documentElement;this._conn.xmlInput(n);this._conn.rawInput(e.data);if(this._handleStreamStart(n)){this._connect_cb(n);this.streamStart=e.data.replace(/^<stream:(.*)\/>$/,"<stream:$1>")}}else if(e.data==="</stream:stream>"){this._conn.rawInput(e.data);this._conn.xmlInput(document.createElement("stream:stream"));this._conn._changeConnectStatus(Strophe.Status.CONNFAIL,"Received closing stream");this._conn._doDisconnect();return}else{var s=this._streamWrap(e.data);var i=(new DOMParser).parseFromString(s,"text/xml").documentElement;this.socket.onmessage=this._onMessage.bind(this);this._conn._connect_cb(i,null,e.data)}},_disconnect:function(e){if(this.socket.readyState!==WebSocket.CLOSED){if(e){this._conn.send(e)}var t="</stream:stream>";this._conn.xmlOutput(document.createElement("stream:stream"));this._conn.rawOutput(t);try{this.socket.send(t)}catch(n){Strophe.info("Couldn't send closing stream tag.")}}this._conn._doDisconnect()},_doDisconnect:function(){Strophe.info("WebSockets _doDisconnect was called");this._closeSocket()},_streamWrap:function(e){return this.streamStart+e+"</stream:stream>"},_closeSocket:function(){if(this.socket){try{this.socket.close()}catch(e){}}this.socket=null},_emptyQueue:function(){return true},_onClose:function(){if(this._conn.connected&&!this._conn.disconnecting){Strophe.error("Websocket closed unexcectedly");this._conn._doDisconnect()}else{Strophe.info("Websocket closed")}},_no_auth_received:function(e){Strophe.error("Server did not send any auth methods");this._conn._changeConnectStatus(Strophe.Status.CONNFAIL,"Server did not send any auth methods");if(e){e=e.bind(this._conn);e()}this._conn._doDisconnect()},_onDisconnectTimeout:function(){},_onError:function(e){Strophe.error("Websocket error "+e);this._conn._changeConnectStatus(Strophe.Status.CONNFAIL,"The WebSocket connection could not be established was disconnected.");this._disconnect()},_onIdle:function(){var e=this._conn._data;if(e.length>0&&!this._conn.paused){for(var t=0;t<e.length;t++){if(e[t]!==null){var n,s;if(e[t]==="restart"){n=this._buildStream();s=this._removeClosingTag(n);n=n.tree()}else{n=e[t];s=Strophe.serialize(n)}this._conn.xmlOutput(n);this._conn.rawOutput(s);this.socket.send(s)}}this._conn._data=[]}},_onMessage:function(e){var t,n;if(e.data==="</stream:stream>"){var s="</stream:stream>";this._conn.rawInput(s);this._conn.xmlInput(document.createElement("stream:stream"));if(!this._conn.disconnecting){this._conn._doDisconnect()}return}else if(e.data.search("<stream:stream ")===0){n=e.data.replace(/<stream:stream (.*[^\/])>/,"<stream:stream $1/>");t=(new DOMParser).parseFromString(n,"text/xml").documentElement;if(!this._handleStreamStart(t)){return}}else{n=this._streamWrap(e.data);t=(new DOMParser).parseFromString(n,"text/xml").documentElement}if(this._check_streamerror(t,Strophe.Status.ERROR)){return}if(this._conn.disconnecting&&t.firstChild.nodeName==="presence"&&t.firstChild.getAttribute("type")==="unavailable"){this._conn.xmlInput(t);this._conn.rawInput(Strophe.serialize(t));return}this._conn._dataRecv(t,e.data)},_onOpen:function(){Strophe.info("Websocket open");var e=this._buildStream();this._conn.xmlOutput(e.tree());var t=this._removeClosingTag(e);this._conn.rawOutput(t);this.socket.send(t)},_removeClosingTag:function(e){var t=Strophe.serialize(e);t=t.replace(/<(stream:stream .*[^\/])\/>$/,"<$1>");return t},_reqToData:function(e){return e},_send:function(){this._conn.flush()},_sendRestart:function(){clearTimeout(this._conn._idleTimeout);this._conn._onIdle.bind(this._conn)()}};(function(){var t,e,i,n={}.hasOwnProperty,o=function(t,e){return function(){return t.apply(e,arguments)}};Strophe.addConnectionPlugin("muc",{_connection:null,rooms:{},roomNames:[],init:function(t){this._connection=t;this._muc_handler=null;Strophe.addNamespace("MUC_OWNER",Strophe.NS.MUC+"#owner");Strophe.addNamespace("MUC_ADMIN",Strophe.NS.MUC+"#admin");Strophe.addNamespace("MUC_USER",Strophe.NS.MUC+"#user");Strophe.addNamespace("MUC_ROOMCONF",Strophe.NS.MUC+"#roomconfig");return Strophe.addNamespace("MUC_REGISTER","jabber:iq:register")},join:function(t,e,n,o,r,s,c){var h,u;u=this.test_append_nick(t,e);h=$pres({from:this._connection.jid,to:u}).c("x",{xmlns:Strophe.NS.MUC});if(c!=null){h=h.c("history",c).up()}if(s!=null){h.cnode(Strophe.xmlElement("password",[],s))}if(typeof extended_presence!=="undefined"&&extended_presence!==null){h.up.cnode(extended_presence)}if(this._muc_handler==null){this._muc_handler=this._connection.addHandler(function(e){return function(i){var n,o,r,s,c,h,u,a,l,d;n=i.getAttribute("from");if(!n){return true}c=n.split("/")[0];if(!e.rooms[c]){return true}t=e.rooms[c];r={};if(i.nodeName==="message"){r=t._message_handlers}else if(i.nodeName==="presence"){a=i.getElementsByTagName("x");if(a.length>0){for(l=0,d=a.length;l<d;l++){h=a[l];u=h.getAttribute("xmlns");if(u&&u.match(Strophe.NS.MUC)){r=t._presence_handlers;break}}}}for(s in r){o=r[s];if(!o(i,t)){delete r[s]}}return true}}(this))}if(!this.rooms.hasOwnProperty(t)){this.rooms[t]=new i(this,t,e,s);this.roomNames.push(t)}if(o){this.rooms[t].addHandler("presence",o)}if(n){this.rooms[t].addHandler("message",n)}if(r){this.rooms[t].addHandler("roster",r)}return this._connection.send(h)},leave:function(t,e,i,n){var o,r,s,c;o=this.roomNames.indexOf(t);delete this.rooms[t];if(o>=0){this.roomNames.splice(o,1);if(this.roomNames.length===0){this._connection.deleteHandler(this._muc_handler);this._muc_handler=null}}c=this.test_append_nick(t,e);s=this._connection.getUniqueId();r=$pres({type:"unavailable",id:s,from:this._connection.jid,to:c});if(n!=null){r.c("status",n)}if(i!=null){this._connection.addHandler(i,null,"presence",null,s)}this._connection.send(r);return s},message:function(t,e,i,n,o){var r,s,c,h;h=this.test_append_nick(t,e);o=o||(e!=null?"chat":"groupchat");s=this._connection.getUniqueId();r=$msg({to:h,from:this._connection.jid,type:o,id:s}).c("body",{xmlns:Strophe.NS.CLIENT}).t(i);r.up();if(n!=null){r.c("html",{xmlns:Strophe.NS.XHTML_IM}).c("body",{xmlns:Strophe.NS.XHTML}).h(n);if(r.node.childNodes.length===0){c=r.node.parentNode;r.up().up();r.node.removeChild(c)}else{r.up().up()}}r.c("x",{xmlns:"jabber:x:event"}).c("composing");this._connection.send(r);return s},groupchat:function(t,e,i){return this.message(t,null,e,i)},invite:function(t,e,i){var n,o;o=this._connection.getUniqueId();n=$msg({from:this._connection.jid,to:t,id:o}).c("x",{xmlns:Strophe.NS.MUC_USER}).c("invite",{to:e});if(i!=null){n.c("reason",i)}this._connection.send(n);return o},multipleInvites:function(t,e,i){var n,o,r,s,c;o=this._connection.getUniqueId();n=$msg({from:this._connection.jid,to:t,id:o}).c("x",{xmlns:Strophe.NS.MUC_USER});for(s=0,c=e.length;s<c;s++){r=e[s];n.c("invite",{to:r});if(i!=null){n.c("reason",i);n.up()}n.up()}this._connection.send(n);return o},directInvite:function(t,e,i,n){var o,r,s;s=this._connection.getUniqueId();o={xmlns:"jabber:x:conference",jid:t};if(i!=null){o.reason=i}if(n!=null){o.password=n}r=$msg({from:this._connection.jid,to:e,id:s}).c("x",o);this._connection.send(r);return s},queryOccupants:function(t,e,i){var n,o;n={xmlns:Strophe.NS.DISCO_ITEMS};o=$iq({from:this._connection.jid,to:t,type:"get"}).c("query",n);return this._connection.sendIQ(o,e,i)},configure:function(t,e,i){var n,o;n=$iq({to:t,type:"get"}).c("query",{xmlns:Strophe.NS.MUC_OWNER});o=n.tree();return this._connection.sendIQ(o,e,i)},cancelConfigure:function(t){var e,i;e=$iq({to:t,type:"set"}).c("query",{xmlns:Strophe.NS.MUC_OWNER}).c("x",{xmlns:"jabber:x:data",type:"cancel"});i=e.tree();return this._connection.sendIQ(i)},saveConfiguration:function(t,e,i,n){var o,r,s,c,h;r=$iq({to:t,type:"set"}).c("query",{xmlns:Strophe.NS.MUC_OWNER});if(typeof Form!=="undefined"&&e instanceof Form){e.type="submit";r.cnode(e.toXML())}else{r.c("x",{xmlns:"jabber:x:data",type:"submit"});for(c=0,h=e.length;c<h;c++){o=e[c];r.cnode(o).up()}}s=r.tree();return this._connection.sendIQ(s,i,n)},createInstantRoom:function(t,e,i){var n;n=$iq({to:t,type:"set"}).c("query",{xmlns:Strophe.NS.MUC_OWNER}).c("x",{xmlns:"jabber:x:data",type:"submit"});return this._connection.sendIQ(n.tree(),e,i)},createConfiguredRoom:function(t,e,i,o){var r,s,c;s=$iq({to:t,type:"set"}).c("query",{xmlns:Strophe.NS.MUC_OWNER}).c("x",{xmlns:"jabber:x:data",type:"submit"});s.c("field",{"var":"FORM_TYPE"}).c("value").t("http://jabber.org/protocol/muc#roomconfig").up().up();for(r in e){if(!n.call(e,r))continue;c=e[r];s.c("field",{"var":r}).c("value").t(c).up().up()}return this._connection.sendIQ(s.tree(),i,o)},setTopic:function(t,e){var i;i=$msg({to:t,from:this._connection.jid,type:"groupchat"}).c("subject",{xmlns:"jabber:client"}).t(e);return this._connection.send(i.tree())},_modifyPrivilege:function(t,e,i,n,o){var r;r=$iq({to:t,type:"set"}).c("query",{xmlns:Strophe.NS.MUC_ADMIN}).cnode(e.node);if(i!=null){r.c("reason",i)}return this._connection.sendIQ(r.tree(),n,o)},modifyRole:function(t,e,i,n,o,r){var s;s=$build("item",{nick:e,role:i});return this._modifyPrivilege(t,s,n,o,r)},kick:function(t,e,i,n,o){return this.modifyRole(t,e,"none",i,n,o)},voice:function(t,e,i,n,o){return this.modifyRole(t,e,"participant",i,n,o)},mute:function(t,e,i,n,o){return this.modifyRole(t,e,"visitor",i,n,o)},op:function(t,e,i,n,o){return this.modifyRole(t,e,"moderator",i,n,o)},deop:function(t,e,i,n,o){return this.modifyRole(t,e,"participant",i,n,o)},modifyAffiliation:function(t,e,i,n,o,r){var s;s=$build("item",{jid:e,affiliation:i});return this._modifyPrivilege(t,s,n,o,r)},ban:function(t,e,i,n,o){return this.modifyAffiliation(t,e,"outcast",i,n,o)},member:function(t,e,i,n,o){return this.modifyAffiliation(t,e,"member",i,n,o)},revoke:function(t,e,i,n,o){return this.modifyAffiliation(t,e,"none",i,n,o)},owner:function(t,e,i,n,o){return this.modifyAffiliation(t,e,"owner",i,n,o)},admin:function(t,e,i,n,o){return this.modifyAffiliation(t,e,"admin",i,n,o)},changeNick:function(t,e){var i,n;n=this.test_append_nick(t,e);i=$pres({from:this._connection.jid,to:n,id:this._connection.getUniqueId()});return this._connection.send(i.tree())},setStatus:function(t,e,i,n){var o,r;r=this.test_append_nick(t,e);o=$pres({from:this._connection.jid,to:r});if(i!=null){o.c("show",i).up()}if(n!=null){o.c("status",n)}return this._connection.send(o.tree())},registrationRequest:function(t,e,i){var n;n=$iq({to:t,from:this._connection.jid,type:"get"}).c("query",{xmlns:Strophe.NS.MUC_REGISTER});return this._connection.sendIQ(n,function(t){var i,n,o,r,s,c,h;n=t.getElementsByTagName("field");s=n.length;r={required:[],optional:[]};for(c=0,h=n.length;c<h;c++){i=n[c];o={"var":i.getAttribute("var"),label:i.getAttribute("label"),type:i.getAttribute("type")};if(i.getElementsByTagName("required").length>0){r.required.push(o)}else{r.optional.push(o)}}return e(r)},i)},submitRegistrationForm:function(t,e,i,n){var o,r,s;o=$iq({to:t,type:"set"}).c("query",{xmlns:Strophe.NS.MUC_REGISTER});o.c("x",{xmlns:"jabber:x:data",type:"submit"});o.c("field",{"var":"FORM_TYPE"}).c("value").t("http://jabber.org/protocol/muc#register").up().up();for(r in e){s=e[r];o.c("field",{"var":r}).c("value").t(s).up().up()}return this._connection.sendIQ(o,i,n)},listRooms:function(t,e,i){var n;n=$iq({to:t,from:this._connection.jid,type:"get"}).c("query",{xmlns:Strophe.NS.DISCO_ITEMS});return this._connection.sendIQ(n,e,i)},test_append_nick:function(t,e){var i,n;n=Strophe.escapeNode(Strophe.getNodeFromJid(t));i=Strophe.getDomainFromJid(t);return n+"@"+i+(e!=null?"/"+e:"")}});i=function(){function e(t,e,i,n){this.client=t;this.name=e;this.nick=i;this.password=n;this._roomRosterHandler=o(this._roomRosterHandler,this);this._addOccupant=o(this._addOccupant,this);this.roster={};this._message_handlers={};this._presence_handlers={};this._roster_handlers={};this._handler_ids=0;if(t.muc){this.client=t.muc}this.name=Strophe.getBareJidFromJid(e);this.addHandler("presence",this._roomRosterHandler)}e.prototype.join=function(t,e,i){return this.client.join(this.name,this.nick,t,e,i,this.password)};e.prototype.leave=function(t,e){this.client.leave(this.name,this.nick,t,e);return delete this.client.rooms[this.name]};e.prototype.message=function(t,e,i,n){return this.client.message(this.name,t,e,i,n)};e.prototype.groupchat=function(t,e){return this.client.groupchat(this.name,t,e)};e.prototype.invite=function(t,e){return this.client.invite(this.name,t,e)};e.prototype.multipleInvites=function(t,e){return this.client.invite(this.name,t,e)};e.prototype.directInvite=function(t,e){return this.client.directInvite(this.name,t,e,this.password)};e.prototype.configure=function(t){return this.client.configure(this.name,t)};e.prototype.cancelConfigure=function(){return this.client.cancelConfigure(this.name)};e.prototype.saveConfiguration=function(t){return this.client.saveConfiguration(this.name,t)};e.prototype.queryOccupants=function(t,e){return this.client.queryOccupants(this.name,t,e)};e.prototype.setTopic=function(t){return this.client.setTopic(this.name,t)};e.prototype.modifyRole=function(t,e,i,n,o){return this.client.modifyRole(this.name,t,e,i,n,o)};e.prototype.kick=function(t,e,i,n){return this.client.kick(this.name,t,e,i,n)};e.prototype.voice=function(t,e,i,n){return this.client.voice(this.name,t,e,i,n)};e.prototype.mute=function(t,e,i,n){return this.client.mute(this.name,t,e,i,n)};e.prototype.op=function(t,e,i,n){return this.client.op(this.name,t,e,i,n)};e.prototype.deop=function(t,e,i,n){return this.client.deop(this.name,t,e,i,n)};e.prototype.modifyAffiliation=function(t,e,i,n,o){return this.client.modifyAffiliation(this.name,t,e,i,n,o)};e.prototype.ban=function(t,e,i,n){return this.client.ban(this.name,t,e,i,n)};e.prototype.member=function(t,e,i,n){return this.client.member(this.name,t,e,i,n)};e.prototype.revoke=function(t,e,i,n){return this.client.revoke(this.name,t,e,i,n)};e.prototype.owner=function(t,e,i,n){return this.client.owner(this.name,t,e,i,n)};e.prototype.admin=function(t,e,i,n){return this.client.admin(this.name,t,e,i,n)};e.prototype.changeNick=function(t){this.nick=t;return this.client.changeNick(this.name,t)};e.prototype.setStatus=function(t,e){return this.client.setStatus(this.name,this.nick,t,e)};e.prototype.addHandler=function(t,e){var i;i=this._handler_ids++;switch(t){case"presence":this._presence_handlers[i]=e;break;case"message":this._message_handlers[i]=e;break;case"roster":this._roster_handlers[i]=e;break;default:this._handler_ids--;return null}return i};e.prototype.removeHandler=function(t){delete this._presence_handlers[t];delete this._message_handlers[t];return delete this._roster_handlers[t]};e.prototype._addOccupant=function(e){var i;i=new t(e,this);this.roster[i.nick]=i;return i};e.prototype._roomRosterHandler=function(t){var i,n,o,r,s,c;i=e._parsePresence(t);s=i.nick;r=i.newnick||null;switch(i.type){case"error":return true;case"unavailable":if(r){i.nick=r;if(this.roster[s]&&this.roster[r]){this.roster[s].update(this.roster[r]);this.roster[r]=this.roster[s]}if(this.roster[s]&&!this.roster[r]){this.roster[r]=this.roster[s].update(i)}}delete this.roster[s];break;default:if(this.roster[s]){this.roster[s].update(i)}else{this._addOccupant(i)}}c=this._roster_handlers;for(o in c){n=c[o];if(!n(this.roster,this)){delete this._roster_handlers[o]}}return true};e._parsePresence=function(t){var e,i,n,o,r,s,c,h,u;n={};n.nick=Strophe.getResourceFromJid(t.getAttribute("from"));n.type=t.getAttribute("type");n.states=[];h=t.childNodes;for(o=0,s=h.length;o<s;o++){e=h[o];switch(e.nodeName){case"status":n.status=e.textContent||null;break;case"show":n.show=e.textContent||null;break;case"x":if(e.getAttribute("xmlns")===Strophe.NS.MUC_USER){u=e.childNodes;for(r=0,c=u.length;r<c;r++){i=u[r];switch(i.nodeName){case"item":n.affiliation=i.getAttribute("affiliation");n.role=i.getAttribute("role");n.jid=i.getAttribute("jid");n.newnick=i.getAttribute("nick");break;case"status":if(i.getAttribute("code")){n.states.push(i.getAttribute("code"))}}}}}}return n};return e}();e=function(){function t(t){this.parse=o(this.parse,this);if(t!=null){this.parse(t)}}t.prototype.parse=function(t){var e,i,n,o,r,s,c,h,u,a,l,d,p;s=t.getElementsByTagName("query")[0].childNodes;this.identities=[];this.features=[];this.x=[];for(c=0,a=s.length;c<a;c++){n=s[c];i=n.attributes;switch(n.nodeName){case"identity":r={};for(h=0,l=i.length;h<l;h++){e=i[h];r[e.name]=e.textContent}this.identities.push(r);break;case"feature":this.features.push(n.getAttribute("var"));break;case"x":if(!n.childNodes[0].getAttribute("var")==="FORM_TYPE"||!n.childNodes[0].getAttribute("type")==="hidden"){break}p=n.childNodes;for(u=0,d=p.length;u<d;u++){o=p[u];if(!o.attributes.type){this.x.push({"var":o.getAttribute("var"),label:o.getAttribute("label")||"",value:o.firstChild.textContent||""})}}}}return{identities:this.identities,features:this.features,x:this.x}};return t}();t=function(){function t(t,e){this.room=e;this.update=o(this.update,this);this.admin=o(this.admin,this);this.owner=o(this.owner,this);this.revoke=o(this.revoke,this);this.member=o(this.member,this);this.ban=o(this.ban,this);this.modifyAffiliation=o(this.modifyAffiliation,this);this.deop=o(this.deop,this);this.op=o(this.op,this);this.mute=o(this.mute,this);this.voice=o(this.voice,this);this.kick=o(this.kick,this);this.modifyRole=o(this.modifyRole,this);this.update(t)}t.prototype.modifyRole=function(t,e,i,n){return this.room.modifyRole(this.nick,t,e,i,n)};t.prototype.kick=function(t,e,i){return this.room.kick(this.nick,t,e,i)};t.prototype.voice=function(t,e,i){return this.room.voice(this.nick,t,e,i)};t.prototype.mute=function(t,e,i){return this.room.mute(this.nick,t,e,i)};t.prototype.op=function(t,e,i){return this.room.op(this.nick,t,e,i)};t.prototype.deop=function(t,e,i){return this.room.deop(this.nick,t,e,i)};t.prototype.modifyAffiliation=function(t,e,i,n){return this.room.modifyAffiliation(this.jid,t,e,i,n)};t.prototype.ban=function(t,e,i){return this.room.ban(this.jid,t,e,i)};t.prototype.member=function(t,e,i){return this.room.member(this.jid,t,e,i)};t.prototype.revoke=function(t,e,i){return this.room.revoke(this.jid,t,e,i)};t.prototype.owner=function(t,e,i){return this.room.owner(this.jid,t,e,i)};t.prototype.admin=function(t,e,i){return this.room.admin(this.jid,t,e,i)};t.prototype.update=function(t){this.nick=t.nick||null;this.affiliation=t.affiliation||null;this.role=t.role||null;this.jid=t.jid||null;this.status=t.status||null;this.show=t.show||null;return this};return t}()}).call(this);(function(t,e){if(typeof define==="function"&&define.amd){define(["jquery"],e)}else{e(t.jQuery)}})(this,function(t){"use strict";var e=function(t,i){var n=this;n.id=e.count++;e.lifo.push(n);if(t){n.open(t,i)}return n};e.defaults={prefix:"jqi",classes:{box:"",fade:"",prompt:"",form:"",close:"",title:"",message:"",buttons:"",button:"",defaultButton:""},title:"",closeText:"&times;",buttons:{Ok:true},buttonTimeout:1e3,loaded:function(t){},submit:function(t,e,i,n){},close:function(t,e,i,n){},statechanging:function(t,e,i){},statechanged:function(t,e){},opacity:.6,zIndex:999,overlayspeed:"slow",promptspeed:"fast",show:"fadeIn",hide:"fadeOut",focus:0,defaultButton:0,useiframe:false,top:"15%",position:{container:null,x:null,y:null,arrow:null,width:null},persistent:true,timeout:0,states:{},initialState:0,state:{name:null,title:"",html:"",buttons:{Ok:true},focus:0,defaultButton:0,position:{container:null,x:null,y:null,arrow:null,width:null},submit:function(t,e,i,n){return true}}};e.setDefaults=function(i){e.defaults=t.extend({},e.defaults,i)};e.setStateDefaults=function(i){e.defaults.state=t.extend({},e.defaults.state,i)};e.count=0;e.lifo=[];e.getLast=function(){var t=e.lifo.length;return t>0?e.lifo[t-1]:false};e.removeFromStack=function(t){for(var i=e.lifo.length-1;i>=0;i--){if(e.lifo[i].id===t){return e.lifo.splice(i,1)[0]}}};e.prototype={id:null,open:function(i,n){var o=this;o.options=t.extend({},e.defaults,n);if(o.timeout){clearTimeout(o.timeout)}o.timeout=false;var s=o.options,a=t(document.body),r=t(window);var f='<div class="'+s.prefix+"box "+s.classes.box+'">';if(s.useiframe&&t("object, applet").length>0){f+='<iframe src="javascript:false;" class="'+s.prefix+"fade "+s.classes.fade+'"></iframe>'}else{f+='<div class="'+s.prefix+"fade "+s.classes.fade+'"></div>'}f+='<div class="'+s.prefix+" "+s.classes.prompt+'">'+'<form action="#" class="'+s.prefix+"form "+s.classes.form+'">'+'<div class="'+s.prefix+"close "+s.classes.close+'">'+s.closeText+"</div>"+'<div class="'+s.prefix+'states"></div>'+"</form>"+"</div>"+"</div>";o.jqib=t(f).appendTo(a);o.jqi=o.jqib.children("."+s.prefix);o.jqif=o.jqib.children("."+s.prefix+"fade");if(i.constructor===String){i={state0:{title:s.title,html:i,buttons:s.buttons,position:s.position,focus:s.focus,defaultButton:s.defaultButton,submit:s.submit}}}o.options.states={};var u,l;for(u in i){l=t.extend({},e.defaults.state,{name:u},i[u]);o.addState(l.name,l);if(o.currentStateName===""){o.currentStateName=l.name}}o.jqi.on("click","."+s.prefix+"buttons button",function(e){var i=t(this),n=i.parents("."+s.prefix+"state"),a=n.data("jqi-name"),r=o.options.states[a],f=n.children("."+s.prefix+"message"),u=r.buttons[i.text()]||r.buttons[i.html()],l={};if(o.options.buttonTimeout>0){o.disableStateButtons(a);setTimeout(function(){o.enableStateButtons(a)},o.options.buttonTimeout)}if(u===undefined){for(var p in r.buttons){if(r.buttons[p].title===i.text()||r.buttons[p].title===i.html()){u=r.buttons[p].value}}}t.each(o.jqi.children("form").serializeArray(),function(t,e){if(l[e.name]===undefined){l[e.name]=e.value}else if(typeof l[e.name]===Array||typeof l[e.name]==="object"){l[e.name].push(e.value)}else{l[e.name]=[l[e.name],e.value]}});var d=new t.Event("impromptu:submit");d.stateName=r.name;d.state=n;n.trigger(d,[u,f,l]);if(!d.isDefaultPrevented()){o.close(true,u,f,l)}});var p=function(){if(s.persistent){var e=s.top.toString().indexOf("%")>=0?r.height()*(parseInt(s.top,10)/100):parseInt(s.top,10),i=parseInt(o.jqi.css("top").replace("px",""),10)-e;t("html,body").animate({scrollTop:i},"fast",function(){var t=0;o.jqib.addClass(s.prefix+"warning");var e=setInterval(function(){o.jqib.toggleClass(s.prefix+"warning");if(t++>1){clearInterval(e);o.jqib.removeClass(s.prefix+"warning")}},100)})}else{o.close(true)}};var d=function(e){var i=window.event?event.keyCode:e.keyCode;if(i===27){p()}if(i===13){var n=o.getCurrentState().find("."+s.prefix+"defaultbutton");var a=t(e.target);if(a.is("textarea,."+s.prefix+"button")===false&&n.length>0){e.preventDefault();n.click()}}if(i===9){var r=t("input,select,textarea,button",o.getCurrentState());var f=!e.shiftKey&&e.target===r[r.length-1];var u=e.shiftKey&&e.target===r[0];if(f||u){setTimeout(function(){if(!r){return}var t=r[u===true?r.length-1:0];if(t){t.focus()}},10);return false}}};o.position();o.style();o._windowResize=function(t){o.position(t)};r.resize({animate:false},o._windowResize);o.jqif.click(p);o.jqi.find("."+s.prefix+"close").click(function(){o.close()});o.jqi.find("."+s.prefix+"form").submit(function(){return false});o.jqib.on("keydown",d).on("impromptu:loaded",s.loaded).on("impromptu:close",s.close).on("impromptu:statechanging",s.statechanging).on("impromptu:statechanged",s.statechanged);o.jqif[s.show](s.overlayspeed);o.jqi[s.show](s.promptspeed,function(){o.goToState(isNaN(s.initialState)?s.initialState:o.jqi.find("."+s.prefix+"states ."+s.prefix+"state").eq(s.initialState).data("jqi-name"));o.jqib.trigger("impromptu:loaded")});if(s.timeout>0){o.timeout=setTimeout(function(){o.close(true)},s.timeout)}return o},close:function(i,n,o,s){var a=this;e.removeFromStack(a.id);if(a.timeout){clearTimeout(a.timeout);a.timeout=false}if(a.jqib){a.jqib[a.options.hide]("fast",function(){a.jqib.trigger("impromptu:close",[n,o,s]);a.jqib.remove();t(window).off("resize",a._windowResize);if(typeof i==="function"){i()}})}a.currentStateName="";return a},addState:function(i,n,o){var s=this,a="",r=null,f="",u="",l=s.options,p=s.jqi.find("."+l.prefix+"states"),d=[],c,m,h,g,b,v=0;n=t.extend({},e.defaults.state,{name:i},n);if(n.position.arrow!==null){f='<div class="'+l.prefix+"arrow "+l.prefix+"arrow"+n.position.arrow+'"></div>'}if(n.title&&n.title!==""){u='<div class="lead '+l.prefix+"title "+l.classes.title+'">'+n.title+"</div>"}c=n.html;if(typeof n.html==="function"){c="Error: html function must return text"}a+='<div class="'+l.prefix+'state" data-jqi-name="'+i+'">'+f+u+'<div class="'+l.prefix+"message "+l.classes.message+'">'+c+"</div>"+'<div class="'+l.prefix+"buttons"+(t.isEmptyObject(n.buttons)?"hide ":" ")+l.classes.buttons+'">';if(t.isArray(n.buttons)){d=n.buttons}else if(t.isPlainObject(n.buttons)){for(h in n.buttons){if(n.buttons.hasOwnProperty(h)){d.push({title:h,value:n.buttons[h]})}}}for(v=0,b=d.length;v<b;v++){g=d[v],m=n.focus===v||isNaN(n.focus)&&n.defaultButton===v?l.prefix+"defaultbutton "+l.classes.defaultButton:"";a+='<button class="'+l.classes.button+" "+l.prefix+"button "+m;if(typeof g.classes!=="undefined"){a+=" "+(t.isArray(g.classes)?g.classes.join(" "):g.classes)+" "}a+='" name="'+l.prefix+"_"+i+"_button"+g.title.replace(/[^a-z0-9]+/gi,"")+'" value="'+g.value+'">'+g.title+"</button>"}a+="</div></div>";r=t(a).css({display:"none"});r.on("impromptu:submit",n.submit);if(o!==undefined){s.getState(o).after(r)}else{p.append(r)}s.options.states[i]=n;return r},removeState:function(t,e){var i=this,n=i.getState(t),o=function(){n.remove()};if(n.length===0){return false}if(n.css("display")!=="none"){if(e!==undefined&&i.getState(e).length>0){i.goToState(e,false,o)}else if(n.next().length>0){i.nextState(o)}else if(n.prev().length>0){i.prevState(o)}else{i.close()}}else{n.slideUp("slow",o)}return true},getApi:function(){return this},getBox:function(){return this.jqib},getPrompt:function(){return this.jqi},getState:function(t){return this.jqi.find('[data-jqi-name="'+t+'"]')},getCurrentState:function(){return this.getState(this.getCurrentStateName())},getCurrentStateName:function(){return this.currentStateName},disableStateButtons:function(e,i,n){var o=this;if(t.isArray(e)){i=e;e=null}o.getState(e||o.getCurrentStateName()).find("."+o.options.prefix+"button").each(function(e,o){if(i===undefined||t.inArray(o.value,i)!==-1){o.disabled=!n}})},enableStateButtons:function(t,e){this.disableStateButtons(t,e,true)},position:function(e){var i=this,n=t.fx.off,o=i.getCurrentState(),s=i.options.states[o.data("jqi-name")],a=s?s.position:undefined,r=t(window),f=document.body.scrollHeight,u=t(window).height(),l=t(document).height(),p=f>u?f:u,d=parseInt(r.scrollTop(),10),c=d+(i.options.top.toString().indexOf("%")>=0?u*(parseInt(i.options.top,10)/100):parseInt(i.options.top,10));if(e!==undefined&&e.data.animate===false){t.fx.off=true}i.jqib.css({position:"absolute",height:p,width:"100%",top:0,left:0,right:0,bottom:0});i.jqif.css({position:"fixed",height:p,width:"100%",top:0,left:0,right:0,bottom:0});if(a&&a.container){var m=t(a.container).offset(),h=false;if(t.isPlainObject(m)&&m.top!==undefined){c=m.top+a.y-(i.options.top.toString().indexOf("%")>=0?u*(parseInt(i.options.top,10)/100):parseInt(i.options.top,10));i.jqi.css({position:"absolute"});i.jqi.animate({top:m.top+a.y,left:m.left+a.x,marginLeft:0,width:a.width!==undefined?a.width:null},function(){if(!h&&m.top+a.y+i.jqi.outerHeight(true)>d+u){t("html,body").animate({scrollTop:c},"slow","swing",function(){});h=true}});if(c<d||c>d+u){t("html,body").animate({scrollTop:c},"slow","swing",function(){});h=true}}}else if(a&&a.width){i.jqi.css({position:"absolute",left:"50%"});i.jqi.animate({top:a.y||c,left:a.x||"50%",marginLeft:a.width/2*-1,width:a.width})}else{i.jqi.css({position:"absolute",top:c,left:"50%",marginLeft:i.jqi.outerWidth(false)/2*-1})}if(e!==undefined&&e.data.animate===false){t.fx.off=n}},style:function(){var t=this;t.jqif.css({zIndex:t.options.zIndex,display:"none",opacity:t.options.opacity});t.jqi.css({zIndex:t.options.zIndex+1,display:"none"});t.jqib.css({zIndex:t.options.zIndex})},goToState:function(e,i,n){var o=this,s=o.jqi,a=o.options,r=o.getState(e),f=a.states[r.data("jqi-name")],u=new t.Event("impromptu:statechanging"),l=o.options;if(f!==undefined){if(typeof f.html==="function"){var p=f.html;r.find("."+l.prefix+"message ").html(p())}if(typeof i==="function"){n=i;i=false}o.jqib.trigger(u,[o.getCurrentStateName(),e]);if(!u.isDefaultPrevented()&&r.length>0){o.jqi.find("."+l.prefix+"parentstate").removeClass(l.prefix+"parentstate");if(i){o.jqi.find("."+l.prefix+"substate").not(r).slideUp(a.promptspeed).removeClass("."+l.prefix+"substate").find("."+l.prefix+"arrow").hide();o.jqi.find("."+l.prefix+"state:visible").addClass(l.prefix+"parentstate");r.addClass(l.prefix+"substate")}else{o.jqi.find("."+l.prefix+"state").not(r).slideUp(a.promptspeed).find("."+l.prefix+"arrow").hide()}o.currentStateName=f.name;r.slideDown(a.promptspeed,function(){var i=t(this);o.enableStateButtons();if(typeof f.focus==="string"){i.find(f.focus).eq(0).focus()}else{i.find("."+l.prefix+"defaultbutton").focus()}i.find("."+l.prefix+"arrow").show(a.promptspeed);if(typeof n==="function"){o.jqib.on("impromptu:statechanged",n)}o.jqib.trigger("impromptu:statechanged",[e]);if(typeof n==="function"){o.jqib.off("impromptu:statechanged",n)}});if(!i){o.position()}}}return r},nextState:function(t){var e=this,i=e.getCurrentState().next();if(i.length>0){e.goToState(i.data("jqi-name"),t)}return i},prevState:function(t){var e=this,i=e.getCurrentState().prev();if(i.length>0){e.goToState(i.data("jqi-name"),t)}return i}};t.prompt=function(t,i){var n=new e(t,i);return n.jqi};t.each(e,function(e,i){t.prompt[e]=i});t.each(e.prototype,function(i,n){t.prompt[i]=function(){var t=e.getLast();if(t&&typeof t[i]==="function"){return t[i].apply(t,arguments)}}});t.fn.prompt=function(e){if(e===undefined){e={}}if(e.withDataAndEvents===undefined){e.withDataAndEvents=false}t.prompt(t(this).clone(e.withDataAndEvents).html(),e)};window.Impromptu=e});!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}(function(e){function t(t){var s=t||window.event,a=h.call(arguments,1),r=0,f=0,d=0,c=0,m=0,g=0;if(t=e.event.fix(s),t.type="mousewheel","detail"in s&&(d=-1*s.detail),"wheelDelta"in s&&(d=s.wheelDelta),"wheelDeltaY"in s&&(d=s.wheelDeltaY),"wheelDeltaX"in s&&(f=-1*s.wheelDeltaX),"axis"in s&&s.axis===s.HORIZONTAL_AXIS&&(f=-1*d,d=0),r=0===d?f:d,"deltaY"in s&&(d=-1*s.deltaY,r=d),"deltaX"in s&&(f=s.deltaX,0===d&&(r=-1*f)),0!==d||0!==f){if(1===s.deltaMode){var w=e.data(this,"mousewheel-line-height");r*=w,d*=w,f*=w}else if(2===s.deltaMode){var v=e.data(this,"mousewheel-page-height");r*=v,d*=v,f*=v}if(c=Math.max(Math.abs(d),Math.abs(f)),(!l||l>c)&&(l=c,i(s,c)&&(l/=40)),i(s,c)&&(r/=40,f/=40,d/=40),r=Math[r>=1?"floor":"ceil"](r/l),f=Math[f>=1?"floor":"ceil"](f/l),d=Math[d>=1?"floor":"ceil"](d/l),u.settings.normalizeOffset&&this.getBoundingClientRect){var p=this.getBoundingClientRect();m=t.clientX-p.left,g=t.clientY-p.top}return t.deltaX=f,t.deltaY=d,t.deltaFactor=l,t.offsetX=m,t.offsetY=g,t.deltaMode=0,a.unshift(t,r,f,d),o&&clearTimeout(o),o=setTimeout(n,200),(e.event.dispatch||e.event.handle).apply(this,a)}}function n(){l=null}function i(e,t){return u.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120===0}var o,l,s=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],a="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],h=Array.prototype.slice;if(e.event.fixHooks)for(var r=s.length;r;)e.event.fixHooks[s[--r]]=e.event.mouseHooks;var u=e.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var n=a.length;n;)this.addEventListener(a[--n],t,!1);else this.onmousewheel=t;e.data(this,"mousewheel-line-height",u.getLineHeight(this)),e.data(this,"mousewheel-page-height",u.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var n=a.length;n;)this.removeEventListener(a[--n],t,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var n=e(t),i=n["offsetParent"in e.fn?"offsetParent":"parent"]();return i.length||(i=e("body")),parseInt(i.css("fontSize"),10)||parseInt(n.css("fontSize"),10)||16},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})});(function(t){if(typeof define==="function"&&define.amd){define(["jquery"],t)}else{t(jQuery)}})(function(t){"use strict";var i={},s=Math.max,h=Math.min;i.c={};i.c.d=t(document);i.c.t=function(t){return t.originalEvent.touches.length-1};i.o=function(){var s=this;this.o=null;this.$=null;this.i=null;this.g=null;this.v=null;this.cv=null;this.x=0;this.y=0;this.w=0;this.h=0;this.$c=null;this.c=null;this.t=0;this.isInit=false;this.fgColor=null;this.pColor=null;this.dH=null;this.cH=null;this.eH=null;this.rH=null;this.scale=1;this.relative=false;this.relativeWidth=false;this.relativeHeight=false;this.$div=null;this.run=function(){var i=function(t,i){var h;for(h in i){s.o[h]=i[h]}s._carve().init();s._configure()._draw()};if(this.$.data("kontroled"))return;this.$.data("kontroled",true);this.extend();this.o=t.extend({min:this.$.data("min")!==undefined?this.$.data("min"):0,max:this.$.data("max")!==undefined?this.$.data("max"):100,stopper:true,readOnly:this.$.data("readonly")||this.$.attr("readonly")==="readonly",cursor:this.$.data("cursor")===true&&30||this.$.data("cursor")||0,thickness:this.$.data("thickness")&&Math.max(Math.min(this.$.data("thickness"),1),.01)||.35,lineCap:this.$.data("linecap")||"butt",width:this.$.data("width")||200,height:this.$.data("height")||200,displayInput:this.$.data("displayinput")==null||this.$.data("displayinput"),displayPrevious:this.$.data("displayprevious"),fgColor:this.$.data("fgcolor")||"#87CEEB",inputColor:this.$.data("inputcolor"),font:this.$.data("font")||"Arial",fontWeight:this.$.data("font-weight")||"bold",inline:false,step:this.$.data("step")||1,rotation:this.$.data("rotation"),draw:null,change:null,cancel:null,release:null,format:function(t){return t},parse:function(t){return parseFloat(t)}},this.o);this.o.flip=this.o.rotation==="anticlockwise"||this.o.rotation==="acw";if(!this.o.inputColor){this.o.inputColor=this.o.fgColor}if(this.$.is("fieldset")){this.v={};this.i=this.$.find("input");this.i.each(function(i){var h=t(this);s.i[i]=h;s.v[i]=s.o.parse(h.val());h.bind("change blur",function(){var t={};t[i]=h.val();s.val(t)})});this.$.find("legend").remove()}else{this.i=this.$;this.v=this.o.parse(this.$.val());this.v===""&&(this.v=this.o.min);this.$.bind("change blur",function(){s.val(s._validate(s.o.parse(s.$.val())))})}!this.o.displayInput&&this.$.hide();this.$c=t(document.createElement("canvas")).attr({width:this.o.width,height:this.o.height});this.$div=t('<div style="'+(this.o.inline?"display:inline;":"")+"width:"+this.o.width+"px;height:"+this.o.height+"px;"+'"></div>');this.$.wrap(this.$div).before(this.$c);this.$div=this.$.parent();if(typeof G_vmlCanvasManager!=="undefined"){G_vmlCanvasManager.initElement(this.$c[0])}this.c=this.$c[0].getContext?this.$c[0].getContext("2d"):null;if(!this.c){throw{name:"CanvasNotSupportedException",message:"Canvas not supported. Please use excanvas on IE8.0.",toString:function(){return this.name+": "+this.message}}}this.scale=(window.devicePixelRatio||1)/(this.c.webkitBackingStorePixelRatio||this.c.mozBackingStorePixelRatio||this.c.msBackingStorePixelRatio||this.c.oBackingStorePixelRatio||this.c.backingStorePixelRatio||1);this.relativeWidth=this.o.width%1!==0&&this.o.width.indexOf("%");this.relativeHeight=this.o.height%1!==0&&this.o.height.indexOf("%");this.relative=this.relativeWidth||this.relativeHeight;this._carve();if(this.v instanceof Object){this.cv={};this.copy(this.v,this.cv)}else{this.cv=this.v}this.$.bind("configure",i).parent().bind("configure",i);this._listen()._configure()._xy().init();this.isInit=true;this.$.val(this.o.format(this.v));this._draw();return this};this._carve=function(){if(this.relative){var t=this.relativeWidth?this.$div.parent().width()*parseInt(this.o.width)/100:this.$div.parent().width(),i=this.relativeHeight?this.$div.parent().height()*parseInt(this.o.height)/100:this.$div.parent().height();this.w=this.h=Math.min(t,i)}else{this.w=this.o.width;this.h=this.o.height}this.$div.css({width:this.w+"px",height:this.h+"px"});this.$c.attr({width:this.w,height:this.h});if(this.scale!==1){this.$c[0].width=this.$c[0].width*this.scale;this.$c[0].height=this.$c[0].height*this.scale;this.$c.width(this.w);this.$c.height(this.h)}return this};this._draw=function(){var t=true;s.g=s.c;s.clear();s.dH&&(t=s.dH());t!==false&&s.draw()};this._touch=function(t){var h=function(t){var i=s.xy2val(t.originalEvent.touches[s.t].pageX,t.originalEvent.touches[s.t].pageY);if(i==s.cv)return;if(s.cH&&s.cH(i)===false)return;s.change(s._validate(i));s._draw()};this.t=i.c.t(t);h(t);i.c.d.bind("touchmove.k",h).bind("touchend.k",function(){i.c.d.unbind("touchmove.k touchend.k");s.val(s.cv)});return this};this._mouse=function(t){var h=function(t){var i=s.xy2val(t.pageX,t.pageY);if(i==s.cv)return;if(s.cH&&s.cH(i)===false)return;s.change(s._validate(i));s._draw()};h(t);i.c.d.bind("mousemove.k",h).bind("keyup.k",function(t){if(t.keyCode===27){i.c.d.unbind("mouseup.k mousemove.k keyup.k");if(s.eH&&s.eH()===false)return;s.cancel()}}).bind("mouseup.k",function(t){i.c.d.unbind("mousemove.k mouseup.k keyup.k");s.val(s.cv)});return this};this._xy=function(){var t=this.$c.offset();this.x=t.left;this.y=t.top;return this};this._listen=function(){if(!this.o.readOnly){this.$c.bind("mousedown",function(t){t.preventDefault();s._xy()._mouse(t)}).bind("touchstart",function(t){t.preventDefault();s._xy()._touch(t)});this.listen()}else{this.$.attr("readonly","readonly")}if(this.relative){t(window).resize(function(){s._carve().init();s._draw()})}return this};this._configure=function(){if(this.o.draw)this.dH=this.o.draw;if(this.o.change)this.cH=this.o.change;if(this.o.cancel)this.eH=this.o.cancel;if(this.o.release)this.rH=this.o.release;if(this.o.displayPrevious){this.pColor=this.h2rgba(this.o.fgColor,"0.4");this.fgColor=this.h2rgba(this.o.fgColor,"0.6")}else{this.fgColor=this.o.fgColor}return this};this._clear=function(){this.$c[0].width=this.$c[0].width};this._validate=function(t){return~~((t<0?-.5:.5)+t/this.o.step)*this.o.step};this.listen=function(){};this.extend=function(){};this.init=function(){};this.change=function(t){};this.val=function(t){};this.xy2val=function(t,i){};this.draw=function(){};this.clear=function(){this._clear()};this.h2rgba=function(t,i){var s;t=t.substring(1,7);s=[parseInt(t.substring(0,2),16),parseInt(t.substring(2,4),16),parseInt(t.substring(4,6),16)];return"rgba("+s[0]+","+s[1]+","+s[2]+","+i+")"};this.copy=function(t,i){for(var s in t){i[s]=t[s]}}};i.Dial=function(){i.o.call(this);this.startAngle=null;this.xy=null;this.radius=null;this.lineWidth=null;this.cursorExt=null;this.w2=null;this.PI2=2*Math.PI;this.extend=function(){this.o=t.extend({bgColor:this.$.data("bgcolor")||"#EEEEEE",angleOffset:this.$.data("angleoffset")||0,angleArc:this.$.data("anglearc")||360,inline:true},this.o)};this.val=function(t,i){if(null!=t){t=this.o.parse(t);if(i!==false&&t!=this.v&&this.rH&&this.rH(t)===false)return;this.cv=this.o.stopper?s(h(t,this.o.max),this.o.min):t;this.v=this.cv;this.$.val(this.o.format(this.v));this._draw()}else{return this.v}};this.xy2val=function(t,i){var e,n;e=Math.atan2(t-(this.x+this.w2),-(i-this.y-this.w2))-this.angleOffset;if(this.o.flip){e=this.angleArc-e-this.PI2}if(this.angleArc!=this.PI2&&e<0&&e>-.5){e=0}else if(e<0){e+=this.PI2}n=~~(.5+e*(this.o.max-this.o.min)/this.angleArc)+this.o.min;this.o.stopper&&(n=s(h(n,this.o.max),this.o.min));return n};this.listen=function(){var i=this,e,n,a=function(t){t.preventDefault();var a=t.originalEvent,o=a.detail||a.wheelDeltaX,r=a.detail||a.wheelDeltaY,l=i._validate(i.o.parse(i.$.val()))+(o>0||r>0?i.o.step:o<0||r<0?-i.o.step:0);l=s(h(l,i.o.max),i.o.min);i.val(l,false);if(i.rH){clearTimeout(e);e=setTimeout(function(){i.rH(l);e=null},100);if(!n){n=setTimeout(function(){if(e)i.rH(l);n=null},200)}}},o,r,l=1,c={37:-i.o.step,38:i.o.step,39:i.o.step,40:-i.o.step};this.$.bind("keydown",function(e){var n=e.keyCode;if(n>=96&&n<=105){n=e.keyCode=n-48}o=parseInt(String.fromCharCode(n));if(isNaN(o)){n!==13&&n!==8&&n!==9&&n!==189&&(n!==190||i.$.val().match(/\./))&&e.preventDefault();if(t.inArray(n,[37,38,39,40])>-1){e.preventDefault();var a=i.o.parse(i.$.val())+c[n]*l;i.o.stopper&&(a=s(h(a,i.o.max),i.o.min));i.change(a);i._draw();r=window.setTimeout(function(){l*=2},30)}}}).bind("keyup",function(t){if(isNaN(o)){if(r){window.clearTimeout(r);r=null;l=1;i.val(i.$.val())}}else{i.$.val()>i.o.max&&i.$.val(i.o.max)||i.$.val()<i.o.min&&i.$.val(i.o.min)}});this.$c.bind("mousewheel DOMMouseScroll",a);this.$.bind("mousewheel DOMMouseScroll",a)};this.init=function(){if(this.v<this.o.min||this.v>this.o.max)this.v=this.o.min;this.$.val(this.v);this.w2=this.w/2;this.cursorExt=this.o.cursor/100;this.xy=this.w2*this.scale;this.lineWidth=this.xy*this.o.thickness;this.lineCap=this.o.lineCap;this.radius=this.xy-this.lineWidth/2;this.o.angleOffset&&(this.o.angleOffset=isNaN(this.o.angleOffset)?0:this.o.angleOffset);this.o.angleArc&&(this.o.angleArc=isNaN(this.o.angleArc)?this.PI2:this.o.angleArc);this.angleOffset=this.o.angleOffset*Math.PI/180;this.angleArc=this.o.angleArc*Math.PI/180;this.startAngle=1.5*Math.PI+this.angleOffset;this.endAngle=1.5*Math.PI+this.angleOffset+this.angleArc;var t=s(String(Math.abs(this.o.max)).length,String(Math.abs(this.o.min)).length,2)+2;this.o.displayInput&&this.i.css({width:(this.w/2+4>>0)+"px",height:(this.w/3>>0)+"px",position:"absolute","vertical-align":"middle","margin-top":(this.w/3>>0)+"px","margin-left":"-"+(this.w*3/4+2>>0)+"px",border:0,background:"none",font:this.o.fontWeight+" "+(this.w/t>>0)+"px "+this.o.font,"text-align":"center",color:this.o.inputColor||this.o.fgColor,padding:"0px","-webkit-appearance":"none"})||this.i.css({width:"0px",visibility:"hidden"})};this.change=function(t){this.cv=t;this.$.val(this.o.format(t))};this.angle=function(t){return(t-this.o.min)*this.angleArc/(this.o.max-this.o.min)};this.arc=function(t){var i,s;t=this.angle(t);if(this.o.flip){i=this.endAngle+1e-5;s=i-t-1e-5}else{i=this.startAngle-1e-5;s=i+t+1e-5}this.o.cursor&&(i=s-this.cursorExt)&&(s=s+this.cursorExt);return{s:i,e:s,d:this.o.flip&&!this.o.cursor}};this.draw=function(){var t=this.g,i=this.arc(this.cv),s,h=1;t.lineWidth=this.lineWidth;t.lineCap=this.lineCap;t.beginPath();t.strokeStyle=this.o.bgColor;t.arc(this.xy,this.xy,this.radius,this.endAngle-1e-5,this.startAngle+1e-5,true);t.stroke();if(this.o.displayPrevious){s=this.arc(this.v);t.beginPath();t.strokeStyle=this.pColor;t.arc(this.xy,this.xy,this.radius,s.s,s.e,s.d);t.stroke();h=this.cv==this.v}t.beginPath();t.strokeStyle=h?this.o.fgColor:this.fgColor;t.arc(this.xy,this.xy,this.radius,i.s,i.e,i.d);t.stroke()};this.cancel=function(){this.val(this.v)}};t.fn.dial=t.fn.knob=function(s){return this.each(function(){var h=new i.Dial;h.o=s;h.$=t(this);h.run()}).parent()}});!function(t){"use strict";var e=function(t){var e,s,n;return e=function(){s=!1},function(){var e=i(arguments);if(s)return n=e,void 0;s=!0;var o=this;e.unshift(function a(){if(n){var e=n;n=void 0,e.unshift(a),t.apply(o,e)}else s=!1}),t.apply(this,e)}},i=function(t){var e;return e=Array.prototype.slice.call(t)},s=function(){var e;return e=t("<div></div>").css(["color"]).color,"undefined"!=typeof e?function(t,e){return t.css(e)}:function(e,i){var s;return s={},t.each(i,function(t,i){s[i]=e.css(i)}),s}}(),n=function(t){return t},o=function(t){var e={};return function(i,s){e[i]?s(e[i]):t.call(this,i,function(t){e[i]=(e[i]||[]).concat(t),s.apply(null,arguments)})}},a=function(t,e){var i,s;if(t.indexOf)return-1!=t.indexOf(e);for(i=0,s=t.length;s>i;i++)if(t[i]===e)return!0;return!1},r=function(){function i(e,i){var s;this.el=e.get(0),s=this.el===document.activeElement,this.$el=e,this.id="textComplete"+r++,this.strategies=[],this.option=i,s?(this.initialize(),this.$el.focus()):this.$el.one("focus.textComplete",t.proxy(this.initialize,this))}var n,o,a,r;return n={list:'<ul class="dropdown-menu"></ul>'},o={list:{position:"absolute",left:0,zIndex:"100",display:"none"}},a=t(n.list).css(o.list),r=0,t.extend(i.prototype,{initialize:function(){var e,i,s,n;e=a.clone(),this.listView=new l(e,this),this.$el.on({"keyup.textComplete":t.proxy(this.onKeyup,this),"keydown.textComplete":t.proxy(this.listView.onKeydown,this.listView)}),s=this.option.appendTo,s?this.listView.appendTo(s instanceof t?s:t(s)):this.listView.appendTo(t("body")),n=this.option.height,n&&(e.css("overflow-y","auto"),e.height(n)),i={},i["click."+this.id]=t.proxy(this.onClickDocument,this),i["keyup."+this.id]=t.proxy(this.onKeyupDocument,this),t(document).on(i)},register:function(t){this.strategies=this.strategies.concat(t)},renderList:function(t){this.clearAtNext&&(this.listView.clear(),this.clearAtNext=!1),t.length&&(this.listView.strategy=this.strategy,this.listView.shown||this.listView.setPosition(this.getCaretPosition()).clear().activate(),t=t.slice(0,this.strategy.maxCount),this.listView.render(t)),!this.listView.data.length&&this.listView.shown&&this.listView.deactivate()},searchCallbackFactory:function(t){var e=this;return function(i,s){e.renderList(i),s||(t(),e.clearAtNext=!0)}},onKeyup:function(t){this.skipSearch(t)||this.trigger(null,!0)},trigger:function(t,e){var i,s;if(t||(t=this.getTextFromHeadToCaret()),i=this.extractSearchQuery(t),i.length){if(s=i[1],e&&this.term===s)return;this.term=s,this.search(i)}else this.term=null,this.listView.deactivate()},skipSearch:function(t){switch(t.keyCode){case 40:case 38:return!0}if(t.ctrlKey)switch(t.keyCode){case 78:case 80:return!0}},onSelect:function(e){var i,s,n,o,a,r,l;if(i=this.getTextFromHeadToCaret(),l=i.length,this.el.isContentEditable){o=window.getSelection(),a=o.getRangeAt(0),r=a.cloneRange(),r.selectNodeContents(a.startContainer);var h=r.toString();s=h.substring(a.startOffset)}else s=this.el.value.substring(this.el.selectionEnd);if(n=this.strategy.replace(e),t.isArray(n)&&(s=n[1]+s,n=n[0]),i=i.replace(this.strategy.match,n),this.el.isContentEditable){a.selectNodeContents(a.startContainer),a.deleteContents();var c=document.createTextNode(i+s);a.insertNode(c),a.setStart(c,i.length),a.collapse(!0),o.removeAllRanges(),o.addRange(a)}else this.$el.val(i+s),this.el.selectionStart=this.el.selectionEnd=i.length;this.$el.trigger("change").trigger("textComplete:select",e),this.el.focus()},onClickDocument:function(t){t.originalEvent&&!t.originalEvent.keepTextCompleteDropdown&&this.listView.deactivate()},onKeyupDocument:function(t){this.listView.shown&&27===t.keyCode&&(this.listView.deactivate(),this.$el.focus())},destroy:function(){this.$el.off(".textComplete"),t(document).off("."+this.id),this.listView&&this.listView.destroy(),this.$el.removeData("textComplete"),this.$el=null},getCaretPosition:function(){var t,e;return t=this.getCaretRelativePosition(),e=this.$el.offset(),t.top+=e.top,t.left+=e.left,t},getCaretRelativePosition:function(){var e,i,n,o,a,r,l,h,c,d;return this.el.isContentEditable?(h=window.getSelection().getRangeAt(0).cloneRange(),c=document.createElement("span"),h.insertNode(c),h.selectNodeContents(c),h.deleteContents(),d=t(c),a=d.offset(),a.left-=this.$el.offset().left,a.top+=d.height()-this.$el.offset().top):(e=["border-width","font-family","font-size","font-style","font-variant","font-weight","height","letter-spacing","word-spacing","line-height","text-decoration","text-align","width","padding-top","padding-right","padding-bottom","padding-left","margin-top","margin-right","margin-bottom","margin-left","border-style","box-sizing"],l=this.$el[0].scrollHeight>this.$el[0].offsetHeight,i=t.extend({position:"absolute",overflow:l?"scroll":"auto","white-space":"pre-wrap",top:0,left:-9999,direction:r},s(this.$el,e)),n=t("<div></div>").css(i).text(this.getTextFromHeadToCaret()),o=t("<span></span>").text(".").appendTo(n),this.$el.before(n),a=o.position(),a.top+=o.height()-this.$el.scrollTop(),n.remove()),r=this.$el.attr("dir")||this.$el.css("direction"),"rtl"===r&&(a.left-=this.listView.$el.width()),a},getTextFromHeadToCaret:function(){var t,e,i;if(this.el.isContentEditable){if(window.getSelection){var i=window.getSelection().getRangeAt(0),s=i.cloneRange();s.selectNodeContents(i.startContainer),t=s.toString().substring(0,i.startOffset)}}else e=this.el.selectionEnd,"number"==typeof e?t=this.el.value.substring(0,e):document.selection&&(i=this.el.createTextRange(),i.moveStart("character",0),i.moveEnd("textedit"),t=i.text);return t},extractSearchQuery:function(t){var e,i,s,n;for(e=0,i=this.strategies.length;i>e;e++)if(s=this.strategies[e],n=t.match(s.match))return[s,n[s.index]];return[]},search:e(function(t,e){var i;this.strategy=e[0],i=e[1],this.strategy.search(i,this.searchCallbackFactory(t))})}),i}(),l=function(){function e(e,i){this.data=[],this.$el=e,this.index=0,this.completer=i,i.option.listPosition&&(this.setPosition=i.option.listPosition),this.$el.on("mousedown.textComplete","li.textcomplete-item",t.proxy(this.onClick,this)),this.$el.on("mouseover.textComplete","li.textcomplete-item",t.proxy(this.onMouseover,this))}return t.extend(e.prototype,{shown:!1,render:function(e){var i,s,n,o,r,l;for(i="",this.strategy.header&&(l=t.isFunction(this.strategy.header)?this.strategy.header(e):this.strategy.header,i+='<li class="textcomplete-header">'+l+"</li>"),s=0,n=e.length;n>s&&(r=e[s],a(this.data,r)||(o=this.data.length,this.data.push(r),i+='<li class="textcomplete-item" data-index="'+o+'"><a>',i+=this.strategy.template(r),i+="</a></li>",this.data.length!==this.strategy.maxCount));s++);this.strategy.footer&&(l=t.isFunction(this.strategy.footer)?this.strategy.footer(e):this.strategy.footer,i+='<li class="textcomplete-footer">'+l+"</li>"),this.$el.append(i),this.data.length?(this.activateIndexedItem(),this.setScroll()):this.deactivate()},clear:function(){return this.data=[],this.$el.html(""),this.index=0,this},activateIndexedItem:function(){this.$el.find(".active").removeClass("active"),this.getActiveItem().addClass("active")},getActiveItem:function(){return t(this.$el.children(".textcomplete-item").get(this.index))},activate:function(){return this.shown||(this.$el.show(),this.completer.$el.trigger("textComplete:show"),this.shown=!0),this},deactivate:function(){return this.shown&&(this.$el.hide(),this.completer.$el.trigger("textComplete:hide"),this.shown=!1,this.data=[],this.index=null),this},setPosition:function(t){var e;return this.strategy.placement.indexOf("top")>-1?(e=parseInt(this.$el.css("font-size")),t={top:"auto",bottom:this.$el.parent().height()-t.top+e,left:t.left}):t.bottom="auto",this.strategy.placement.indexOf("absleft")>-1&&(t.left=0),this.strategy.placement.indexOf("absright")>-1&&(t.right=0,t.left="auto"),this.$el.css(t),this},setScroll:function(){var t=this.getActiveItem(),e=t.position().top,i=t.outerHeight(),s=this.$el.innerHeight(),n=this.$el.scrollTop();0===this.index||this.index===this.data.length-1||0>e?this.$el.scrollTop(e+n):e+i>s&&this.$el.scrollTop(e+i+n-s)},select:function(t){var e=this;this.completer.onSelect(this.data[t]),setTimeout(function(){e.deactivate()},0)},onKeydown:function(e){if(this.shown){var i=e.ctrlKey||e.altKey||e.metaKey||e.shiftKey;if(38===e.keyCode||e.ctrlKey&&80===e.keyCode)e.preventDefault(),0===this.index?this.index=this.data.length-1:this.index-=1,this.activateIndexedItem(),this.setScroll();else if(40===e.keyCode||e.ctrlKey&&78===e.keyCode)e.preventDefault(),this.index===this.data.length-1?this.index=0:this.index+=1,this.activateIndexedItem(),this.setScroll();else if(i||13!==e.keyCode&&9!==e.keyCode){if(33===e.keyCode){e.preventDefault();var s=0,n=this.getActiveItem().position().top-this.$el.innerHeight();this.$el.children().each(function(e){return t(this).position().top+t(this).outerHeight()>n?(s=e,!1):void 0}),this.index=s,this.activateIndexedItem(),this.setScroll()}else if(34===e.keyCode){e.preventDefault();var s=this.data.length-1,n=this.getActiveItem().position().top+this.$el.innerHeight();this.$el.children().each(function(e){return t(this).position().top>n?(s=e,!1):void 0}),this.index=s,this.activateIndexedItem(),this.setScroll()}}else e.preventDefault(),this.select(parseInt(this.getActiveItem().data("index"),10))}},onClick:function(e){var i=t(e.target);e.preventDefault(),e.originalEvent.keepTextCompleteDropdown=!0,i.hasClass("textcomplete-item")||(i=i.parents("li.textcomplete-item")),this.select(parseInt(i.data("index"),10))},onMouseover:function(e){var i=t(e.target);e.preventDefault(),i.hasClass("textcomplete-item")||(i=i.parents("li.textcomplete-item")),this.index=parseInt(i.data("index"),10),this.activateIndexedItem()},destroy:function(){this.deactivate(),this.$el.off("click.textComplete").remove(),this.$el=null},appendTo:function(t){t.css({position:"relative"}).append(this.$el)}}),e}();t.fn.textcomplete=function(e,i){var s,a,l,h;if(h="textComplete",i||(i={}),"destroy"===e)return this.each(function(){var e=t(this).data(h);e&&e.destroy()});for(s=0,a=e.length;a>s;s++)l=e[s],l.template||(l.template=n),null==l.index&&(l.index=2),null==l.placement&&(l.placement=""),l.cache&&(l.search=o(l.search)),l.maxCount||(l.maxCount=10);return this.each(function(){var s,n;s=t(this),n=s.data(h),n||(n=new r(s,i),s.data(h,n)),n.register(e)})}}(window.jQuery||window.Zepto);!function(c){c.fn.simpleColor=function(f){function o(){f=c.simpleColorOptions;var o=c("<div class='simpleColorContainer' />");o.css("position","relative");var l=this.value&&""!=this.value?this.value:f.defaultColor,i=c("<div class='simpleColorDisplay' />");i.css(c.extend(f.displayCSS,{"background-color":l})),i.data("color",l),o.append(i),f.displayColorCode&&(i.data("displayColorCode",!0),i.text(this.value),i.css({color:f.colorCodeColor,textAlign:f.colorCodeAlign}));var e=function(o){if(c("html").bind("click.simpleColorDisplay",function(l){c("html").unbind("click.simpleColorDisplay"),c(".simpleColorChooser").hide();var e=c(l.target);(e.is(".simpleColorCell")===!1||c.contains(c(o.target).closest(".simpleColorContainer")[0],e[0])===!1)&&(i.css("background-color",i.data("color")),f.displayColorCode&&i.text(i.data("color"))),f.onClose&&f.onClose(t)}),o.data.container.chooser)o.data.container.chooser.toggle();else{var l=c("<div class='simpleColorChooser'/>");l.css(f.chooserCSS),o.data.container.chooser=l,o.data.container.append(l);for(var e=0;e<f.colors.length;e++){var r=c("<div class='simpleColorCell' id='"+f.colors[e]+"'/>");r.css({width:f.cellWidth+"px",height:f.cellHeight+"px",margin:f.cellMargin+"px",cursor:"pointer",lineHeight:f.cellHeight+"px",fontSize:"1px","float":"left","background-color":"#"+f.colors[e]}),l.append(r),(f.onCellEnter||f.livePreview)&&r.bind("mouseenter",function(){f.onCellEnter&&f.onCellEnter(this.id,t),f.livePreview&&(i.css("background-color","#"+this.id),f.displayColorCode&&i.text("#"+this.id))}),r.bind("click",{input:o.data.input,chooser:l,displayBox:i},function(o){var l="#"+this.id;o.data.input.value=l,c(o.data.input).change(),c(o.data.displayBox).data("color",l),o.data.displayBox.css("background-color",l),o.data.chooser.hide(),f.displayColorCode&&o.data.displayBox.text(l),f.onSelect&&f.onSelect(this.id,t)})}}},r={input:this,container:o,displayBox:i};i.bind("click",r,e),c(this).after(o),c(this).data("container",o)}var t=this,l=["990033","ff3366","cc0033","ff0033","ff9999","cc3366","ffccff","cc6699","993366","660033","cc3399","ff99cc","ff66cc","ff99ff","ff6699","cc0066","ff0066","ff3399","ff0099","ff33cc","ff00cc","ff66ff","ff33ff","ff00ff","cc0099","990066","cc66cc","cc33cc","cc99ff","cc66ff","cc33ff","993399","cc00cc","cc00ff","9900cc","990099","cc99cc","996699","663366","660099","9933cc","660066","9900ff","9933ff","9966cc","330033","663399","6633cc","6600cc","9966ff","330066","6600ff","6633ff","ccccff","9999ff","9999cc","6666cc","6666ff","666699","333366","333399","330099","3300cc","3300ff","3333ff","3333cc","0066ff","0033ff","3366ff","3366cc","000066","000033","0000ff","000099","0033cc","0000cc","336699","0066cc","99ccff","6699ff","003366","6699cc","006699","3399cc","0099cc","66ccff","3399ff","003399","0099ff","33ccff","00ccff","99ffff","66ffff","33ffff","00ffff","00cccc","009999","669999","99cccc","ccffff","33cccc","66cccc","339999","336666","006666","003333","00ffcc","33ffcc","33cc99","00cc99","66ffcc","99ffcc","00ff99","339966","006633","336633","669966","66cc66","99ff99","66ff66","339933","99cc99","66ff99","33ff99","33cc66","00cc66","66cc99","009966","009933","33ff66","00ff66","ccffcc","ccff99","99ff66","99ff33","00ff33","33ff33","00cc33","33cc33","66ff33","00ff00","66cc33","006600","003300","009900","33ff00","66ff00","99ff00","66cc00","00cc00","33cc00","339900","99cc66","669933","99cc33","336600","669900","99cc00","ccff66","ccff33","ccff00","999900","cccc00","cccc33","333300","666600","999933","cccc66","666633","999966","cccc99","ffffcc","ffff99","ffff66","ffff33","ffff00","ffcc00","ffcc66","ffcc33","cc9933","996600","cc9900","ff9900","cc6600","993300","cc6633","663300","ff9966","ff6633","ff9933","ff6600","cc3300","996633","330000","663333","996666","cc9999","993333","cc6666","ffcccc","ff3333","cc3333","ff6666","660000","990000","cc0000","ff0000","ff3300","cc9966","ffcc99","ffffff","cccccc","999999","666666","333333","000000","000000","000000","000000","000000","000000","000000","000000","000000"];return f=c.extend({defaultColor:this.attr("defaultColor")||"#FFF",cellWidth:this.attr("cellWidth")||10,cellHeight:this.attr("cellHeight")||10,cellMargin:this.attr("cellMargin")||1,boxWidth:this.attr("boxWidth")||"115px",boxHeight:this.attr("boxHeight")||"20px",columns:this.attr("columns")||16,insert:this.attr("insert")||"after",colors:this.attr("colors")||l,displayColorCode:this.attr("displayColorCode")||!1,colorCodeAlign:this.attr("colorCodeAlign")||"center",colorCodeColor:this.attr("colorCodeColor")||"#FFF",onSelect:null,onCellEnter:null,onClose:null,livePreview:!1},f||{}),f.totalWidth=f.columns*(f.cellWidth+2*f.cellMargin),f.chooserCSS=c.extend({border:"1px solid #000",margin:"0 0 0 5px",width:f.totalWidth,height:f.totalHeight,top:0,left:f.boxWidth,position:"absolute","background-color":"#fff"},f.chooserCSS||{}),f.displayCSS=c.extend({"background-color":f.defaultColor,border:"1px solid #000",width:f.boxWidth,height:f.boxHeight,"line-height":f.boxHeight+"px",cursor:"pointer"},f.displayCSS||{}),this.hide(),-1!=navigator.userAgent.indexOf("MSIE")&&(f.totalWidth+=2),f.totalHeight=Math.ceil(f.colors.length/f.columns)*(f.cellHeight+2*f.cellMargin),c.simpleColorOptions=f,this.each(o),c(".simpleColorDisplay").each(function(){c(this).click(function(c){c.stopPropagation()})}),this},c.fn.closeChooser=function(){return this.each(function(){c(this).data("container").find(".simpleColorChooser").hide()}),this},c.fn.setColor=function(f){return this.each(function(){var o=c(this).data("container").find(".simpleColorDisplay");o.css("background-color",f).data("color",f),o.data("displayColorCode")===!0&&o.text(f)}),this}}(jQuery);!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?e(require("jquery")):e(jQuery)}(function(e){function n(e){return u.raw?e:encodeURIComponent(e)}function o(e){return u.raw?e:decodeURIComponent(e)}function i(e){return n(u.json?JSON.stringify(e):String(e))}function r(e){0===e.indexOf('"')&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return e=decodeURIComponent(e.replace(c," ")),u.json?JSON.parse(e):e}catch(n){}}function t(n,o){var i=u.raw?n:r(n);return e.isFunction(o)?o(i):i}var c=/\+/g,u=e.cookie=function(r,c,f){if(void 0!==c&&!e.isFunction(c)){if(f=e.extend({},u.defaults,f),"number"==typeof f.expires){var a=f.expires,d=f.expires=new Date;d.setTime(+d+864e5*a)}return document.cookie=[n(r),"=",i(c),f.expires?"; expires="+f.expires.toUTCString():"",f.path?"; path="+f.path:"",f.domain?"; domain="+f.domain:"",f.secure?"; secure":""].join("")}for(var p=r?void 0:{},s=document.cookie?document.cookie.split("; "):[],m=0,x=s.length;x>m;m++){var v=s[m].split("="),k=o(v.shift()),l=v.join("=");if(r&&r===k){p=t(l,c);break}r||void 0===(l=t(l))||(p[k]=l)}return p};u.defaults={},e.removeCookie=function(n,o){return void 0===e.cookie(n)?!1:(e.cookie(n,"",e.extend({},o,{expires:-1})),!e.cookie(n))}});(function(t){function i(t){if(t.attr("title")||typeof t.attr("original-title")!="string"){t.attr("original-title",t.attr("title")||"").removeAttr("title")}}function e(e,s){this.$element=t(e);this.options=s;this.enabled=true;i(this.$element)}e.prototype={show:function(){var i=this.getTitle();if(i&&this.enabled){var e=this.tip();e.find(".tipsy-inner")[this.options.html?"html":"text"](i);e[0].className="tipsy";e.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).appendTo(document.body);var s=t.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight});var n=e[0].offsetWidth,o=e[0].offsetHeight;var l=typeof this.options.gravity=="function"?this.options.gravity.call(this.$element[0]):this.options.gravity;var a;switch(l.charAt(0)){case"n":a={top:s.top+s.height+this.options.offset,left:s.left+s.width/2-n/2};break;case"s":a={top:s.top-o-this.options.offset,left:s.left+s.width/2-n/2};break;case"e":a={top:s.top+s.height/2-o/2,left:s.left-n-this.options.offset};break;case"w":a={top:s.top+s.height/2-o/2,left:s.left+s.width+this.options.offset};break}if(l.length==2){if(l.charAt(1)=="w"){a.left=s.left+s.width/2-15}else{a.left=s.left+s.width/2-n+15}}e.css(a).addClass("tipsy-"+l);if(this.options.fade){e.stop().css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:this.options.opacity})}else{e.css({visibility:"visible",opacity:this.options.opacity})}}},hide:function(){if(this.options.fade){this.tip().stop().fadeOut(function(){t(this).remove()})}else{this.tip().remove()}},getTitle:function(){var t,e=this.$element,s=this.options;i(e);var t,s=this.options;if(typeof s.title=="string"){t=e.attr(s.title=="title"?"original-title":s.title)}else if(typeof s.title=="function"){t=s.title.call(e[0])}t=(""+t).replace(/(^\s*|\s*$)/,"");return t||s.fallback},tip:function(){if(!this.$tip){this.$tip=t('<div class="tipsy"></div>').html('<div class="tipsy-arrow"></div><div class="tipsy-inner"/></div>')}return this.$tip},validate:function(){if(!this.$element[0].parentNode){this.hide();this.$element=null;this.options=null}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},toggleEnabled:function(){this.enabled=!this.enabled}};t.fn.tipsy=function(i){if(i===true){return this.data("tipsy")}else if(typeof i=="string"){return this.data("tipsy")[i]()}i=t.extend({},t.fn.tipsy.defaults,i);function s(s){var n=t.data(s,"tipsy");if(!n){n=new e(s,t.fn.tipsy.elementOptions(s,i));t.data(s,"tipsy",n)}return n}function n(){var t=s(this);t.hoverState="in";if(i.delayIn==0){t.show()}else{setTimeout(function(){if(t.hoverState=="in")t.show()},i.delayIn)}}function o(){var t=s(this);t.hoverState="out";if(i.delayOut==0){t.hide()}else{setTimeout(function(){if(t.hoverState=="out")t.hide()},i.delayOut)}}if(!i.live)this.each(function(){s(this)});if(i.trigger!="manual"){var l=i.live?"live":"bind",a=i.trigger=="hover"?"mouseenter":"focus",f=i.trigger=="hover"?"mouseleave":"blur";this[l](a,n)[l](f,o)}return this};t.fn.tipsy.defaults={delayIn:0,delayOut:0,fade:false,fallback:"",gravity:"n",html:false,live:false,offset:0,opacity:.8,title:"title",trigger:"hover"};t.fn.tipsy.elementOptions=function(i,e){return t.metadata?t.extend({},e,t(i).metadata()):e};t.fn.tipsy.autoNS=function(){return t(this).offset().top>t(document).scrollTop()+t(window).height()/2?"s":"n"};t.fn.tipsy.autoWE=function(){return t(this).offset().left>t(document).scrollLeft()+t(window).width()/2?"e":"w"}})(jQuery);(function e(t,r,n){function i(o,s){if(!r[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!s&&a)return a(o,!0);if(l)return l(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var u=r[o]={exports:{}};t[o][0].call(u.exports,function(e){var r=t[o][1][e];return i(r?r:e)},u,u.exports,e,t,r,n)}return r[o].exports}var l=typeof require=="function"&&require;for(var o=0;o<n.length;o++)i(n[o]);return i})({1:[function(e,t,r){"use strict";var n=e("../main"),i=e("../plugin/instances");function l(e){e.fn.perfectScrollbar=function(t){return this.each(function(){if(typeof t==="object"||typeof t==="undefined"){var r=t;if(!i.get(this)){n.initialize(this,r)}}else{var l=t;if(l==="update"){n.update(this)}else if(l==="destroy"){n.destroy(this)}}return e(this)})}}if(typeof define==="function"&&define.amd){define(["jquery"],l)}else{var o=window.jQuery?window.jQuery:window.$;if(typeof o!=="undefined"){l(o)}}t.exports=l},{"../main":7,"../plugin/instances":18}],2:[function(e,t,r){"use strict";function n(e,t){var r=e.className.split(" ");if(r.indexOf(t)<0){r.push(t)}e.className=r.join(" ")}function i(e,t){var r=e.className.split(" ");var n=r.indexOf(t);if(n>=0){r.splice(n,1)}e.className=r.join(" ")}r.add=function(e,t){if(e.classList){e.classList.add(t)}else{n(e,t)}};r.remove=function(e,t){if(e.classList){e.classList.remove(t)}else{i(e,t)}};r.list=function(e){if(e.classList){return e.classList}else{return e.className.split(" ")}}},{}],3:[function(e,t,r){"use strict";r.e=function(e,t){var r=document.createElement(e);r.className=t;return r};r.appendTo=function(e,t){t.appendChild(e);return e};function n(e,t){return window.getComputedStyle(e)[t]}function i(e,t,r){if(typeof r==="number"){r=r.toString()+"px"}e.style[t]=r;return e}function l(e,t){for(var r in t){var n=t[r];if(typeof n==="number"){n=n.toString()+"px"}e.style[r]=n}return e}r.css=function(e,t,r){if(typeof t==="object"){return l(e,t)}else{if(typeof r==="undefined"){return n(e,t)}else{return i(e,t,r)}}};r.matches=function(e,t){if(typeof e.matches!=="undefined"){return e.matches(t)}else{if(typeof e.matchesSelector!=="undefined"){return e.matchesSelector(t)}else if(typeof e.webkitMatchesSelector!=="undefined"){return e.webkitMatchesSelector(t)}else if(typeof e.mozMatchesSelector!=="undefined"){return e.mozMatchesSelector(t)}else if(typeof e.msMatchesSelector!=="undefined"){return e.msMatchesSelector(t)}}};r.remove=function(e){if(typeof e.remove!=="undefined"){e.remove()}else{if(e.parentNode){e.parentNode.removeChild(e)}}}},{}],4:[function(e,t,r){"use strict";var n=function(e){this.element=e;this.events={}};n.prototype.bind=function(e,t){if(typeof this.events[e]==="undefined"){this.events[e]=[]}this.events[e].push(t);this.element.addEventListener(e,t,false)};n.prototype.unbind=function(e,t){var r=typeof t!=="undefined";this.events[e]=this.events[e].filter(function(n){if(r&&n!==t){return true}this.element.removeEventListener(e,n,false);return false},this)};n.prototype.unbindAll=function(){for(var e in this.events){this.unbind(e)}};var i=function(){this.eventElements=[]};i.prototype.eventElement=function(e){var t=this.eventElements.filter(function(t){return t.element===e})[0];if(typeof t==="undefined"){t=new n(e);this.eventElements.push(t)}return t};i.prototype.bind=function(e,t,r){this.eventElement(e).bind(t,r)};i.prototype.unbind=function(e,t,r){this.eventElement(e).unbind(t,r)};i.prototype.unbindAll=function(){for(var e=0;e<this.eventElements.length;e++){this.eventElements[e].unbindAll()}};i.prototype.once=function(e,t,r){var n=this.eventElement(e);var i=function(e){n.unbind(t,i);r(e)};n.bind(t,i)};t.exports=i},{}],5:[function(e,t,r){"use strict";t.exports=function(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return function(){return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}}()},{}],6:[function(e,t,r){"use strict";var n=e("./class"),i=e("./dom");r.toInt=function(e){return parseInt(e,10)||0};r.clone=function(e){if(e===null){return null}else if(typeof e==="object"){var t={};for(var r in e){t[r]=this.clone(e[r])}return t}else{return e}};r.extend=function(e,t){var r=this.clone(e);for(var n in t){r[n]=this.clone(t[n])}return r};r.isEditable=function(e){return i.matches(e,"input,[contenteditable]")||i.matches(e,"select,[contenteditable]")||i.matches(e,"textarea,[contenteditable]")||i.matches(e,"button,[contenteditable]")};r.removePsClasses=function(e){var t=n.list(e);for(var r=0;r<t.length;r++){var i=t[r];if(i.indexOf("ps-")===0){n.remove(e,i)}}};r.outerWidth=function(e){return this.toInt(i.css(e,"width"))+this.toInt(i.css(e,"paddingLeft"))+this.toInt(i.css(e,"paddingRight"))+this.toInt(i.css(e,"borderLeftWidth"))+this.toInt(i.css(e,"borderRightWidth"))};r.startScrolling=function(e,t){n.add(e,"ps-in-scrolling");if(typeof t!=="undefined"){n.add(e,"ps-"+t)}else{n.add(e,"ps-x");n.add(e,"ps-y")}};r.stopScrolling=function(e,t){n.remove(e,"ps-in-scrolling");if(typeof t!=="undefined"){n.remove(e,"ps-"+t)}else{n.remove(e,"ps-x");n.remove(e,"ps-y")}};r.env={isWebKit:"WebkitAppearance"in document.documentElement.style,supportsTouch:"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,supportsIePointer:window.navigator.msMaxTouchPoints!==null}},{"./class":2,"./dom":3}],7:[function(e,t,r){"use strict";var n=e("./plugin/destroy"),i=e("./plugin/initialize"),l=e("./plugin/update");t.exports={initialize:i,update:l,destroy:n}},{"./plugin/destroy":9,"./plugin/initialize":17,"./plugin/update":20}],8:[function(e,t,r){"use strict";t.exports={wheelSpeed:1,wheelPropagation:false,swipePropagation:true,minScrollbarLength:null,maxScrollbarLength:null,useBothWheelAxes:false,useKeyboard:true,suppressScrollX:false,suppressScrollY:false,scrollXMarginOffset:0,scrollYMarginOffset:0,stopPropagationOnClick:true}},{}],9:[function(e,t,r){"use strict";var n=e("../lib/dom"),i=e("../lib/helper"),l=e("./instances");t.exports=function(e){var t=l.get(e);if(!t){return}t.event.unbindAll();n.remove(t.scrollbarX);n.remove(t.scrollbarY);n.remove(t.scrollbarXRail);n.remove(t.scrollbarYRail);i.removePsClasses(e);l.remove(e)}},{"../lib/dom":3,"../lib/helper":6,"./instances":18}],10:[function(e,t,r){"use strict";var n=e("../../lib/helper"),i=e("../instances"),l=e("../update-geometry");function o(e,t){function r(e){return e.getBoundingClientRect()}var i=window.Event.prototype.stopPropagation.bind;if(t.settings.stopPropagationOnClick){t.event.bind(t.scrollbarY,"click",i)}t.event.bind(t.scrollbarYRail,"click",function(i){var o=n.toInt(t.scrollbarYHeight/2);var s=t.railYRatio*(i.pageY-window.scrollY-r(t.scrollbarYRail).top-o);var a=t.railYRatio*(t.railYHeight-t.scrollbarYHeight);var c=s/a;if(c<0){c=0}else if(c>1){c=1}e.scrollTop=(t.contentHeight-t.containerHeight)*c;l(e);i.stopPropagation()});if(t.settings.stopPropagationOnClick){t.event.bind(t.scrollbarX,"click",i)}t.event.bind(t.scrollbarXRail,"click",function(i){var o=n.toInt(t.scrollbarXWidth/2);var s=t.railXRatio*(i.pageX-window.scrollX-r(t.scrollbarXRail).left-o);var a=t.railXRatio*(t.railXWidth-t.scrollbarXWidth);var c=s/a;if(c<0){c=0}else if(c>1){c=1}e.scrollLeft=(t.contentWidth-t.containerWidth)*c-t.negativeScrollAdjustment;l(e);i.stopPropagation()})}t.exports=function(e){var t=i.get(e);o(e,t)}},{"../../lib/helper":6,"../instances":18,"../update-geometry":19}],11:[function(e,t,r){"use strict";var n=e("../../lib/dom"),i=e("../../lib/helper"),l=e("../instances"),o=e("../update-geometry");function s(e,t){var r=null;var l=null;function s(n){var l=r+n*t.railXRatio;var o=t.scrollbarXRail.getBoundingClientRect().left+t.railXRatio*(t.railXWidth-t.scrollbarXWidth);if(l<0){t.scrollbarXLeft=0}else if(l>o){t.scrollbarXLeft=o}else{t.scrollbarXLeft=l}var s=i.toInt(t.scrollbarXLeft*(t.contentWidth-t.containerWidth)/(t.containerWidth-t.railXRatio*t.scrollbarXWidth))-t.negativeScrollAdjustment;e.scrollLeft=s}var a=function(t){s(t.pageX-l);o(e);t.stopPropagation();t.preventDefault()};var c=function(){i.stopScrolling(e,"x");t.event.unbind(t.ownerDocument,"mousemove",a)};t.event.bind(t.scrollbarX,"mousedown",function(o){l=o.pageX;r=i.toInt(n.css(t.scrollbarX,"left"))*t.railXRatio;i.startScrolling(e,"x");t.event.bind(t.ownerDocument,"mousemove",a);t.event.once(t.ownerDocument,"mouseup",c);o.stopPropagation();o.preventDefault()})}function a(e,t){var r=null;var l=null;function s(n){var l=r+n*t.railYRatio;var o=t.scrollbarYRail.getBoundingClientRect().top+t.railYRatio*(t.railYHeight-t.scrollbarYHeight);if(l<0){t.scrollbarYTop=0}else if(l>o){t.scrollbarYTop=o}else{t.scrollbarYTop=l}var s=i.toInt(t.scrollbarYTop*(t.contentHeight-t.containerHeight)/(t.containerHeight-t.railYRatio*t.scrollbarYHeight));e.scrollTop=s}var a=function(t){s(t.pageY-l);o(e);t.stopPropagation();t.preventDefault()};var c=function(){i.stopScrolling(e,"y");t.event.unbind(t.ownerDocument,"mousemove",a)};t.event.bind(t.scrollbarY,"mousedown",function(o){l=o.pageY;r=i.toInt(n.css(t.scrollbarY,"top"))*t.railYRatio;i.startScrolling(e,"y");t.event.bind(t.ownerDocument,"mousemove",a);t.event.once(t.ownerDocument,"mouseup",c);o.stopPropagation();o.preventDefault()})}t.exports=function(e){var t=l.get(e);s(e,t);a(e,t)}},{"../../lib/dom":3,"../../lib/helper":6,"../instances":18,"../update-geometry":19}],12:[function(e,t,r){"use strict";var n=e("../../lib/helper"),i=e("../instances"),l=e("../update-geometry");function o(e,t){var r=false;t.event.bind(e,"mouseenter",function(){r=true});t.event.bind(e,"mouseleave",function(){r=false});var i=false;function o(r,n){var i=e.scrollTop;if(r===0){if(!t.scrollbarYActive){return false}if(i===0&&n>0||i>=t.contentHeight-t.containerHeight&&n<0){return!t.settings.wheelPropagation}}var l=e.scrollLeft;if(n===0){if(!t.scrollbarXActive){return false}if(l===0&&r<0||l>=t.contentWidth-t.containerWidth&&r>0){return!t.settings.wheelPropagation}}return true}t.event.bind(t.ownerDocument,"keydown",function(s){if(s.isDefaultPrevented&&s.isDefaultPrevented()){return}if(!r){return}var a=document.activeElement?document.activeElement:t.ownerDocument.activeElement;if(a){while(a.shadowRoot){a=a.shadowRoot.activeElement}if(n.isEditable(a)){return}}var c=0;var u=0;switch(s.which){case 37:c=-30;break;case 38:u=30;break;case 39:c=30;break;case 40:u=-30;break;case 33:u=90;break;case 32:case 34:u=-90;break;case 35:if(s.ctrlKey){u=-t.contentHeight}else{u=-t.containerHeight}break;case 36:if(s.ctrlKey){u=e.scrollTop}else{u=t.containerHeight}break;default:return}e.scrollTop=e.scrollTop-u;e.scrollLeft=e.scrollLeft+c;l(e);i=o(c,u);if(i){s.preventDefault()}})}t.exports=function(e){var t=i.get(e);o(e,t)}},{"../../lib/helper":6,"../instances":18,"../update-geometry":19}],13:[function(e,t,r){"use strict";var n=e("../../lib/helper"),i=e("../instances"),l=e("../update-geometry");function o(e,t){var r=false;function i(r,n){var i=e.scrollTop;if(r===0){if(!t.scrollbarYActive){return false}if(i===0&&n>0||i>=t.contentHeight-t.containerHeight&&n<0){return!t.settings.wheelPropagation}}var l=e.scrollLeft;if(n===0){if(!t.scrollbarXActive){return false}if(l===0&&r<0||l>=t.contentWidth-t.containerWidth&&r>0){return!t.settings.wheelPropagation}}return true}function o(e){var t=e.deltaX;var r=-1*e.deltaY;if(typeof t==="undefined"||typeof r==="undefined"){t=-1*e.wheelDeltaX/6;r=e.wheelDeltaY/6}if(e.deltaMode&&e.deltaMode===1){t*=10;r*=13}if(t!==t&&r!==r){t=0;r=e.wheelDelta}return[t,r]}function s(t,r){var n=e.querySelector("textarea:hover");if(n){var i=n.scrollHeight-n.clientHeight;if(i>0){if(!(n.scrollTop===0&&r>0)&&!(n.scrollTop===i&&r<0)){return true}}var l=n.scrollLeft-n.clientWidth;if(l>0){if(!(n.scrollLeft===0&&t<0)&&!(n.scrollLeft===l&&t>0)){return true}}}return false}function a(a){if(!n.env.isWebKit&&e.querySelector("select:focus")){return}var c=o(a);var u=c[0];var f=c[1];if(s(u,f)){return}r=false;if(!t.settings.useBothWheelAxes){e.scrollTop=e.scrollTop-f*t.settings.wheelSpeed;e.scrollLeft=e.scrollLeft+u*t.settings.wheelSpeed}else if(t.scrollbarYActive&&!t.scrollbarXActive){if(f){e.scrollTop=e.scrollTop-f*t.settings.wheelSpeed}else{e.scrollTop=e.scrollTop+u*t.settings.wheelSpeed}r=true}else if(t.scrollbarXActive&&!t.scrollbarYActive){if(u){e.scrollLeft=e.scrollLeft+u*t.settings.wheelSpeed}else{e.scrollLeft=e.scrollLeft-f*t.settings.wheelSpeed}r=true}l(e);r=r||i(u,f);if(r){a.stopPropagation();a.preventDefault()}}if(typeof window.onwheel!=="undefined"){t.event.bind(e,"wheel",a)}else if(typeof window.onmousewheel!=="undefined"){t.event.bind(e,"mousewheel",a)}}t.exports=function(e){var t=i.get(e);o(e,t)}},{"../../lib/helper":6,"../instances":18,"../update-geometry":19}],14:[function(e,t,r){"use strict";var n=e("../instances"),i=e("../update-geometry");function l(e,t){t.event.bind(e,"scroll",function(){i(e)})}t.exports=function(e){var t=n.get(e);l(e,t)}},{"../instances":18,"../update-geometry":19}],15:[function(e,t,r){"use strict";var n=e("../../lib/helper"),i=e("../instances"),l=e("../update-geometry");function o(e,t){function r(){var e=window.getSelection?window.getSelection():document.getSelection?document.getSelection():"";if(e.toString().length===0){return null}else{return e.getRangeAt(0).commonAncestorContainer}}var o=null;var s={top:0,left:0};function a(){if(!o){o=setInterval(function(){if(!i.get(e)){clearInterval(o);return}e.scrollTop=e.scrollTop+s.top;e.scrollLeft=e.scrollLeft+s.left;l(e)},50)}}function c(){if(o){clearInterval(o);o=null}n.stopScrolling(e)}var u=false;t.event.bind(t.ownerDocument,"selectionchange",function(){if(e.contains(r())){u=true}else{u=false;c()}});t.event.bind(window,"mouseup",function(){if(u){u=false;c()}});t.event.bind(window,"mousemove",function(t){if(u){var r={x:t.pageX,y:t.pageY};var i={left:e.offsetLeft,right:e.offsetLeft+e.offsetWidth,top:e.offsetTop,bottom:e.offsetTop+e.offsetHeight};if(r.x<i.left+3){s.left=-5;n.startScrolling(e,"x")}else if(r.x>i.right-3){s.left=5;n.startScrolling(e,"x")}else{s.left=0}if(r.y<i.top+3){if(i.top+3-r.y<5){s.top=-5}else{s.top=-20}n.startScrolling(e,"y")}else if(r.y>i.bottom-3){if(r.y-i.bottom+3<5){s.top=5}else{s.top=20}n.startScrolling(e,"y")}else{s.top=0}if(s.top===0&&s.left===0){c()}else{a()}}})}t.exports=function(e){var t=i.get(e);o(e,t)}},{"../../lib/helper":6,"../instances":18,"../update-geometry":19}],16:[function(e,t,r){"use strict";var n=e("../instances"),i=e("../update-geometry");function l(e,t,r,l){function o(r,n){var i=e.scrollTop;var l=e.scrollLeft;var o=Math.abs(r);var s=Math.abs(n);if(s>o){if(n<0&&i===t.contentHeight-t.containerHeight||n>0&&i===0){return!t.settings.swipePropagation}}else if(o>s){if(r<0&&l===t.contentWidth-t.containerWidth||r>0&&l===0){return!t.settings.swipePropagation}}return true}function s(t,r){e.scrollTop=e.scrollTop-r;e.scrollLeft=e.scrollLeft-t;i(e)}var a={};var c=0;var u={};var f=null;var d=false;var p=false;function h(){d=true}function b(){d=false}function v(e){if(e.targetTouches){return e.targetTouches[0]}else{return e}}function g(e){if(e.targetTouches&&e.targetTouches.length===1){return true}if(e.pointerType&&e.pointerType!=="mouse"&&e.pointerType!==e.MSPOINTER_TYPE_MOUSE){return true}return false}function m(e){if(g(e)){p=true;var t=v(e);a.pageX=t.pageX;a.pageY=t.pageY;c=(new Date).getTime();if(f!==null){clearInterval(f)}e.stopPropagation()}}function Y(e){if(!d&&p&&g(e)){var t=v(e);var r={pageX:t.pageX,pageY:t.pageY};var n=r.pageX-a.pageX;var i=r.pageY-a.pageY;s(n,i);a=r;var l=(new Date).getTime();var f=l-c;if(f>0){u.x=n/f;u.y=i/f;c=l}if(o(n,i)){e.stopPropagation();e.preventDefault()}}}function w(){if(!d&&p){p=false;clearInterval(f);f=setInterval(function(){if(!n.get(e)){clearInterval(f);return}if(Math.abs(u.x)<.01&&Math.abs(u.y)<.01){clearInterval(f);return}s(u.x*30,u.y*30);u.x*=.8;u.y*=.8},10)}}if(r){t.event.bind(window,"touchstart",h);t.event.bind(window,"touchend",b);t.event.bind(e,"touchstart",m);t.event.bind(e,"touchmove",Y);t.event.bind(e,"touchend",w)}if(l){if(window.PointerEvent){t.event.bind(window,"pointerdown",h);t.event.bind(window,"pointerup",b);t.event.bind(e,"pointerdown",m);t.event.bind(e,"pointermove",Y);t.event.bind(e,"pointerup",w)}else if(window.MSPointerEvent){t.event.bind(window,"MSPointerDown",h);t.event.bind(window,"MSPointerUp",b);t.event.bind(e,"MSPointerDown",m);t.event.bind(e,"MSPointerMove",Y);t.event.bind(e,"MSPointerUp",w)}}}t.exports=function(e,t,r){var i=n.get(e);l(e,i,t,r)}},{"../instances":18,"../update-geometry":19}],17:[function(e,t,r){"use strict";var n=e("../lib/class"),i=e("../lib/helper"),l=e("./instances"),o=e("./update-geometry");var s=e("./handler/click-rail"),a=e("./handler/drag-scrollbar"),c=e("./handler/keyboard"),u=e("./handler/mouse-wheel"),f=e("./handler/native-scroll"),d=e("./handler/selection"),p=e("./handler/touch");t.exports=function(e,t){t=typeof t==="object"?t:{};n.add(e,"ps-container");var r=l.add(e);r.settings=i.extend(r.settings,t);s(e);a(e);u(e);f(e);d(e);if(i.env.supportsTouch||i.env.supportsIePointer){p(e,i.env.supportsTouch,i.env.supportsIePointer)}if(r.settings.useKeyboard){c(e)}o(e)}},{"../lib/class":2,"../lib/helper":6,"./handler/click-rail":10,"./handler/drag-scrollbar":11,"./handler/keyboard":12,"./handler/mouse-wheel":13,"./handler/native-scroll":14,"./handler/selection":15,"./handler/touch":16,"./instances":18,"./update-geometry":19}],18:[function(e,t,r){"use strict";var n=e("../lib/dom"),i=e("./default-setting"),l=e("../lib/event-manager"),o=e("../lib/guid"),s=e("../lib/helper");var a={};function c(e){var t=this;t.settings=s.clone(i);t.containerWidth=null;t.containerHeight=null;t.contentWidth=null;t.contentHeight=null;t.isRtl=n.css(e,"direction")==="rtl";t.isNegativeScroll=function(){var t=e.scrollLeft;var r=null;e.scrollLeft=-1;r=e.scrollLeft<0;e.scrollLeft=t;return r}();t.negativeScrollAdjustment=t.isNegativeScroll?e.scrollWidth-e.clientWidth:0;t.event=new l;t.ownerDocument=e.ownerDocument||document;t.scrollbarXRail=n.appendTo(n.e("div","ps-scrollbar-x-rail"),e);t.scrollbarX=n.appendTo(n.e("div","ps-scrollbar-x"),t.scrollbarXRail);t.scrollbarXActive=null;t.scrollbarXWidth=null;t.scrollbarXLeft=null;t.scrollbarXBottom=s.toInt(n.css(t.scrollbarXRail,"bottom"));t.isScrollbarXUsingBottom=t.scrollbarXBottom===t.scrollbarXBottom;t.scrollbarXTop=t.isScrollbarXUsingBottom?null:s.toInt(n.css(t.scrollbarXRail,"top"));t.railBorderXWidth=s.toInt(n.css(t.scrollbarXRail,"borderLeftWidth"))+s.toInt(n.css(t.scrollbarXRail,"borderRightWidth"));n.css(t.scrollbarXRail,"display","block");t.railXMarginWidth=s.toInt(n.css(t.scrollbarXRail,"marginLeft"))+s.toInt(n.css(t.scrollbarXRail,"marginRight"));n.css(t.scrollbarXRail,"display","");t.railXWidth=null;t.railXRatio=null;t.scrollbarYRail=n.appendTo(n.e("div","ps-scrollbar-y-rail"),e);t.scrollbarY=n.appendTo(n.e("div","ps-scrollbar-y"),t.scrollbarYRail);t.scrollbarYActive=null;t.scrollbarYHeight=null;t.scrollbarYTop=null;t.scrollbarYRight=s.toInt(n.css(t.scrollbarYRail,"right"));t.isScrollbarYUsingRight=t.scrollbarYRight===t.scrollbarYRight;t.scrollbarYLeft=t.isScrollbarYUsingRight?null:s.toInt(n.css(t.scrollbarYRail,"left"));t.scrollbarYOuterWidth=t.isRtl?s.outerWidth(t.scrollbarY):null;t.railBorderYWidth=s.toInt(n.css(t.scrollbarYRail,"borderTopWidth"))+s.toInt(n.css(t.scrollbarYRail,"borderBottomWidth"));n.css(t.scrollbarYRail,"display","block");t.railYMarginHeight=s.toInt(n.css(t.scrollbarYRail,"marginTop"))+s.toInt(n.css(t.scrollbarYRail,"marginBottom"));n.css(t.scrollbarYRail,"display","");t.railYHeight=null;t.railYRatio=null}function u(e){if(typeof e.dataset==="undefined"){return e.getAttribute("data-ps-id")}else{return e.dataset.psId}}function f(e,t){if(typeof e.dataset==="undefined"){e.setAttribute("data-ps-id",t)}else{e.dataset.psId=t}}function d(e){if(typeof e.dataset==="undefined"){e.removeAttribute("data-ps-id")}else{delete e.dataset.psId}}r.add=function(e){var t=o();f(e,t);a[t]=new c(e);return a[t]};r.remove=function(e){delete a[u(e)];d(e)};r.get=function(e){return a[u(e)]}},{"../lib/dom":3,"../lib/event-manager":4,"../lib/guid":5,"../lib/helper":6,"./default-setting":8}],19:[function(e,t,r){"use strict";var n=e("../lib/class"),i=e("../lib/dom"),l=e("../lib/helper"),o=e("./instances");function s(e,t){if(e.settings.minScrollbarLength){t=Math.max(t,e.settings.minScrollbarLength)}if(e.settings.maxScrollbarLength){t=Math.min(t,e.settings.maxScrollbarLength)}return t}function a(e,t){var r={width:t.railXWidth};if(t.isRtl){r.left=t.negativeScrollAdjustment+e.scrollLeft+t.containerWidth-t.contentWidth}else{r.left=e.scrollLeft}if(t.isScrollbarXUsingBottom){r.bottom=t.scrollbarXBottom-e.scrollTop}else{r.top=t.scrollbarXTop+e.scrollTop}i.css(t.scrollbarXRail,r);var n={top:e.scrollTop,height:t.railYHeight};if(t.isScrollbarYUsingRight){if(t.isRtl){n.right=t.contentWidth-(t.negativeScrollAdjustment+e.scrollLeft)-t.scrollbarYRight-t.scrollbarYOuterWidth}else{n.right=t.scrollbarYRight-e.scrollLeft}}else{if(t.isRtl){n.left=t.negativeScrollAdjustment+e.scrollLeft+t.containerWidth*2-t.contentWidth-t.scrollbarYLeft-t.scrollbarYOuterWidth}else{n.left=t.scrollbarYLeft+e.scrollLeft}}i.css(t.scrollbarYRail,n);i.css(t.scrollbarX,{left:t.scrollbarXLeft,width:t.scrollbarXWidth-t.railBorderXWidth});i.css(t.scrollbarY,{top:t.scrollbarYTop,height:t.scrollbarYHeight-t.railBorderYWidth})}t.exports=function(e){var t=o.get(e);t.containerWidth=e.clientWidth;t.containerHeight=e.clientHeight;t.contentWidth=e.scrollWidth;t.contentHeight=e.scrollHeight;if(!e.contains(t.scrollbarXRail)){i.appendTo(t.scrollbarXRail,e)}if(!e.contains(t.scrollbarYRail)){i.appendTo(t.scrollbarYRail,e)}if(!t.settings.suppressScrollX&&t.containerWidth+t.settings.scrollXMarginOffset<t.contentWidth){t.scrollbarXActive=true;t.railXWidth=t.containerWidth-t.railXMarginWidth;t.railXRatio=t.containerWidth/t.railXWidth;t.scrollbarXWidth=s(t,l.toInt(t.railXWidth*t.containerWidth/t.contentWidth));t.scrollbarXLeft=l.toInt((t.negativeScrollAdjustment+e.scrollLeft)*(t.railXWidth-t.scrollbarXWidth)/(t.contentWidth-t.containerWidth))}else{t.scrollbarXActive=false;t.scrollbarXWidth=0;t.scrollbarXLeft=0;e.scrollLeft=0}if(!t.settings.suppressScrollY&&t.containerHeight+t.settings.scrollYMarginOffset<t.contentHeight){t.scrollbarYActive=true;t.railYHeight=t.containerHeight-t.railYMarginHeight;t.railYRatio=t.containerHeight/t.railYHeight;t.scrollbarYHeight=s(t,l.toInt(t.railYHeight*t.containerHeight/t.contentHeight));t.scrollbarYTop=l.toInt(e.scrollTop*(t.railYHeight-t.scrollbarYHeight)/(t.contentHeight-t.containerHeight))}else{t.scrollbarYActive=false;t.scrollbarYHeight=0;t.scrollbarYTop=0;e.scrollTop=0}if(t.scrollbarXLeft>=t.railXWidth-t.scrollbarXWidth){t.scrollbarXLeft=t.railXWidth-t.scrollbarXWidth}if(t.scrollbarYTop>=t.railYHeight-t.scrollbarYHeight){t.scrollbarYTop=t.railYHeight-t.scrollbarYHeight}a(e,t);n[t.scrollbarXActive?"add":"remove"](e,"ps-active-x");n[t.scrollbarYActive?"add":"remove"](e,"ps-active-y")}},{"../lib/class":2,"../lib/dom":3,"../lib/helper":6,"./instances":18}],20:[function(e,t,r){"use strict";var n=e("../lib/dom"),i=e("../lib/helper"),l=e("./instances"),o=e("./update-geometry");t.exports=function(e){var t=l.get(e);if(!t){return}t.negativeScrollAdjustment=t.isNegativeScroll?e.scrollWidth-e.clientWidth:0;n.css(t.scrollbarXRail,"display","block");n.css(t.scrollbarYRail,"display","block");t.railXMarginWidth=i.toInt(n.css(t.scrollbarXRail,"marginLeft"))+i.toInt(n.css(t.scrollbarXRail,"marginRight"));t.railYMarginHeight=i.toInt(n.css(t.scrollbarYRail,"marginTop"))+i.toInt(n.css(t.scrollbarYRail,"marginBottom"));n.css(t.scrollbarXRail,"display","none");n.css(t.scrollbarYRail,"display","none");o(e);n.css(t.scrollbarXRail,"display","");n.css(t.scrollbarYRail,"display","")}},{"../lib/dom":3,"../lib/helper":6,"./instances":18,"./update-geometry":19}]},{},[1]);(function(e){if(typeof module!=="undefined"&&module.exports){module.exports=e}else{e(jQuery,window,document)}})(function(e){(function(t){var i=typeof define==="function"&&define.amd,a=typeof module!=="undefined"&&module.exports,o="https:"==document.location.protocol?"https:":"http:",n="cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.1.12/jquery.mousewheel.min.js";if(!i){if(a){require("jquery-mousewheel")(e)}else{e.event.special.mousewheel||e("head").append(decodeURI("%3Cscript src="+o+"//"+n+"%3E%3C/script%3E"))}}t()})(function(){var t="mCustomScrollbar",i="mCS",a=".mCustomScrollbar",o={setTop:0,setLeft:0,axis:"y",scrollbarPosition:"inside",scrollInertia:950,autoDraggerLength:true,alwaysShowScrollbar:0,snapOffset:0,mouseWheel:{enable:true,scrollAmount:"auto",axis:"y",deltaFactor:"auto",disableOver:["select","option","keygen","datalist","textarea"]},scrollButtons:{scrollType:"stepless",scrollAmount:"auto"},keyboard:{enable:true,scrollType:"stepless",scrollAmount:"auto"},contentTouchScroll:25,advanced:{autoScrollOnFocus:"input,textarea,select,button,datalist,keygen,a[tabindex],area,object,[contenteditable='true']",updateOnContentResize:true,updateOnImageLoad:true,autoUpdateTimeout:60},theme:"light",callbacks:{onTotalScrollOffset:0,onTotalScrollBackOffset:0,alwaysTriggerOffsets:true}},n=0,r={},l=window.attachEvent&&!window.addEventListener?1:0,s=false,c,d=["mCSB_dragger_onDrag","mCSB_scrollTools_onDrag","mCS_img_loaded","mCS_disabled","mCS_destroyed","mCS_no_scrollbar","mCS-autoHide","mCS-dir-rtl","mCS_no_scrollbar_y","mCS_no_scrollbar_x","mCS_y_hidden","mCS_x_hidden","mCSB_draggerContainer","mCSB_buttonUp","mCSB_buttonDown","mCSB_buttonLeft","mCSB_buttonRight"],f={init:function(t){var t=e.extend(true,{},o,t),l=u.call(this);if(t.live){var s=t.liveSelector||this.selector||a,c=e(s);if(t.live==="off"){m(s);return}r[s]=setTimeout(function(){c.mCustomScrollbar(t);if(t.live==="once"&&c.length){m(s)}},500)}else{m(s)}t.setWidth=t.set_width?t.set_width:t.setWidth;t.setHeight=t.set_height?t.set_height:t.setHeight;t.axis=t.horizontalScroll?"x":p(t.axis);t.scrollInertia=t.scrollInertia>0&&t.scrollInertia<17?17:t.scrollInertia;if(typeof t.mouseWheel!=="object"&&t.mouseWheel==true){t.mouseWheel={enable:true,scrollAmount:"auto",axis:"y",preventDefault:false,deltaFactor:"auto",normalizeDelta:false,invert:false}}t.mouseWheel.scrollAmount=!t.mouseWheelPixels?t.mouseWheel.scrollAmount:t.mouseWheelPixels;t.mouseWheel.normalizeDelta=!t.advanced.normalizeMouseWheelDelta?t.mouseWheel.normalizeDelta:t.advanced.normalizeMouseWheelDelta;t.scrollButtons.scrollType=g(t.scrollButtons.scrollType);h(t);return e(l).each(function(){var a=e(this);if(!a.data(i)){a.data(i,{idx:++n,opt:t,scrollRatio:{y:null,x:null},overflowed:null,contentReset:{y:null,x:null},bindEvents:false,tweenRunning:false,sequential:{},langDir:a.css("direction"),cbOffsets:null,trigger:null});var o=a.data(i),r=o.opt,l=a.data("mcs-axis"),s=a.data("mcs-scrollbar-position"),c=a.data("mcs-theme");if(l){r.axis=l}if(s){r.scrollbarPosition=s}if(c){r.theme=c;h(r)}v.call(this);e("#mCSB_"+o.idx+"_container img:not(."+d[2]+")").addClass(d[2]);f.update.call(null,a)}})},update:function(t,a){var o=t||u.call(this);return e(o).each(function(){var t=e(this);if(t.data(i)){var o=t.data(i),n=o.opt,r=e("#mCSB_"+o.idx+"_container"),l=[e("#mCSB_"+o.idx+"_dragger_vertical"),e("#mCSB_"+o.idx+"_dragger_horizontal")];if(!r.length){return}if(o.tweenRunning){V(t)}if(t.hasClass(d[3])){t.removeClass(d[3])}if(t.hasClass(d[4])){t.removeClass(d[4])}S.call(this);_.call(this);if(n.axis!=="y"&&!n.advanced.autoExpandHorizontalScroll){r.css("width",x(r.children()))}o.overflowed=B.call(this);O.call(this);if(n.autoDraggerLength){b.call(this)}C.call(this);k.call(this);var s=[Math.abs(r[0].offsetTop),Math.abs(r[0].offsetLeft)];if(n.axis!=="x"){if(!o.overflowed[0]){T.call(this);if(n.axis==="y"){M.call(this)}else if(n.axis==="yx"&&o.overflowed[1]){Q(t,s[1].toString(),{dir:"x",dur:0,overwrite:"none"})}}else if(l[0].height()>l[0].parent().height()){T.call(this)}else{Q(t,s[0].toString(),{dir:"y",dur:0,overwrite:"none"});o.contentReset.y=null}}if(n.axis!=="y"){if(!o.overflowed[1]){T.call(this);if(n.axis==="x"){M.call(this)}else if(n.axis==="yx"&&o.overflowed[0]){Q(t,s[0].toString(),{dir:"y",dur:0,overwrite:"none"})}}else if(l[1].width()>l[1].parent().width()){T.call(this)}else{Q(t,s[1].toString(),{dir:"x",dur:0,overwrite:"none"});o.contentReset.x=null}}if(a&&o){if(a===2&&n.callbacks.onImageLoad&&typeof n.callbacks.onImageLoad==="function"){n.callbacks.onImageLoad.call(this)}else if(a===3&&n.callbacks.onSelectorChange&&typeof n.callbacks.onSelectorChange==="function"){n.callbacks.onSelectorChange.call(this)}else if(n.callbacks.onUpdate&&typeof n.callbacks.onUpdate==="function"){n.callbacks.onUpdate.call(this)}}X.call(this)}})},scrollTo:function(t,a){if(typeof t=="undefined"||t==null){return}var o=u.call(this);return e(o).each(function(){var o=e(this);if(o.data(i)){var n=o.data(i),r=n.opt,l={trigger:"external",scrollInertia:r.scrollInertia,scrollEasing:"mcsEaseInOut",moveDragger:false,timeout:60,callbacks:true,onStart:true,onUpdate:true,onComplete:true},s=e.extend(true,{},l,a),c=Y.call(this,t),d=s.scrollInertia>0&&s.scrollInertia<17?17:s.scrollInertia;c[0]=j.call(this,c[0],"y");c[1]=j.call(this,c[1],"x");if(s.moveDragger){c[0]*=n.scrollRatio.y;c[1]*=n.scrollRatio.x}s.dur=d;setTimeout(function(){if(c[0]!==null&&typeof c[0]!=="undefined"&&r.axis!=="x"&&n.overflowed[0]){s.dir="y";s.overwrite="all";Q(o,c[0].toString(),s)}if(c[1]!==null&&typeof c[1]!=="undefined"&&r.axis!=="y"&&n.overflowed[1]){s.dir="x";s.overwrite="none";Q(o,c[1].toString(),s)}},s.timeout)}})},stop:function(){var t=u.call(this);return e(t).each(function(){var t=e(this);if(t.data(i)){V(t)}})},disable:function(t){var a=u.call(this);return e(a).each(function(){var a=e(this);if(a.data(i)){var o=a.data(i);X.call(this,"remove");M.call(this);if(t){T.call(this)}O.call(this,true);a.addClass(d[3])}})},destroy:function(){var a=u.call(this);return e(a).each(function(){var o=e(this);if(o.data(i)){var n=o.data(i),r=n.opt,l=e("#mCSB_"+n.idx),s=e("#mCSB_"+n.idx+"_container"),c=e(".mCSB_"+n.idx+"_scrollbar");if(r.live){m(r.liveSelector||e(a).selector)}X.call(this,"remove");M.call(this);T.call(this);o.removeData(i);Z(this,"mcs");c.remove();s.find("img."+d[2]).removeClass(d[2]);l.replaceWith(s.contents());o.removeClass(t+" _"+i+"_"+n.idx+" "+d[6]+" "+d[7]+" "+d[5]+" "+d[3]).addClass(d[4])}})}},u=function(){return typeof e(this)!=="object"||e(this).length<1?a:this},h=function(t){var i=["rounded","rounded-dark","rounded-dots","rounded-dots-dark"],a=["rounded-dots","rounded-dots-dark","3d","3d-dark","3d-thick","3d-thick-dark","inset","inset-dark","inset-2","inset-2-dark","inset-3","inset-3-dark"],o=["minimal","minimal-dark"],n=["minimal","minimal-dark"],r=["minimal","minimal-dark"];t.autoDraggerLength=e.inArray(t.theme,i)>-1?false:t.autoDraggerLength;t.autoExpandScrollbar=e.inArray(t.theme,a)>-1?false:t.autoExpandScrollbar;t.scrollButtons.enable=e.inArray(t.theme,o)>-1?false:t.scrollButtons.enable;t.autoHideScrollbar=e.inArray(t.theme,n)>-1?true:t.autoHideScrollbar;t.scrollbarPosition=e.inArray(t.theme,r)>-1?"outside":t.scrollbarPosition},m=function(e){if(r[e]){clearTimeout(r[e]);Z(r,e)}},p=function(e){return e==="yx"||e==="xy"||e==="auto"?"yx":e==="x"||e==="horizontal"?"x":"y"},g=function(e){return e==="stepped"||e==="pixels"||e==="step"||e==="click"?"stepped":"stepless"},v=function(){var a=e(this),o=a.data(i),n=o.opt,r=n.autoExpandScrollbar?" "+d[1]+"_expand":"",l=["<div id='mCSB_"+o.idx+"_scrollbar_vertical' class='mCSB_scrollTools mCSB_"+o.idx+"_scrollbar mCS-"+n.theme+" mCSB_scrollTools_vertical"+r+"'><div class='"+d[12]+"'><div id='mCSB_"+o.idx+"_dragger_vertical' class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>","<div id='mCSB_"+o.idx+"_scrollbar_horizontal' class='mCSB_scrollTools mCSB_"+o.idx+"_scrollbar mCS-"+n.theme+" mCSB_scrollTools_horizontal"+r+"'><div class='"+d[12]+"'><div id='mCSB_"+o.idx+"_dragger_horizontal' class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>"],s=n.axis==="yx"?"mCSB_vertical_horizontal":n.axis==="x"?"mCSB_horizontal":"mCSB_vertical",c=n.axis==="yx"?l[0]+l[1]:n.axis==="x"?l[1]:l[0],f=n.axis==="yx"?"<div id='mCSB_"+o.idx+"_container_wrapper' class='mCSB_container_wrapper' />":"",u=n.autoHideScrollbar?" "+d[6]:"",h=n.axis!=="x"&&o.langDir==="rtl"?" "+d[7]:"";if(n.setWidth){a.css("width",n.setWidth)}if(n.setHeight){a.css("height",n.setHeight)}n.setLeft=n.axis!=="y"&&o.langDir==="rtl"?"989999px":n.setLeft;a.addClass(t+" _"+i+"_"+o.idx+u+h).wrapInner("<div id='mCSB_"+o.idx+"' class='mCustomScrollBox mCS-"+n.theme+" "+s+"'><div id='mCSB_"+o.idx+"_container' class='mCSB_container' style='position:relative; top:"+n.setTop+"; left:"+n.setLeft+";' dir="+o.langDir+" /></div>");var m=e("#mCSB_"+o.idx),p=e("#mCSB_"+o.idx+"_container");if(n.axis!=="y"&&!n.advanced.autoExpandHorizontalScroll){p.css("width",x(p.children()))}if(n.scrollbarPosition==="outside"){if(a.css("position")==="static"){a.css("position","relative")}a.css("overflow","visible");m.addClass("mCSB_outside").after(c)}else{m.addClass("mCSB_inside").append(c);p.wrap(f)}w.call(this);var g=[e("#mCSB_"+o.idx+"_dragger_vertical"),e("#mCSB_"+o.idx+"_dragger_horizontal")];g[0].css("min-height",g[0].height());g[1].css("min-width",g[1].width())},x=function(t){return Math.max.apply(Math,t.map(function(){return e(this).outerWidth(true)}).get())},_=function(){var t=e(this),a=t.data(i),o=a.opt,n=e("#mCSB_"+a.idx+"_container");if(o.advanced.autoExpandHorizontalScroll&&o.axis!=="y"){n.css({position:"absolute",width:"auto"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:Math.ceil(n[0].getBoundingClientRect().right+.4)-Math.floor(n[0].getBoundingClientRect().left),position:"relative"}).unwrap()}},w=function(){var t=e(this),a=t.data(i),o=a.opt,n=e(".mCSB_"+a.idx+"_scrollbar:first"),r=!tt(o.scrollButtons.tabindex)?"":"tabindex='"+o.scrollButtons.tabindex+"'",l=["<a href='#' class='"+d[13]+"' oncontextmenu='return false;' "+r+" />","<a href='#' class='"+d[14]+"' oncontextmenu='return false;' "+r+" />","<a href='#' class='"+d[15]+"' oncontextmenu='return false;' "+r+" />","<a href='#' class='"+d[16]+"' oncontextmenu='return false;' "+r+" />"],s=[o.axis==="x"?l[2]:l[0],o.axis==="x"?l[3]:l[1],l[2],l[3]];if(o.scrollButtons.enable){n.prepend(s[0]).append(s[1]).next(".mCSB_scrollTools").prepend(s[2]).append(s[3])}},S=function(){var t=e(this),a=t.data(i),o=e("#mCSB_"+a.idx),n=t.css("max-height")||"none",r=n.indexOf("%")!==-1,l=t.css("box-sizing");if(n!=="none"){var s=r?t.parent().height()*parseInt(n)/100:parseInt(n);if(l==="border-box"){s-=t.innerHeight()-t.height()+(t.outerHeight()-t.innerHeight())}o.css("max-height",Math.round(s))}},b=function(){var t=e(this),a=t.data(i),o=e("#mCSB_"+a.idx),n=e("#mCSB_"+a.idx+"_container"),r=[e("#mCSB_"+a.idx+"_dragger_vertical"),e("#mCSB_"+a.idx+"_dragger_horizontal")],s=[o.height()/n.outerHeight(false),o.width()/n.outerWidth(false)],c=[parseInt(r[0].css("min-height")),Math.round(s[0]*r[0].parent().height()),parseInt(r[1].css("min-width")),Math.round(s[1]*r[1].parent().width())],d=l&&c[1]<c[0]?c[0]:c[1],f=l&&c[3]<c[2]?c[2]:c[3];r[0].css({height:d,"max-height":r[0].parent().height()-10}).find(".mCSB_dragger_bar").css({"line-height":c[0]+"px"});r[1].css({width:f,"max-width":r[1].parent().width()-10})},C=function(){var t=e(this),a=t.data(i),o=e("#mCSB_"+a.idx),n=e("#mCSB_"+a.idx+"_container"),r=[e("#mCSB_"+a.idx+"_dragger_vertical"),e("#mCSB_"+a.idx+"_dragger_horizontal")],l=[n.outerHeight(false)-o.height(),n.outerWidth(false)-o.width()],s=[l[0]/(r[0].parent().height()-r[0].height()),l[1]/(r[1].parent().width()-r[1].width())];a.scrollRatio={y:s[0],x:s[1]}},y=function(e,t,i){var a=i?d[0]+"_expanded":"",o=e.closest(".mCSB_scrollTools");if(t==="active"){e.toggleClass(d[0]+" "+a);o.toggleClass(d[1]);e[0]._draggable=e[0]._draggable?0:1}else{if(!e[0]._draggable){if(t==="hide"){e.removeClass(d[0]);o.removeClass(d[1])}else{e.addClass(d[0]);o.addClass(d[1])}}}},B=function(){var t=e(this),a=t.data(i),o=e("#mCSB_"+a.idx),n=e("#mCSB_"+a.idx+"_container"),r=a.overflowed==null?n.height():n.outerHeight(false),l=a.overflowed==null?n.width():n.outerWidth(false);return[r>o.height(),l>o.width()]},T=function(){var t=e(this),a=t.data(i),o=a.opt,n=e("#mCSB_"+a.idx),r=e("#mCSB_"+a.idx+"_container"),l=[e("#mCSB_"+a.idx+"_dragger_vertical"),e("#mCSB_"+a.idx+"_dragger_horizontal")];V(t);if(o.axis!=="x"&&!a.overflowed[0]||o.axis==="y"&&a.overflowed[0]){l[0].add(r).css("top",0);Q(t,"_resetY")}if(o.axis!=="y"&&!a.overflowed[1]||o.axis==="x"&&a.overflowed[1]){var s=dx=0;if(a.langDir==="rtl"){s=n.width()-r.outerWidth(false);dx=Math.abs(s/a.scrollRatio.x)}r.css("left",s);l[1].css("left",dx);Q(t,"_resetX")}},k=function(){var t=e(this),a=t.data(i),o=a.opt;if(!a.bindEvents){R.call(this);if(o.contentTouchScroll){D.call(this)}E.call(this);if(o.mouseWheel.enable){function n(){r=setTimeout(function(){if(!e.event.special.mousewheel){n()}else{clearTimeout(r);W.call(t[0])}},100)}var r;n()}P.call(this);H.call(this);if(o.advanced.autoScrollOnFocus){z.call(this)}if(o.scrollButtons.enable){U.call(this)}if(o.keyboard.enable){F.call(this)}a.bindEvents=true}},M=function(){var t=e(this),a=t.data(i),o=a.opt,n=i+"_"+a.idx,r=".mCSB_"+a.idx+"_scrollbar",l=e("#mCSB_"+a.idx+",#mCSB_"+a.idx+"_container,#mCSB_"+a.idx+"_container_wrapper,"+r+" ."+d[12]+",#mCSB_"+a.idx+"_dragger_vertical,#mCSB_"+a.idx+"_dragger_horizontal,"+r+">a"),s=e("#mCSB_"+a.idx+"_container");if(o.advanced.releaseDraggableSelectors){l.add(e(o.advanced.releaseDraggableSelectors))}if(a.bindEvents){e(document).unbind("."+n);l.each(function(){e(this).unbind("."+n)});clearTimeout(t[0]._focusTimeout);Z(t[0],"_focusTimeout");clearTimeout(a.sequential.step);Z(a.sequential,"step");clearTimeout(s[0].onCompleteTimeout);Z(s[0],"onCompleteTimeout");a.bindEvents=false}},O=function(t){var a=e(this),o=a.data(i),n=o.opt,r=e("#mCSB_"+o.idx+"_container_wrapper"),l=r.length?r:e("#mCSB_"+o.idx+"_container"),s=[e("#mCSB_"+o.idx+"_scrollbar_vertical"),e("#mCSB_"+o.idx+"_scrollbar_horizontal")],c=[s[0].find(".mCSB_dragger"),s[1].find(".mCSB_dragger")];if(n.axis!=="x"){if(o.overflowed[0]&&!t){s[0].add(c[0]).add(s[0].children("a")).css("display","block");l.removeClass(d[8]+" "+d[10])}else{if(n.alwaysShowScrollbar){if(n.alwaysShowScrollbar!==2){c[0].css("display","none")}l.removeClass(d[10])}else{s[0].css("display","none");l.addClass(d[10])}l.addClass(d[8])}}if(n.axis!=="y"){if(o.overflowed[1]&&!t){s[1].add(c[1]).add(s[1].children("a")).css("display","block");l.removeClass(d[9]+" "+d[11])}else{if(n.alwaysShowScrollbar){if(n.alwaysShowScrollbar!==2){c[1].css("display","none")}l.removeClass(d[11])}else{s[1].css("display","none");l.addClass(d[11])}l.addClass(d[9])}}if(!o.overflowed[0]&&!o.overflowed[1]){a.addClass(d[5])}else{a.removeClass(d[5])}},I=function(e){var t=e.type;switch(t){case"pointerdown":case"MSPointerDown":case"pointermove":case"MSPointerMove":case"pointerup":case"MSPointerUp":return e.target.ownerDocument!==document?[e.originalEvent.screenY,e.originalEvent.screenX,false]:[e.originalEvent.pageY,e.originalEvent.pageX,false];break;case"touchstart":case"touchmove":case"touchend":var i=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0],a=e.originalEvent.touches.length||e.originalEvent.changedTouches.length;return e.target.ownerDocument!==document?[i.screenY,i.screenX,a>1]:[i.pageY,i.pageX,a>1];break;default:return[e.pageY,e.pageX,false]}},R=function(){var t=e(this),a=t.data(i),o=a.opt,n=i+"_"+a.idx,r=["mCSB_"+a.idx+"_dragger_vertical","mCSB_"+a.idx+"_dragger_horizontal"],c=e("#mCSB_"+a.idx+"_container"),d=e("#"+r[0]+",#"+r[1]),f,u,h,m=o.advanced.releaseDraggableSelectors?d.add(e(o.advanced.releaseDraggableSelectors)):d;d.bind("mousedown."+n+" touchstart."+n+" pointerdown."+n+" MSPointerDown."+n,function(i){i.stopImmediatePropagation();i.preventDefault();if(!$(i)){return}s=true;if(l){document.onselectstart=function(){return false}}p(false);V(t);f=e(this);var a=f.offset(),n=I(i)[0]-a.top,r=I(i)[1]-a.left,c=f.height()+a.top,d=f.width()+a.left;if(n<c&&n>0&&r<d&&r>0){u=n;h=r}y(f,"active",o.autoExpandScrollbar)}).bind("touchmove."+n,function(e){e.stopImmediatePropagation();e.preventDefault();var t=f.offset(),i=I(e)[0]-t.top,a=I(e)[1]-t.left;g(u,h,i,a)});e(document).bind("mousemove."+n+" pointermove."+n+" MSPointerMove."+n,function(e){if(f){var t=f.offset(),i=I(e)[0]-t.top,a=I(e)[1]-t.left;if(u===i){return}g(u,h,i,a)}}).add(m).bind("mouseup."+n+" touchend."+n+" pointerup."+n+" MSPointerUp."+n,function(e){if(f){y(f,"active",o.autoExpandScrollbar);f=null}s=false;if(l){document.onselectstart=null}p(true)});function p(e){var t=c.find("iframe");if(!t.length){return}var i=!e?"none":"auto";t.css("pointer-events",i)}function g(e,i,n,l){c[0].idleTimer=o.scrollInertia<233?250:0;if(f.attr("id")===r[1]){var s="x",d=(f[0].offsetLeft-i+l)*a.scrollRatio.x}else{var s="y",d=(f[0].offsetTop-e+n)*a.scrollRatio.y}Q(t,d.toString(),{dir:s,drag:true})}},D=function(){var t=e(this),a=t.data(i),o=a.opt,n=i+"_"+a.idx,r=e("#mCSB_"+a.idx),l=e("#mCSB_"+a.idx+"_container"),d=[e("#mCSB_"+a.idx+"_dragger_vertical"),e("#mCSB_"+a.idx+"_dragger_horizontal")],f,u,h,m,p=[],g=[],v,x,_,w,S,b,C=0,y,B=o.axis==="yx"?"none":"all",T=[],k,M,O=l.find("iframe"),R=["touchstart."+n+" pointerdown."+n+" MSPointerDown."+n,"touchmove."+n+" pointermove."+n+" MSPointerMove."+n,"touchend."+n+" pointerup."+n+" MSPointerUp."+n];l.bind(R[0],function(e){D(e)}).bind(R[1],function(e){E(e)});r.bind(R[0],function(e){W(e)}).bind(R[2],function(e){A(e)});if(O.length){O.each(function(){e(this).load(function(){if(L(this)){e(this.contentDocument||this.contentWindow.document).bind(R[0],function(e){D(e);W(e)}).bind(R[1],function(e){E(e)}).bind(R[2],function(e){A(e)})}})})}function D(e){if(!et(e)||s||I(e)[2]){c=0;return}c=1;k=0;M=0;t.removeClass("mCS_touch_action");var i=l.offset();f=I(e)[0]-i.top;u=I(e)[1]-i.left;T=[I(e)[0],I(e)[1]]}function E(e){if(!et(e)||s||I(e)[2]){return}e.stopImmediatePropagation();if(M&&!k){return}x=J();var i=r.offset(),n=I(e)[0]-i.top,c=I(e)[1]-i.left,h="mcsLinearOut";p.push(n);g.push(c);T[2]=Math.abs(I(e)[0]-T[0]);T[3]=Math.abs(I(e)[1]-T[1]);if(a.overflowed[0]){var m=d[0].parent().height()-d[0].height(),v=f-n>0&&n-f>-(m*a.scrollRatio.y)&&(T[3]*2<T[2]||o.axis==="yx")}if(a.overflowed[1]){var _=d[1].parent().width()-d[1].width(),w=u-c>0&&c-u>-(_*a.scrollRatio.x)&&(T[2]*2<T[3]||o.axis==="yx")}if(v||w){e.preventDefault();k=1}else{M=1;t.addClass("mCS_touch_action")}b=o.axis==="yx"?[f-n,u-c]:o.axis==="x"?[null,u-c]:[f-n,null];l[0].idleTimer=250;if(a.overflowed[0]){z(b[0],C,h,"y","all",true)}if(a.overflowed[1]){z(b[1],C,h,"x",B,true)}}function W(e){if(!et(e)||s||I(e)[2]){c=0;return}c=1;e.stopImmediatePropagation();V(t);v=J();var i=r.offset();h=I(e)[0]-i.top;m=I(e)[1]-i.left;p=[];g=[]}function A(e){if(!et(e)||s||I(e)[2]){return}e.stopImmediatePropagation();k=0;M=0;_=J();var t=r.offset(),i=I(e)[0]-t.top,n=I(e)[1]-t.left;if(_-x>30){return}S=1e3/(_-v);var c="mcsEaseOut",d=S<2.5,f=d?[p[p.length-2],g[g.length-2]]:[0,0];w=d?[i-f[0],n-f[1]]:[i-h,n-m];var u=[Math.abs(w[0]),Math.abs(w[1])];S=d?[Math.abs(w[0]/4),Math.abs(w[1]/4)]:[S,S];var C=[Math.abs(l[0].offsetTop)-w[0]*P(u[0]/S[0],S[0]),Math.abs(l[0].offsetLeft)-w[1]*P(u[1]/S[1],S[1])];b=o.axis==="yx"?[C[0],C[1]]:o.axis==="x"?[null,C[1]]:[C[0],null];y=[u[0]*4+o.scrollInertia,u[1]*4+o.scrollInertia];var T=parseInt(o.contentTouchScroll)||0;b[0]=u[0]>T?b[0]:0;b[1]=u[1]>T?b[1]:0;if(a.overflowed[0]){z(b[0],y[0],c,"y",B,false)}if(a.overflowed[1]){z(b[1],y[1],c,"x",B,false)}}function P(e,t){var i=[t*1.5,t*2,t/1.5,t/2];if(e>90){return t>4?i[0]:i[3]}else if(e>60){return t>3?i[3]:i[2]}else if(e>30){return t>8?i[1]:t>6?i[0]:t>4?t:i[2]}else{return t>8?t:i[3]}}function z(e,i,a,o,n,r){if(!e){return}Q(t,e.toString(),{dur:i,scrollEasing:a,dir:o,overwrite:n,drag:r})}},E=function(){var t=e(this),a=t.data(i),o=a.opt,n=a.sequential,r=i+"_"+a.idx,l=e("#mCSB_"+a.idx+"_container"),d=l.parent(),f;l.bind("mousedown."+r,function(e){if(c){return}if(!f){f=1;s=true}}).add(document).bind("mousemove."+r,function(e){if(!c&&f&&u()){var t=l.offset(),i=I(e)[0]-t.top+l[0].offsetTop,r=I(e)[1]-t.left+l[0].offsetLeft;if(i>0&&i<d.height()&&r>0&&r<d.width()){if(n.step){h("off",null,"stepped")}}else{if(o.axis!=="x"&&a.overflowed[0]){if(i<0){h("on",38)}else if(i>d.height()){h("on",40)}}if(o.axis!=="y"&&a.overflowed[1]){if(r<0){h("on",37)}else if(r>d.width()){h("on",39)}}}}}).bind("mouseup."+r,function(e){if(c){return}if(f){f=0;h("off",null)}s=false});function u(){return window.getSelection?window.getSelection().toString():document.selection&&document.selection.type!="Control"?document.selection.createRange().text:0}function h(e,i,a){n.type=a&&f?"stepped":"stepless";n.scrollAmount=10;q(t,e,i,"mcsLinearOut",a?60:null)}},W=function(){if(!e(this).data(i)){return}var t=e(this),a=t.data(i),o=a.opt,n=i+"_"+a.idx,r=e("#mCSB_"+a.idx),s=[e("#mCSB_"+a.idx+"_dragger_vertical"),e("#mCSB_"+a.idx+"_dragger_horizontal")],c=e("#mCSB_"+a.idx+"_container").find("iframe");if(c.length){c.each(function(){e(this).load(function(){if(L(this)){e(this.contentDocument||this.contentWindow.document).bind("mousewheel."+n,function(e,t){d(e,t)})}})})}r.bind("mousewheel."+n,function(e,t){d(e,t)});function d(i,n){V(t);if(A(t,i.target)){return}var c=o.mouseWheel.deltaFactor!=="auto"?parseInt(o.mouseWheel.deltaFactor):l&&i.deltaFactor<100?100:i.deltaFactor||100;if(o.axis==="x"||o.mouseWheel.axis==="x"){var d="x",f=[Math.round(c*a.scrollRatio.x),parseInt(o.mouseWheel.scrollAmount)],u=o.mouseWheel.scrollAmount!=="auto"?f[1]:f[0]>=r.width()?r.width()*.9:f[0],h=Math.abs(e("#mCSB_"+a.idx+"_container")[0].offsetLeft),m=s[1][0].offsetLeft,p=s[1].parent().width()-s[1].width(),g=i.deltaX||i.deltaY||n}else{var d="y",f=[Math.round(c*a.scrollRatio.y),parseInt(o.mouseWheel.scrollAmount)],u=o.mouseWheel.scrollAmount!=="auto"?f[1]:f[0]>=r.height()?r.height()*.9:f[0],h=Math.abs(e("#mCSB_"+a.idx+"_container")[0].offsetTop),m=s[0][0].offsetTop,p=s[0].parent().height()-s[0].height(),g=i.deltaY||n}if(d==="y"&&!a.overflowed[0]||d==="x"&&!a.overflowed[1]){return}if(o.mouseWheel.invert||i.webkitDirectionInvertedFromDevice){g=-g}if(o.mouseWheel.normalizeDelta){g=g<0?-1:1}if(g>0&&m!==0||g<0&&m!==p||o.mouseWheel.preventDefault){i.stopImmediatePropagation();i.preventDefault()}Q(t,(h-g*u).toString(),{dir:d})}},L=function(e){var t=null;try{var i=e.contentDocument||e.contentWindow.document;t=i.body.innerHTML}catch(a){}return t!==null},A=function(t,a){var o=a.nodeName.toLowerCase(),n=t.data(i).opt.mouseWheel.disableOver,r=["select","textarea"];return e.inArray(o,n)>-1&&!(e.inArray(o,r)>-1&&!e(a).is(":focus"))},P=function(){var t=e(this),a=t.data(i),o=i+"_"+a.idx,n=e("#mCSB_"+a.idx+"_container"),r=n.parent(),l=e(".mCSB_"+a.idx+"_scrollbar ."+d[12]);l.bind("touchstart."+o+" pointerdown."+o+" MSPointerDown."+o,function(e){s=true}).bind("touchend."+o+" pointerup."+o+" MSPointerUp."+o,function(e){s=false}).bind("click."+o,function(i){if(e(i.target).hasClass(d[12])||e(i.target).hasClass("mCSB_draggerRail")){V(t);var o=e(this),l=o.find(".mCSB_dragger");if(o.parent(".mCSB_scrollTools_horizontal").length>0){if(!a.overflowed[1]){return}var s="x",c=i.pageX>l.offset().left?-1:1,f=Math.abs(n[0].offsetLeft)-c*(r.width()*.9)}else{if(!a.overflowed[0]){return}var s="y",c=i.pageY>l.offset().top?-1:1,f=Math.abs(n[0].offsetTop)-c*(r.height()*.9)}Q(t,f.toString(),{dir:s,scrollEasing:"mcsEaseInOut"})}})},z=function(){var t=e(this),a=t.data(i),o=a.opt,n=i+"_"+a.idx,r=e("#mCSB_"+a.idx+"_container"),l=r.parent();r.bind("focusin."+n,function(i){var a=e(document.activeElement),n=r.find(".mCustomScrollBox").length,s=0;if(!a.is(o.advanced.autoScrollOnFocus)){return}V(t);clearTimeout(t[0]._focusTimeout);t[0]._focusTimer=n?(s+17)*n:0;t[0]._focusTimeout=setTimeout(function(){var e=[it(a)[0],it(a)[1]],i=[r[0].offsetTop,r[0].offsetLeft],n=[i[0]+e[0]>=0&&i[0]+e[0]<l.height()-a.outerHeight(false),i[1]+e[1]>=0&&i[0]+e[1]<l.width()-a.outerWidth(false)],c=o.axis==="yx"&&!n[0]&&!n[1]?"none":"all";if(o.axis!=="x"&&!n[0]){Q(t,e[0].toString(),{dir:"y",scrollEasing:"mcsEaseInOut",overwrite:c,dur:s})}if(o.axis!=="y"&&!n[1]){Q(t,e[1].toString(),{dir:"x",scrollEasing:"mcsEaseInOut",overwrite:c,dur:s})}},t[0]._focusTimer)})},H=function(){var t=e(this),a=t.data(i),o=i+"_"+a.idx,n=e("#mCSB_"+a.idx+"_container").parent();n.bind("scroll."+o,function(t){if(n.scrollTop()!==0||n.scrollLeft()!==0){e(".mCSB_"+a.idx+"_scrollbar").css("visibility","hidden")}})},U=function(){var t=e(this),a=t.data(i),o=a.opt,n=a.sequential,r=i+"_"+a.idx,l=".mCSB_"+a.idx+"_scrollbar",c=e(l+">a");c.bind("mousedown."+r+" touchstart."+r+" pointerdown."+r+" MSPointerDown."+r+" mouseup."+r+" touchend."+r+" pointerup."+r+" MSPointerUp."+r+" mouseout."+r+" pointerout."+r+" MSPointerOut."+r+" click."+r,function(i){i.preventDefault();if(!$(i)){return}var r=e(this).attr("class");n.type=o.scrollButtons.scrollType;switch(i.type){case"mousedown":case"touchstart":case"pointerdown":case"MSPointerDown":if(n.type==="stepped"){return}s=true;a.tweenRunning=false;l("on",r);break;case"mouseup":case"touchend":case"pointerup":case"MSPointerUp":case"mouseout":case"pointerout":case"MSPointerOut":if(n.type==="stepped"){return}s=false;if(n.dir){l("off",r)}break;case"click":if(n.type!=="stepped"||a.tweenRunning){return}l("on",r);break}function l(e,i){n.scrollAmount=o.snapAmount||o.scrollButtons.scrollAmount;q(t,e,i)}})},F=function(){var t=e(this),a=t.data(i),o=a.opt,n=a.sequential,r=i+"_"+a.idx,l=e("#mCSB_"+a.idx),s=e("#mCSB_"+a.idx+"_container"),c=s.parent(),d="input,textarea,select,datalist,keygen,[contenteditable='true']",f=s.find("iframe"),u=["blur."+r+" keydown."+r+" keyup."+r];if(f.length){f.each(function(){e(this).load(function(){if(L(this)){e(this.contentDocument||this.contentWindow.document).bind(u[0],function(e){h(e)})}})})}l.attr("tabindex","0").bind(u[0],function(e){h(e)});function h(i){switch(i.type){case"blur":if(a.tweenRunning&&n.dir){m("off",null)}break;case"keydown":case"keyup":var r=i.keyCode?i.keyCode:i.which,l="on";if(o.axis!=="x"&&(r===38||r===40)||o.axis!=="y"&&(r===37||r===39)){if((r===38||r===40)&&!a.overflowed[0]||(r===37||r===39)&&!a.overflowed[1]){return}if(i.type==="keyup"){l="off"}if(!e(document.activeElement).is(d)){i.preventDefault();i.stopImmediatePropagation();m(l,r)}}else if(r===33||r===34){if(a.overflowed[0]||a.overflowed[1]){i.preventDefault();i.stopImmediatePropagation()}if(i.type==="keyup"){V(t);var f=r===34?-1:1;if(o.axis==="x"||o.axis==="yx"&&a.overflowed[1]&&!a.overflowed[0]){var u="x",h=Math.abs(s[0].offsetLeft)-f*(c.width()*.9)}else{var u="y",h=Math.abs(s[0].offsetTop)-f*(c.height()*.9)}Q(t,h.toString(),{dir:u,scrollEasing:"mcsEaseInOut"})}}else if(r===35||r===36){if(!e(document.activeElement).is(d)){if(a.overflowed[0]||a.overflowed[1]){i.preventDefault();i.stopImmediatePropagation()}if(i.type==="keyup"){if(o.axis==="x"||o.axis==="yx"&&a.overflowed[1]&&!a.overflowed[0]){var u="x",h=r===35?Math.abs(c.width()-s.outerWidth(false)):0}else{var u="y",h=r===35?Math.abs(c.height()-s.outerHeight(false)):0}Q(t,h.toString(),{dir:u,scrollEasing:"mcsEaseInOut"})}}}break}function m(e,i){n.type=o.keyboard.scrollType;n.scrollAmount=o.snapAmount||o.keyboard.scrollAmount;if(n.type==="stepped"&&a.tweenRunning){return}q(t,e,i)}}},q=function(t,a,o,n,r){var l=t.data(i),s=l.opt,c=l.sequential,f=e("#mCSB_"+l.idx+"_container"),u=c.type==="stepped"?true:false,h=s.scrollInertia<26?26:s.scrollInertia,m=s.scrollInertia<1?17:s.scrollInertia;switch(a){case"on":c.dir=[o===d[16]||o===d[15]||o===39||o===37?"x":"y",o===d[13]||o===d[15]||o===38||o===37?-1:1];V(t);if(tt(o)&&c.type==="stepped"){return}p(u);break;case"off":g();if(u||l.tweenRunning&&c.dir){p(true)}break}function p(e){var i=c.type!=="stepped",a=r?r:!e?1e3/60:i?h/1.5:m,o=!e?2.5:i?7.5:40,s=[Math.abs(f[0].offsetTop),Math.abs(f[0].offsetLeft)],d=[l.scrollRatio.y>10?10:l.scrollRatio.y,l.scrollRatio.x>10?10:l.scrollRatio.x],u=c.dir[0]==="x"?s[1]+c.dir[1]*(d[1]*o):s[0]+c.dir[1]*(d[0]*o),g=c.dir[0]==="x"?s[1]+c.dir[1]*parseInt(c.scrollAmount):s[0]+c.dir[1]*parseInt(c.scrollAmount),v=c.scrollAmount!=="auto"?g:u,x=n?n:!e?"mcsLinear":i?"mcsLinearOut":"mcsEaseInOut",_=!e?false:true;if(e&&a<17){v=c.dir[0]==="x"?s[1]:s[0]}Q(t,v.toString(),{dir:c.dir[0],scrollEasing:x,dur:a,onComplete:_});if(e){c.dir=false;return}clearTimeout(c.step);c.step=setTimeout(function(){p()},a)}function g(){clearTimeout(c.step);Z(c,"step");V(t)}},Y=function(t){var a=e(this).data(i).opt,o=[];if(typeof t==="function"){t=t()}if(!(t instanceof Array)){o[0]=t.y?t.y:t.x||a.axis==="x"?null:t;o[1]=t.x?t.x:t.y||a.axis==="y"?null:t}else{o=t.length>1?[t[0],t[1]]:a.axis==="x"?[null,t[0]]:[t[0],null]}if(typeof o[0]==="function"){o[0]=o[0]()}if(typeof o[1]==="function"){o[1]=o[1]()}return o},j=function(t,a){if(t==null||typeof t=="undefined"){return}var o=e(this),n=o.data(i),r=n.opt,l=e("#mCSB_"+n.idx+"_container"),s=l.parent(),c=typeof t;if(!a){a=r.axis==="x"?"x":"y"}var d=a==="x"?l.outerWidth(false):l.outerHeight(false),u=a==="x"?l[0].offsetLeft:l[0].offsetTop,h=a==="x"?"left":"top";switch(c){case"function":return t();break;case"object":var m=t.jquery?t:e(t);if(!m.length){return}return a==="x"?it(m)[1]:it(m)[0];break;case"string":case"number":if(tt(t)){return Math.abs(t)}else if(t.indexOf("%")!==-1){return Math.abs(d*parseInt(t)/100)}else if(t.indexOf("-=")!==-1){return Math.abs(u-parseInt(t.split("-=")[1]))}else if(t.indexOf("+=")!==-1){var p=u+parseInt(t.split("+=")[1]);return p>=0?0:Math.abs(p)}else if(t.indexOf("px")!==-1&&tt(t.split("px")[0])){return Math.abs(t.split("px")[0])}else{if(t==="top"||t==="left"){return 0}else if(t==="bottom"){return Math.abs(s.height()-l.outerHeight(false))}else if(t==="right"){return Math.abs(s.width()-l.outerWidth(false))}else if(t==="first"||t==="last"){var m=l.find(":"+t);return a==="x"?it(m)[1]:it(m)[0]}else{if(e(t).length){return a==="x"?it(e(t))[1]:it(e(t))[0]}else{l.css(h,t);f.update.call(null,o[0]);return}}}break}},X=function(t){var a=e(this),o=a.data(i),n=o.opt,r=e("#mCSB_"+o.idx+"_container");if(t){clearTimeout(r[0].autoUpdate);Z(r[0],"autoUpdate");return}var l=r.parent(),s=[e("#mCSB_"+o.idx+"_scrollbar_vertical"),e("#mCSB_"+o.idx+"_scrollbar_horizontal")],c=function(){return[s[0].is(":visible")?s[0].outerHeight(true):0,s[1].is(":visible")?s[1].outerWidth(true):0]},u=S(),h,m=[r.outerHeight(false),r.outerWidth(false),l.height(),l.width(),c()[0],c()[1]],p,g=_(),v;x();function x(){clearTimeout(r[0].autoUpdate);if(a.parents("html").length===0){a=null;return}r[0].autoUpdate=setTimeout(function(){if(n.advanced.updateOnSelectorChange){h=S();if(h!==u){b(3);u=h;return}}if(n.advanced.updateOnContentResize){p=[r.outerHeight(false),r.outerWidth(false),l.height(),l.width(),c()[0],c()[1]];if(p[0]!==m[0]||p[1]!==m[1]||p[2]!==m[2]||p[3]!==m[3]||p[4]!==m[4]||p[5]!==m[5]){b(p[0]!==m[0]||p[1]!==m[1]);m=p}}if(n.advanced.updateOnImageLoad){v=_();if(v!==g){r.find("img").each(function(){w(this)});g=v}}if(n.advanced.updateOnSelectorChange||n.advanced.updateOnContentResize||n.advanced.updateOnImageLoad){x()}},n.advanced.autoUpdateTimeout)}function _(){var e=0;if(n.advanced.updateOnImageLoad){e=r.find("img").length}return e}function w(t){if(e(t).hasClass(d[2])){b();return}var i=new Image;function a(e,t){return function(){return t.apply(e,arguments)}}function o(){this.onload=null;e(t).addClass(d[2]);b(2)}i.onload=a(i,o);i.src=t.src}function S(){if(n.advanced.updateOnSelectorChange===true){n.advanced.updateOnSelectorChange="*"}var t=0,i=r.find(n.advanced.updateOnSelectorChange);if(n.advanced.updateOnSelectorChange&&i.length>0){i.each(function(){t+=e(this).height()+e(this).width()})}return t}function b(e){clearTimeout(r[0].autoUpdate);f.update.call(null,a[0],e)}},N=function(e,t,i){return Math.round(e/t)*t-i},V=function(t){var a=t.data(i),o=e("#mCSB_"+a.idx+"_container,#mCSB_"+a.idx+"_container_wrapper,#mCSB_"+a.idx+"_dragger_vertical,#mCSB_"+a.idx+"_dragger_horizontal");o.each(function(){K.call(this)})},Q=function(t,a,o){var n=t.data(i),r=n.opt,l={trigger:"internal",dir:"y",scrollEasing:"mcsEaseOut",drag:false,dur:r.scrollInertia,overwrite:"all",callbacks:true,onStart:true,onUpdate:true,onComplete:true},o=e.extend(l,o),s=[o.dur,o.drag?0:o.dur],c=e("#mCSB_"+n.idx),d=e("#mCSB_"+n.idx+"_container"),f=d.parent(),u=r.callbacks.onTotalScrollOffset?Y.call(t,r.callbacks.onTotalScrollOffset):[0,0],h=r.callbacks.onTotalScrollBackOffset?Y.call(t,r.callbacks.onTotalScrollBackOffset):[0,0];n.trigger=o.trigger;if(f.scrollTop()!==0||f.scrollLeft()!==0){e(".mCSB_"+n.idx+"_scrollbar").css("visibility","visible");f.scrollTop(0).scrollLeft(0)}if(a==="_resetY"&&!n.contentReset.y){if(C("onOverflowYNone")){r.callbacks.onOverflowYNone.call(t[0])}n.contentReset.y=1}if(a==="_resetX"&&!n.contentReset.x){if(C("onOverflowXNone")){r.callbacks.onOverflowXNone.call(t[0])}n.contentReset.x=1}if(a==="_resetY"||a==="_resetX"){return}if((n.contentReset.y||!t[0].mcs)&&n.overflowed[0]){if(C("onOverflowY")){r.callbacks.onOverflowY.call(t[0])}n.contentReset.x=null}if((n.contentReset.x||!t[0].mcs)&&n.overflowed[1]){if(C("onOverflowX")){r.callbacks.onOverflowX.call(t[0])}n.contentReset.x=null}if(r.snapAmount){a=N(a,r.snapAmount,r.snapOffset)}switch(o.dir){case"x":var m=e("#mCSB_"+n.idx+"_dragger_horizontal"),p="left",g=d[0].offsetLeft,v=[c.width()-d.outerWidth(false),m.parent().width()-m.width()],x=[a,a===0?0:a/n.scrollRatio.x],_=u[1],w=h[1],S=_>0?_/n.scrollRatio.x:0,b=w>0?w/n.scrollRatio.x:0;break;case"y":var m=e("#mCSB_"+n.idx+"_dragger_vertical"),p="top",g=d[0].offsetTop,v=[c.height()-d.outerHeight(false),m.parent().height()-m.height()],x=[a,a===0?0:a/n.scrollRatio.y],_=u[0],w=h[0],S=_>0?_/n.scrollRatio.y:0,b=w>0?w/n.scrollRatio.y:0;break}if(x[1]<0||x[0]===0&&x[1]===0){x=[0,0]}else if(x[1]>=v[1]){x=[v[0],v[1]]}else{x[0]=-x[0]}if(!t[0].mcs){T();if(C("onInit")){r.callbacks.onInit.call(t[0])}}clearTimeout(d[0].onCompleteTimeout);if(!n.tweenRunning&&(g===0&&x[0]>=0||g===v[0]&&x[0]<=v[0])){return}G(m[0],p,Math.round(x[1]),s[1],o.scrollEasing);G(d[0],p,Math.round(x[0]),s[0],o.scrollEasing,o.overwrite,{onStart:function(){if(o.callbacks&&o.onStart&&!n.tweenRunning){if(C("onScrollStart")){T();r.callbacks.onScrollStart.call(t[0])}n.tweenRunning=true;y(m);n.cbOffsets=B()}},onUpdate:function(){if(o.callbacks&&o.onUpdate){if(C("whileScrolling")){T();r.callbacks.whileScrolling.call(t[0])}}},onComplete:function(){if(o.callbacks&&o.onComplete){if(r.axis==="yx"){clearTimeout(d[0].onCompleteTimeout)}var e=d[0].idleTimer||0;d[0].onCompleteTimeout=setTimeout(function(){if(C("onScroll")){T();r.callbacks.onScroll.call(t[0])}if(C("onTotalScroll")&&x[1]>=v[1]-S&&n.cbOffsets[0]){T();r.callbacks.onTotalScroll.call(t[0])}if(C("onTotalScrollBack")&&x[1]<=b&&n.cbOffsets[1]){T();r.callbacks.onTotalScrollBack.call(t[0])}n.tweenRunning=false;d[0].idleTimer=0;y(m,"hide")},e)}}});function C(e){return n&&r.callbacks[e]&&typeof r.callbacks[e]==="function"}function B(){return[r.callbacks.alwaysTriggerOffsets||g>=v[0]+_,r.callbacks.alwaysTriggerOffsets||g<=-w]}function T(){var e=[d[0].offsetTop,d[0].offsetLeft],i=[m[0].offsetTop,m[0].offsetLeft],a=[d.outerHeight(false),d.outerWidth(false)],n=[c.height(),c.width()];t[0].mcs={content:d,top:e[0],left:e[1],draggerTop:i[0],draggerLeft:i[1],topPct:Math.round(100*Math.abs(e[0])/(Math.abs(a[0])-n[0])),leftPct:Math.round(100*Math.abs(e[1])/(Math.abs(a[1])-n[1])),direction:o.dir}}},G=function(e,t,i,a,o,n,r){if(!e._mTween){e._mTween={top:{},left:{}}}var r=r||{},l=r.onStart||function(){},s=r.onUpdate||function(){},c=r.onComplete||function(){},d=J(),f,u=0,h=e.offsetTop,m=e.style,p,g=e._mTween[t];if(t==="left"){h=e.offsetLeft}var v=i-h;g.stop=0;if(n!=="none"){S()}w();function x(){if(g.stop){return}if(!u){l.call()}u=J()-d;_();if(u>=g.time){g.time=u>g.time?u+f-(u-g.time):u+f-1;if(g.time<u+1){g.time=u+1}}if(g.time<a){g.id=p(x)}else{c.call()}}function _(){if(a>0){g.currVal=b(g.time,h,v,a,o);m[t]=Math.round(g.currVal)+"px"}else{m[t]=i+"px"}s.call()}function w(){f=1e3/60;g.time=u+f;p=!window.requestAnimationFrame?function(e){_();return setTimeout(e,.01)}:window.requestAnimationFrame;g.id=p(x)}function S(){if(g.id==null){return}if(!window.requestAnimationFrame){clearTimeout(g.id)}else{window.cancelAnimationFrame(g.id)}g.id=null}function b(e,t,i,a,o){switch(o){case"linear":case"mcsLinear":return i*e/a+t;break;case"mcsLinearOut":e/=a;e--;return i*Math.sqrt(1-e*e)+t;break;case"easeInOutSmooth":e/=a/2;if(e<1)return i/2*e*e+t;e--;return-i/2*(e*(e-2)-1)+t;break;case"easeInOutStrong":e/=a/2;if(e<1)return i/2*Math.pow(2,10*(e-1))+t;e--;return i/2*(-Math.pow(2,-10*e)+2)+t;break;case"easeInOut":case"mcsEaseInOut":e/=a/2;if(e<1)return i/2*e*e*e+t;e-=2;return i/2*(e*e*e+2)+t;break;case"easeOutSmooth":e/=a;e--;return-i*(e*e*e*e-1)+t;break;case"easeOutStrong":return i*(-Math.pow(2,-10*e/a)+1)+t;break;case"easeOut":case"mcsEaseOut":default:var n=(e/=a)*e,r=n*e;return t+i*(.499999999999997*r*n+-2.5*n*n+5.5*r+-6.5*n+4*e)}}},J=function(){if(window.performance&&window.performance.now){return window.performance.now()}else{if(window.performance&&window.performance.webkitNow){return window.performance.webkitNow()}else{if(Date.now){return Date.now()}else{return(new Date).getTime()}}}},K=function(){var e=this;if(!e._mTween){e._mTween={top:{},left:{}}}var t=["top","left"];for(var i=0;i<t.length;i++){var a=t[i];if(e._mTween[a].id){if(!window.requestAnimationFrame){clearTimeout(e._mTween[a].id)}else{window.cancelAnimationFrame(e._mTween[a].id)}e._mTween[a].id=null;e._mTween[a].stop=1}}},Z=function(e,t){try{delete e[t]}catch(i){e[t]=null}},$=function(e){return!(e.which&&e.which!==1)},et=function(e){var t=e.originalEvent.pointerType;return!(t&&t!=="touch"&&t!==2)},tt=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},it=function(e){var t=e.parents(".mCSB_container");return[e.offset().top-t.offset().top,e.offset().left-t.offset().left]};e.fn[t]=function(t){if(f[t]){return f[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof t==="object"||!t){return f.init.apply(this,arguments)}else{e.error("Method "+t+" does not exist")}};e[t]=function(t){if(f[t]){return f[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof t==="object"||!t){return f.init.apply(this,arguments)}else{e.error("Method "+t+" does not exist")}};e[t].defaults=o;window[t]=true;e(window).load(function(){e(a)[t]();e.extend(e.expr[":"],{mcsInView:e.expr[":"].mcsInView||function(t){var i=e(t),a=i.parents(".mCSB_container"),o,n;if(!a.length){return}o=a.parent();n=[a[0].offsetTop,a[0].offsetLeft];return n[0]+it(i)[0]>=0&&n[0]+it(i)[0]<o.height()-i.outerHeight(false)&&n[1]+it(i)[1]>=0&&n[1]+it(i)[1]<o.width()-i.outerWidth(false)},mcsOverflow:e.expr[":"].mcsOverflow||function(t){var a=e(t).data(i);if(!a){return}return a.overflowed[0]||a.overflowed[1]}})})})});(function(e){if(typeof exports==="object"){var i=require("jquery");module.exports=e(i||$)}else if(typeof define==="function"&&define.amd){define(["jquery"],e)}else{e(i||$)}})(function(e){var i={start:function(e){if(e)s.call(this,e);var i=this,t=setTimeout(function(){a.call(i)},1e3);this.data("ttStartTime",(new Date).getTime());this.data("intervalId",t)},stop:function(){var e=this.data();if(e.intervalId){clearTimeout(e.intervalId);this.data("intervalId",null)}return e},reset:function(e){var t=i.stop.call(this);this.find("div").css({backgroundPosition:"left center"});this.find("ul").parent().removeClass("timeTo-alert");if(typeof e==="undefined"){e=t.value}if(t.vals){t.vals=null}s.call(this,e)}};var t={en:{days:"days",hours:"hours",min:"minutes",sec:"seconds"},ru:{days:"дней",hours:"часов",min:"минут",sec:"секунд"},ua:{days:"днiв",hours:"годин",min:"хвилин",sec:"секунд"},de:{days:"Tag",hours:"Uhr",min:"Minuten",sec:"Secunden"},fr:{days:"jours",hours:"heures",min:"minutes",sec:"secondes"},sp:{days:"días",hours:"horas",min:"minutos",sec:"segundos"},it:{days:"giorni",hours:"ore",min:"minuti",sec:"secondi"},nl:{days:"dagen",hours:"uren",min:"minuten",sec:"seconden"},no:{days:"dager",hours:"timer",min:"minutter",sec:"sekunder"},pt:{days:"dias",hours:"horas",min:"minutos",sec:"segundos"},tr:{days:"gün",hours:"saat",min:"dakika",sec:"saniye"}};if(typeof e.support.transition==="undefined"){e.support.transition=function(){var e=document.body||document.documentElement,i=e.style,t=i.transition!==undefined||i.WebkitTransition!==undefined||i.MozTransition!==undefined||i.MsTransition!==undefined||i.OTransition!==undefined;return t}()}e.fn.timeTo=function(){var a={callback:null,captionSize:0,countdown:true,countdownAlertLimit:10,displayCaptions:false,displayDays:0,displayHours:true,displaySeconds:true,fontFamily:"Verdana, sans-serif",fontSize:28,lang:"en",seconds:0,start:true,theme:"white",vals:[0,0,0,0,0,0,0,0,0],limits:[9,9,9,2,9,5,9,5,9],iSec:8,iHour:4,tickTimeout:1e3,intervalId:null},n,l={};for(var o=0,r;r=arguments[o];++o){if(o==0&&typeof r==="string"){n=r}else{if(typeof r=="object"){if(typeof r.getTime==="function"){l.timeTo=r}else{l=e.extend(l,r)}}else{if(typeof r=="function"){l.callback=r}else{var d=parseInt(r);if(!isNaN(d)){l.seconds=d}}}}}if(l.timeTo){var f,u=(new Date).getTime();if(l.timeTo.getTime){f=l.timeTo.getTime()}else if(typeof l.timeTo==="number"){f=l.timeTo}if(l.timeTo>u){l.seconds=Math.floor((f-u)/1e3)}}else if(l.time||!l.seconds){var f=l.time;if(!f)f=new Date;if(typeof f==="object"&&f.getTime){l.seconds=f.getHours()*3600+f.getMinutes()*60+f.getSeconds();l.countdown=false}else if(typeof f==="string"){var c=f.split(":"),m=0,p=1,h;while(h=c.pop()){m+=h*p;p*=60}l.seconds=m;l.countdown=false}}if(l.countdown!==false&&l.seconds>86400&&typeof l.displayDays==="undefined"){var v=Math.floor(l.seconds/86400);l.displayDays=v<10&&1||v<100&&2||3}else if(l.displayDays===true){l.displayDays=3}else if(l.displayDays){l.displayDays=l.displayDays>0?Math.floor(l.displayDays):3}return this.each(function(){var o=e(this),r=o.data(),d;if(!r.vals){r=e.extend(a,l);r.height=Math.round(r.fontSize*100/93);r.width=Math.round(r.fontSize*.8+r.height*.13);r.displayHours=!!(r.displayDays||r.displayHours);o.addClass("timeTo").addClass("timeTo-"+r.theme).css({fontFamily:r.fontFamily,fontSize:r.fontSize+"px"});var f=Math.round(r.height/10),u="<ul><li>0</li><li>0</li></ul></div>",c="",m='<div class="first">'+u,p="<div>"+u,h="<span>:</span>",v="",y=r.displaySeconds?"":"display: none;",g=r.captionSize||Math.round(r.fontSize*.43);thtml=(r.displayCaptions?(r.displayHours?'<figure>$1<figcaption style="font-size:'+g+'px">'+t[r.lang].hours+"</figcaption></figure>"+h:"")+'<figure>$1<figcaption style="font-size:'+g+'px">'+t[r.lang].min+"</figcaption></figure>"+'<i style="font-style: normal !important; '+y+'">'+h+"</i>"+'<figure style="'+y+'">$1<figcaption style="font-size:'+g+'px">'+t[r.lang].sec+"</figcaption></figure>":(r.displayHours?"$1"+h:"")+"$1"+h+"$1").replace(/\$1/g,m+p);if(r.displayDays>0){var T=r.fontSize*.4,I=m;for(d=r.displayDays-1;d>0;d--){I+=d===1?p.replace('">'," margin-right:"+Math.round(T)+'px">'):p}thtml=(r.displayCaptions?'<figure>$1<figcaption style="font-size:'+g+'px;">'+t[r.lang].days+"</figcaption></figure>":"$1").replace(/\$1/,I)+h+thtml}o.html(thtml)}else{if(r.intervalId){clearInterval(r.intervalId);r.intervalId=null}e.extend(r,l)}var S=o.find("div");if(S.length<r.vals.length){var D=r.vals.length-S.length,b=r.vals,w=r.limits;r.vals=[];r.limits=[];for(d=0;d<S.length;d++){r.vals[d]=b[D+d];r.limits[d]=w[D+d]}r.iSec=r.vals.length-1;r.iHour=r.vals.length-5}r.sec=r.seconds;o.data(r);if(n&&i[n]){i[n].call(o,r.seconds)}else if(r.start){i.start.call(o,r.seconds)}else{s.call(o,r.seconds)}})};function s(e){var i=this.data(),t=this.find("ul");if(!i.vals||t.length===0)return;if(!e)e=i.seconds;var s=false;if(i.intervalId){s=true;clearTimeout(i.intervalId)}var n=Math.floor(e/86400),l=n*86400,o=Math.floor((e-l)/3600);l+=o*3600;var r=Math.floor((e-l)/60);l+=r*60;var d=e-l,f=(n<100?"0"+(n<10?"0":""):"")+n+(o<10?"0":"")+o+(r<10?"0":"")+r+(d<10?"0":"")+d;for(var u=i.vals.length-1,c=f.length-1,m;u>=0;u--,c--){m=parseInt(f.substr(c,1));i.vals[u]=m;t.eq(u).children().html(m)}if(s){var p=this;i.ttStartTime=Date.now();i.intervalId=setTimeout(function(){a.call(p)},1e3);this.data("intervalId",i.intervalId)}}function a(i){var t=this.find("ul"),s=this.data();if(!s.vals||t.length==0){if(s.intervalId){clearTimeout(s.intervalId);this.data("intervalId",null)}if(s.callback)s.callback();return}if(i==undefined){i=s.iSec}var n=s.vals[i],l=t.eq(i),o=l.children(),r=s.countdown?-1:1;o.eq(1).html(n);n+=r;if(i==s.iSec){var d=s.tickTimeout,f=(new Date).getTime()-s.ttStartTime;s.sec+=r;d+=Math.abs(s.seconds-s.sec)*d-f;s.intervalId=setTimeout(function(){a.call(u)},d)}if(n<0||n>s.limits[i]){if(n<0){n=s.limits[i];if(i==s.iHour&&s.displayDays>0&&i>0&&s.vals[i-1]==0)n=3}else n=0;if(i>0){a.call(this,i-1)}}o.eq(0).html(n);var u=this;if(e.support.transition){l.addClass("transition");l.css({top:0});setTimeout(function(){l.removeClass("transition");o.eq(1).html(n);l.css({top:"-50px"});if(r>0||i!=s.iSec)return;if(s.sec==s.countdownAlertLimit){t.parent().addClass("timeTo-alert")}if(s.sec===0){t.parent().removeClass("timeTo-alert");if(s.intervalId){clearTimeout(s.intervalId);u.data("intervalId",null)}if(typeof s.callback==="function")s.callback()}},410)}else{l.stop().animate({top:0},400,i!=s.iSec?null:function(){o.eq(1).html(n);l.css({top:"-50px"});if(r>0||i!=s.iSec)return;if(s.sec==s.countdownAlertLimit){t.parent().addClass("timeTo-alert")}else if(s.sec==0){t.parent().removeClass("timeTo-alert");if(s.intervalId){clearTimeout(s.intervalId);u.data("intervalId",null)}if(typeof s.callback==="function")s.callback()}})}s.vals[i]=n}return jQuery});(function(e){e.fn.extend({elastic:function(){var t=["paddingTop","paddingRight","paddingBottom","paddingLeft","fontSize","lineHeight","fontFamily","width","fontWeight","border-top-width","border-right-width","border-bottom-width","border-left-width","borderTopStyle","borderTopColor","borderRightStyle","borderRightColor","borderBottomStyle","borderBottomColor","borderLeftStyle","borderLeftColor"];return this.each(function(){if(this.type!=="textarea"){return false}var i=e(this),r=e("<div />").css({position:"absolute",display:"none","word-wrap":"break-word"}),o=parseInt(i.css("line-height"),10)||parseInt(i.css("font-size"),"10"),n=parseInt(i.css("height"),10)||o*3,h=parseInt(i.css("max-height"),10)||Number.MAX_VALUE,d=0;if(h<0){h=Number.MAX_VALUE}r.appendTo(i.parent());var a=t.length;while(a--){r.css(t[a].toString(),i.css(t[a].toString()))}function s(){curatedWidth=Math.floor(parseInt(i.width(),10));if(r.width()!==curatedWidth){r.css({width:curatedWidth+"px"});g(true)}}function p(e,t){var r=Math.floor(parseInt(e,10));if(i.height()!==r){i.css({height:r+"px",overflow:t});i.trigger("resize")}}function g(e){var t=i.val().replace(/&/g,"&amp;").replace(/ {2}/g,"&nbsp;").replace(/<|>/g,"&gt;").replace(/\n/g,"<br />");var d=r.html().replace(/<br>/gi,"<br />");if(e||t+"&nbsp;"!==d){r.html(t+"&nbsp;");if(Math.abs(r.height()+o-i.height())>3){var a=r.height()+o;if(a>=h){p(h,"auto")}else if(a<=n){p(n,"hidden")}else{p(a,"hidden")}}}}i.css({overflow:"hidden"});i.bind("keyup change cut paste",function(){g()});$(window).bind("resize",s);i.bind("resize",s);i.bind("update",g);i.bind("blur",function(){if(r.height()<h){if(r.height()>n){i.height(r.height())}else{i.height(n)}}});i.bind("input paste",function(e){setTimeout(g,250)});g()})}})})(jQuery);var O3Global=new function(){};var AjaxCodeConfig=new function(){this.STRUCTURAL_NO_XML=1;this.STRUCTURAL_NO_JSON=1;this.STRUCTURAL_NO_CODE=2;this.EVERYTHING=42;this.OK=0;this.ERROR=10;this.NO_LOGIN=20};var Ozone=new function(){var e=0;this.BASE_LINK="/?module=";this.DEFAULT_MODULE="Layout.Main";this.LOGIN_MODULE="Homepage";function t(){return Math.round((new Date).getTime()/1e3)}function n(n){e=t()-n}function r(){return t()-e}n(1409069052);this.setServerTime=n;this.getServerTime=r};var O3Repository=new function(){var e=-1;var t=new Array;function n(n){t[++e]=n;return e}function r(e,n){var r=t[e];t[e]=n;return r}function a(e){return t[e]}function i(e){return r(e,null)}function o(){t=new Array;e=-1}this.add=n;this.put=r;this.get=a;this.remove=i;this.reset=o};var JSON;if(!JSON){JSON={}}(function(){"use strict";function f(e){return e<10?"0"+e:e}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(e){escapable.lastIndex=0;return escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t==="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,a,i,o=gap,l,f=t[e];if(f&&typeof f==="object"&&typeof f.toJSON==="function"){f=f.toJSON(e)}if(typeof rep==="function"){f=rep.call(t,e,f)}switch(typeof f){case"string":return quote(f);case"number":return isFinite(f)?String(f):"null";case"boolean":case"null":return String(f);case"object":if(!f){return"null"}gap+=indent;l=[];if(Object.prototype.toString.apply(f)==="[object Array]"){i=f.length;for(n=0;n<i;n+=1){l[n]=str(n,f)||"null"}a=l.length===0?"[]":gap?"[\n"+gap+l.join(",\n"+gap)+"\n"+o+"]":"["+l.join(",")+"]";gap=o;return a}if(rep&&typeof rep==="object"){i=rep.length;for(n=0;n<i;n+=1){if(typeof rep[n]==="string"){r=rep[n];a=str(r,f);if(a){l.push(quote(r)+(gap?": ":":")+a)}}}}else{for(r in f){if(Object.prototype.hasOwnProperty.call(f,r)){a=str(r,f);if(a){l.push(quote(r)+(gap?": ":":")+a)}}}}a=l.length===0?"{}":gap?"{\n"+gap+l.join(",\n"+gap)+"\n"+o+"}":"{"+l.join(",")+"}";gap=o;return a}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(e,t,n){var r;gap="";indent="";if(typeof n==="number"){for(r=0;r<n;r+=1){indent+=" "}}else if(typeof n==="string"){indent=n}rep=t;if(t&&typeof t!=="function"&&(typeof t!=="object"||typeof t.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":e})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(e,t){var n,r,a=e[t];if(a&&typeof a==="object"){for(n in a){if(Object.prototype.hasOwnProperty.call(a,n)){r=walk(a,n);if(r!==undefined){a[n]=r}else{delete a[n]}}}}return reviver.call(e,t,a)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}})();var O3AjaxHandler=new function(){var e=Array();var t=Array();var n=null;var r=null;function a(t,n){if(typeof e[t]=="function")e[t](n)}function i(e,n){if(typeof t[e]=="function")t[e](n)}function o(t,n){e[t]=n}function l(e,n){t[e]=n}function f(e){n=e}function s(e){r=e}function u(){if(typeof n=="function")n()}function d(){if(typeof r=="function")r()}this.preHandle=a;this.handle=i;this.setGlobalPreHandler=o;this.setGlobalHandler=l;this.setIncPendingHandler=f;this.setDecPendingHandler=s;this.incrementPending=u;this.decrementPending=d};if(AjaxCodeConfig.STRUCTURAL_NO_XML)O3AjaxHandler.setGlobalHandler(AjaxCodeConfig.STRUCTURAL_NO_XML,function(e){alert("Structural error: no XML")});if(AjaxCodeConfig.STRUCTURAL_NO_CODE)O3AjaxHandler.setGlobalHandler(AjaxCodeConfig.STRUCTURAL_NO_CODE,function(e){alert("Structural error: no Code")});if(AjaxCodeConfig.NO_LOGIN)O3AjaxHandler.setGlobalHandler(AjaxCodeConfig.NO_LOGIN,function(e){top.location=Ozone.BASE_LINK+Ozone.LOGIN_MODULE});if(AjaxCodeConfig.ERROR){var fncHandleError=function(e){var t=e.getElementsByTagName("message")[0].firstChild.data;alert(t)};O3AjaxHandler.setGlobalHandler(AjaxCodeConfig.ERROR,fncHandleError)}var O3JsonHandler=new function(){var e=Array();var t=Array();function n(t,n){if(typeof e[t]=="function")e[t](n)}function r(e,n){if(typeof t[e]=="function")t[e](n)}function a(t,n){e[t]=n}function i(e,n){t[e]=n}this.preHandle=n;this.handle=r;this.setGlobalPreHandler=a;this.setGlobalHandler=i};if(AjaxCodeConfig.STRUCTURAL_NO_JSON)O3JsonHandler.setGlobalHandler(AjaxCodeConfig.STRUCTURAL_NO_JSON,function(e){alert("Structural error: no JSON")});if(AjaxCodeConfig.STRUCTURAL_NO_CODE)O3JsonHandler.setGlobalHandler(AjaxCodeConfig.STRUCTURAL_NO_CODE,function(e){alert("Structural error: no Code")});if(AjaxCodeConfig.NO_LOGIN)O3JsonHandler.setGlobalHandler(AjaxCodeConfig.NO_LOGIN,function(e){top.location=Ozone.BASE_LINK+Ozone.LOGIN_MODULE});if(AjaxCodeConfig.ERROR){var fncHandleError=function(e){var t=e.message;alert(t)};O3JsonHandler.setGlobalHandler(AjaxCodeConfig.ERROR,fncHandleError)}function O3Ajax(){var e=null;var t=null;var n=null;var r=null;var a=null;var i="";var o=Array();function l(){if(window.XMLHttpRequest)e=new XMLHttpRequest;else if(window.ActiveXObject){try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}}else return false;if(e==null)return false;e.onreadystatechange=v;a=new Array;return true}function f(e){for(sKey in e)a[sKey]=e[sKey]}function s(e){i+="&"+e}function u(e,t){a[e]=t}function d(){a=new Array}function c(){var e="";for(var t in a){if(typeof a[t]=="function")continue;if(O3Global.Types.isArray(a[t])){for(var n in a[t]){if(typeof a[t][n]=="function")continue;e+=O3Global.Types.encodeURL(t)+"["+O3Global.Types.encodeURL(n)+"]="+O3Global.Types.encodeURL(a[t][n])+"&"}}else e+=O3Global.Types.encodeURL(t)+"="+O3Global.Types.encodeURL(a[t])+"&"}e+=i;return e}function p(e){r=e}function h(e){n=e}function v(){if(e.readyState==4&&(e.status==200||window.location.href.indexOf("http")==-1)){if(window.O3AjaxHandler)O3AjaxHandler.decrementPending();if(t)t()}}function O(){if(e.responseXML&&e.responseXML.documentElement&&e.responseXML.documentElement.attributes.getNamedItem("code")){g();return}if(r){var t=O3Global.DOM.getById(r);if(t){t.innerHTML=e.responseText;t.disabled=""}}if(n)n(e.responseText)}function g(){var t=e.responseXML;if(t)t=t.documentElement;var n=AjaxCodeConfig.OK;if(!t){n=AjaxCodeConfig.STRUCTURAL_NO_XML;alert(e.responseText)}else{var r=t.attributes.getNamedItem("code");if(!r)n=AjaxCodeConfig.STRUCTURAL_NO_CODE;else{n=r.value;var a=t.attributes.getNamedItem("time");if(a)Ozone.setServerTime(a.value);var i=t.getElementsByTagName("debug");if(i){i=i[0];if(i){var l=i.childNodes;for(var f=0;f<l.length;f++){var s=l[f];if(!s.firstChild)continue;alert("Debug:\n\n"+s.firstChild.data)}}}}}O3AjaxHandler.preHandle(n,t);if(typeof o[n]=="function"){if(!o[n](t))O3AjaxHandler.handle(n,t)}else O3AjaxHandler.handle(n,t)}function y(){var t=null;try{t=JSON.parse(e.responseText)}catch(n){}var r=AjaxCodeConfig.OK;if(!t){r=AjaxCodeConfig.STRUCTURAL_NO_JSON;alert(e.responseText)}else{r=t.code;if(typeof r==="undefined")r=AjaxCodeConfig.STRUCTURAL_NO_CODE;else{if(typeof t.time!=="undefined")Ozone.setServerTime(t.time);if(O3Global.Types.isArray(t.debug)){for(var a=0;a<t.debug.length;a++)alert("Debug:\n\n"+t.debug[a])}}}O3JsonHandler.preHandle(r,t?t.data:null);if(typeof o[r]=="function"){if(!o[r](t?t.data:null))O3JsonHandler.handle(r,t?t.data:null)}else O3JsonHandler.handle(r,t?t.data:null)}function m(){var t=e.responseXML;if(t)t=t.documentElement;if(!t){alert(e.responseText);return}var r=t.attributes.getNamedItem("occurred");var a=false;if(!r||r.value=="error"){alert("Error; could not start message pump. Live updates are disabled!");return}a=r.value=="yes";var i="";if(a){a=false;var o=t.getElementsByTagName("command");if(o&&o[0]&&o[0].firstChild){a=true;i=o[0].firstChild.data}}if(n)n(a,i)}function C(t,n){var r=Ozone.BASE_LINK+t+"&action="+n+"&O3Request="+(new Date).getTime();var a=c();e.open("POST",r,true);e.setRequestHeader("Content-Type","application/x-www-form-urlencoded");e.send(a);O3AjaxHandler.incrementPending()}function b(e,n){t=O;C(e,n)}function A(e,n){t=g;C(e,n)}function T(e,n){t=y;C(e,n)}function N(n){t=m;e.open("POST","http://"+n+"/event",true);e.send(null)}function L(e,t){o[e]=t}if(!l())alert("Could not create O3Ajax. Your browser does not support XMLHttpRequest.");this.addPostData=f;this.addRawPostData=s;this.addPostValue=u;this.clearPostData=d;this.setContainer=p;this.setCallback=h;this.requestPage=b;this.requestXML=A;this.requestJSON=T;this.requestEvent=N;this.setHandler=L}O3Global.DOM=new function(){function e(e){if(document.all){return document.all[e]}else if(document.layers){return document.layers[e]}else if(document.getElementById){var t=document.getElementById(e);if(t==null){if(document.getElementsByName&&document.getElementsByName(e)&&document.getElementsByName(e)[0]){t=document.getElementsByName(e);if(t.length==1)t=t[0]}}if(t==null){for(var n in document.forms){var r=document.forms[n];if(r.elements&&r.elements[e]){t=r.elements[e];break}}}return t}else{return null}}function t(t){var n=e(t);if(!n)return;if(O3Global.Ajax)O3Global.Ajax.clearEntry(t);n.innerHTML=""}function n(t){var n=e(t);if(n&&n.style)n.style.display=""}function r(t){var n=e(t);if(n&&n.style)n.style.display="none"}function a(t){var n=e(t);if(n&&n.parentElement)n.parentElement.removeChild(n)}function i(e){var t=e.offsetLeft;while(e.offsetParent!=null){e=e.offsetParent;t+=e.offsetLeft}return t}function o(e){var t=e.offsetTop;while(e.offsetParent!=null){e=e.offsetParent;t+=e.offsetTop}return t}function l(t,n){var r=e(t);if(!r)return;if(r.filters&&r.filters.alpha)r.filters.alpha.opacity=n*100;else{r.style.KHTMLOpacity=n;r.style.MozOpacity=n;r.style.opacity=n}}function f(t,n,r,a){var i=e(t);if(!i)return false;var o=i.getElementsByTagName("tbody")[0];if(!o){o=document.createElement("tbody");i.appendChild(o)}var l=document.createElement("tr");if(a)l.id=a;for(var f=0;f<n.length;f++){var s=document.createElement("td");s.innerHTML=n[f];l.appendChild(s)}var u=null;if(r)u=e(r);if(u)o.insertBefore(l,u);else o.appendChild(l);return true}function s(t,n){var r=e(t);if(!r)return false;var a=r.getElementsByTagName("tbody")[0];if(!a)return false;var i=e(n);if(!i)return false;a.removeChild(i);return true}function u(e,t){if(e.currentStyle)return e.currentStyle[t];else if(window.getComputedStyle)return document.defaultView.getComputedStyle(e,null).getPropertyValue(t);return null}function d(t,n){var r=e(t);if(!r)return false;var a=new Image;a.src=r.src;r.width=Math.round(a.width*n);r.height=Math.round(a.height*n);return true}function c(e,t){if(!e)return;var n=e.scrollLeft-t;if(n<0)n=0;else if(n>e.scrollWidth)n=e.scrollWidth;e.scrollLeft=n}function p(e,t){if(!e)return;var n=e.scrollTop-t;if(n<0)n=0;if(n>e.scrollHeight)n=e.scrollHeight;e.scrollTop=n}function h(t,n){var r=e(t);if(r)r.className=n}this.getById=e;this.clearDiv=t;this.showDiv=n;this.hideDiv=r;this.removeDiv=a;this.getAbsoluteLeft=i;this.getAbsoluteTop=o;this.insertRow=f;this.removeRow=s;this.getStyle=u;this.zoomImage=d;this.scrollHorizontal=c;this.scrollVertical=p;this.setClass=h;this.setImageOpacity=l};O3Global.Types=new function(){function e(e){var t=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;return t.test(e)}function t(e){if(e&&e.constructor&&e.constructor.toString().indexOf("Array")!=-1)return true;return false}function n(e,n,r){if(!t(e)||!t(n))return false;for(var a in e){if(e[a]!=n[a])return false}if(!r){for(var a in n){if(e[a]!=n[a])return false}}return true}function r(e){if(e==null)return false;e=""+e;var t="-0123456789";var n;for(var r=0;r<e.length;r++){n=e.charAt(r);if(t.indexOf(n)==-1)return false}return true}function a(e){e=""+e;var t="0123456789"+"ABCDEFGHIJKLMNOPQRSTUVWXYZ"+"abcdefghijklmnopqrstuvwxyz"+"-_.!~*'()";var n="0123456789ABCDEF";var r="";for(var a=0;a<e.length;a++){var i=e.charAt(a);if(i==" ")r+="+";else if(t.indexOf(i)!=-1)r+=i;else{var o=i.charCodeAt(0);if(o>255){alert("Unicode Character '"+i+"' cannot be encoded using standard URL encoding.\n"+"(URL encoding only supports 8-bit characters.)\n"+"A space (+) will be substituted.");r+="+"}else{r+="%";r+=n.charAt(o>>4&15);r+=n.charAt(o&15)}}}return r}this.validateEmail=e;this.isArray=t;this.arrayCompare=n;this.isNumeric=r;this.encodeURL=a};O3Global.Ajax=new function(){var aPages=new Array;function loadDiv(e,t,n,r,a,i){if(n=="topbar")Collapse.show(Collapse.TOP);if(n=="menu")Collapse.show(Collapse.LEFT);if(n=="right")Collapse.show(Collapse.RIGHT);if(n=="bottom")Collapse.show(Collapse.BOTTOM);if(!i){var o=aPages[n];if(o){if(o["module"]==e&&o["action"]==t&&(o["postdata"]==r||O3Global.Types.arrayCompare(o["postdata"],r))){if(a)a();return}}}aPages[n]=new Array;aPages[n]["module"]=e;aPages[n]["action"]=t;aPages[n]["postdata"]=r;var l=new O3Ajax;var f=O3Global.DOM.getById(n);if(r){if(O3Global.Types.isArray(r))l.addPostData(r);else l.addRawPostData(r)}if(a)l.setCallback(a);announceLoading(n);l.setContainer(n);l.requestPage(e,t)}function reloadDiv(e,t,n,r,a,i,o){var l=aPages[e];if(!l)return;if(!t)loadDiv(l["module"],l["action"],e,l["postdata"],a,true);else{if(l["module"]==t&&l["action"]==n&&(l["postdata"]==r||O3Global.Types.arrayCompare(r,l["postdata"],i))){if(o&&O3Global.Types.isArray(r)&&O3Global.Types.isArray(o)){for(var f in o)r[f]=o[f]}loadDiv(t,n,e,r,a,true)}}}function loadXML(e,t,n,r,a){var i=new O3Ajax;if(n){if(O3Global.Types.isArray(n))i.addPostData(n);else i.addRawPostData(n)}if(r)i.setHandler(AjaxCodeConfig.OK,r);if(a)i.setHandler(AjaxCodeConfig.ERROR,a);i.requestXML(e,t)}function loadJSON(e,t,n,r,a){var i=new O3Ajax;if(n){if(O3Global.Types.isArray(n))i.addPostData(n);else i.addRawPostData(n)}if(r)i.setHandler(AjaxCodeConfig.OK,r);if(a)i.setHandler(AjaxCodeConfig.ERROR,a);i.requestJSON(e,t)}function deserializeXML(oXML,oObject){var aNodes=oXML.childNodes;if(!aNodes||aNodes.length==0)return;for(var i=0;i<aNodes.length;i++){var oNode=aNodes[i];if(!oNode.firstChild)continue;var sName=oNode.nodeName;if(!sName||sName.length==0)continue;var fncSet=eval("oObject.set"+sName);if(typeof fncSet!="function")continue;fncSet(oNode.firstChild.data)}}function announceLoading(e){var t=O3Global.DOM.getById(e);if(t){var n=O3Global.DOM.getById("workingdata");var r=n?n.innerHTML:"";t.innerHTML=r;t.disabled=true}}function clearEntry(e){if(aPages[e])aPages[e]=null}this.loadDiv=loadDiv;this.reloadDiv=reloadDiv;this.loadXML=loadXML;this.loadJSON=loadJSON;this.deserializeXML=deserializeXML;this.clearEntry=clearEntry};O3Global.Forms=new function(){var e=0;var t=1;var n=2;var r=3;var a=4;var i=5;function o(o){if(!o)return null;var l=new Array;var f=new Array;for(var s in o.elements){var u=o.elements[s];if(u==null)continue;var d=e;if(u.type!=null){if(u.type=="text"||u.type=="textarea"||u.type=="hidden"||u.type=="password")d=t;else if(u.type=="radio")d=i;else if(u.type=="checkbox")d=r;else if(u.type=="select-one"||u.type=="select-multiple")d=a}if(u[0]!=null&&u[0].type=="radio")d=n;if(d==e)continue;if(u.disabled||d==n&&u[0].disabled)continue;if(d==i&&!u.checked)continue;if(u.name)s=u.name;else if(u[0].name)s=u[0].name;if(d==n){if(f[s])continue;else f[s]=true}switch(d){case n:for(var c=0;c<u.length;c++){if(u[c].checked){l[s]=u[c].value;break}}break;case r:if(u.checked)l[s]=u.value;break;default:l[s]=u.value;break}}return l}function l(e,t){if(!e)return;for(var n=0;n<e.elements.length;n++){var r=e.elements[n];if(r==null)continue;if(r.disabled!=null)r.disabled=t}}function f(e){l(e,false)}function s(e){l(e,true)}function u(e){if(e[0]){for(var t=0;t<e.length;t++){if(e[t].checked)return e[t].value}}else return e.value}this.serializeForm=o;this.enableForm=f;this.disableForm=s;this.getRadioValue=u};function ProgBar(sPBId){var sId="";var iMax=-1;var iWidth=100;var iValue=0;var iHeight=15;var sCaption=null;var iMinColor=25600;var iMaxColor=25600;var sBorder="1px solid black";var sDisplay="inline";var bAttach=false;var oBarSub=null;var oBarDiv=null;var oBarColor=null;var oBarWDiv=null;function construct(t){sId=t}function calculateColor(){var t=0;if(iMax!=0)t=1/iMax*iValue;var a=iMinColor&255;var i=(iMinColor&65280)>>8;var r=(iMinColor&16711680)>>16;var o=iMaxColor&255;var e=(iMaxColor&65280)>>8;var l=(iMaxColor&16711680)>>16;var n=Math.round(a+(o-a)*t);var s=Math.round(i+(e-i)*t);var d=Math.round(r+(l-r)*t);var u=d<<16|s<<8|n<<0;var h=u.toString(16);while(h.length<6)h="0"+h;return"#"+h}function create(){if(sId.length==0){alert("You need an ID to create a ProgBar");return}if(iMax<=0){alert("Max has to be > 0 to create a ProgBar");return}var t=0;if(iValue>=iMax)t=iWidth;else{var a=iMax*iValue;var t=0;if(a!=0)t=Math.round(iWidth/a)}var i=calculateColor();if(sCaption==null)sCaption=iValue;var r='<div id="jsprogbar_'+sId+'" style="display: '+sDisplay+';">\n'+'  <table cellpadding="0" cellspacing="0" style="border: '+sBorder+"; margin: 0px; padding: 0px; width: "+iWidth+'px;">\n'+"    <tr>\n"+'      <td style="text-align: left;">\n'+'        <div id="jsprogbar_div_'+sId+'" style="font-size: smaller; height: 15px; overflow: hidden; text-align: center; position: absolute; width: '+iWidth+'px;">'+sCaption+"</div>\n"+'        <table id="jsprogbar_sub_'+sId+'" cellpadding="0" cellspacing="0" style="font-size: smaller; height: '+iHeight+"px; width: "+t+'px;">\n'+"          <tr>\n"+'            <td id="jsprogbar_color_'+sId+'" nowrap style="background-color: '+i+';"><div id="jsprogbar_wdiv_'+sId+'" style="width: '+t+'px; overflow: hidden;">&nbsp;</div></td>\n'+"          </tr>\n"+"        </table>\n"+"      </td>\n"+"    </tr>\n"+"  </table>\n"+"</div>\n";return r}function attach(){if(sId.length==0){alert("You need an ID to attach a ProgBar");return}bAttach=true;var oValues=O3Global.DOM.getById("jsprogbar_values_"+sId);if(!oValues)return false;eval(oValues.innerHTML);bAttach=false;return true}function init(){if(bAttach){if(!attach())return false}oBarSub=O3Global.DOM.getById("jsprogbar_sub_"+sId);oBarDiv=O3Global.DOM.getById("jsprogbar_div_"+sId);oBarColor=O3Global.DOM.getById("jsprogbar_color_"+sId);oBarWDiv=O3Global.DOM.getById("jsprogbar_wdiv_"+sId);return oBarSub&&oBarDiv&&oBarColor&&oBarWDiv}function update(t,a){iValue=t*1;sCaption=a;if(!init())return false;if(iValue<0||iValue>iMax)return false;if(!sCaption)sCaption=iValue;var i=Math.round(iWidth/iMax*iValue);oBarWDiv.style.width=i+"px";oBarSub.style.width=i+"px";oBarDiv.innerHTML=sCaption;oBarColor.style.background=calculateColor();return true}function hide(){sDisplay="none";O3Global.DOM.hideDiv("jsprogbar_"+sId)}function show(){sDisplay="inline";O3Global.DOM.showDiv("jsprogbar_"+sId)}function setMax(t){iMax=t*1}function setWidth(t){iWidth=t*1}function setValue(t){iValue=t*1}function setHeight(t){iHeight=t*1}function setCaption(t){sCaption=t}function setColor(t){iMinColor=t*1;iMaxColor=t*1}function setMinColor(t){iMinColor=t*1}function setMaxColor(t){iMaxColor=t*1}function setBorder(t){sBorder=t}construct(sPBId);this.construct=construct;this.create=create;this.attach=attach;this.update=update;this.hide=hide;this.show=show;this.setMax=setMax;this.setWidth=setWidth;this.setValue=setValue;this.setHeight=setHeight;this.setCaption=setCaption;this.setColor=setColor;this.setMinColor=setMinColor;this.setMaxColor=setMaxColor;this.setBorder=setBorder}
(function(e){var t={initialized:false,element:null,open:false};var o={init:function(){if(t.initialized)return;e("body").append('<div id="omertabox_overlay"></div>');t.initialized=true},popup:function(){if(!t.initialized)o.init();if(t.open)t.element.hide();var i=e("body");t.element=this.first();if(t.element.data("fixed")!="y"){t.element.hide();t.element.css("position","absolute");t.element.css("z-index","1010");i.append(t.element);t.element.data("fixed","y")}var n=Math.round((e(window).width()-t.element.width())/2)+i.scrollLeft();var l=Math.round((e(window).height()-t.element.height())/2)+i.scrollTop();t.element.css("top",l+"px");t.element.css("left",n+"px");if(!t.open){e("#omertabox_overlay").height(e(document).height());e("#omertabox_overlay").fadeTo(0,0,function(){e("#omertabox_overlay").show();e("#omertabox_overlay").fadeTo(300,.65,function(){t.element.show();t.open=true})})}else{t.element.show()}return this},close:function(){t.element.hide();t.open=false;e("#omertabox_overlay").fadeTo(300,0,function(){e("#omertabox_overlay").hide()})}};e.fn.omertabox=function(t){if(o[t])return o[t].apply(this,Array.prototype.slice.call(arguments,1));else if(!t)return o.popup.apply(this,arguments);else e.error("Method "+t+" does not exist on jQuery.omertabox")}})(jQuery);(function(e,t,n){if(typeof module!=="undefined"&&module.exports){module.exports=n()}else if(typeof define==="function"&&define.amd){define(n)}else{t[e]=n()}})("Fingerprint",this,function(){"use strict";var e=function(e){var t,n;t=Array.prototype.forEach;n=Array.prototype.map;this.each=function(e,n,r){if(e===null){return}if(t&&e.forEach===t){e.forEach(n,r)}else if(e.length===+e.length){for(var i=0,a=e.length;i<a;i++){if(n.call(r,e[i],i,e)==={})return}}else{for(var o in e){if(e.hasOwnProperty(o)){if(n.call(r,e[o],o,e)==={})return}}}};this.map=function(e,t,r){var i=[];if(e==null)return i;if(n&&e.map===n)return e.map(t,r);this.each(e,function(e,n,a){i[i.length]=t.call(r,e,n,a)});return i};if(typeof e=="object"){this.hasher=e.hasher;this.screen_resolution=e.screen_resolution;this.canvas=e.canvas;this.ie_activex=e.ie_activex}else if(typeof e=="function"){this.hasher=e}};e.prototype={get:function(){var e=[];e.push(navigator.userAgent);e.push(navigator.language);e.push(screen.colorDepth);if(this.screen_resolution){var t=this.getScreenResolution();if(typeof t!=="undefined"){e.push(this.getScreenResolution().join("x"))}}e.push((new Date).getTimezoneOffset());e.push(this.hasSessionStorage());e.push(this.hasLocalStorage());e.push(!!window.indexedDB);if(document.body){e.push(typeof document.body.addBehavior)}else{e.push(typeof undefined)}e.push(typeof window.openDatabase);e.push(navigator.cpuClass);e.push(navigator.platform);e.push(navigator.doNotTrack);e.push(this.getPluginsString());if(this.canvas&&this.isCanvasSupported()){e.push(this.getCanvasFingerprint())}if(this.hasher){return this.hasher(e.join("###"),31)}else{return this.murmurhash3_32_gc(e.join("###"),31)}},murmurhash3_32_gc:function(e,t){var n,r,i,a,o,s,u,l;n=e.length&3;r=e.length-n;i=t;o=3432918353;s=461845907;l=0;while(l<r){u=e.charCodeAt(l)&255|(e.charCodeAt(++l)&255)<<8|(e.charCodeAt(++l)&255)<<16|(e.charCodeAt(++l)&255)<<24;++l;u=(u&65535)*o+(((u>>>16)*o&65535)<<16)&4294967295;u=u<<15|u>>>17;u=(u&65535)*s+(((u>>>16)*s&65535)<<16)&4294967295;i^=u;i=i<<13|i>>>19;a=(i&65535)*5+(((i>>>16)*5&65535)<<16)&4294967295;i=(a&65535)+27492+(((a>>>16)+58964&65535)<<16)}u=0;switch(n){case 3:u^=(e.charCodeAt(l+2)&255)<<16;case 2:u^=(e.charCodeAt(l+1)&255)<<8;case 1:u^=e.charCodeAt(l)&255;u=(u&65535)*o+(((u>>>16)*o&65535)<<16)&4294967295;u=u<<15|u>>>17;u=(u&65535)*s+(((u>>>16)*s&65535)<<16)&4294967295;i^=u}i^=e.length;i^=i>>>16;i=(i&65535)*2246822507+(((i>>>16)*2246822507&65535)<<16)&4294967295;i^=i>>>13;i=(i&65535)*3266489909+(((i>>>16)*3266489909&65535)<<16)&4294967295;i^=i>>>16;return i>>>0},hasLocalStorage:function(){try{return!!window.localStorage}catch(e){return true}},hasSessionStorage:function(){try{return!!window.sessionStorage}catch(e){return true}},isCanvasSupported:function(){var e=document.createElement("canvas");return!!(e.getContext&&e.getContext("2d"))},isIE:function(){if(navigator.appName==="Microsoft Internet Explorer"){return true}else if(navigator.appName==="Netscape"&&/Trident/.test(navigator.userAgent)){return true}return false},getPluginsString:function(){if(this.isIE()&&this.ie_activex){return this.getIEPluginsString()}else{return this.getRegularPluginsString()}},getRegularPluginsString:function(){return this.map(navigator.plugins,function(e){var t=this.map(e,function(e){return[e.type,e.suffixes].join("~")}).join(",");return[e.name,e.description,t].join("::")},this).join(";")},getIEPluginsString:function(){if(window.ActiveXObject){var e=["ShockwaveFlash.ShockwaveFlash","AcroPDF.PDF","PDF.PdfCtrl","QuickTime.QuickTime","rmocx.RealPlayer G2 Control","rmocx.RealPlayer G2 Control.1","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","RealVideo.RealVideo(tm) ActiveX Control (32-bit)","RealPlayer","SWCtl.SWCtl","WMPlayer.OCX","AgControl.AgControl","Skype.Detection"];return this.map(e,function(e){try{new ActiveXObject(e);return e}catch(t){return null}}).join(";")}else{return""}},getScreenResolution:function(){return[screen.height,screen.width]},getCanvasFingerprint:function(){var e=document.createElement("canvas");var t=e.getContext("2d");var n="http://valve.github.io";t.textBaseline="top";t.font="14px 'Arial'";t.textBaseline="alphabetic";t.fillStyle="#f60";t.fillRect(125,1,62,20);t.fillStyle="#069";t.fillText(n,2,15);t.fillStyle="rgba(102, 204, 0, 0.7)";t.fillText(n,4,17);return e.toDataURL()}};return e});(function(t,e){"object"===typeof exports?e(exports):"function"===typeof define&&define.amd?define(["exports"],e):e(t)})(this,function(t){function e(t){this._targetElement=t;this._options={nextLabel:"Next &rarr;",prevLabel:"&larr; Back",skipLabel:"Skip",doneLabel:"Done",tooltipPosition:"bottom",tooltipClass:"",highlightClass:"",exitOnEsc:!0,exitOnOverlayClick:!0,showStepNumbers:!0,keyboardNavigation:!0,showButtons:!0,showBullets:!0,showProgress:!1,scrollToElement:!0,overlayOpacity:.8,positionPrecedence:["bottom","top","right","left"],disableInteraction:!1}}function n(t){var e=[],n=this;if(this._options.steps)for(var l=[],a=0,l=this._options.steps.length;a<l;a++){var h=o(this._options.steps[a]);h.step=e.length+1;"string"===typeof h.element&&(h.element=document.querySelector(h.element));if("undefined"===typeof h.element||null==h.element){var p=document.querySelector(".introjsFloatingElement");null==p&&(p=document.createElement("div"),p.className="introjsFloatingElement",document.body.appendChild(p));h.element=p;h.position="floating"}null!=h.element&&e.push(h)}else{l=t.querySelectorAll("*[data-intro]");if(1>l.length)return!1;a=0;for(h=l.length;a<h;a++){var p=l[a],u=parseInt(p.getAttribute("data-step"),10);0<u&&(e[u-1]={element:p,intro:p.getAttribute("data-intro"),step:parseInt(p.getAttribute("data-step"),10),tooltipClass:p.getAttribute("data-tooltipClass"),highlightClass:p.getAttribute("data-highlightClass"),position:p.getAttribute("data-position")||this._options.tooltipPosition})}a=u=0;for(h=l.length;a<h;a++)if(p=l[a],null==p.getAttribute("data-step")){for(;"undefined"!=typeof e[u];)u++;e[u]={element:p,intro:p.getAttribute("data-intro"),step:u+1,tooltipClass:p.getAttribute("data-tooltipClass"),highlightClass:p.getAttribute("data-highlightClass"),position:p.getAttribute("data-position")||this._options.tooltipPosition}}}a=[];for(l=0;l<e.length;l++)e[l]&&a.push(e[l]);e=a;e.sort(function(t,e){return t.step-e.step});n._introItems=e;m.call(n,t)&&(i.call(n),t.querySelector(".introjs-skipbutton"),t.querySelector(".introjs-nextbutton"),n._onKeyDown=function(e){if(27===e.keyCode&&!0==n._options.exitOnEsc)s.call(n,t),void 0!=n._introExitCallback&&n._introExitCallback.call(n);else if(37===e.keyCode)r.call(n);else if(39===e.keyCode)i.call(n);else if(13===e.keyCode){var o=e.target||e.srcElement;o&&0<o.className.indexOf("introjs-prevbutton")?r.call(n):o&&0<o.className.indexOf("introjs-skipbutton")?s.call(n,t):i.call(n);e.preventDefault?e.preventDefault():e.returnValue=!1}},n._onResize=function(t){c.call(n,document.querySelector(".introjs-helperLayer"));c.call(n,document.querySelector(".introjs-tooltipReferenceLayer"))},window.addEventListener?(this._options.keyboardNavigation&&window.addEventListener("keydown",n._onKeyDown,!0),window.addEventListener("resize",n._onResize,!0)):document.attachEvent&&(this._options.keyboardNavigation&&document.attachEvent("onkeydown",n._onKeyDown),document.attachEvent("onresize",n._onResize)));return!1}function o(t){if(null==t||"object"!=typeof t||"undefined"!=typeof t.nodeType)return t;var e={},n;for(n in t)e[n]=o(t[n]);return e}function i(){this._direction="forward";"undefined"===typeof this._currentStep?this._currentStep=0:++this._currentStep;if(this._introItems.length<=this._currentStep)"function"===typeof this._introCompleteCallback&&this._introCompleteCallback.call(this),s.call(this,this._targetElement);else{var t=this._introItems[this._currentStep];"undefined"!==typeof this._introBeforeChangeCallback&&this._introBeforeChangeCallback.call(this,t.element);p.call(this,t)}}function r(){this._direction="backward";if(0===this._currentStep)return!1;var t=this._introItems[--this._currentStep];"undefined"!==typeof this._introBeforeChangeCallback&&this._introBeforeChangeCallback.call(this,t.element);p.call(this,t)}function s(t){var e=t.querySelector(".introjs-overlay");if(null!=e){e.style.opacity=0;setTimeout(function(){e.parentNode&&e.parentNode.removeChild(e)},500);var n=t.querySelector(".introjs-helperLayer");n&&n.parentNode.removeChild(n);(n=t.querySelector(".introjs-tooltipReferenceLayer"))&&n.parentNode.removeChild(n);(t=t.querySelector(".introjs-disableInteraction"))&&t.parentNode.removeChild(t);(t=document.querySelector(".introjsFloatingElement"))&&t.parentNode.removeChild(t);if(t=document.querySelector(".introjs-showElement"))t.className=t.className.replace(/introjs-[a-zA-Z]+/g,"").replace(/^\s+|\s+$/g,"");if((t=document.querySelectorAll(".introjs-fixParent"))&&0<t.length)for(n=t.length-1;0<=n;n--)t[n].className=t[n].className.replace(/introjs-fixParent/g,"").replace(/^\s+|\s+$/g,"");window.removeEventListener?window.removeEventListener("keydown",this._onKeyDown,!0):document.detachEvent&&document.detachEvent("onkeydown",this._onKeyDown);this._currentStep=void 0}}function l(t,e,n,o){var i="";e.style.top=null;e.style.right=null;e.style.bottom=null;e.style.left=null;e.style.marginLeft=null;e.style.marginTop=null;n.style.display="inherit";"undefined"!=typeof o&&null!=o&&(o.style.top=null,o.style.left=null);if(this._introItems[this._currentStep]){i=this._introItems[this._currentStep];i="string"===typeof i.tooltipClass?i.tooltipClass:this._options.tooltipClass;e.className=("introjs-tooltip "+i).replace(/^\s+|\s+$/g,"");currentTooltipPosition=this._introItems[this._currentStep].position;if(("auto"==currentTooltipPosition||"auto"==this._options.tooltipPosition)&&"floating"!=currentTooltipPosition){var i=currentTooltipPosition,r=this._options.positionPrecedence.slice(),s=d(),l=y(e).height+10,c=y(e).width+20,h=y(t),p="floating";h.left+c>s.width||0>h.left+h.width/2-c?(a(r,"bottom"),a(r,"top")):(h.height+h.top+l>s.height&&a(r,"bottom"),0>h.top-l&&a(r,"top"));h.width+h.left+c>s.width&&a(r,"right");0>h.left-c&&a(r,"left");0<r.length&&(p=r[0]);i&&"auto"!=i&&-1<r.indexOf(i)&&(p=i);currentTooltipPosition=p}i=y(t);r=y(e).height;s=d();switch(currentTooltipPosition){case"top":e.style.left="15px";e.style.top="-"+(r+10)+"px";n.className="introjs-arrow bottom";break;case"right":e.style.left=y(t).width+20+"px";i.top+r>s.height&&(n.className="introjs-arrow left-bottom",e.style.top="-"+(r-i.height-20)+"px");n.className="introjs-arrow left";break;case"left":!0==this._options.showStepNumbers&&(e.style.top="15px");i.top+r>s.height?(e.style.top="-"+(r-i.height-20)+"px",n.className="introjs-arrow right-bottom"):n.className="introjs-arrow right";e.style.right=i.width+20+"px";break;case"floating":n.style.display="none";t=y(e);e.style.left="50%";e.style.top="50%";e.style.marginLeft="-"+t.width/2+"px";e.style.marginTop="-"+t.height/2+"px";"undefined"!=typeof o&&null!=o&&(o.style.left="-"+(t.width/2+18)+"px",o.style.top="-"+(t.height/2+18)+"px");break;case"bottom-right-aligned":n.className="introjs-arrow top-right";e.style.right="0px";e.style.bottom="-"+(y(e).height+10)+"px";break;case"bottom-middle-aligned":o=y(t);t=y(e);n.className="introjs-arrow top-middle";e.style.left=o.width/2-t.width/2+"px";e.style.bottom="-"+(t.height+10)+"px";break;default:e.style.bottom="-"+(y(e).height+10)+"px",e.style.left=y(t).width/2-y(e).width/2+"px",n.className="introjs-arrow top"}}}function a(t,e){-1<t.indexOf(e)&&t.splice(t.indexOf(e),1)}function c(t){if(t&&this._introItems[this._currentStep]){var e=this._introItems[this._currentStep],n=y(e.element),o=10;"floating"==e.position&&(o=0);t.setAttribute("style","width: "+(n.width+o)+"px; height:"+(n.height+o)+"px; top:"+(n.top-5)+"px;left: "+(n.left-5)+"px;")}}function h(){var t=document.querySelector(".introjs-disableInteraction");null===t&&(t=document.createElement("div"),t.className="introjs-disableInteraction",this._targetElement.appendChild(t));c.call(this,t)}function p(t){"undefined"!==typeof this._introChangeCallback&&this._introChangeCallback.call(this,t.element);var e=this,n=document.querySelector(".introjs-helperLayer"),o=document.querySelector(".introjs-tooltipReferenceLayer"),a="introjs-helperLayer";y(t.element);"string"===typeof t.highlightClass&&(a+=" "+t.highlightClass);"string"===typeof this._options.highlightClass&&(a+=" "+this._options.highlightClass);if(null!=n){var p=o.querySelector(".introjs-helperNumberLayer"),m=o.querySelector(".introjs-tooltiptext"),b=o.querySelector(".introjs-arrow"),_=o.querySelector(".introjs-tooltip"),w=o.querySelector(".introjs-skipbutton"),v=o.querySelector(".introjs-prevbutton"),C=o.querySelector(".introjs-nextbutton");n.className=a;_.style.opacity=0;_.style.display="none";if(null!=p){var j=this._introItems[0<=t.step-2?t.step-2:0];if(null!=j&&"forward"==this._direction&&"floating"==j.position||"backward"==this._direction&&"floating"==t.position)p.style.opacity=0}c.call(e,n);c.call(e,o);if((j=document.querySelectorAll(".introjs-fixParent"))&&0<j.length)for(a=j.length-1;0<=a;a--)j[a].className=j[a].className.replace(/introjs-fixParent/g,"").replace(/^\s+|\s+$/g,"");j=document.querySelector(".introjs-showElement");j.className=j.className.replace(/introjs-[a-zA-Z]+/g,"").replace(/^\s+|\s+$/g,"");e._lastShowElementTimer&&clearTimeout(e._lastShowElementTimer);e._lastShowElementTimer=setTimeout(function(){null!=p&&(p.innerHTML=t.step);m.innerHTML=t.intro;_.style.display="block";l.call(e,t.element,_,b,p);o.querySelector(".introjs-bullets li > a.active").className="";o.querySelector('.introjs-bullets li > a[data-stepnumber="'+t.step+'"]').className="active";o.querySelector(".introjs-progress .introjs-progressbar").setAttribute("style","width:"+g.call(e)+"%;");_.style.opacity=1;p&&(p.style.opacity=1);-1===C.tabIndex?w.focus():C.focus()},350)}else{var x=document.createElement("div"),v=document.createElement("div"),n=document.createElement("div"),N=document.createElement("div"),S=document.createElement("div"),k=document.createElement("div"),E=document.createElement("div"),L=document.createElement("div");x.className=a;v.className="introjs-tooltipReferenceLayer";c.call(e,x);c.call(e,v);this._targetElement.appendChild(x);this._targetElement.appendChild(v);n.className="introjs-arrow";S.className="introjs-tooltiptext";S.innerHTML=t.intro;k.className="introjs-bullets";!1===this._options.showBullets&&(k.style.display="none");for(var x=document.createElement("ul"),a=0,I=this._introItems.length;a<I;a++){var T=document.createElement("li"),q=document.createElement("a");q.onclick=function(){e.goToStep(this.getAttribute("data-stepnumber"))};a===t.step-1&&(q.className="active");q.href="javascript:void(0);";q.innerHTML="&nbsp;";q.setAttribute("data-stepnumber",this._introItems[a].step);T.appendChild(q);x.appendChild(T)}k.appendChild(x);E.className="introjs-progress";!1===this._options.showProgress&&(E.style.display="none");a=document.createElement("div");a.className="introjs-progressbar";a.setAttribute("style","width:"+g.call(this)+"%;");E.appendChild(a);L.className="introjs-tooltipbuttons";!1===this._options.showButtons&&(L.style.display="none");N.className="introjs-tooltip";N.appendChild(S);N.appendChild(k);N.appendChild(E);!0==this._options.showStepNumbers&&(j=document.createElement("span"),j.className="introjs-helperNumberLayer",j.innerHTML=t.step,v.appendChild(j));N.appendChild(n);v.appendChild(N);C=document.createElement("a");C.onclick=function(){e._introItems.length-1!=e._currentStep&&i.call(e)};C.href="javascript:void(0);";C.innerHTML=this._options.nextLabel;v=document.createElement("a");v.onclick=function(){0!=e._currentStep&&r.call(e)};v.href="javascript:void(0);";v.innerHTML=this._options.prevLabel;w=document.createElement("a");w.className="introjs-button introjs-skipbutton";w.href="javascript:void(0);";w.innerHTML=this._options.skipLabel;w.onclick=function(){e._introItems.length-1==e._currentStep&&"function"===typeof e._introCompleteCallback&&e._introCompleteCallback.call(e);e._introItems.length-1!=e._currentStep&&"function"===typeof e._introExitCallback&&e._introExitCallback.call(e);s.call(e,e._targetElement)};L.appendChild(w);1<this._introItems.length&&(L.appendChild(v),L.appendChild(C));N.appendChild(L);l.call(e,t.element,N,n,j)}!0===this._options.disableInteraction&&h.call(e);v.removeAttribute("tabIndex");C.removeAttribute("tabIndex");0==this._currentStep&&1<this._introItems.length?(v.className="introjs-button introjs-prevbutton introjs-disabled",v.tabIndex="-1",C.className="introjs-button introjs-nextbutton",w.innerHTML=this._options.skipLabel):this._introItems.length-1==this._currentStep||1==this._introItems.length?(w.innerHTML=this._options.doneLabel,v.className="introjs-button introjs-prevbutton",C.className="introjs-button introjs-nextbutton introjs-disabled",C.tabIndex="-1"):(v.className="introjs-button introjs-prevbutton",C.className="introjs-button introjs-nextbutton",w.innerHTML=this._options.skipLabel);C.focus();t.element.className+=" introjs-showElement";j=u(t.element,"position");"absolute"!==j&&"relative"!==j&&(t.element.className+=" introjs-relativePosition");for(j=t.element.parentNode;null!=j&&"body"!==j.tagName.toLowerCase();){n=u(j,"z-index");N=parseFloat(u(j,"opacity"));L=u(j,"transform")||u(j,"-webkit-transform")||u(j,"-moz-transform")||u(j,"-ms-transform")||u(j,"-o-transform");if(/[0-9]+/.test(n)||1>N||"none"!==L)j.className+=" introjs-fixParent";j=j.parentNode}f(t.element)||!0!==this._options.scrollToElement||(N=t.element.getBoundingClientRect(),j=d().height,n=N.bottom-(N.bottom-N.top),N=N.bottom-j,0>n||t.element.clientHeight>j?window.scrollBy(0,n-30):window.scrollBy(0,N+100));"undefined"!==typeof this._introAfterChangeCallback&&this._introAfterChangeCallback.call(this,t.element)}function u(t,e){var n="";t.currentStyle?n=t.currentStyle[e]:document.defaultView&&document.defaultView.getComputedStyle&&(n=document.defaultView.getComputedStyle(t,null).getPropertyValue(e));return n&&n.toLowerCase?n.toLowerCase():n}function d(){if(void 0!=window.innerWidth)return{width:window.innerWidth,height:window.innerHeight};var t=document.documentElement;return{width:t.clientWidth,height:t.clientHeight}}function f(t){t=t.getBoundingClientRect();return 0<=t.top&&0<=t.left&&t.bottom+80<=window.innerHeight&&t.right<=window.innerWidth}function m(t){var e=document.createElement("div"),n="",o=this;e.className="introjs-overlay";if("body"===t.tagName.toLowerCase())n+="top: 0;bottom: 0; left: 0;right: 0;position: fixed;",e.setAttribute("style",n);else{var i=y(t);i&&(n+="width: "+i.width+"px; height:"+i.height+"px; top:"+i.top+"px;left: "+i.left+"px;",e.setAttribute("style",n))}t.appendChild(e);e.onclick=function(){!0==o._options.exitOnOverlayClick&&(s.call(o,t),void 0!=o._introExitCallback&&o._introExitCallback.call(o))};setTimeout(function(){n+="opacity: "+o._options.overlayOpacity.toString()+";";e.setAttribute("style",n)},10);return!0}function y(t){var e={};e.width=t.offsetWidth;e.height=t.offsetHeight;for(var n=0,o=0;t&&!isNaN(t.offsetLeft)&&!isNaN(t.offsetTop);)n+=t.offsetLeft,o+=t.offsetTop,t=t.offsetParent;e.top=o;e.left=n;return e}function g(){return 100*(parseInt(this._currentStep+1,10)/this._introItems.length)}var b=function(t){if("object"===typeof t)return new e(t);if("string"===typeof t){if(t=document.querySelector(t))return new e(t);throw Error("There is no element with given selector.")}return new e(document.body)};b.version="1.0.0";b.fn=e.prototype={clone:function(){return new e(this)},setOption:function(t,e){this._options[t]=e;return this},setOptions:function(t){var e=this._options,n={},o;for(o in e)n[o]=e[o];for(o in t)n[o]=t[o];this._options=n;return this},start:function(){n.call(this,this._targetElement);return this},goToStep:function(t){this._currentStep=t-2;"undefined"!==typeof this._introItems&&i.call(this);return this},nextStep:function(){i.call(this);return this},previousStep:function(){r.call(this);return this},exit:function(){s.call(this,this._targetElement);return this},refresh:function(){c.call(this,document.querySelector(".introjs-helperLayer"));c.call(this,document.querySelector(".introjs-tooltipReferenceLayer"));return this},onbeforechange:function(t){if("function"===typeof t)this._introBeforeChangeCallback=t;else throw Error("Provided callback for onbeforechange was not a function");return this},onchange:function(t){if("function"===typeof t)this._introChangeCallback=t;else throw Error("Provided callback for onchange was not a function.");return this},onafterchange:function(t){if("function"===typeof t)this._introAfterChangeCallback=t;else throw Error("Provided callback for onafterchange was not a function");return this},oncomplete:function(t){if("function"===typeof t)this._introCompleteCallback=t;else throw Error("Provided callback for oncomplete was not a function.");return this},onexit:function(t){if("function"===typeof t)this._introExitCallback=t;else throw Error("Provided callback for onexit was not a function.");return this}};return t.introJs=b});(function(e){var t={};var s={mode:"horizontal",slideSelector:"",infiniteLoop:true,hideControlOnEnd:false,speed:500,easing:null,slideMargin:0,startSlide:0,randomStart:false,captions:false,ticker:false,tickerHover:false,adaptiveHeight:false,adaptiveHeightSpeed:500,video:false,useCSS:true,preloadImages:"visible",responsive:true,slideZIndex:50,wrapperClass:"bx-wrapper",touchEnabled:true,swipeThreshold:50,oneToOneTouch:true,preventDefaultSwipeX:true,preventDefaultSwipeY:false,pager:true,pagerType:"full",pagerShortSeparator:" / ",pagerSelector:null,buildPager:null,pagerCustom:null,controls:true,nextText:"Next",prevText:"Prev",nextSelector:null,prevSelector:null,autoControls:false,startText:"Start",stopText:"Stop",autoControlsCombine:false,autoControlsSelector:null,auto:false,pause:4e3,autoStart:true,autoDirection:"next",autoHover:false,autoDelay:0,autoSlideForOnePage:false,minSlides:1,maxSlides:1,moveSlides:0,slideWidth:0,onSliderLoad:function(){},onSlideBefore:function(){},onSlideAfter:function(){},onSlideNext:function(){},onSlidePrev:function(){},onSliderResize:function(){}};e.fn.bxSlider=function(n){if(this.length==0)return this;if(this.length>1){this.each(function(){e(this).bxSlider(n)});return this}var o={};var r=this;t.el=this;var a=e(window).width();var l=e(window).height();var d=function(){o.settings=e.extend({},s,n);o.settings.slideWidth=parseInt(o.settings.slideWidth);o.children=r.children(o.settings.slideSelector);if(o.children.length<o.settings.minSlides)o.settings.minSlides=o.children.length;if(o.children.length<o.settings.maxSlides)o.settings.maxSlides=o.children.length;if(o.settings.randomStart)o.settings.startSlide=Math.floor(Math.random()*o.children.length);o.active={index:o.settings.startSlide};o.carousel=o.settings.minSlides>1||o.settings.maxSlides>1;if(o.carousel)o.settings.preloadImages="all";o.minThreshold=o.settings.minSlides*o.settings.slideWidth+(o.settings.minSlides-1)*o.settings.slideMargin;o.maxThreshold=o.settings.maxSlides*o.settings.slideWidth+(o.settings.maxSlides-1)*o.settings.slideMargin;o.working=false;o.controls={};o.interval=null;o.animProp=o.settings.mode=="vertical"?"top":"left";o.usingCSS=o.settings.useCSS&&o.settings.mode!="fade"&&function(){var e=document.createElement("div");var t=["WebkitPerspective","MozPerspective","OPerspective","msPerspective"];for(var i in t){if(e.style[t[i]]!==undefined){o.cssPrefix=t[i].replace("Perspective","").toLowerCase();o.animProp="-"+o.cssPrefix+"-transform";return true}}return false}();if(o.settings.mode=="vertical")o.settings.maxSlides=o.settings.minSlides;r.data("origStyle",r.attr("style"));r.children(o.settings.slideSelector).each(function(){e(this).data("origStyle",e(this).attr("style"))});c()};var c=function(){r.wrap('<div class="'+o.settings.wrapperClass+'"><div class="bx-viewport"></div></div>');o.viewport=r.parent();o.loader=e('<div class="bx-loading" />');o.viewport.prepend(o.loader);r.css({width:o.settings.mode=="horizontal"?o.children.length*100+215+"%":"auto",position:"relative"});if(o.usingCSS&&o.settings.easing){r.css("-"+o.cssPrefix+"-transition-timing-function",o.settings.easing)}else if(!o.settings.easing){o.settings.easing="swing"}var t=p();o.viewport.css({width:"100%",overflow:"hidden",position:"relative"});o.viewport.parent().css({maxWidth:u()});if(!o.settings.pager){o.viewport.parent().css({margin:"0 auto 0px"})}o.children.css({"float":o.settings.mode=="horizontal"?"left":"none",listStyle:"none",position:"relative"});o.children.css("width",h());if(o.settings.mode=="horizontal"&&o.settings.slideMargin>0)o.children.css("marginRight",o.settings.slideMargin);if(o.settings.mode=="vertical"&&o.settings.slideMargin>0)o.children.css("marginBottom",o.settings.slideMargin);if(o.settings.mode=="fade"){o.children.css({position:"absolute",zIndex:0,display:"none"});o.children.eq(o.settings.startSlide).css({zIndex:o.settings.slideZIndex,display:"block"})}o.controls.el=e('<div class="bx-controls" />');if(o.settings.captions)P();o.active.last=o.settings.startSlide==x()-1;if(o.settings.video)r.fitVids();var i=o.children.eq(o.settings.startSlide);if(o.settings.preloadImages=="all")i=o.children;if(!o.settings.ticker){if(o.settings.pager)T();if(o.settings.controls)C();if(o.settings.auto&&o.settings.autoControls)E();if(o.settings.controls||o.settings.autoControls||o.settings.pager)o.viewport.after(o.controls.el)}else{o.settings.pager=false}g(i,v)};var g=function(t,i){var s=t.find("img, iframe").length;if(s==0){i();return}var n=0;t.find("img, iframe").each(function(){e(this).one("load",function(){if(++n==s)i()}).each(function(){if(this.complete)e(this).load()})})};var v=function(){if(o.settings.infiniteLoop&&o.settings.mode!="fade"&&!o.settings.ticker){var t=o.settings.mode=="vertical"?o.settings.minSlides:o.settings.maxSlides;var i=o.children.slice(0,t).clone().addClass("bx-clone");var s=o.children.slice(-t).clone().addClass("bx-clone");r.append(i).prepend(s)}o.loader.remove();S();if(o.settings.mode=="vertical")o.settings.adaptiveHeight=true;o.viewport.height(f());r.redrawSlider();o.settings.onSliderLoad(o.active.index);o.initialized=true;if(o.settings.responsive)e(window).bind("resize",j);if(o.settings.auto&&o.settings.autoStart&&(x()>1||o.settings.autoSlideForOnePage))H();if(o.settings.ticker)L();if(o.settings.pager)q(o.settings.startSlide);if(o.settings.controls)W();if(o.settings.touchEnabled&&!o.settings.ticker)N()};var f=function(){var t=0;var s=e();if(o.settings.mode!="vertical"&&!o.settings.adaptiveHeight){s=o.children}else{if(!o.carousel){s=o.children.eq(o.active.index)}else{var n=o.settings.moveSlides==1?o.active.index:o.active.index*m();s=o.children.eq(n);for(i=1;i<=o.settings.maxSlides-1;i++){if(n+i>=o.children.length){s=s.add(o.children.eq(i-1))}else{s=s.add(o.children.eq(n+i))}}}}if(o.settings.mode=="vertical"){s.each(function(i){t+=e(this).outerHeight()});if(o.settings.slideMargin>0){t+=o.settings.slideMargin*(o.settings.minSlides-1)}}else{t=Math.max.apply(Math,s.map(function(){return e(this).outerHeight(false)}).get())}if(o.viewport.css("box-sizing")=="border-box"){t+=parseFloat(o.viewport.css("padding-top"))+parseFloat(o.viewport.css("padding-bottom"))+parseFloat(o.viewport.css("border-top-width"))+parseFloat(o.viewport.css("border-bottom-width"))}else if(o.viewport.css("box-sizing")=="padding-box"){t+=parseFloat(o.viewport.css("padding-top"))+parseFloat(o.viewport.css("padding-bottom"))}return t};var u=function(){var e="100%";if(o.settings.slideWidth>0){if(o.settings.mode=="horizontal"){e=o.settings.maxSlides*o.settings.slideWidth+(o.settings.maxSlides-1)*o.settings.slideMargin}else{e=o.settings.slideWidth}}return e};var h=function(){var e=o.settings.slideWidth;var t=o.viewport.width();if(o.settings.slideWidth==0||o.settings.slideWidth>t&&!o.carousel||o.settings.mode=="vertical"){e=t}else if(o.settings.maxSlides>1&&o.settings.mode=="horizontal"){if(t>o.maxThreshold){}else if(t<o.minThreshold){e=(t-o.settings.slideMargin*(o.settings.minSlides-1))/o.settings.minSlides}}return e};var p=function(){var e=1;if(o.settings.mode=="horizontal"&&o.settings.slideWidth>0){if(o.viewport.width()<o.minThreshold){e=o.settings.minSlides}else if(o.viewport.width()>o.maxThreshold){e=o.settings.maxSlides}else{var t=o.children.first().width()+o.settings.slideMargin;e=Math.floor((o.viewport.width()+o.settings.slideMargin)/t)}}else if(o.settings.mode=="vertical"){e=o.settings.minSlides}return e};var x=function(){var e=0;if(o.settings.moveSlides>0){if(o.settings.infiniteLoop){e=Math.ceil(o.children.length/m())}else{var t=0;var i=0;while(t<o.children.length){++e;t=i+p();i+=o.settings.moveSlides<=p()?o.settings.moveSlides:p()}}}else{e=Math.ceil(o.children.length/p())}return e};var m=function(){if(o.settings.moveSlides>0&&o.settings.moveSlides<=p()){return o.settings.moveSlides}return p()};var S=function(){if(o.children.length>o.settings.maxSlides&&o.active.last&&!o.settings.infiniteLoop){if(o.settings.mode=="horizontal"){var e=o.children.last();var t=e.position();b(-(t.left-(o.viewport.width()-e.outerWidth())),"reset",0)}else if(o.settings.mode=="vertical"){var i=o.children.length-o.settings.minSlides;var t=o.children.eq(i).position();b(-t.top,"reset",0)}}else{var t=o.children.eq(o.active.index*m()).position();if(o.active.index==x()-1)o.active.last=true;if(t!=undefined){if(o.settings.mode=="horizontal")b(-t.left,"reset",0);else if(o.settings.mode=="vertical")b(-t.top,"reset",0)}}};var b=function(e,t,i,s){if(o.usingCSS){var n=o.settings.mode=="vertical"?"translate3d(0, "+e+"px, 0)":"translate3d("+e+"px, 0, 0)";r.css("-"+o.cssPrefix+"-transition-duration",i/1e3+"s");if(t=="slide"){r.css(o.animProp,n);r.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){r.unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd");D()})}else if(t=="reset"){r.css(o.animProp,n)}else if(t=="ticker"){r.css("-"+o.cssPrefix+"-transition-timing-function","linear");r.css(o.animProp,n);r.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){r.unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd");b(s["resetValue"],"reset",0);F()})}}else{var a={};a[o.animProp]=e;if(t=="slide"){r.animate(a,i,o.settings.easing,function(){D()})}else if(t=="reset"){r.css(o.animProp,e)}else if(t=="ticker"){r.animate(a,speed,"linear",function(){b(s["resetValue"],"reset",0);F()})}}};var w=function(){var t="";var i=x();for(var s=0;s<i;s++){var n="";if(o.settings.buildPager&&e.isFunction(o.settings.buildPager)){n=o.settings.buildPager(s);o.pagerEl.addClass("bx-custom-pager")}else{n=s+1;o.pagerEl.addClass("bx-default-pager")}t+='<div class="bx-pager-item"><a href="javascript:void(0)" data-slide-index="'+s+'" class="bx-pager-link">'+n+"</a></div>"}o.pagerEl.html(t)};var T=function(){if(!o.settings.pagerCustom){o.pagerEl=e('<div class="bx-pager" />');if(o.settings.pagerSelector){e(o.settings.pagerSelector).html(o.pagerEl)}else{o.controls.el.addClass("bx-has-pager").append(o.pagerEl)}w()}else{o.pagerEl=e(o.settings.pagerCustom)}o.pagerEl.on("click","a",I)};var C=function(){o.controls.next=e('<a class="bx-next" href="javascript:void(0)">'+o.settings.nextText+"</a>");o.controls.prev=e('<a class="bx-prev" href="javascript:void(0)">'+o.settings.prevText+"</a>");o.controls.next.bind("click",z);o.controls.prev.bind("click",y);if(o.settings.nextSelector){e(o.settings.nextSelector).append(o.controls.next)}if(o.settings.prevSelector){e(o.settings.prevSelector).append(o.controls.prev)}if(!o.settings.nextSelector&&!o.settings.prevSelector){o.controls.directionEl=e('<div class="bx-controls-direction" />');o.controls.directionEl.append(o.controls.prev).append(o.controls.next);o.controls.el.addClass("bx-has-controls-direction").append(o.controls.directionEl)}};var E=function(){o.controls.start=e('<div class="bx-controls-auto-item"><a class="bx-start" href="">'+o.settings.startText+"</a></div>");o.controls.stop=e('<div class="bx-controls-auto-item"><a class="bx-stop" href="">'+o.settings.stopText+"</a></div>");o.controls.autoEl=e('<div class="bx-controls-auto" />');o.controls.autoEl.on("click",".bx-start",M);o.controls.autoEl.on("click",".bx-stop",k);if(o.settings.autoControlsCombine){o.controls.autoEl.append(o.controls.start)}else{o.controls.autoEl.append(o.controls.start).append(o.controls.stop)}if(o.settings.autoControlsSelector){e(o.settings.autoControlsSelector).html(o.controls.autoEl)}else{o.controls.el.addClass("bx-has-controls-auto").append(o.controls.autoEl)}A(o.settings.autoStart?"stop":"start")};var P=function(){o.children.each(function(t){var i=e(this).find("img:first").attr("title");if(i!=undefined&&(""+i).length){e(this).append('<div class="bx-caption"><span>'+i+"</span></div>")}})};var z=function(e){if(o.settings.auto)r.stopAuto();r.goToNextSlide();e.preventDefault()};var y=function(e){if(o.settings.auto)r.stopAuto();r.goToPrevSlide();e.preventDefault()};var M=function(e){r.startAuto();e.preventDefault()};var k=function(e){r.stopAuto();e.preventDefault()};var I=function(t){if(o.settings.auto)r.stopAuto();var i=e(t.currentTarget);if(i.attr("data-slide-index")!==undefined){var s=parseInt(i.attr("data-slide-index"));if(s!=o.active.index)r.goToSlide(s);t.preventDefault()}};var q=function(t){var i=o.children.length;if(o.settings.pagerType=="short"){if(o.settings.maxSlides>1){i=Math.ceil(o.children.length/o.settings.maxSlides)}o.pagerEl.html(t+1+o.settings.pagerShortSeparator+i);return}o.pagerEl.find("a").removeClass("active");o.pagerEl.each(function(i,s){e(s).find("a").eq(t).addClass("active")})};var D=function(){if(o.settings.infiniteLoop){var e="";if(o.active.index==0){e=o.children.eq(0).position()}else if(o.active.index==x()-1&&o.carousel){e=o.children.eq((x()-1)*m()).position()}else if(o.active.index==o.children.length-1){e=o.children.eq(o.children.length-1).position()}if(e){if(o.settings.mode=="horizontal"){b(-e.left,"reset",0)}else if(o.settings.mode=="vertical"){b(-e.top,"reset",0)}}}o.working=false;o.settings.onSlideAfter(o.children.eq(o.active.index),o.oldIndex,o.active.index)};var A=function(e){if(o.settings.autoControlsCombine){o.controls.autoEl.html(o.controls[e])}else{o.controls.autoEl.find("a").removeClass("active");o.controls.autoEl.find("a:not(.bx-"+e+")").addClass("active")}};var W=function(){if(x()==1){o.controls.prev.addClass("disabled");o.controls.next.addClass("disabled")}else if(!o.settings.infiniteLoop&&o.settings.hideControlOnEnd){if(o.active.index==0){o.controls.prev.addClass("disabled");o.controls.next.removeClass("disabled")}else if(o.active.index==x()-1){o.controls.next.addClass("disabled");o.controls.prev.removeClass("disabled")}else{o.controls.prev.removeClass("disabled");o.controls.next.removeClass("disabled")}}};var H=function(){if(o.settings.autoDelay>0){var e=setTimeout(r.startAuto,o.settings.autoDelay)}else{r.startAuto()}if(o.settings.autoHover){r.hover(function(){if(o.interval){r.stopAuto(true);o.autoPaused=true}},function(){if(o.autoPaused){r.startAuto(true);o.autoPaused=null}})}};var L=function(){var t=0;if(o.settings.autoDirection=="next"){r.append(o.children.clone().addClass("bx-clone"))}else{r.prepend(o.children.clone().addClass("bx-clone"));var i=o.children.first().position();t=o.settings.mode=="horizontal"?-i.left:-i.top}b(t,"reset",0);o.settings.pager=false;o.settings.controls=false;o.settings.autoControls=false;if(o.settings.tickerHover&&!o.usingCSS){o.viewport.hover(function(){r.stop()},function(){var t=0;o.children.each(function(i){t+=o.settings.mode=="horizontal"?e(this).outerWidth(true):e(this).outerHeight(true)});var i=o.settings.speed/t;var s=o.settings.mode=="horizontal"?"left":"top";var n=i*(t-Math.abs(parseInt(r.css(s))));F(n)})}F()};var F=function(e){speed=e?e:o.settings.speed;var t={left:0,top:0};var i={left:0,top:0};if(o.settings.autoDirection=="next"){t=r.find(".bx-clone").first().position()}else{i=o.children.first().position()}var s=o.settings.mode=="horizontal"?-t.left:-t.top;var n=o.settings.mode=="horizontal"?-i.left:-i.top;var a={resetValue:n};b(s,"ticker",speed,a)};var N=function(){o.touch={start:{x:0,y:0},end:{x:0,y:0}};o.viewport.bind("touchstart",O)};var O=function(e){if(o.working){e.preventDefault()}else{o.touch.originalPos=r.position();var t=e.originalEvent;o.touch.start.x=t.changedTouches[0].pageX;o.touch.start.y=t.changedTouches[0].pageY;o.viewport.bind("touchmove",X);o.viewport.bind("touchend",Y)}};var X=function(e){var t=e.originalEvent;var i=Math.abs(t.changedTouches[0].pageX-o.touch.start.x);var s=Math.abs(t.changedTouches[0].pageY-o.touch.start.y);if(i*3>s&&o.settings.preventDefaultSwipeX){e.preventDefault()}else if(s*3>i&&o.settings.preventDefaultSwipeY){e.preventDefault()}if(o.settings.mode!="fade"&&o.settings.oneToOneTouch){var n=0;if(o.settings.mode=="horizontal"){var r=t.changedTouches[0].pageX-o.touch.start.x;n=o.touch.originalPos.left+r}else{var r=t.changedTouches[0].pageY-o.touch.start.y;n=o.touch.originalPos.top+r}b(n,"reset",0)}};var Y=function(e){o.viewport.unbind("touchmove",X);var t=e.originalEvent;var i=0;o.touch.end.x=t.changedTouches[0].pageX;o.touch.end.y=t.changedTouches[0].pageY;if(o.settings.mode=="fade"){var s=Math.abs(o.touch.start.x-o.touch.end.x);if(s>=o.settings.swipeThreshold){o.touch.start.x>o.touch.end.x?r.goToNextSlide():r.goToPrevSlide();r.stopAuto()}}else{var s=0;if(o.settings.mode=="horizontal"){s=o.touch.end.x-o.touch.start.x;i=o.touch.originalPos.left}else{s=o.touch.end.y-o.touch.start.y;i=o.touch.originalPos.top}if(!o.settings.infiniteLoop&&(o.active.index==0&&s>0||o.active.last&&s<0)){b(i,"reset",200)}else{if(Math.abs(s)>=o.settings.swipeThreshold){s<0?r.goToNextSlide():r.goToPrevSlide();r.stopAuto()}else{b(i,"reset",200)}}}o.viewport.unbind("touchend",Y)};var j=function(t){if(!o.initialized)return;var i=e(window).width();var s=e(window).height();if(a!=i||l!=s){a=i;l=s;r.redrawSlider();o.settings.onSliderResize.call(r,o.active.index)}};r.goToSlide=function(t,i){if(o.working||o.active.index==t)return;o.working=true;o.oldIndex=o.active.index;if(t<0){o.active.index=x()-1}else if(t>=x()){o.active.index=0}else{o.active.index=t}o.settings.onSlideBefore(o.children.eq(o.active.index),o.oldIndex,o.active.index);if(i=="next"){o.settings.onSlideNext(o.children.eq(o.active.index),o.oldIndex,o.active.index)}else if(i=="prev"){o.settings.onSlidePrev(o.children.eq(o.active.index),o.oldIndex,o.active.index)}o.active.last=o.active.index>=x()-1;if(o.settings.pager)q(o.active.index);if(o.settings.controls)W();if(o.settings.mode=="fade"){if(o.settings.adaptiveHeight&&o.viewport.height()!=f()){o.viewport.animate({height:f()},o.settings.adaptiveHeightSpeed)}o.children.filter(":visible").fadeOut(o.settings.speed).css({zIndex:0});o.children.eq(o.active.index).css("zIndex",o.settings.slideZIndex+1).fadeIn(o.settings.speed,function(){e(this).css("zIndex",o.settings.slideZIndex);D()})}else{if(o.settings.adaptiveHeight&&o.viewport.height()!=f()){o.viewport.animate({height:f()},o.settings.adaptiveHeightSpeed)}var s=0;var n={left:0,top:0};if(!o.settings.infiniteLoop&&o.carousel&&o.active.last){if(o.settings.mode=="horizontal"){var a=o.children.eq(o.children.length-1);n=a.position();s=o.viewport.width()-a.outerWidth()}else{var l=o.children.length-o.settings.minSlides;n=o.children.eq(l).position()}}else if(o.carousel&&o.active.last&&i=="prev"){var d=o.settings.moveSlides==1?o.settings.maxSlides-m():(x()-1)*m()-(o.children.length-o.settings.maxSlides);var a=r.children(".bx-clone").eq(d);n=a.position()}else if(i=="next"&&o.active.index==0){n=r.find("> .bx-clone").eq(o.settings.maxSlides).position();o.active.last=false}else if(t>=0){var c=t*m();n=o.children.eq(c).position()}if("undefined"!==typeof n){var g=o.settings.mode=="horizontal"?-(n.left-s):-n.top;b(g,"slide",o.settings.speed)}}};r.goToNextSlide=function(){if(!o.settings.infiniteLoop&&o.active.last)return;var e=parseInt(o.active.index)+1;r.goToSlide(e,"next")};r.goToPrevSlide=function(){if(!o.settings.infiniteLoop&&o.active.index==0)return;var e=parseInt(o.active.index)-1;r.goToSlide(e,"prev")};r.startAuto=function(e){if(o.interval)return;o.interval=setInterval(function(){o.settings.autoDirection=="next"?r.goToNextSlide():r.goToPrevSlide()},o.settings.pause);if(o.settings.autoControls&&e!=true)A("stop")};r.stopAuto=function(e){if(!o.interval)return;clearInterval(o.interval);o.interval=null;if(o.settings.autoControls&&e!=true)A("start")};r.getCurrentSlide=function(){return o.active.index};r.getCurrentSlideElement=function(){return o.children.eq(o.active.index)};r.getSlideCount=function(){return o.children.length};r.redrawSlider=function(){o.children.add(r.find(".bx-clone")).width(h());o.viewport.css("height",f());if(!o.settings.ticker)S();if(o.active.last)o.active.index=x()-1;if(o.active.index>=x())o.active.last=true;if(o.settings.pager&&!o.settings.pagerCustom){w();q(o.active.index)}};r.destroySlider=function(){if(!o.initialized)return;o.initialized=false;e(".bx-clone",this).remove();o.children.each(function(){e(this).data("origStyle")!=undefined?e(this).attr("style",e(this).data("origStyle")):e(this).removeAttr("style")});e(this).data("origStyle")!=undefined?this.attr("style",e(this).data("origStyle")):e(this).removeAttr("style");e(this).unwrap().unwrap();if(o.controls.el)o.controls.el.remove();if(o.controls.next)o.controls.next.remove();if(o.controls.prev)o.controls.prev.remove();if(o.pagerEl&&o.settings.controls)o.pagerEl.remove();e(".bx-caption",this).remove();if(o.controls.autoEl)o.controls.autoEl.remove();clearInterval(o.interval);if(o.settings.responsive)e(window).unbind("resize",j)};r.reloadSlider=function(e){if(e!=undefined)n=e;r.destroySlider();d()};d();return this}})(jQuery);(function(e){if(typeof e.fn.each2=="undefined"){e.extend(e.fn,{each2:function(t){var s=e([0]),i=-1,n=this.length;while(++i<n&&(s.context=s[0]=this[i])&&t.call(s[0],i,s)!==false);return this}})}})(jQuery);(function(e,t){"use strict";if(window.Select2!==t){return}var s,i,n,o,r,a={x:0,y:0},l,c,h={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(e){e=e.which?e.which:e;switch(e){case h.LEFT:case h.RIGHT:case h.UP:case h.DOWN:return true}return false},isControl:function(e){var t=e.which;switch(t){case h.SHIFT:case h.CTRL:case h.ALT:return true}if(e.metaKey)return true;return false},isFunctionKey:function(e){e=e.which?e.which:e;return e>=112&&e<=123}},u="<div class='select2-measure-scrollbar'></div>",f={"Ⓐ":"A","Ａ":"A","À":"A","Á":"A","Â":"A","Ầ":"A","Ấ":"A","Ẫ":"A","Ẩ":"A","Ã":"A","Ā":"A","Ă":"A","Ằ":"A","Ắ":"A","Ẵ":"A","Ẳ":"A","Ȧ":"A","Ǡ":"A","Ä":"A","Ǟ":"A","Ả":"A","Å":"A","Ǻ":"A","Ǎ":"A","Ȁ":"A","Ȃ":"A","Ạ":"A","Ậ":"A","Ặ":"A","Ḁ":"A","Ą":"A","Ⱥ":"A","Ɐ":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ⓑ":"B","Ｂ":"B","Ḃ":"B","Ḅ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ɓ":"B","Ⓒ":"C","Ｃ":"C","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","Ç":"C","Ḉ":"C","Ƈ":"C","Ȼ":"C","Ꜿ":"C","Ⓓ":"D","Ｄ":"D","Ḋ":"D","Ď":"D","Ḍ":"D","Ḑ":"D","Ḓ":"D","Ḏ":"D","Đ":"D","Ƌ":"D","Ɗ":"D","Ɖ":"D","Ꝺ":"D","Ǳ":"DZ","Ǆ":"DZ","ǲ":"Dz","ǅ":"Dz","Ⓔ":"E","Ｅ":"E","È":"E","É":"E","Ê":"E","Ề":"E","Ế":"E","Ễ":"E","Ể":"E","Ẽ":"E","Ē":"E","Ḕ":"E","Ḗ":"E","Ĕ":"E","Ė":"E","Ë":"E","Ẻ":"E","Ě":"E","Ȅ":"E","Ȇ":"E","Ẹ":"E","Ệ":"E","Ȩ":"E","Ḝ":"E","Ę":"E","Ḙ":"E","Ḛ":"E","Ɛ":"E","Ǝ":"E","Ⓕ":"F","Ｆ":"F","Ḟ":"F","Ƒ":"F","Ꝼ":"F","Ⓖ":"G","Ｇ":"G","Ǵ":"G","Ĝ":"G","Ḡ":"G","Ğ":"G","Ġ":"G","Ǧ":"G","Ģ":"G","Ǥ":"G","Ɠ":"G","Ꞡ":"G","Ᵹ":"G","Ꝿ":"G","Ⓗ":"H","Ｈ":"H","Ĥ":"H","Ḣ":"H","Ḧ":"H","Ȟ":"H","Ḥ":"H","Ḩ":"H","Ḫ":"H","Ħ":"H","Ⱨ":"H","Ⱶ":"H","Ɥ":"H","Ⓘ":"I","Ｉ":"I","Ì":"I","Í":"I","Î":"I","Ĩ":"I","Ī":"I","Ĭ":"I","İ":"I","Ï":"I","Ḯ":"I","Ỉ":"I","Ǐ":"I","Ȉ":"I","Ȋ":"I","Ị":"I","Į":"I","Ḭ":"I","Ɨ":"I","Ⓙ":"J","Ｊ":"J","Ĵ":"J","Ɉ":"J","Ⓚ":"K","Ｋ":"K","Ḱ":"K","Ǩ":"K","Ḳ":"K","Ķ":"K","Ḵ":"K","Ƙ":"K","Ⱪ":"K","Ꝁ":"K","Ꝃ":"K","Ꝅ":"K","Ꞣ":"K","Ⓛ":"L","Ｌ":"L","Ŀ":"L","Ĺ":"L","Ľ":"L","Ḷ":"L","Ḹ":"L","Ļ":"L","Ḽ":"L","Ḻ":"L","Ł":"L","Ƚ":"L","Ɫ":"L","Ⱡ":"L","Ꝉ":"L","Ꝇ":"L","Ꞁ":"L","Ǉ":"LJ","ǈ":"Lj","Ⓜ":"M","Ｍ":"M","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ɯ":"M","Ⓝ":"N","Ｎ":"N","Ǹ":"N","Ń":"N","Ñ":"N","Ṅ":"N","Ň":"N","Ṇ":"N","Ņ":"N","Ṋ":"N","Ṉ":"N","Ƞ":"N","Ɲ":"N","Ꞑ":"N","Ꞥ":"N","Ǌ":"NJ","ǋ":"Nj","Ⓞ":"O","Ｏ":"O","Ò":"O","Ó":"O","Ô":"O","Ồ":"O","Ố":"O","Ỗ":"O","Ổ":"O","Õ":"O","Ṍ":"O","Ȭ":"O","Ṏ":"O","Ō":"O","Ṑ":"O","Ṓ":"O","Ŏ":"O","Ȯ":"O","Ȱ":"O","Ö":"O","Ȫ":"O","Ỏ":"O","Ő":"O","Ǒ":"O","Ȍ":"O","Ȏ":"O","Ơ":"O","Ờ":"O","Ớ":"O","Ỡ":"O","Ở":"O","Ợ":"O","Ọ":"O","Ộ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Ɔ":"O","Ɵ":"O","Ꝋ":"O","Ꝍ":"O","Ƣ":"OI","Ꝏ":"OO","Ȣ":"OU","Ⓟ":"P","Ｐ":"P","Ṕ":"P","Ṗ":"P","Ƥ":"P","Ᵽ":"P","Ꝑ":"P","Ꝓ":"P","Ꝕ":"P","Ⓠ":"Q","Ｑ":"Q","Ꝗ":"Q","Ꝙ":"Q","Ɋ":"Q","Ⓡ":"R","Ｒ":"R","Ŕ":"R","Ṙ":"R","Ř":"R","Ȑ":"R","Ȓ":"R","Ṛ":"R","Ṝ":"R","Ŗ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꝛ":"R","Ꞧ":"R","Ꞃ":"R","Ⓢ":"S","Ｓ":"S","ẞ":"S","Ś":"S","Ṥ":"S","Ŝ":"S","Ṡ":"S","Š":"S","Ṧ":"S","Ṣ":"S","Ṩ":"S","Ș":"S","Ş":"S","Ȿ":"S","Ꞩ":"S","Ꞅ":"S","Ⓣ":"T","Ｔ":"T","Ṫ":"T","Ť":"T","Ṭ":"T","Ț":"T","Ţ":"T","Ṱ":"T","Ṯ":"T","Ŧ":"T","Ƭ":"T","Ʈ":"T","Ⱦ":"T","Ꞇ":"T","Ꜩ":"TZ","Ⓤ":"U","Ｕ":"U","Ù":"U","Ú":"U","Û":"U","Ũ":"U","Ṹ":"U","Ū":"U","Ṻ":"U","Ŭ":"U","Ü":"U","Ǜ":"U","Ǘ":"U","Ǖ":"U","Ǚ":"U","Ủ":"U","Ů":"U","Ű":"U","Ǔ":"U","Ȕ":"U","Ȗ":"U","Ư":"U","Ừ":"U","Ứ":"U","Ữ":"U","Ử":"U","Ự":"U","Ụ":"U","Ṳ":"U","Ų":"U","Ṷ":"U","Ṵ":"U","Ʉ":"U","Ⓥ":"V","Ｖ":"V","Ṽ":"V","Ṿ":"V","Ʋ":"V","Ꝟ":"V","Ʌ":"V","Ꝡ":"VY","Ⓦ":"W","Ｗ":"W","Ẁ":"W","Ẃ":"W","Ŵ":"W","Ẇ":"W","Ẅ":"W","Ẉ":"W","Ⱳ":"W","Ⓧ":"X","Ｘ":"X","Ẋ":"X","Ẍ":"X","Ⓨ":"Y","Ｙ":"Y","Ỳ":"Y","Ý":"Y","Ŷ":"Y","Ỹ":"Y","Ȳ":"Y","Ẏ":"Y","Ÿ":"Y","Ỷ":"Y","Ỵ":"Y","Ƴ":"Y","Ɏ":"Y","Ỿ":"Y","Ⓩ":"Z","Ｚ":"Z","Ź":"Z","Ẑ":"Z","Ż":"Z","Ž":"Z","Ẓ":"Z","Ẕ":"Z","Ƶ":"Z","Ȥ":"Z","Ɀ":"Z","Ⱬ":"Z","Ꝣ":"Z","ⓐ":"a","ａ":"a","ẚ":"a","à":"a","á":"a","â":"a","ầ":"a","ấ":"a","ẫ":"a","ẩ":"a","ã":"a","ā":"a","ă":"a","ằ":"a","ắ":"a","ẵ":"a","ẳ":"a","ȧ":"a","ǡ":"a","ä":"a","ǟ":"a","ả":"a","å":"a","ǻ":"a","ǎ":"a","ȁ":"a","ȃ":"a","ạ":"a","ậ":"a","ặ":"a","ḁ":"a","ą":"a","ⱥ":"a","ɐ":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ⓑ":"b","ｂ":"b","ḃ":"b","ḅ":"b","ḇ":"b","ƀ":"b","ƃ":"b","ɓ":"b","ⓒ":"c","ｃ":"c","ć":"c","ĉ":"c","ċ":"c","č":"c","ç":"c","ḉ":"c","ƈ":"c","ȼ":"c","ꜿ":"c","ↄ":"c","ⓓ":"d","ｄ":"d","ḋ":"d","ď":"d","ḍ":"d","ḑ":"d","ḓ":"d","ḏ":"d","đ":"d","ƌ":"d","ɖ":"d","ɗ":"d","ꝺ":"d","ǳ":"dz","ǆ":"dz","ⓔ":"e","ｅ":"e","è":"e","é":"e","ê":"e","ề":"e","ế":"e","ễ":"e","ể":"e","ẽ":"e","ē":"e","ḕ":"e","ḗ":"e","ĕ":"e","ė":"e","ë":"e","ẻ":"e","ě":"e","ȅ":"e","ȇ":"e","ẹ":"e","ệ":"e","ȩ":"e","ḝ":"e","ę":"e","ḙ":"e","ḛ":"e","ɇ":"e","ɛ":"e","ǝ":"e","ⓕ":"f","ｆ":"f","ḟ":"f","ƒ":"f","ꝼ":"f","ⓖ":"g","ｇ":"g","ǵ":"g","ĝ":"g","ḡ":"g","ğ":"g","ġ":"g","ǧ":"g","ģ":"g","ǥ":"g","ɠ":"g","ꞡ":"g","ᵹ":"g","ꝿ":"g","ⓗ":"h","ｈ":"h","ĥ":"h","ḣ":"h","ḧ":"h","ȟ":"h","ḥ":"h","ḩ":"h","ḫ":"h","ẖ":"h","ħ":"h","ⱨ":"h","ⱶ":"h","ɥ":"h","ƕ":"hv","ⓘ":"i","ｉ":"i","ì":"i","í":"i","î":"i","ĩ":"i","ī":"i","ĭ":"i","ï":"i","ḯ":"i","ỉ":"i","ǐ":"i","ȉ":"i","ȋ":"i","ị":"i","į":"i","ḭ":"i","ɨ":"i","ı":"i","ⓙ":"j","ｊ":"j","ĵ":"j","ǰ":"j","ɉ":"j","ⓚ":"k","ｋ":"k","ḱ":"k","ǩ":"k","ḳ":"k","ķ":"k","ḵ":"k","ƙ":"k","ⱪ":"k","ꝁ":"k","ꝃ":"k","ꝅ":"k","ꞣ":"k","ⓛ":"l","ｌ":"l","ŀ":"l","ĺ":"l","ľ":"l","ḷ":"l","ḹ":"l","ļ":"l","ḽ":"l","ḻ":"l","ſ":"l","ł":"l","ƚ":"l","ɫ":"l","ⱡ":"l","ꝉ":"l","ꞁ":"l","ꝇ":"l","ǉ":"lj","ⓜ":"m","ｍ":"m","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ɯ":"m","ⓝ":"n","ｎ":"n","ǹ":"n","ń":"n","ñ":"n","ṅ":"n","ň":"n","ṇ":"n","ņ":"n","ṋ":"n","ṉ":"n","ƞ":"n","ɲ":"n","ŉ":"n","ꞑ":"n","ꞥ":"n","ǌ":"nj","ⓞ":"o","ｏ":"o","ò":"o","ó":"o","ô":"o","ồ":"o","ố":"o","ỗ":"o","ổ":"o","õ":"o","ṍ":"o","ȭ":"o","ṏ":"o","ō":"o","ṑ":"o","ṓ":"o","ŏ":"o","ȯ":"o","ȱ":"o","ö":"o","ȫ":"o","ỏ":"o","ő":"o","ǒ":"o","ȍ":"o","ȏ":"o","ơ":"o","ờ":"o","ớ":"o","ỡ":"o","ở":"o","ợ":"o","ọ":"o","ộ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","ɔ":"o","ꝋ":"o","ꝍ":"o","ɵ":"o","ƣ":"oi","ȣ":"ou","ꝏ":"oo","ⓟ":"p","ｐ":"p","ṕ":"p","ṗ":"p","ƥ":"p","ᵽ":"p","ꝑ":"p","ꝓ":"p","ꝕ":"p","ⓠ":"q","ｑ":"q","ɋ":"q","ꝗ":"q","ꝙ":"q","ⓡ":"r","ｒ":"r","ŕ":"r","ṙ":"r","ř":"r","ȑ":"r","ȓ":"r","ṛ":"r","ṝ":"r","ŗ":"r","ṟ":"r","ɍ":"r","ɽ":"r","ꝛ":"r","ꞧ":"r","ꞃ":"r","ⓢ":"s","ｓ":"s","ß":"s","ś":"s","ṥ":"s","ŝ":"s","ṡ":"s","š":"s","ṧ":"s","ṣ":"s","ṩ":"s","ș":"s","ş":"s","ȿ":"s","ꞩ":"s","ꞅ":"s","ẛ":"s","ⓣ":"t","ｔ":"t","ṫ":"t","ẗ":"t","ť":"t","ṭ":"t","ț":"t","ţ":"t","ṱ":"t","ṯ":"t","ŧ":"t","ƭ":"t","ʈ":"t","ⱦ":"t","ꞇ":"t","ꜩ":"tz","ⓤ":"u","ｕ":"u","ù":"u","ú":"u","û":"u","ũ":"u","ṹ":"u","ū":"u","ṻ":"u","ŭ":"u","ü":"u","ǜ":"u","ǘ":"u","ǖ":"u","ǚ":"u","ủ":"u","ů":"u","ű":"u","ǔ":"u","ȕ":"u","ȗ":"u","ư":"u","ừ":"u","ứ":"u","ữ":"u","ử":"u","ự":"u","ụ":"u","ṳ":"u","ų":"u","ṷ":"u","ṵ":"u","ʉ":"u","ⓥ":"v","ｖ":"v","ṽ":"v","ṿ":"v","ʋ":"v","ꝟ":"v","ʌ":"v","ꝡ":"vy","ⓦ":"w","ｗ":"w","ẁ":"w","ẃ":"w","ŵ":"w","ẇ":"w","ẅ":"w","ẘ":"w","ẉ":"w","ⱳ":"w","ⓧ":"x","ｘ":"x","ẋ":"x","ẍ":"x","ⓨ":"y","ｙ":"y","ỳ":"y","ý":"y","ŷ":"y","ỹ":"y","ȳ":"y","ẏ":"y","ÿ":"y","ỷ":"y","ẙ":"y","ỵ":"y","ƴ":"y","ɏ":"y","ỿ":"y","ⓩ":"z","ｚ":"z","ź":"z","ẑ":"z","ż":"z","ž":"z","ẓ":"z","ẕ":"z","ƶ":"z","ȥ":"z","ɀ":"z","ⱬ":"z","ꝣ":"z","Ά":"Α","Έ":"Ε","Ή":"Η","Ί":"Ι","Ϊ":"Ι","Ό":"Ο","Ύ":"Υ","Ϋ":"Υ","Ώ":"Ω","ά":"α","έ":"ε","ή":"η","ί":"ι","ϊ":"ι","ΐ":"ι","ό":"ο","ύ":"υ","ϋ":"υ","ΰ":"υ","ω":"ω","ς":"σ"};l=e(document);o=function(){var e=1;return function(){return e++}}();function d(t){var s=e(document.createTextNode(""));t.before(s);s.before(t);s.remove()}function p(e){function t(e){return f[e]||e}return e.replace(/[^\u0000-\u007E]/g,t)}function g(e,t){var s=0,i=t.length;for(;s<i;s=s+1){if(v(e,t[s]))return s}return-1}function m(){var t=e(u);t.appendTo(document.body);var s={width:t.width()-t[0].clientWidth,height:t.height()-t[0].clientHeight};t.remove();return s}function v(e,s){if(e===s)return true;if(e===t||s===t)return false;if(e===null||s===null)return false;if(e.constructor===String)return e+""===s+"";if(s.constructor===String)return s+""===e+"";return false}function w(e,t,s){var i,n,o;if(e===null||e.length<1)return[];i=e.split(t);for(n=0,o=i.length;n<o;n=n+1)i[n]=s(i[n]);return i}function b(e){return e.outerWidth(false)-e.width()}function C(s){var i="keyup-change-value";s.on("keydown",function(){if(e.data(s,i)===t){e.data(s,i,s.val())}});s.on("keyup",function(){var n=e.data(s,i);if(n!==t&&s.val()!==n){e.removeData(s,i);s.trigger("keyup-change")}})}function S(s){s.on("mousemove",function(s){var i=a;if(i===t||i.x!==s.pageX||i.y!==s.pageY){e(s.target).trigger("mousemove-filtered",s)}})}function y(e,s,i){i=i||t;var n;return function(){var t=arguments;window.clearTimeout(n);n=window.setTimeout(function(){s.apply(i,t)},e)}}function E(e,t){var s=y(e,function(e){t.trigger("scroll-debounced",e)});t.on("scroll",function(e){if(g(e.target,t.get())>=0)s(e)})}function x(e){if(e[0]===document.activeElement)return;window.setTimeout(function(){var t=e[0],s=e.val().length,i;e.focus();var n=t.offsetWidth>0||t.offsetHeight>0;if(n&&t===document.activeElement){if(t.setSelectionRange){t.setSelectionRange(s,s)}else if(t.createTextRange){i=t.createTextRange();i.collapse(false);i.select()}}},0)}function T(t){t=e(t)[0];var s=0;var i=0;if("selectionStart"in t){s=t.selectionStart;i=t.selectionEnd-s}else if("selection"in document){t.focus();var n=document.selection.createRange();i=document.selection.createRange().text.length;n.moveStart("character",-t.value.length);s=n.text.length-i}return{offset:s,length:i}}function O(e){e.preventDefault();e.stopPropagation()}function P(e){e.preventDefault();e.stopImmediatePropagation()}function I(t){if(!r){var s=t[0].currentStyle||window.getComputedStyle(t[0],null);r=e(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:s.fontSize,fontFamily:s.fontFamily,fontStyle:s.fontStyle,fontWeight:s.fontWeight,letterSpacing:s.letterSpacing,textTransform:s.textTransform,whiteSpace:"nowrap"});r.attr("class","select2-sizer");e(document.body).append(r)}r.text(t.val());return r.width()}function k(t,s,i){var n,o=[],r;n=e.trim(t.attr("class"));if(n){n=""+n;e(n.split(/\s+/)).each2(function(){if(this.indexOf("select2-")===0){o.push(this)}})}n=e.trim(s.attr("class"));if(n){n=""+n;e(n.split(/\s+/)).each2(function(){if(this.indexOf("select2-")!==0){r=i(this);if(r){o.push(r)}}})}t.attr("class",o.join(" "))}function A(e,t,s,i){var n=p(e.toUpperCase()).indexOf(p(t.toUpperCase())),o=t.length;if(n<0){s.push(i(e));return}s.push(i(e.substring(0,n)));s.push("<span class='select2-match'>");s.push(i(e.substring(n,n+o)));s.push("</span>");s.push(i(e.substring(n+o,e.length)))}function R(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return String(e).replace(/[&<>"'\/\\]/g,function(e){return t[e]})}function D(s){var i,n=null,o=s.quietMillis||100,r=s.url,a=this;return function(l){window.clearTimeout(i);i=window.setTimeout(function(){var i=s.data,o=r,c=s.transport||e.fn.select2.ajaxDefaults.transport,h={type:s.type||"GET",cache:s.cache||false,jsonpCallback:s.jsonpCallback||t,dataType:s.dataType||"json"},u=e.extend({},e.fn.select2.ajaxDefaults.params,h);i=i?i.call(a,l.term,l.page,l.context):null;o=typeof o==="function"?o.call(a,l.term,l.page,l.context):o;if(n&&typeof n.abort==="function"){n.abort()}if(s.params){if(e.isFunction(s.params)){e.extend(u,s.params.call(a))}else{e.extend(u,s.params)}}e.extend(u,{url:o,dataType:s.dataType,data:i,success:function(e){var t=s.results(e,l.page,l);l.callback(t)},error:function(e,t,s){var i={hasError:true,jqXHR:e,textStatus:t,errorThrown:s};l.callback(i)}});n=c.call(a,u)},o)}}function H(t){var s=t,i,n,o=function(e){return""+e.text};if(e.isArray(s)){n=s;s={results:n}}if(e.isFunction(s)===false){n=s;s=function(){return n}}var r=s();if(r.text){o=r.text;if(!e.isFunction(o)){i=r.text;o=function(e){return e[i]}}}return function(t){var i=t.term,n={results:[]},r;if(i===""){t.callback(s());return}r=function(s,n){var a,l;s=s[0];if(s.children){a={};for(l in s){if(s.hasOwnProperty(l))a[l]=s[l]}a.children=[];e(s.children).each2(function(e,t){r(t,a.children)});if(a.children.length||t.matcher(i,o(a),s)){n.push(a)}}else{if(t.matcher(i,o(s),s)){n.push(s)}}};e(s().results).each2(function(e,t){r(t,n.results)});t.callback(n)}}function M(s){var i=e.isFunction(s);return function(n){var o=n.term,r={results:[]};var a=i?s(n):s;if(e.isArray(a)){e(a).each(function(){var e=this.text!==t,s=e?this.text:this;if(o===""||n.matcher(o,s)){r.results.push(e?this:{id:this,text:this})}});n.callback(r)}}}function N(t,s){if(e.isFunction(t))return true;if(!t)return false;if(typeof t==="string")return true;throw new Error(s+" must be a string, function, or falsy value")}function L(t,s){if(e.isFunction(t)){var i=Array.prototype.slice.call(arguments,2);return t.apply(s,i)}return t}function F(t){var s=0;e.each(t,function(e,t){if(t.children){s+=F(t.children)}else{s++}});return s}function U(e,s,i,n){var o=e,r=false,a,l,c,h,u;if(!n.createSearchChoice||!n.tokenSeparators||n.tokenSeparators.length<1)return t;while(true){l=-1;for(c=0,h=n.tokenSeparators.length;c<h;c++){u=n.tokenSeparators[c];l=e.indexOf(u);if(l>=0)break}if(l<0)break;a=e.substring(0,l);e=e.substring(l+u.length);if(a.length>0){a=n.createSearchChoice.call(this,a,s);if(a!==t&&a!==null&&n.id(a)!==t&&n.id(a)!==null){r=false;for(c=0,h=s.length;c<h;c++){if(v(n.id(a),n.id(s[c]))){r=true;break}}if(!r)i(a)}}}if(o!==e)return e}function z(){var t=this;e.each(arguments,function(e,s){t[s].remove();t[s]=null})}function j(t,s){var i=function(){};i.prototype=new t;i.prototype.constructor=i;i.prototype.parent=t.prototype;i.prototype=e.extend(i.prototype,s);return i}s=j(Object,{bind:function(e){var t=this;return function(){e.apply(t,arguments)}},init:function(s){var i,n,r=".select2-results";this.opts=s=this.prepareOpts(s);this.id=s.id;if(s.element.data("select2")!==t&&s.element.data("select2")!==null){s.element.data("select2").destroy()}this.container=this.createContainer();this.liveRegion=e(".select2-hidden-accessible");if(this.liveRegion.length==0){this.liveRegion=e("<span>",{role:"status","aria-live":"polite"}).addClass("select2-hidden-accessible").appendTo(document.body)}this.containerId="s2id_"+(s.element.attr("id")||"autogen"+o());this.containerEventName=this.containerId.replace(/([.])/g,"_").replace(/([;&,\-\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1");this.container.attr("id",this.containerId);this.container.attr("title",s.element.attr("title"));this.body=e(document.body);k(this.container,this.opts.element,this.opts.adaptContainerCssClass);this.container.attr("style",s.element.attr("style"));this.container.css(L(s.containerCss,this.opts.element));this.container.addClass(L(s.containerCssClass,this.opts.element));this.elementTabIndex=this.opts.element.attr("tabindex");this.opts.element.data("select2",this).attr("tabindex","-1").before(this.container).on("click.select2",O);this.container.data("select2",this);this.dropdown=this.container.find(".select2-drop");k(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass);this.dropdown.addClass(L(s.dropdownCssClass,this.opts.element));this.dropdown.data("select2",this);this.dropdown.on("click",O);this.results=i=this.container.find(r);this.search=n=this.container.find("input.select2-input");this.queryCount=0;this.resultsPage=0;this.context=null;this.initContainer();this.container.on("click",O);S(this.results);this.dropdown.on("mousemove-filtered",r,this.bind(this.highlightUnderEvent));this.dropdown.on("touchstart touchmove touchend",r,this.bind(function(e){this._touchEvent=true;this.highlightUnderEvent(e)}));this.dropdown.on("touchmove",r,this.bind(this.touchMoved));this.dropdown.on("touchstart touchend",r,this.bind(this.clearTouchMoved));this.dropdown.on("click",this.bind(function(e){if(this._touchEvent){this._touchEvent=false;this.selectHighlighted()}}));E(80,this.results);this.dropdown.on("scroll-debounced",r,this.bind(this.loadMoreIfNeeded));e(this.container).on("change",".select2-input",function(e){e.stopPropagation()});e(this.dropdown).on("change",".select2-input",function(e){e.stopPropagation()});if(e.fn.mousewheel){i.mousewheel(function(e,t,s,n){var o=i.scrollTop();if(n>0&&o-n<=0){i.scrollTop(0);O(e)}else if(n<0&&i.get(0).scrollHeight-i.scrollTop()+n<=i.height()){i.scrollTop(i.get(0).scrollHeight-i.height());O(e)}})}C(n);n.on("keyup-change input paste",this.bind(this.updateResults));n.on("focus",function(){n.addClass("select2-focused")});n.on("blur",function(){n.removeClass("select2-focused")});this.dropdown.on("mouseup",r,this.bind(function(t){if(e(t.target).closest(".select2-result-selectable").length>0){this.highlightUnderEvent(t);this.selectHighlighted(t)}}));this.dropdown.on("click mouseup mousedown touchstart touchend focusin",function(e){e.stopPropagation()});this.lastSearchTerm=t;if(e.isFunction(this.opts.initSelection)){this.initSelection();this.monitorSource()}if(s.maximumInputLength!==null){this.search.attr("maxlength",s.maximumInputLength)}var a=s.element.prop("disabled");if(a===t)a=false;this.enable(!a);var l=s.element.prop("readonly");if(l===t)l=false;this.readonly(l);c=c||m();this.autofocus=s.element.prop("autofocus");s.element.prop("autofocus",false);if(this.autofocus)this.focus();this.search.attr("placeholder",s.searchInputPlaceholder)},destroy:function(){var e=this.opts.element,s=e.data("select2"),i=this;this.close();if(e.length&&e[0].detachEvent&&i._sync){e.each(function(){if(i._sync){this.detachEvent("onpropertychange",i._sync)}})}if(this.propertyObserver){this.propertyObserver.disconnect();this.propertyObserver=null}this._sync=null;if(s!==t){s.container.remove();s.liveRegion.remove();s.dropdown.remove();e.removeData("select2").off("select2");if(!e.is("input[type='hidden']")){e.show().prop("autofocus",this.autofocus||false);if(this.elementTabIndex){e.attr({tabindex:this.elementTabIndex})}else{e.removeAttr("tabindex")}e.show()}else{e.css("display","")}}z.call(this,"container","liveRegion","dropdown","results","search")},optionToData:function(e){if(e.is("option")){return{id:e.prop("value"),text:e.text(),element:e.get(),css:e.attr("class"),disabled:e.prop("disabled"),locked:v(e.attr("locked"),"locked")||v(e.data("locked"),true)}}else if(e.is("optgroup")){return{text:e.attr("label"),children:[],element:e.get(),css:e.attr("class")}}},prepareOpts:function(s){var i,n,r,a,l=this;i=s.element;if(i.get(0).tagName.toLowerCase()==="select"){this.select=n=s.element}if(n){e.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in s){throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}})}s=e.extend({},{populateResults:function(i,n,r){var a,c=this.opts.id,h=this.liveRegion;a=function(i,n,u){var f,d,p,g,m,v,w,b,C,S;i=s.sortResults(i,n,r);var y=[];for(f=0,d=i.length;f<d;f=f+1){p=i[f];m=p.disabled===true;g=!m&&c(p)!==t;v=p.children&&p.children.length>0;w=e("<li></li>");w.addClass("select2-results-dept-"+u);w.addClass("select2-result");w.addClass(g?"select2-result-selectable":"select2-result-unselectable");if(m){w.addClass("select2-disabled")}if(v){w.addClass("select2-result-with-children")}w.addClass(l.opts.formatResultCssClass(p));w.attr("role","presentation");b=e(document.createElement("div"));b.addClass("select2-result-label");b.attr("id","select2-result-label-"+o());b.attr("role","option");S=s.formatResult(p,b,r,l.opts.escapeMarkup);if(S!==t){b.html(S);w.append(b)}if(v){C=e("<ul></ul>");C.addClass("select2-result-sub");a(p.children,C,u+1);w.append(C)}w.data("select2-data",p);y.push(w[0])}n.append(y);h.text(s.formatMatches(i.length))};a(n,i,0)}},e.fn.select2.defaults,s);if(typeof s.id!=="function"){r=s.id;s.id=function(e){return e[r]}}if(e.isArray(s.element.data("select2Tags"))){if("tags"in s){throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+s.element.attr("id")}s.tags=s.element.data("select2Tags")}if(n){s.query=this.bind(function(e){var s={results:[],more:false},n=e.term,o,r,a;a=function(t,s){var i;if(t.is("option")){if(e.matcher(n,t.text(),t)){s.push(l.optionToData(t))}}else if(t.is("optgroup")){i=l.optionToData(t);t.children().each2(function(e,t){a(t,i.children)});if(i.children.length>0){s.push(i)}}};o=i.children();if(this.getPlaceholder()!==t&&o.length>0){r=this.getPlaceholderOption();if(r){o=o.not(r)}}o.each2(function(e,t){a(t,s.results)});e.callback(s)});s.id=function(e){return e.id}}else{if(!("query"in s)){if("ajax"in s){a=s.element.data("ajax-url");if(a&&a.length>0){s.ajax.url=a}s.query=D.call(s.element,s.ajax)}else if("data"in s){s.query=H(s.data)}else if("tags"in s){s.query=M(s.tags);if(s.createSearchChoice===t){s.createSearchChoice=function(t){return{id:e.trim(t),text:e.trim(t)}}}if(s.initSelection===t){s.initSelection=function(t,i){var n=[];e(w(t.val(),s.separator,s.transformVal)).each(function(){var t={id:this,text:this},i=s.tags;if(e.isFunction(i))i=i();e(i).each(function(){if(v(this.id,t.id)){t=this;return false}});n.push(t)});i(n)}}}}}if(typeof s.query!=="function"){throw"query function not defined for Select2 "+s.element.attr("id")}if(s.createSearchChoicePosition==="top"){s.createSearchChoicePosition=function(e,t){e.unshift(t)}}else if(s.createSearchChoicePosition==="bottom"){s.createSearchChoicePosition=function(e,t){e.push(t)}}else if(typeof s.createSearchChoicePosition!=="function"){throw"invalid createSearchChoicePosition option must be 'top', 'bottom' or a custom function"}return s},monitorSource:function(){var s=this.opts.element,i,n=this;s.on("change.select2",this.bind(function(e){if(this.opts.element.data("select2-change-triggered")!==true){this.initSelection()}}));this._sync=this.bind(function(){var e=s.prop("disabled");if(e===t)e=false;this.enable(!e);var i=s.prop("readonly");if(i===t)i=false;this.readonly(i);if(this.container){k(this.container,this.opts.element,this.opts.adaptContainerCssClass);this.container.addClass(L(this.opts.containerCssClass,this.opts.element))}if(this.dropdown){k(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass);this.dropdown.addClass(L(this.opts.dropdownCssClass,this.opts.element))}});if(s.length&&s[0].attachEvent){s.each(function(){this.attachEvent("onpropertychange",n._sync)})}i=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;if(i!==t){if(this.propertyObserver){delete this.propertyObserver;this.propertyObserver=null}this.propertyObserver=new i(function(t){e.each(t,n._sync)});this.propertyObserver.observe(s.get(0),{attributes:true,subtree:false})}},triggerSelect:function(t){var s=e.Event("select2-selecting",{val:this.id(t),object:t,choice:t});this.opts.element.trigger(s);return!s.isDefaultPrevented()},triggerChange:function(t){t=t||{};t=e.extend({},t,{type:"change",val:this.val()});this.opts.element.data("select2-change-triggered",true);this.opts.element.trigger(t);this.opts.element.data("select2-change-triggered",false);this.opts.element.click();if(this.opts.blurOnChange)this.opts.element.blur()},isInterfaceEnabled:function(){return this.enabledInterface===true},enableInterface:function(){var e=this._enabled&&!this._readonly,t=!e;if(e===this.enabledInterface)return false;this.container.toggleClass("select2-container-disabled",t);this.close();this.enabledInterface=e;return true},enable:function(e){if(e===t)e=true;if(this._enabled===e)return;this._enabled=e;this.opts.element.prop("disabled",!e);this.enableInterface()},disable:function(){this.enable(false)},readonly:function(e){if(e===t)e=false;if(this._readonly===e)return;this._readonly=e;this.opts.element.prop("readonly",e);this.enableInterface()},opened:function(){return this.container?this.container.hasClass("select2-dropdown-open"):false},positionDropdown:function(){var t=this.dropdown,s=this.container,i=s.offset(),n=s.outerHeight(false),o=s.outerWidth(false),r=t.outerHeight(false),a=e(window),l=a.width(),h=a.height(),u=a.scrollLeft()+l,f=a.scrollTop()+h,d=i.top+n,p=i.left,g=d+r<=f,m=i.top-r>=a.scrollTop(),v=t.outerWidth(false),w=function(){return p+v<=u},b=function(){return i.left+u+s.outerWidth(false)>v},C=t.hasClass("select2-drop-above"),S,y,E,x,T;if(C){y=true;if(!m&&g){E=true;y=false}}else{y=false;if(!g&&m){E=true;y=true}}if(E){t.hide();i=this.container.offset();n=this.container.outerHeight(false);o=this.container.outerWidth(false);r=t.outerHeight(false);u=a.scrollLeft()+l;f=a.scrollTop()+h;d=i.top+n;p=i.left;v=t.outerWidth(false);t.show();this.focusSearch()}if(this.opts.dropdownAutoWidth){T=e(".select2-results",t)[0];t.addClass("select2-drop-auto-width");t.css("width","");v=t.outerWidth(false)+(T.scrollHeight===T.clientHeight?0:c.width);v>o?o=v:v=o;r=t.outerHeight(false)}else{this.container.removeClass("select2-drop-auto-width")}if(this.body.css("position")!=="static"){S=this.body.offset();d-=S.top;p-=S.left}if(!w()&&b()){p=i.left+this.container.outerWidth(false)-v}x={left:p,width:o};if(y){this.container.addClass("select2-drop-above");t.addClass("select2-drop-above");r=t.outerHeight(false);x.top=i.top-r;x.bottom="auto"}else{x.top=d;x.bottom="auto";this.container.removeClass("select2-drop-above");t.removeClass("select2-drop-above")}x=e.extend(x,L(this.opts.dropdownCss,this.opts.element));t.css(x)},shouldOpen:function(){var t;if(this.opened())return false;if(this._enabled===false||this._readonly===true)return false;t=e.Event("select2-opening");this.opts.element.trigger(t);return!t.isDefaultPrevented()},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above");this.dropdown.removeClass("select2-drop-above")},open:function(){if(!this.shouldOpen())return false;this.opening();l.on("mousemove.select2Event",function(e){a.x=e.pageX;a.y=e.pageY});return true},opening:function(){var t=this.containerEventName,s="scroll."+t,i="resize."+t,n="orientationchange."+t,o;this.container.addClass("select2-dropdown-open").addClass("select2-container-active");this.clearDropdownAlignmentPreference();if(this.dropdown[0]!==this.body.children().last()[0]){this.dropdown.detach().appendTo(this.body)}o=e("#select2-drop-mask");if(o.length===0){o=e(document.createElement("div"));o.attr("id","select2-drop-mask").attr("class","select2-drop-mask");o.hide();o.appendTo(this.body);o.on("mousedown touchstart click",function(t){d(o);var s=e("#select2-drop"),i;if(s.length>0){i=s.data("select2");if(i.opts.selectOnBlur){i.selectHighlighted({noFocus:true})}i.close();t.preventDefault();t.stopPropagation()}})}if(this.dropdown.prev()[0]!==o[0]){this.dropdown.before(o)}e("#select2-drop").removeAttr("id");this.dropdown.attr("id","select2-drop");o.show();this.positionDropdown();this.dropdown.show();this.positionDropdown();this.dropdown.addClass("select2-drop-active");var r=this;this.container.parents().add(window).each(function(){e(this).on(i+" "+s+" "+n,function(e){if(r.opened())r.positionDropdown()})})},close:function(){if(!this.opened())return;var t=this.containerEventName,s="scroll."+t,i="resize."+t,n="orientationchange."+t;this.container.parents().add(window).each(function(){e(this).off(s).off(i).off(n)});this.clearDropdownAlignmentPreference();e("#select2-drop-mask").hide();this.dropdown.removeAttr("id");this.dropdown.hide();this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active");this.results.empty();l.off("mousemove.select2Event");this.clearSearch();this.search.removeClass("select2-active");this.search.removeAttr("aria-activedescendant");this.opts.element.trigger(e.Event("select2-close"))},externalSearch:function(e){this.open();this.search.val(e);this.updateResults(false)},clearSearch:function(){},prefillNextSearchTerm:function(){if(this.search.val()!==""){return false}var e=this.opts.nextSearchTerm(this.data(),this.lastSearchTerm);if(e!==t){this.search.val(e);this.search.select();return true}return false},getMaximumSelectionSize:function(){return L(this.opts.maximumSelectionSize,this.opts.element)},ensureHighlightVisible:function(){var t=this.results,s,i,n,o,r,a,l,c;i=this.highlight();if(i<0)return;if(i==0){t.scrollTop(0);return}s=this.findHighlightableChoices().find(".select2-result-label");n=e(s[i]);c=(n.offset()||{}).top||0;o=c+n.outerHeight(true);if(i===s.length-1){l=t.find("li.select2-more-results");if(l.length>0){o=l.offset().top+l.outerHeight(true)}}r=t.offset().top+t.outerHeight(false);if(o>r){t.scrollTop(t.scrollTop()+(o-r))}a=c-t.offset().top;if(a<0&&n.css("display")!="none"){t.scrollTop(t.scrollTop()+a)}},findHighlightableChoices:function(){return this.results.find(".select2-result-selectable:not(.select2-disabled):not(.select2-selected)")},moveHighlight:function(t){var s=this.findHighlightableChoices(),i=this.highlight();while(i>-1&&i<s.length){i+=t;var n=e(s[i]);if(n.hasClass("select2-result-selectable")&&!n.hasClass("select2-disabled")&&!n.hasClass("select2-selected")){this.highlight(i);break}}},highlight:function(t){var s=this.findHighlightableChoices(),i,n;if(arguments.length===0){return g(s.filter(".select2-highlighted")[0],s.get())}if(t>=s.length)t=s.length-1;if(t<0)t=0;this.removeHighlight();i=e(s[t]);i.addClass("select2-highlighted");this.search.attr("aria-activedescendant",i.find(".select2-result-label").attr("id"));this.ensureHighlightVisible();this.liveRegion.text(i.text());n=i.data("select2-data");if(n){this.opts.element.trigger({type:"select2-highlight",val:this.id(n),choice:n})}},removeHighlight:function(){this.results.find(".select2-highlighted").removeClass("select2-highlighted")},touchMoved:function(){this._touchMoved=true},clearTouchMoved:function(){this._touchMoved=false},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(t){var s=e(t.target).closest(".select2-result-selectable");if(s.length>0&&!s.is(".select2-highlighted")){var i=this.findHighlightableChoices();this.highlight(i.index(s))}else if(s.length==0){this.removeHighlight()}},loadMoreIfNeeded:function(){var e=this.results,t=e.find("li.select2-more-results"),s,i=this.resultsPage+1,n=this,o=this.search.val(),r=this.context;if(t.length===0)return;s=t.offset().top-e.offset().top-e.height();if(s<=this.opts.loadMorePadding){t.addClass("select2-active");this.opts.query({element:this.opts.element,term:o,page:i,context:r,matcher:this.opts.matcher,callback:this.bind(function(s){if(!n.opened())return;n.opts.populateResults.call(this,e,s.results,{term:o,page:i,context:r});n.postprocessResults(s,false,false);if(s.more===true){t.detach().appendTo(e).html(n.opts.escapeMarkup(L(n.opts.formatLoadMore,n.opts.element,i+1)));window.setTimeout(function(){n.loadMoreIfNeeded()},10)}else{t.remove()}n.positionDropdown();n.resultsPage=i;n.context=s.context;this.opts.element.trigger({type:"select2-loaded",items:s})})})}},tokenize:function(){},updateResults:function(s){var i=this.search,n=this.results,o=this.opts,r,a=this,l,c=i.val(),h=e.data(this.container,"select2-last-term"),u;if(s!==true&&h&&v(c,h))return;e.data(this.container,"select2-last-term",c);if(s!==true&&(this.showSearchInput===false||!this.opened())){return}function f(){i.removeClass("select2-active");a.positionDropdown();if(n.find(".select2-no-results,.select2-selection-limit,.select2-searching").length){a.liveRegion.text(n.text())}else{a.liveRegion.text(a.opts.formatMatches(n.find('.select2-result-selectable:not(".select2-selected")').length))}}function d(e){n.html(e);f()}u=++this.queryCount;var p=this.getMaximumSelectionSize();if(p>=1){r=this.data();if(e.isArray(r)&&r.length>=p&&N(o.formatSelectionTooBig,"formatSelectionTooBig")){d("<li class='select2-selection-limit'>"+L(o.formatSelectionTooBig,o.element,p)+"</li>");return}}if(i.val().length<o.minimumInputLength){if(N(o.formatInputTooShort,"formatInputTooShort")){d("<li class='select2-no-results'>"+L(o.formatInputTooShort,o.element,i.val(),o.minimumInputLength)+"</li>")}else{d("")}if(s&&this.showSearch)this.showSearch(true);return}if(o.maximumInputLength&&i.val().length>o.maximumInputLength){if(N(o.formatInputTooLong,"formatInputTooLong")){d("<li class='select2-no-results'>"+L(o.formatInputTooLong,o.element,i.val(),o.maximumInputLength)+"</li>")}else{d("")}return}if(o.formatSearching&&this.findHighlightableChoices().length===0){d("<li class='select2-searching'>"+L(o.formatSearching,o.element)+"</li>")}i.addClass("select2-active");this.removeHighlight();l=this.tokenize();if(l!=t&&l!=null){i.val(l)}this.resultsPage=1;o.query({element:o.element,term:i.val(),page:this.resultsPage,context:null,matcher:o.matcher,callback:this.bind(function(r){var l;if(u!=this.queryCount){return}if(!this.opened()){this.search.removeClass("select2-active");return}if(r.hasError!==t&&N(o.formatAjaxError,"formatAjaxError")){d("<li class='select2-ajax-error'>"+L(o.formatAjaxError,o.element,r.jqXHR,r.textStatus,r.errorThrown)+"</li>");return}this.context=r.context===t?null:r.context;if(this.opts.createSearchChoice&&i.val()!==""){l=this.opts.createSearchChoice.call(a,i.val(),r.results);if(l!==t&&l!==null&&a.id(l)!==t&&a.id(l)!==null){if(e(r.results).filter(function(){return v(a.id(this),a.id(l))}).length===0){this.opts.createSearchChoicePosition(r.results,l)}}}if(r.results.length===0&&N(o.formatNoMatches,"formatNoMatches")){d("<li class='select2-no-results'>"+L(o.formatNoMatches,o.element,i.val())+"</li>");this.showSearch(i.val());return}n.empty();a.opts.populateResults.call(this,n,r.results,{term:i.val(),page:this.resultsPage,context:null});if(r.more===true&&N(o.formatLoadMore,"formatLoadMore")){n.append("<li class='select2-more-results'>"+o.escapeMarkup(L(o.formatLoadMore,o.element,this.resultsPage))+"</li>");window.setTimeout(function(){a.loadMoreIfNeeded()},10)}this.postprocessResults(r,s);f();this.opts.element.trigger({type:"select2-loaded",items:r})})})},cancel:function(){this.close()},blur:function(){if(this.opts.selectOnBlur)this.selectHighlighted({noFocus:true});this.close();this.container.removeClass("select2-container-active");if(this.search[0]===document.activeElement){this.search.blur()}this.clearSearch();this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){x(this.search)},selectHighlighted:function(e){if(this._touchMoved){this.clearTouchMoved();return}var t=this.highlight(),s=this.results.find(".select2-highlighted"),i=s.closest(".select2-result").data("select2-data");if(i){this.highlight(t);this.onSelect(i,e)}else if(e&&e.noFocus){this.close()}},getPlaceholder:function(){var e;return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder||((e=this.getPlaceholderOption())!==t?e.text():t)},getPlaceholderOption:function(){if(this.select){var s=this.select.children("option").first();if(this.opts.placeholderOption!==t){return this.opts.placeholderOption==="first"&&s||typeof this.opts.placeholderOption==="function"&&this.opts.placeholderOption(this.select)}else if(e.trim(s.text())===""&&s.val()===""){return s}}},initContainerWidth:function(){function t(){var t,s,i,n,o,r;if(this.opts.width==="off"){return null}else if(this.opts.width==="element"){return this.opts.element.outerWidth(false)===0?"auto":this.opts.element.outerWidth(false)+"px"}else if(this.opts.width==="copy"||this.opts.width==="resolve"){t=this.opts.element.attr("style");if(typeof t==="string"){s=t.split(";");for(n=0,o=s.length;n<o;n=n+1){r=s[n].replace(/\s/g,"");i=r.match(/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i);if(i!==null&&i.length>=1)return i[1]}}if(this.opts.width==="resolve"){t=this.opts.element.css("width");if(t.indexOf("%")>0)return t;return this.opts.element.outerWidth(false)===0?"auto":this.opts.element.outerWidth(false)+"px"}return null}else if(e.isFunction(this.opts.width)){return this.opts.width()}else{return this.opts.width}}var s=t.call(this);if(s!==null){this.container.css("width",s)}}});i=j(s,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container"}).html(["<a href='javascript:void(0)' class='select2-choice' tabindex='-1'>","   <span class='select2-chosen'>&#160;</span><abbr class='select2-search-choice-close'></abbr>","   <span class='select2-arrow' role='presentation'><b role='presentation'></b></span>","</a>","<label for='' class='select2-offscreen'></label>","<input class='select2-focusser select2-offscreen' type='text' aria-haspopup='true' role='button' />","<div class='select2-drop select2-display-none'>","   <div class='select2-search'>","       <label for='' class='select2-offscreen'></label>","       <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input' role='combobox' aria-expanded='true'","       aria-autocomplete='list' />","   </div>","   <ul class='select2-results' role='listbox'>","   </ul>","</div>"].join(""));return t},enableInterface:function(){if(this.parent.enableInterface.apply(this,arguments)){this.focusser.prop("disabled",!this.isInterfaceEnabled())}},opening:function(){var t,s,i;if(this.opts.minimumResultsForSearch>=0){this.showSearch(true)}this.parent.opening.apply(this,arguments);if(this.showSearchInput!==false){this.search.val(this.focusser.val())}if(this.opts.shouldFocusInput(this)){this.search.focus();t=this.search.get(0);if(t.createTextRange){s=t.createTextRange();s.collapse(false);s.select()}else if(t.setSelectionRange){i=this.search.val().length;t.setSelectionRange(i,i)}}this.prefillNextSearchTerm();this.focusser.prop("disabled",true).val("");this.updateResults(true);this.opts.element.trigger(e.Event("select2-open"))},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments);this.focusser.prop("disabled",false);if(this.opts.shouldFocusInput(this)){this.focusser.focus()}},focus:function(){if(this.opened()){this.close()}else{this.focusser.prop("disabled",false);if(this.opts.shouldFocusInput(this)){this.focusser.focus()}}},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments);this.focusser.prop("disabled",false);if(this.opts.shouldFocusInput(this)){this.focusser.focus()}},destroy:function(){e("label[for='"+this.focusser.attr("id")+"']").attr("for",this.opts.element.attr("id"));this.parent.destroy.apply(this,arguments);z.call(this,"selection","focusser")},initContainer:function(){var t,s=this.container,i=this.dropdown,n=o(),r;if(this.opts.minimumResultsForSearch<0){this.showSearch(false)}else{this.showSearch(true)}this.selection=t=s.find(".select2-choice");this.focusser=s.find(".select2-focusser");t.find(".select2-chosen").attr("id","select2-chosen-"+n);this.focusser.attr("aria-labelledby","select2-chosen-"+n);this.results.attr("id","select2-results-"+n);this.search.attr("aria-owns","select2-results-"+n);this.focusser.attr("id","s2id_autogen"+n);r=e("label[for='"+this.opts.element.attr("id")+"']");this.opts.element.focus(this.bind(function(){this.focus()}));this.focusser.prev().text(r.text()).attr("for",this.focusser.attr("id"));var a=this.opts.element.attr("title");this.opts.element.attr("title",a||r.text());this.focusser.attr("tabindex",this.elementTabIndex);this.search.attr("id",this.focusser.attr("id")+"_search");this.search.prev().text(e("label[for='"+this.focusser.attr("id")+"']").text()).attr("for",this.search.attr("id"));this.search.on("keydown",this.bind(function(e){if(!this.isInterfaceEnabled())return;if(229==e.keyCode)return;if(e.which===h.PAGE_UP||e.which===h.PAGE_DOWN){O(e);return}switch(e.which){case h.UP:case h.DOWN:this.moveHighlight(e.which===h.UP?-1:1);O(e);return;case h.ENTER:this.selectHighlighted();O(e);return;case h.TAB:this.selectHighlighted({noFocus:true});return;case h.ESC:this.cancel(e);O(e);return}}));this.search.on("blur",this.bind(function(e){if(document.activeElement===this.body.get(0)){window.setTimeout(this.bind(function(){if(this.opened()){this.search.focus()}}),0)}}));this.focusser.on("keydown",this.bind(function(e){if(!this.isInterfaceEnabled())return;if(e.which===h.TAB||h.isControl(e)||h.isFunctionKey(e)||e.which===h.ESC){return}if(this.opts.openOnEnter===false&&e.which===h.ENTER){O(e);return}if(e.which==h.DOWN||e.which==h.UP||e.which==h.ENTER&&this.opts.openOnEnter){if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return;this.open();O(e);return}if(e.which==h.DELETE||e.which==h.BACKSPACE){if(this.opts.allowClear){this.clear()}O(e);return}}));C(this.focusser);this.focusser.on("keyup-change input",this.bind(function(e){if(this.opts.minimumResultsForSearch>=0){e.stopPropagation();if(this.opened())return;this.open()}}));t.on("mousedown touchstart","abbr",this.bind(function(e){if(!this.isInterfaceEnabled()){return}this.clear();P(e);this.close();if(this.selection){this.selection.focus()}}));t.on("mousedown touchstart",this.bind(function(s){d(t);if(!this.container.hasClass("select2-container-active")){this.opts.element.trigger(e.Event("select2-focus"))}if(this.opened()){this.close()}else if(this.isInterfaceEnabled()){this.open()}O(s)}));i.on("mousedown touchstart",this.bind(function(){if(this.opts.shouldFocusInput(this)){this.search.focus()}}));t.on("focus",this.bind(function(e){O(e)}));this.focusser.on("focus",this.bind(function(){if(!this.container.hasClass("select2-container-active")){this.opts.element.trigger(e.Event("select2-focus"))}this.container.addClass("select2-container-active")})).on("blur",this.bind(function(){if(!this.opened()){this.container.removeClass("select2-container-active");this.opts.element.trigger(e.Event("select2-blur"))}}));this.search.on("focus",this.bind(function(){if(!this.container.hasClass("select2-container-active")){this.opts.element.trigger(e.Event("select2-focus"))}this.container.addClass("select2-container-active")}));this.initContainerWidth();this.opts.element.hide();this.setPlaceholder()},clear:function(t){var s=this.selection.data("select2-data");if(s){var i=e.Event("select2-clearing");this.opts.element.trigger(i);if(i.isDefaultPrevented()){return}var n=this.getPlaceholderOption();this.opts.element.val(n?n.val():"");this.selection.find(".select2-chosen").empty();this.selection.removeData("select2-data");this.setPlaceholder();if(t!==false){this.opts.element.trigger({type:"select2-removed",val:this.id(s),choice:s});this.triggerChange({removed:s})}}},initSelection:function(){var e;if(this.isPlaceholderOptionSelected()){this.updateSelection(null);this.close();this.setPlaceholder()}else{var s=this;this.opts.initSelection.call(null,this.opts.element,function(e){if(e!==t&&e!==null){s.updateSelection(e);s.close();s.setPlaceholder();s.lastSearchTerm=s.search.val()}})}},isPlaceholderOptionSelected:function(){var e;if(this.getPlaceholder()===t)return false;return(e=this.getPlaceholderOption())!==t&&e.prop("selected")||this.opts.element.val()===""||this.opts.element.val()===t||this.opts.element.val()===null},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments),s=this;if(t.element.get(0).tagName.toLowerCase()==="select"){t.initSelection=function(e,t){var i=e.find("option").filter(function(){return this.selected&&!this.disabled});t(s.optionToData(i))}}else if("data"in t){t.initSelection=t.initSelection||function(s,i){var n=s.val();var o=null;t.query({matcher:function(e,s,i){var r=v(n,t.id(i));if(r){o=i}return r},callback:!e.isFunction(i)?e.noop:function(){i(o)}})}}return t},getPlaceholder:function(){if(this.select){if(this.getPlaceholderOption()===t){return t}}return this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var e=this.getPlaceholder();if(this.isPlaceholderOptionSelected()&&e!==t){if(this.select&&this.getPlaceholderOption()===t)return;this.selection.find(".select2-chosen").html(this.opts.escapeMarkup(e));this.selection.addClass("select2-default");this.container.removeClass("select2-allowclear")}},postprocessResults:function(e,t,s){var i=0,n=this,o=true;this.findHighlightableChoices().each2(function(e,t){if(v(n.id(t.data("select2-data")),n.opts.element.val())){i=e;return false}});if(s!==false){if(t===true&&i>=0){this.highlight(i)}else{this.highlight(0)}}if(t===true){var r=this.opts.minimumResultsForSearch;if(r>=0){this.showSearch(F(e.results)>=r)}}},showSearch:function(t){if(this.showSearchInput===t)return;this.showSearchInput=t;this.dropdown.find(".select2-search").toggleClass("select2-search-hidden",!t);this.dropdown.find(".select2-search").toggleClass("select2-offscreen",!t);e(this.dropdown,this.container).toggleClass("select2-with-searchbox",t)},onSelect:function(e,t){if(!this.triggerSelect(e)){return}var s=this.opts.element.val(),i=this.data();this.opts.element.val(this.id(e));this.updateSelection(e);this.opts.element.trigger({type:"select2-selected",val:this.id(e),choice:e});this.lastSearchTerm=this.search.val();this.close();if((!t||!t.noFocus)&&this.opts.shouldFocusInput(this)){this.focusser.focus()}if(!v(s,this.id(e))){this.triggerChange({added:e,removed:i})}},updateSelection:function(e){var s=this.selection.find(".select2-chosen"),i,n;this.selection.data("select2-data",e);s.empty();if(e!==null){i=this.opts.formatSelection(e,s,this.opts.escapeMarkup)}if(i!==t){s.append(i)}n=this.opts.formatSelectionCssClass(e,s);if(n!==t){s.addClass(n)}this.selection.removeClass("select2-default");if(this.opts.allowClear&&this.getPlaceholder()!==t){this.container.addClass("select2-allowclear")}},val:function(){var e,s=false,i=null,n=this,o=this.data();if(arguments.length===0){return this.opts.element.val()}e=arguments[0];if(arguments.length>1){s=arguments[1]}if(this.select){this.select.val(e).find("option").filter(function(){return this.selected}).each2(function(e,t){i=n.optionToData(t);return false});this.updateSelection(i);this.setPlaceholder();if(s){this.triggerChange({added:i,removed:o})}}else{if(!e&&e!==0){this.clear(s);return}if(this.opts.initSelection===t){throw new Error("cannot call val() if initSelection() is not defined")}this.opts.element.val(e);this.opts.initSelection(this.opts.element,function(e){n.opts.element.val(!e?"":n.id(e));n.updateSelection(e);n.setPlaceholder();if(s){n.triggerChange({added:e,removed:o})}})}},clearSearch:function(){this.search.val("");this.focusser.val("")},data:function(e){var s,i=false;if(arguments.length===0){s=this.selection.data("select2-data");if(s==t)s=null;return s}else{if(arguments.length>1){i=arguments[1]}if(!e){this.clear(i)}else{s=this.data();this.opts.element.val(!e?"":this.id(e));this.updateSelection(e);if(i){this.triggerChange({added:e,removed:s})}}}}});n=j(s,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html(["<ul class='select2-choices'>","  <li class='select2-search-field'>","    <label for='' class='select2-offscreen'></label>","    <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi select2-display-none'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments),s=this;if(t.element.get(0).tagName.toLowerCase()==="select"){t.initSelection=function(e,t){var i=[];e.find("option").filter(function(){return this.selected&&!this.disabled}).each2(function(e,t){i.push(s.optionToData(t))});t(i)}}else if("data"in t){t.initSelection=t.initSelection||function(s,i){var n=w(s.val(),t.separator,t.transformVal);var o=[];t.query({matcher:function(s,i,r){var a=e.grep(n,function(e){return v(e,t.id(r))}).length;if(a){o.push(r)}return a},callback:!e.isFunction(i)?e.noop:function(){var e=[];for(var s=0;s<n.length;s++){var r=n[s];for(var a=0;a<o.length;a++){var l=o[a];if(v(r,t.id(l))){e.push(l);o.splice(a,1);break}}}i(e)}})}}return t},selectChoice:function(e){var t=this.container.find(".select2-search-choice-focus");if(t.length&&e&&e[0]==t[0]){}else{if(t.length){this.opts.element.trigger("choice-deselected",t)}t.removeClass("select2-search-choice-focus");if(e&&e.length){this.close();e.addClass("select2-search-choice-focus");this.opts.element.trigger("choice-selected",e)}}},destroy:function(){e("label[for='"+this.search.attr("id")+"']").attr("for",this.opts.element.attr("id"));this.parent.destroy.apply(this,arguments);z.call(this,"searchContainer","selection")},initContainer:function(){var t=".select2-choices",s;this.searchContainer=this.container.find(".select2-search-field");this.selection=s=this.container.find(t);var i=this;this.selection.on("click",".select2-container:not(.select2-container-disabled) .select2-search-choice:not(.select2-locked)",function(t){i.search[0].focus();i.selectChoice(e(this))});this.search.attr("id","s2id_autogen"+o());this.search.prev().text(e("label[for='"+this.opts.element.attr("id")+"']").text()).attr("for",this.search.attr("id"));this.opts.element.focus(this.bind(function(){this.focus()}));this.search.on("input paste",this.bind(function(){if(this.search.attr("placeholder")&&this.search.val().length==0)return;if(!this.isInterfaceEnabled())return;if(!this.opened()){this.open()}}));this.search.attr("tabindex",this.elementTabIndex);this.keydowns=0;this.search.on("keydown",this.bind(function(e){if(!this.isInterfaceEnabled())return;++this.keydowns;var t=s.find(".select2-search-choice-focus");var i=t.prev(".select2-search-choice:not(.select2-locked)");var n=t.next(".select2-search-choice:not(.select2-locked)");var o=T(this.search);if(t.length&&(e.which==h.LEFT||e.which==h.RIGHT||e.which==h.BACKSPACE||e.which==h.DELETE||e.which==h.ENTER)){var r=t;if(e.which==h.LEFT&&i.length){r=i}else if(e.which==h.RIGHT){r=n.length?n:null}else if(e.which===h.BACKSPACE){if(this.unselect(t.first())){this.search.width(10);r=i.length?i:n}}else if(e.which==h.DELETE){if(this.unselect(t.first())){this.search.width(10);r=n.length?n:null}}else if(e.which==h.ENTER){r=null}this.selectChoice(r);O(e);if(!r||!r.length){this.open()}return}else if((e.which===h.BACKSPACE&&this.keydowns==1||e.which==h.LEFT)&&(o.offset==0&&!o.length)){this.selectChoice(s.find(".select2-search-choice:not(.select2-locked)").last());O(e);return}else{this.selectChoice(null)}if(this.opened()){switch(e.which){case h.UP:case h.DOWN:this.moveHighlight(e.which===h.UP?-1:1);O(e);return;case h.ENTER:this.selectHighlighted();O(e);return;case h.TAB:this.selectHighlighted({noFocus:true});this.close();return;case h.ESC:this.cancel(e);O(e);return}}if(e.which===h.TAB||h.isControl(e)||h.isFunctionKey(e)||e.which===h.BACKSPACE||e.which===h.ESC){return}if(e.which===h.ENTER){if(this.opts.openOnEnter===false){return}else if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey){return}}this.open();if(e.which===h.PAGE_UP||e.which===h.PAGE_DOWN){O(e)}if(e.which===h.ENTER){O(e)}}));this.search.on("keyup",this.bind(function(e){this.keydowns=0;this.resizeSearch()}));this.search.on("blur",this.bind(function(t){this.container.removeClass("select2-container-active");this.search.removeClass("select2-focused");this.selectChoice(null);if(!this.opened())this.clearSearch();t.stopImmediatePropagation();this.opts.element.trigger(e.Event("select2-blur"))}));this.container.on("click",t,this.bind(function(t){if(!this.isInterfaceEnabled())return;if(e(t.target).closest(".select2-search-choice").length>0){return}this.selectChoice(null);this.clearPlaceholder();if(!this.container.hasClass("select2-container-active")){this.opts.element.trigger(e.Event("select2-focus"))}this.open();this.focusSearch();t.preventDefault()}));this.container.on("focus",t,this.bind(function(){if(!this.isInterfaceEnabled())return;if(!this.container.hasClass("select2-container-active")){this.opts.element.trigger(e.Event("select2-focus"))}this.container.addClass("select2-container-active");this.dropdown.addClass("select2-drop-active");this.clearPlaceholder()}));this.initContainerWidth();this.opts.element.hide();this.clearSearch()},enableInterface:function(){if(this.parent.enableInterface.apply(this,arguments)){this.search.prop("disabled",!this.isInterfaceEnabled())}},initSelection:function(){var e;if(this.opts.element.val()===""&&this.opts.element.text()===""){this.updateSelection([]);this.close();this.clearSearch()}if(this.select||this.opts.element.val()!==""){var s=this;this.opts.initSelection.call(null,this.opts.element,function(e){if(e!==t&&e!==null){s.updateSelection(e);s.close();s.clearSearch()}})}},clearSearch:function(){var e=this.getPlaceholder(),s=this.getMaxSearchWidth();if(e!==t&&this.getVal().length===0&&this.search.hasClass("select2-focused")===false){this.search.val(e).addClass("select2-default");this.search.width(s>0?s:this.container.css("width"))}else{this.search.val("").width(10)}},clearPlaceholder:function(){if(this.search.hasClass("select2-default")){this.search.val("").removeClass("select2-default")}},opening:function(){this.clearPlaceholder();this.resizeSearch();this.parent.opening.apply(this,arguments);this.focusSearch();this.prefillNextSearchTerm();this.updateResults(true);if(this.opts.shouldFocusInput(this)){this.search.focus()}this.opts.element.trigger(e.Event("select2-open"))},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments)},focus:function(){this.close();this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(t){var s={},i=[],n=this;e(t).each(function(){if(!(n.id(this)in s)){s[n.id(this)]=0;i.push(this)}});this.selection.find(".select2-search-choice").remove();this.addSelectedChoice(i);n.postprocessResults()},tokenize:function(){var e=this.search.val();e=this.opts.tokenizer.call(this,e,this.data(),this.bind(this.onSelect),this.opts);if(e!=null&&e!=t){this.search.val(e);if(e.length>0){this.open()}}},onSelect:function(e,t){if(!this.triggerSelect(e)||e.text===""){return}this.addSelectedChoice(e);this.opts.element.trigger({type:"selected",val:this.id(e),choice:e});this.lastSearchTerm=this.search.val();this.clearSearch();this.updateResults();if(this.select||!this.opts.closeOnSelect)this.postprocessResults(e,false,this.opts.closeOnSelect===true);if(this.opts.closeOnSelect){this.close();this.search.width(10)}else{if(this.countSelectableResults()>0){this.search.width(10);this.resizeSearch();if(this.getMaximumSelectionSize()>0&&this.val().length>=this.getMaximumSelectionSize()){this.updateResults(true)}else{if(this.prefillNextSearchTerm()){this.updateResults()}}this.positionDropdown()}else{this.close();this.search.width(10)}}this.triggerChange({added:e});if(!t||!t.noFocus)this.focusSearch()},cancel:function(){this.close();this.focusSearch()},addSelectedChoice:function(t){var s=this.getVal(),i=this;e(t).each(function(){s.push(i.createChoice(this))});this.setVal(s)},createChoice:function(s){var i=!s.locked,n=e("<li class='select2-search-choice'>"+"    <div></div>"+"    <a href='#' class='select2-search-choice-close' tabindex='-1'></a>"+"</li>"),o=e("<li class='select2-search-choice select2-locked'>"+"<div></div>"+"</li>");var r=i?n:o,a=this.id(s),l,c;l=this.opts.formatSelection(s,r.find("div"),this.opts.escapeMarkup);if(l!=t){r.find("div").replaceWith(e("<div></div>").html(l))}c=this.opts.formatSelectionCssClass(s,r.find("div"));if(c!=t){r.addClass(c)}if(i){r.find(".select2-search-choice-close").on("mousedown",O).on("click dblclick",this.bind(function(t){if(!this.isInterfaceEnabled())return;this.unselect(e(t.target));this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");O(t);this.close();this.focusSearch()})).on("focus",this.bind(function(){if(!this.isInterfaceEnabled())return;this.container.addClass("select2-container-active");this.dropdown.addClass("select2-drop-active")}))}r.data("select2-data",s);r.insertBefore(this.searchContainer);return a},unselect:function(t){var s=this.getVal(),i,n;t=t.closest(".select2-search-choice");if(t.length===0){throw"Invalid argument: "+t+". Must be .select2-search-choice"}i=t.data("select2-data");if(!i){return}var o=e.Event("select2-removing");o.val=this.id(i);o.choice=i;this.opts.element.trigger(o);if(o.isDefaultPrevented()){return false}while((n=g(this.id(i),s))>=0){s.splice(n,1);this.setVal(s);if(this.select)this.postprocessResults()}t.remove();this.opts.element.trigger({type:"select2-removed",val:this.id(i),choice:i});this.triggerChange({removed:i});return true},postprocessResults:function(e,t,s){var i=this.getVal(),n=this.results.find(".select2-result"),o=this.results.find(".select2-result-with-children"),r=this;n.each2(function(e,t){var s=r.id(t.data("select2-data"));if(g(s,i)>=0){t.addClass("select2-selected");t.find(".select2-result-selectable").addClass("select2-selected")}});o.each2(function(e,t){if(!t.is(".select2-result-selectable")&&t.find(".select2-result-selectable:not(.select2-selected)").length===0){t.addClass("select2-selected")}});if(this.highlight()==-1&&s!==false&&this.opts.closeOnSelect===true){r.highlight(0)}if(!this.opts.createSearchChoice&&!n.filter(".select2-result:not(.select2-selected)").length>0){if(!e||e&&!e.more&&this.results.find(".select2-no-results").length===0){if(N(r.opts.formatNoMatches,"formatNoMatches")){this.results.append("<li class='select2-no-results'>"+L(r.opts.formatNoMatches,r.opts.element,r.search.val())+"</li>")}}}},getMaxSearchWidth:function(){return this.selection.width()-b(this.search)},resizeSearch:function(){var e,t,s,i,n,o=b(this.search);e=I(this.search)+10;t=this.search.offset().left;s=this.selection.width();i=this.selection.offset().left;n=s-(t-i)-o;if(n<e){n=s-o}if(n<40){n=s-o}if(n<=0){n=e}this.search.width(Math.floor(n))},getVal:function(){var e;if(this.select){e=this.select.val();return e===null?[]:e}else{e=this.opts.element.val();return w(e,this.opts.separator,this.opts.transformVal)}},setVal:function(t){if(this.select){this.select.val(t)}else{var s=[],i={};e(t).each(function(){if(!(this in i)){s.push(this);i[this]=0}});this.opts.element.val(s.length===0?"":s.join(this.opts.separator))}},buildChangeDetails:function(e,t){var t=t.slice(0),e=e.slice(0);for(var s=0;s<t.length;s++){for(var i=0;i<e.length;i++){if(v(this.opts.id(t[s]),this.opts.id(e[i]))){t.splice(s,1);s--;e.splice(i,1);break}}}return{added:t,removed:e}},val:function(s,i){var n,o=this;if(arguments.length===0){return this.getVal()}n=this.data();if(!n.length)n=[];if(!s&&s!==0){this.opts.element.val("");this.updateSelection([]);this.clearSearch();if(i){this.triggerChange({added:this.data(),removed:n})}return}this.setVal(s);if(this.select){this.opts.initSelection(this.select,this.bind(this.updateSelection));if(i){this.triggerChange(this.buildChangeDetails(n,this.data()))}}else{if(this.opts.initSelection===t){throw new Error("val() cannot be called if initSelection() is not defined")}this.opts.initSelection(this.opts.element,function(t){var s=e.map(t,o.id);o.setVal(s);o.updateSelection(t);o.clearSearch();if(i){o.triggerChange(o.buildChangeDetails(n,o.data()))}})}this.clearSearch()},onSortStart:function(){if(this.select){throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.")}this.search.width(0);this.searchContainer.hide()},onSortEnd:function(){var t=[],s=this;this.searchContainer.show();this.searchContainer.appendTo(this.searchContainer.parent());this.resizeSearch();this.selection.find(".select2-search-choice").each(function(){t.push(s.opts.id(e(this).data("select2-data")))});this.setVal(t);this.triggerChange()},data:function(t,s){var i=this,n,o;if(arguments.length===0){return this.selection.children(".select2-search-choice").map(function(){return e(this).data("select2-data")}).get()}else{o=this.data();if(!t){t=[]}n=e.map(t,function(e){return i.opts.id(e)});this.setVal(n);this.updateSelection(t);this.clearSearch();if(s){this.triggerChange(this.buildChangeDetails(o,this.data()))}}}});e.fn.select2=function(){var s=Array.prototype.slice.call(arguments,0),i,n,o,r,a,l=["val","destroy","opened","open","close","focus","isFocused","container","dropdown","onSortStart","onSortEnd","enable","disable","readonly","positionDropdown","data","search"],c=["opened","isFocused","container","dropdown"],h=["val","data"],u={search:"externalSearch"};this.each(function(){if(s.length===0||typeof s[0]==="object"){i=s.length===0?{}:e.extend({},s[0]);i.element=e(this);if(i.element.get(0).tagName.toLowerCase()==="select"){a=i.element.prop("multiple")}else{a=i.multiple||false;if("tags"in i){i.multiple=a=true}}n=a?new window.Select2["class"].multi:new window.Select2["class"].single;n.init(i)}else if(typeof s[0]==="string"){if(g(s[0],l)<0){throw"Unknown method: "+s[0]}r=t;n=e(this).data("select2");if(n===t)return;o=s[0];if(o==="container"){r=n.container}else if(o==="dropdown"){r=n.dropdown}else{if(u[o])o=u[o];r=n[o].apply(n,s.slice(1))}if(g(s[0],c)>=0||g(s[0],h)>=0&&s.length==1){return false}}else{throw"Invalid arguments to select2 plugin: "+s}});return r===t?this:r};e.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:true,openOnEnter:true,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(e,t,s,i){var n=[];A(this.text(e),s.term,n,i);return n.join("")},transformVal:function(t){return e.trim(t)},formatSelection:function(e,s,i){return e?i(this.text(e)):t},sortResults:function(e,t,s){return e},formatResultCssClass:function(e){return e.css},formatSelectionCssClass:function(e,s){return t},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(e){return e==t?null:e.id},text:function(t){if(t&&this.data&&this.data.text){if(e.isFunction(this.data.text)){return this.data.text(t)}else{return t[this.data.text]}}else{return t.text}},matcher:function(e,t){return p(""+t).toUpperCase().indexOf(p(""+e).toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:U,escapeMarkup:R,blurOnChange:false,selectOnBlur:false,adaptContainerCssClass:function(e){return e},adaptDropdownCssClass:function(e){return null},nextSearchTerm:function(e,s){return t},searchInputPlaceholder:"",createSearchChoicePosition:"top",shouldFocusInput:function(e){var t="ontouchstart"in window||navigator.msMaxTouchPoints>0;if(!t){return true}if(e.opts.minimumResultsForSearch<0){return false}return true}};e.fn.select2.locales=[];e.fn.select2.locales["en"]={formatMatches:function(e){if(e===1){return"One result is available, press enter to select it."}return e+" results are available, use up and down arrow keys to navigate."},formatNoMatches:function(){return"No matches found"},formatAjaxError:function(e,t,s){return"Loading failed"},formatInputTooShort:function(e,t){var s=t-e.length;return"Please enter "+s+" or more character"+(s==1?"":"s")},formatInputTooLong:function(e,t){var s=e.length-t;return"Please delete "+s+" character"+(s==1?"":"s")},formatSelectionTooBig:function(e){return"You can only select "+e+" item"+(e==1?"":"s")},formatLoadMore:function(e){return"Loading more results…"},formatSearching:function(){return"Searching…"}};e.extend(e.fn.select2.defaults,e.fn.select2.locales["en"]);e.fn.select2.ajaxDefaults={transport:e.ajax,params:{type:"GET",cache:false,dataType:"json"}};window.Select2={query:{ajax:D,local:H,tags:M},util:{debounce:y,markMatch:A,escapeMarkup:R,stripDiacritics:p},"class":{"abstract":s,single:i,multi:n}}})(jQuery);(function(e,t,n){var i={BACKSPACE:8,TAB:9,RETURN:13,ESC:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,COMMA:188,SPACE:32,HOME:36,END:35};var a={triggerChar:"@",onDataRequest:e.noop,minChars:2,allowRepeat:false,showAvatars:true,elastic:true,onCaret:false,classes:{autoCompleteItemActive:"active"},templates:{wrapper:t.template('<div class="mentions-input-box"></div>'),autocompleteList:t.template('<div class="mentions-autocomplete-list"></div>'),autocompleteListItem:t.template('<li data-ref-id="<%= id %>" data-ref-type="<%= type %>" data-display="<%= display %>"><%= content %></li>'),autocompleteListItemAvatar:t.template('<img src="<%= avatar %>" />'),autocompleteListItemIcon:t.template('<div class="icon <%= icon %>"></div>'),mentionsOverlay:t.template('<div class="mentions"><div></div></div>'),mentionItemSyntax:t.template("@[<%= value %>](<%= type %>:<%= id %>)"),mentionItemHighlight:t.template("<strong><span><%= value %></span></strong>")}};var r={htmlEncode:function(e){return t.escape(e)},regexpEncode:function(e){return e.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")},highlightTerm:function(e,t){if(!t&&!t.length){return e}return e.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+t+")(?![^<>]*>)(?![^&;]+;)","gi"),"<b>$1</b>")},setCaratPosition:function(e,t){if(e.createTextRange){var n=e.createTextRange();n.move("character",t);n.select()}else{if(e.selectionStart){e.focus();e.setSelectionRange(t,t)}else{e.focus()}}},rtrim:function(e){return e.replace(/\s+$/,"")}};var o=function(n){var o,s,l,c,u,p,d,f=[],m={},v=[],h="";n=e.extend(true,{},a,n);function g(){s=e(o);if(s.attr("data-mentions-input")==="true"){return}l=s.parent();u=e(n.templates.wrapper());s.wrapAll(u);u=l.find("> div.mentions-input-box");s.attr("data-mentions-input","true");s.bind("keydown",M);s.bind("keypress",O);s.bind("click",R);s.bind("blur",k);if(navigator.userAgent.indexOf("MSIE 8")>-1){s.bind("propertychange",L)}else{s.bind("input",L)}if(n.elastic){s.elastic()}}function y(){c=e(n.templates.autocompleteList());c.appendTo(u);c.delegate("li","mousedown",S)}function x(){p=e(n.templates.mentionsOverlay());p.prependTo(u)}function C(){var e=I();t.each(f,function(t){var i=n.templates.mentionItemSyntax(t);e=e.replace(new RegExp(r.regexpEncode(t.value),"g"),i)});var i=r.htmlEncode(e);t.each(f,function(e){var a=t.extend({},e,{value:r.htmlEncode(e.value)});var o=n.templates.mentionItemSyntax(a);var s=n.templates.mentionItemHighlight(a);i=i.replace(new RegExp(r.regexpEncode(o),"g"),s)});i=i.replace(/\n/g,"<br />");i=i.replace(/ {2}/g,"&nbsp; ");s.data("messageText",e);s.trigger("updated");p.find("div").html(i)}function E(){v=[]}function w(){var e=I();f=t.reject(f,function(t,n){return!t.value||e.indexOf(t.value)==-1});f=t.compact(f)}function b(e){var i=I();var a=new RegExp("\\"+n.triggerChar+h,"gi");a.exec(i);var o=a.lastIndex-h.length-1;var l=a.lastIndex;var c=i.substr(0,o);var u=i.substr(l,i.length);var p=(c+e.value).length+1;if(!t.find(f,function(t){return t.id==e.id})){f.push(e)}E();h="";N();var d=c+e.value+" "+u;s.val(d);s.trigger("mention");C();s.focus();r.setCaratPosition(s[0],p)}function I(){return e.trim(s.val())}function T(t){var n,i,a,r,o,s,l,c,u,p,d;if(!(u=t[0]))return;if(!e(u).is("textarea"))return;if(u.selectionEnd==null)return;l={position:"absolute",overflow:"auto",whiteSpace:"pre-wrap",wordWrap:"break-word",boxSizing:"content-box",top:0,left:-9999},c=["boxSizing","fontFamily","fontSize","fontStyle","fontVariant","fontWeight","height","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","textDecoration","textIndent","textTransform","width","word-spacing"];for(p=0,d=c.length;p<d;p++)o=c[p],l[o]=e(u).css(o);return a=document.createElement("div"),e(a).css(l),e(u).after(a),i=document.createTextNode(u.value.substring(0,u.selectionEnd)),n=document.createTextNode(u.value.substring(u.selectionEnd)),r=document.createElement("span"),r.innerHTML="&nbsp;",a.appendChild(i),a.appendChild(r),a.appendChild(n),a.scrollTop=u.scrollTop,s=e(r).position(),e(a).remove(),s}function A(){var t=e(s).offset().top;var n=e("body").offset().top;var i=e(window).scrollTop();if(i>t){e(window).scrollTop(t-n)}}function S(t){var n=e(this);var i=m[n.attr("data-uid")];b(i);A();return false}function R(e){E()}function k(e){N()}function L(e){C();w();var i=t.lastIndexOf(v,n.triggerChar);if(i>-1){h=v.slice(i+1).join("");h=r.rtrim(h);t.defer(t.bind(P,this,h))}}function O(e){if(e.keyCode!==i.BACKSPACE){var t=String.fromCharCode(e.which||e.keyCode);v.push(t)}}function M(n){if(n.keyCode===i.LEFT||n.keyCode===i.RIGHT||n.keyCode===i.HOME||n.keyCode===i.END){t.defer(E);if(navigator.userAgent.indexOf("MSIE 9")>-1){t.defer(C)}return}if(n.keyCode===i.BACKSPACE){v=v.slice(0,-1+v.length);return}if(!c.is(":visible")){return true}switch(n.keyCode){case i.UP:case i.DOWN:var a=null;if(n.keyCode===i.DOWN){if(d&&d.length){a=d.next()}else{a=c.find("li").first()}}else{a=e(d).prev()}if(a.length){D(a)}return false;case i.RETURN:case i.TAB:if(d&&d.length){d.trigger("mousedown");return false}break}return true}function N(){d=null;c.empty().hide()}function D(e){e.addClass(n.classes.autoCompleteItemActive);e.siblings().removeClass(n.classes.autoCompleteItemActive);d=e}function H(i,a){c.show();if(!n.allowRepeat){var o=t.pluck(f,"value");a=t.reject(a,function(e){return t.include(o,e.name)})}if(!a.length){N();return}c.empty();var l=e("<ul>").appendTo(c).hide();t.each(a,function(a,o){var s=t.uniqueId("mention_");m[s]=t.extend({},a,{value:a.name});var c=e(n.templates.autocompleteListItem({id:r.htmlEncode(a.id),display:r.htmlEncode(a.name),type:r.htmlEncode(a.type),content:r.highlightTerm(r.htmlEncode(a.display?a.display:a.name),i)})).attr("data-uid",s);if(o===0){D(c)}if(n.showAvatars){var u;if(a.avatar){u=e(n.templates.autocompleteListItemAvatar({avatar:a.avatar}))}else{u=e(n.templates.autocompleteListItemIcon({icon:a.icon}))}u.prependTo(c)}c=c.appendTo(l)});c.show();if(n.onCaret){j(c,s)}l.show()}function P(e){if(e&&e.length&&e.length>=n.minChars){n.onDataRequest.call(this,"search",e,function(t){H(e,t)})}else{N()}}function j(e,t){var n=T(t),i=parseInt(t.css("line-height"),10)||18;e.css("width","15em");e.css("left",n.left);e.css("bottom",i+n.top)}function B(){s.val("");f=[];C()}return{init:function(e){o=e;g();y();x();B();if(n.prefillMention){b(n.prefillMention)}},val:function(e){if(!t.isFunction(e)){return}e.call(this,f.length?s.data("messageText"):I())},reset:function(){B()},getMentions:function(e){if(!t.isFunction(e)){return}e.call(this,f)}}};e.fn.mentionsInput=function(n,i){var a=arguments;if(typeof n==="object"||!n){i=n}return this.each(function(){var r=e.data(this,"mentionsInput")||e.data(this,"mentionsInput",new o(i));if(t.isFunction(r[n])){return r[n].apply(this,Array.prototype.slice.call(a,1))}else if(typeof n==="object"||!n){return r.init.call(this,this)}else{e.error("Method "+n+" does not exist")}})}})(jQuery,_);(function(e){function t(e,t,n){switch(arguments.length){case 2:return null!=e?e:t;case 3:return null!=e?e:null!=t?t:n;default:throw new Error("Implement me")}}function n(e,t){return bt.call(e,t)}function s(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function a(e){gt.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function i(e,t){var n=!0;return h(function(){return n&&(a(e),n=!1),t.apply(this,arguments)},t)}function r(e,t){pn[e]||(a(t),pn[e]=!0)}function o(e,t){return function(n){return m(e.call(this,n),t)}}function u(e,t){return function(n){return this.localeData().ordinal(e.call(this,n),t)}}function c(){}function l(e,t){t!==!1&&F(e),f(this,e),this._d=new Date(+e._d)}function d(e){var t=k(e),n=t.year||0,s=t.quarter||0,a=t.month||0,i=t.week||0,r=t.day||0,o=t.hour||0,u=t.minute||0,c=t.second||0,l=t.millisecond||0;this._milliseconds=+l+1e3*c+6e4*u+36e5*o,this._days=+r+7*i,this._months=+a+3*s+12*n,this._data={},this._locale=gt.localeData(),this._bubble()}function h(e,t){for(var s in t)n(t,s)&&(e[s]=t[s]);return n(t,"toString")&&(e.toString=t.toString),n(t,"valueOf")&&(e.valueOf=t.valueOf),e}function f(e,t){var n,s,a;if("undefined"!=typeof t._isAMomentObject&&(e._isAMomentObject=t._isAMomentObject),"undefined"!=typeof t._i&&(e._i=t._i),"undefined"!=typeof t._f&&(e._f=t._f),"undefined"!=typeof t._l&&(e._l=t._l),"undefined"!=typeof t._strict&&(e._strict=t._strict),"undefined"!=typeof t._tzm&&(e._tzm=t._tzm),"undefined"!=typeof t._isUTC&&(e._isUTC=t._isUTC),"undefined"!=typeof t._offset&&(e._offset=t._offset),"undefined"!=typeof t._pf&&(e._pf=t._pf),"undefined"!=typeof t._locale&&(e._locale=t._locale),zt.length>0)for(n in zt)s=zt[n],a=t[s],"undefined"!=typeof a&&(e[s]=a);return e}function _(e){return 0>e?Math.ceil(e):Math.floor(e)}function m(e,t,n){for(var s=""+Math.abs(e),a=e>=0;s.length<t;)s="0"+s;return(a?n?"+":"":"-")+s}function y(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function p(e,t){var n;return t=L(t,e),e.isBefore(t)?n=y(e,t):(n=y(t,e),n.milliseconds=-n.milliseconds,n.months=-n.months),n}function D(e,t){return function(n,s){var a,i;return null===s||isNaN(+s)||(r(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period)."),i=n,n=s,s=i),n="string"==typeof n?+n:n,a=gt.duration(n,s),g(this,a,e),this}}function g(e,t,n,s){var a=t._milliseconds,i=t._days,r=t._months;s=null==s?!0:s,a&&e._d.setTime(+e._d+a*n),i&&ft(e,"Date",ht(e,"Date")+i*n),r&&dt(e,ht(e,"Month")+r*n),s&&gt.updateOffset(e,i||r)}function M(e){return"[object Array]"===Object.prototype.toString.call(e)}function Y(e){return"[object Date]"===Object.prototype.toString.call(e)||e instanceof Date}function w(e,t,n){var s,a=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),r=0;for(s=0;a>s;s++)(n&&e[s]!==t[s]||!n&&S(e[s])!==S(t[s]))&&r++;return r+i}function v(e){if(e){var t=e.toLowerCase().replace(/(.)s$/,"$1");e=ln[e]||dn[t]||t}return e}function k(e){var t,s,a={};for(s in e)n(e,s)&&(t=v(s),t&&(a[t]=e[s]));return a}function b(t){var n,s;if(0===t.indexOf("week"))n=7,s="day";else{if(0!==t.indexOf("month"))return;n=12,s="month"}gt[t]=function(a,i){var r,o,u=gt._locale[t],c=[];if("number"==typeof a&&(i=a,a=e),o=function(e){var t=gt().utc().set(s,e);return u.call(gt._locale,t,a||"")},null!=i)return o(i);for(r=0;n>r;r++)c.push(o(r));return c}}function S(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=t>=0?Math.floor(t):Math.ceil(t)),n}function T(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}function O(e,t,n){return ot(gt([e,11,31+t-n]),t,n).week}function W(e){return G(e)?366:365}function G(e){return e%4===0&&e%100!==0||e%400===0}function F(e){var t;e._a&&-2===e._pf.overflow&&(t=e._a[Tt]<0||e._a[Tt]>11?Tt:e._a[Ot]<1||e._a[Ot]>T(e._a[St],e._a[Tt])?Ot:e._a[Wt]<0||e._a[Wt]>23?Wt:e._a[Gt]<0||e._a[Gt]>59?Gt:e._a[Ft]<0||e._a[Ft]>59?Ft:e._a[Ut]<0||e._a[Ut]>999?Ut:-1,e._pf._overflowDayOfYear&&(St>t||t>Ot)&&(t=Ot),e._pf.overflow=t)}function U(e){return null==e._isValid&&(e._isValid=!isNaN(e._d.getTime())&&e._pf.overflow<0&&!e._pf.empty&&!e._pf.invalidMonth&&!e._pf.nullInput&&!e._pf.invalidFormat&&!e._pf.userInvalidated,e._strict&&(e._isValid=e._isValid&&0===e._pf.charsLeftOver&&0===e._pf.unusedTokens.length)),e._isValid}function C(e){return e?e.toLowerCase().replace("_","-"):e}function z(e){for(var t,n,s,a,i=0;i<e.length;){for(a=C(e[i]).split("-"),t=a.length,n=C(e[i+1]),n=n?n.split("-"):null;t>0;){if(s=I(a.slice(0,t).join("-")))return s;if(n&&n.length>=t&&w(a,n,!0)>=t-1)break;t--}i++}return null}function I(e){var t=null;if(!Ct[e]&&It)try{t=gt.locale(),require("./locale/"+e),gt.locale(t)}catch(n){}return Ct[e]}function L(e,t){return t._isUTC?gt(e).zone(t._offset||0):gt(e).local()}function P(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function H(e){var t,n,s=e.match(At);for(t=0,n=s.length;n>t;t++)s[t]=yn[s[t]]?yn[s[t]]:P(s[t]);return function(a){var i="";for(t=0;n>t;t++)i+=s[t]instanceof Function?s[t].call(a,e):s[t];return i}}function A(e,t){return e.isValid()?(t=x(t,e.localeData()),hn[t]||(hn[t]=H(t)),hn[t](e)):e.localeData().invalidDate()}function x(e,t){function n(e){return t.longDateFormat(e)||e}var s=5;for(xt.lastIndex=0;s>=0&&xt.test(e);)e=e.replace(xt,n),xt.lastIndex=0,s-=1;return e}function Z(e,t){var n,s=t._strict;switch(e){case"Q":return Bt;case"DDDD":return Kt;case"YYYY":case"GGGG":case"gggg":return s?en:jt;case"Y":case"G":case"g":return nn;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return s?tn:Nt;case"S":if(s)return Bt;case"SS":if(s)return Rt;case"SSS":if(s)return Kt;case"DDD":return Et;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return qt;case"a":case"A":return t._locale._meridiemParse;case"X":return Qt;case"Z":case"ZZ":return $t;case"T":return Jt;case"SSSS":return Vt;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return s?Rt:Zt;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return Zt;case"Do":return Xt;default:return n=new RegExp(X(Q(e.replace("\\","")),"i"))}}function E(e){e=e||"";var t=e.match($t)||[],n=t[t.length-1]||[],s=(n+"").match(un)||["-",0,0],a=+(60*s[1])+S(s[2]);return"+"===s[0]?-a:a}function j(e,t,n){var s,a=n._a;switch(e){case"Q":null!=t&&(a[Tt]=3*(S(t)-1));break;case"M":case"MM":null!=t&&(a[Tt]=S(t)-1);break;case"MMM":case"MMMM":s=n._locale.monthsParse(t),null!=s?a[Tt]=s:n._pf.invalidMonth=t;break;case"D":case"DD":null!=t&&(a[Ot]=S(t));break;case"Do":null!=t&&(a[Ot]=S(parseInt(t,10)));break;case"DDD":case"DDDD":null!=t&&(n._dayOfYear=S(t));break;case"YY":a[St]=gt.parseTwoDigitYear(t);break;case"YYYY":case"YYYYY":case"YYYYYY":a[St]=S(t);break;case"a":case"A":n._isPm=n._locale.isPM(t);break;case"H":case"HH":case"h":case"hh":a[Wt]=S(t);break;case"m":case"mm":a[Gt]=S(t);break;case"s":case"ss":a[Ft]=S(t);break;case"S":case"SS":case"SSS":case"SSSS":a[Ut]=S(1e3*("0."+t));break;case"X":n._d=new Date(1e3*parseFloat(t));break;case"Z":case"ZZ":n._useUTC=!0,n._tzm=E(t);break;case"dd":case"ddd":case"dddd":s=n._locale.weekdaysParse(t),null!=s?(n._w=n._w||{},n._w.d=s):n._pf.invalidWeekday=t;break;case"w":case"ww":case"W":case"WW":case"d":case"e":case"E":e=e.substr(0,1);case"gggg":case"GGGG":case"GGGGG":e=e.substr(0,2),t&&(n._w=n._w||{},n._w[e]=S(t));break;case"gg":case"GG":n._w=n._w||{},n._w[e]=gt.parseTwoDigitYear(t)}}function N(e){var n,s,a,i,r,o,u;n=e._w,null!=n.GG||null!=n.W||null!=n.E?(r=1,o=4,s=t(n.GG,e._a[St],ot(gt(),1,4).year),a=t(n.W,1),i=t(n.E,1)):(r=e._locale._week.dow,o=e._locale._week.doy,s=t(n.gg,e._a[St],ot(gt(),r,o).year),a=t(n.w,1),null!=n.d?(i=n.d,r>i&&++a):i=null!=n.e?n.e+r:r),u=ut(s,a,i,o,r),e._a[St]=u.year,e._dayOfYear=u.dayOfYear}function V(e){var n,s,a,i,r=[];if(!e._d){for(a=$(e),e._w&&null==e._a[Ot]&&null==e._a[Tt]&&N(e),e._dayOfYear&&(i=t(e._a[St],a[St]),e._dayOfYear>W(i)&&(e._pf._overflowDayOfYear=!0),s=st(i,0,e._dayOfYear),e._a[Tt]=s.getUTCMonth(),e._a[Ot]=s.getUTCDate()),n=0;3>n&&null==e._a[n];++n)e._a[n]=r[n]=a[n];for(;7>n;n++)e._a[n]=r[n]=null==e._a[n]?2===n?1:0:e._a[n];e._d=(e._useUTC?st:nt).apply(null,r),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()+e._tzm)}}function q(e){var t;e._d||(t=k(e._i),e._a=[t.year,t.month,t.day,t.hour,t.minute,t.second,t.millisecond],V(e))}function $(e){var t=new Date;return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function J(e){if(e._f===gt.ISO_8601)return void R(e);e._a=[],e._pf.empty=!0;var t,n,s,a,i,r=""+e._i,o=r.length,u=0;for(s=x(e._f,e._locale).match(At)||[],t=0;t<s.length;t++)a=s[t],n=(r.match(Z(a,e))||[])[0],n&&(i=r.substr(0,r.indexOf(n)),i.length>0&&e._pf.unusedInput.push(i),r=r.slice(r.indexOf(n)+n.length),u+=n.length),yn[a]?(n?e._pf.empty=!1:e._pf.unusedTokens.push(a),j(a,n,e)):e._strict&&!n&&e._pf.unusedTokens.push(a);e._pf.charsLeftOver=o-u,r.length>0&&e._pf.unusedInput.push(r),e._isPm&&e._a[Wt]<12&&(e._a[Wt]+=12),e._isPm===!1&&12===e._a[Wt]&&(e._a[Wt]=0),V(e),F(e)}function Q(e){return e.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,s,a){return t||n||s||a})}function X(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function B(e){var t,n,a,i,r;if(0===e._f.length)return e._pf.invalidFormat=!0,void(e._d=new Date(0/0));for(i=0;i<e._f.length;i++)r=0,t=f({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._pf=s(),t._f=e._f[i],J(t),U(t)&&(r+=t._pf.charsLeftOver,r+=10*t._pf.unusedTokens.length,t._pf.score=r,(null==a||a>r)&&(a=r,n=t));h(e,n||t)}function R(e){var t,n,s=e._i,a=sn.exec(s);if(a){for(e._pf.iso=!0,t=0,n=rn.length;n>t;t++)if(rn[t][1].exec(s)){e._f=rn[t][0]+(a[6]||" ");break}for(t=0,n=on.length;n>t;t++)if(on[t][1].exec(s)){e._f+=on[t][0];break}s.match($t)&&(e._f+="Z"),J(e)}else e._isValid=!1}function K(e){R(e),e._isValid===!1&&(delete e._isValid,gt.createFromInputFallback(e))}function et(e,t){var n,s=[];for(n=0;n<e.length;++n)s.push(t(e[n],n));return s}function tt(t){var n,s=t._i;s===e?t._d=new Date:Y(s)?t._d=new Date(+s):null!==(n=Lt.exec(s))?t._d=new Date(+n[1]):"string"==typeof s?K(t):M(s)?(t._a=et(s.slice(0),function(e){return parseInt(e,10)}),V(t)):"object"==typeof s?q(t):"number"==typeof s?t._d=new Date(s):gt.createFromInputFallback(t)}function nt(e,t,n,s,a,i,r){var o=new Date(e,t,n,s,a,i,r);return 1970>e&&o.setFullYear(e),o}function st(e){var t=new Date(Date.UTC.apply(null,arguments));return 1970>e&&t.setUTCFullYear(e),t}function at(e,t){if("string"==typeof e)if(isNaN(e)){if(e=t.weekdaysParse(e),"number"!=typeof e)return null}else e=parseInt(e,10);return e}function it(e,t,n,s,a){return a.relativeTime(t||1,!!n,e,s)}function rt(e,t,n){var s=gt.duration(e).abs(),a=kt(s.as("s")),i=kt(s.as("m")),r=kt(s.as("h")),o=kt(s.as("d")),u=kt(s.as("M")),c=kt(s.as("y")),l=a<fn.s&&["s",a]||1===i&&["m"]||i<fn.m&&["mm",i]||1===r&&["h"]||r<fn.h&&["hh",r]||1===o&&["d"]||o<fn.d&&["dd",o]||1===u&&["M"]||u<fn.M&&["MM",u]||1===c&&["y"]||["yy",c];return l[2]=t,l[3]=+e>0,l[4]=n,it.apply({},l)}function ot(e,t,n){var s,a=n-t,i=n-e.day();return i>a&&(i-=7),a-7>i&&(i+=7),s=gt(e).add(i,"d"),{week:Math.ceil(s.dayOfYear()/7),year:s.year()}}function ut(e,t,n,s,a){var i,r,o=st(e,0,1).getUTCDay();return o=0===o?7:o,n=null!=n?n:a,i=a-o+(o>s?7:0)-(a>o?7:0),r=7*(t-1)+(n-a)+i+1,{year:r>0?e:e-1,dayOfYear:r>0?r:W(e-1)+r}}function ct(t){var n=t._i,s=t._f;return t._locale=t._locale||gt.localeData(t._l),null===n||s===e&&""===n?gt.invalid({nullInput:!0}):("string"==typeof n&&(t._i=n=t._locale.preparse(n)),gt.isMoment(n)?new l(n,!0):(s?M(s)?B(t):J(t):tt(t),new l(t)))}function lt(e,t){var n,s;if(1===t.length&&M(t[0])&&(t=t[0]),!t.length)return gt();for(n=t[0],s=1;s<t.length;++s)t[s][e](n)&&(n=t[s]);return n}function dt(e,t){var n;return"string"==typeof t&&(t=e.localeData().monthsParse(t),"number"!=typeof t)?e:(n=Math.min(e.date(),T(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e)}function ht(e,t){return e._d["get"+(e._isUTC?"UTC":"")+t]()}function ft(e,t,n){return"Month"===t?dt(e,n):e._d["set"+(e._isUTC?"UTC":"")+t](n)}function _t(e,t){return function(n){return null!=n?(ft(this,e,n),gt.updateOffset(this,t),this):ht(this,e)}}function mt(e){return 400*e/146097}function yt(e){return 146097*e/400}function pt(e){gt.duration.fn[e]=function(){return this._data[e]}}function Dt(e){"undefined"==typeof ender&&(Mt=vt.moment,vt.moment=e?i("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.",gt):gt)}for(var gt,Mt,Yt,wt="2.8.3",vt="undefined"!=typeof global?global:this,kt=Math.round,bt=Object.prototype.hasOwnProperty,St=0,Tt=1,Ot=2,Wt=3,Gt=4,Ft=5,Ut=6,Ct={},zt=[],It="undefined"!=typeof module&&module.exports,Lt=/^\/?Date\((\-?\d+)/i,Pt=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,Ht=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,At=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,xt=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,Zt=/\d\d?/,Et=/\d{1,3}/,jt=/\d{1,4}/,Nt=/[+\-]?\d{1,6}/,Vt=/\d+/,qt=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,$t=/Z|[\+\-]\d\d:?\d\d/gi,Jt=/T/i,Qt=/[\+\-]?\d+(\.\d{1,3})?/,Xt=/\d{1,2}/,Bt=/\d/,Rt=/\d\d/,Kt=/\d{3}/,en=/\d{4}/,tn=/[+-]?\d{6}/,nn=/[+-]?\d+/,sn=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,an="YYYY-MM-DDTHH:mm:ssZ",rn=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],on=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],un=/([\+\-]|\d\d)/gi,cn=("Date|Hours|Minutes|Seconds|Milliseconds".split("|"),{Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6}),ln={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},dn={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},hn={},fn={s:45,m:45,h:22,d:26,M:11},_n="DDD w W M D d".split(" "),mn="M D H h m s w W".split(" "),yn={M:function(){return this.month()+1},MMM:function(e){return this.localeData().monthsShort(this,e)},MMMM:function(e){return this.localeData().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.localeData().weekdaysMin(this,e)},ddd:function(e){return this.localeData().weekdaysShort(this,e)},dddd:function(e){return this.localeData().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return m(this.year()%100,2)},YYYY:function(){return m(this.year(),4)},YYYYY:function(){return m(this.year(),5)},YYYYYY:function(){var e=this.year(),t=e>=0?"+":"-";return t+m(Math.abs(e),6)},gg:function(){return m(this.weekYear()%100,2)},gggg:function(){return m(this.weekYear(),4)},ggggg:function(){return m(this.weekYear(),5)},GG:function(){return m(this.isoWeekYear()%100,2)},GGGG:function(){return m(this.isoWeekYear(),4)},GGGGG:function(){return m(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return S(this.milliseconds()/100)},SS:function(){return m(S(this.milliseconds()/10),2)},SSS:function(){return m(this.milliseconds(),3)},SSSS:function(){return m(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+m(S(e/60),2)+":"+m(S(e)%60,2)},ZZ:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+m(S(e/60),2)+m(S(e)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()},Q:function(){return this.quarter()}},pn={},Dn=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];_n.length;)Yt=_n.pop(),yn[Yt+"o"]=u(yn[Yt],Yt);for(;mn.length;)Yt=mn.pop(),yn[Yt+Yt]=o(yn[Yt],2);yn.DDDD=o(yn.DDD,3),h(c.prototype,{set:function(e){var t,n;for(n in e)t=e[n],"function"==typeof t?this[n]=t:this["_"+n]=t},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e){var t,n,s;for(this._monthsParse||(this._monthsParse=[]),t=0;12>t;t++)if(this._monthsParse[t]||(n=gt.utc([2e3,t]),s="^"+this.months(n,"")+"|^"+this.monthsShort(n,""),this._monthsParse[t]=new RegExp(s.replace(".",""),"i")),this._monthsParse[t].test(e))return t},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},weekdaysParse:function(e){var t,n,s;for(this._weekdaysParse||(this._weekdaysParse=[]),t=0;7>t;t++)if(this._weekdaysParse[t]||(n=gt([2e3,1]).day(t),s="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[t]=new RegExp(s.replace(".",""),"i")),this._weekdaysParse[t].test(e))return t},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY LT",LLLL:"dddd, MMMM D, YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},isPM:function(e){return"p"===(e+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(e,t){var n=this._calendar[e];return"function"==typeof n?n.apply(t):n},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,n,s){var a=this._relativeTime[n];return"function"==typeof a?a(e,t,n,s):a.replace(/%d/i,e)},pastFuture:function(e,t){var n=this._relativeTime[e>0?"future":"past"];return"function"==typeof n?n(t):n.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",preparse:function(e){return e},postformat:function(e){return e},week:function(e){return ot(e,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),gt=function(t,n,a,i){var r;return"boolean"==typeof a&&(i=a,a=e),r={},r._isAMomentObject=!0,r._i=t,r._f=n,r._l=a,r._strict=i,r._isUTC=!1,r._pf=s(),ct(r)},gt.suppressDeprecationWarnings=!1,gt.createFromInputFallback=i("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(e){e._d=new Date(e._i)}),gt.min=function(){var e=[].slice.call(arguments,0);return lt("isBefore",e)},gt.max=function(){var e=[].slice.call(arguments,0);return lt("isAfter",e)},gt.utc=function(t,n,a,i){var r;return"boolean"==typeof a&&(i=a,a=e),r={},r._isAMomentObject=!0,r._useUTC=!0,r._isUTC=!0,r._l=a,r._i=t,r._f=n,r._strict=i,r._pf=s(),ct(r).utc()},gt.unix=function(e){return gt(1e3*e)},gt.duration=function(e,t){var s,a,i,r,o=e,u=null;return gt.isDuration(e)?o={ms:e._milliseconds,d:e._days,M:e._months}:"number"==typeof e?(o={},t?o[t]=e:o.milliseconds=e):(u=Pt.exec(e))?(s="-"===u[1]?-1:1,o={y:0,d:S(u[Ot])*s,h:S(u[Wt])*s,m:S(u[Gt])*s,s:S(u[Ft])*s,ms:S(u[Ut])*s}):(u=Ht.exec(e))?(s="-"===u[1]?-1:1,i=function(e){var t=e&&parseFloat(e.replace(",","."));return(isNaN(t)?0:t)*s},o={y:i(u[2]),M:i(u[3]),d:i(u[4]),h:i(u[5]),m:i(u[6]),s:i(u[7]),w:i(u[8])}):"object"==typeof o&&("from"in o||"to"in o)&&(r=p(gt(o.from),gt(o.to)),o={},o.ms=r.milliseconds,o.M=r.months),a=new d(o),gt.isDuration(e)&&n(e,"_locale")&&(a._locale=e._locale),a},gt.version=wt,gt.defaultFormat=an,gt.ISO_8601=function(){},gt.momentProperties=zt,gt.updateOffset=function(){},gt.relativeTimeThreshold=function(t,n){return fn[t]===e?!1:n===e?fn[t]:(fn[t]=n,!0)},gt.lang=i("moment.lang is deprecated. Use moment.locale instead.",function(e,t){return gt.locale(e,t)}),gt.locale=function(e,t){var n;return e&&(n="undefined"!=typeof t?gt.defineLocale(e,t):gt.localeData(e),n&&(gt.duration._locale=gt._locale=n)),gt._locale._abbr},gt.defineLocale=function(e,t){return null!==t?(t.abbr=e,Ct[e]||(Ct[e]=new c),Ct[e].set(t),gt.locale(e),Ct[e]):(delete Ct[e],null)},gt.langData=i("moment.langData is deprecated. Use moment.localeData instead.",function(e){return gt.localeData(e)}),gt.localeData=function(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return gt._locale;if(!M(e)){if(t=I(e))return t;e=[e]}return z(e)},gt.isMoment=function(e){return e instanceof l||null!=e&&n(e,"_isAMomentObject")},gt.isDuration=function(e){return e instanceof d};for(Yt=Dn.length-1;Yt>=0;--Yt)b(Dn[Yt]);gt.normalizeUnits=function(e){return v(e)},gt.invalid=function(e){var t=gt.utc(0/0);return null!=e?h(t._pf,e):t._pf.userInvalidated=!0,t},gt.parseZone=function(){return gt.apply(null,arguments).parseZone()},gt.parseTwoDigitYear=function(e){return S(e)+(S(e)>68?1900:2e3)},h(gt.fn=l.prototype,{clone:function(){return gt(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var e=gt(this).utc();return 0<e.year()&&e.year()<=9999?A(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):A(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return U(this)},isDSTShifted:function(){return this._a?this.isValid()&&w(this._a,(this._isUTC?gt.utc(this._a):gt(this._a)).toArray())>0:!1},parsingFlags:function(){return h({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(e){return this.zone(0,e)},local:function(e){return this._isUTC&&(this.zone(0,e),this._isUTC=!1,e&&this.add(this._dateTzOffset(),"m")),this},format:function(e){var t=A(this,e||gt.defaultFormat);return this.localeData().postformat(t)},add:D(1,"add"),subtract:D(-1,"subtract"),diff:function(e,t,n){var s,a,i,r=L(e,this),o=6e4*(this.zone()-r.zone());return t=v(t),"year"===t||"month"===t?(s=432e5*(this.daysInMonth()+r.daysInMonth()),a=12*(this.year()-r.year())+(this.month()-r.month()),i=this-gt(this).startOf("month")-(r-gt(r).startOf("month")),i-=6e4*(this.zone()-gt(this).startOf("month").zone()-(r.zone()-gt(r).startOf("month").zone())),a+=i/s,"year"===t&&(a/=12)):(s=this-r,a="second"===t?s/1e3:"minute"===t?s/6e4:"hour"===t?s/36e5:"day"===t?(s-o)/864e5:"week"===t?(s-o)/6048e5:s),n?a:_(a)},from:function(e,t){return gt.duration({to:this,from:e}).locale(this.locale()).humanize(!t)},fromNow:function(e){return this.from(gt(),e)},calendar:function(e){var t=e||gt(),n=L(t,this).startOf("day"),s=this.diff(n,"days",!0),a=-6>s?"sameElse":-1>s?"lastWeek":0>s?"lastDay":1>s?"sameDay":2>s?"nextDay":7>s?"nextWeek":"sameElse";return this.format(this.localeData().calendar(a,this))},isLeapYear:function(){return G(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=at(e,this.localeData()),this.add(e-t,"d")):t},month:_t("Month",!0),startOf:function(e){switch(e=v(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e?this.weekday(0):"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this},endOf:function(e){return e=v(e),this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms")},isAfter:function(e,t){return t=v("undefined"!=typeof t?t:"millisecond"),"millisecond"===t?(e=gt.isMoment(e)?e:gt(e),+this>+e):+this.clone().startOf(t)>+gt(e).startOf(t)},isBefore:function(e,t){return t=v("undefined"!=typeof t?t:"millisecond"),"millisecond"===t?(e=gt.isMoment(e)?e:gt(e),+e>+this):+this.clone().startOf(t)<+gt(e).startOf(t)},isSame:function(e,t){return t=v(t||"millisecond"),"millisecond"===t?(e=gt.isMoment(e)?e:gt(e),+this===+e):+this.clone().startOf(t)===+L(e,this).startOf(t)},min:i("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(e){return e=gt.apply(null,arguments),this>e?this:e}),max:i("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(e){return e=gt.apply(null,arguments),e>this?this:e}),zone:function(e,t){var n,s=this._offset||0;return null==e?this._isUTC?s:this._dateTzOffset():("string"==typeof e&&(e=E(e)),Math.abs(e)<16&&(e=60*e),!this._isUTC&&t&&(n=this._dateTzOffset()),this._offset=e,this._isUTC=!0,null!=n&&this.subtract(n,"m"),s!==e&&(!t||this._changeInProgress?g(this,gt.duration(s-e,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,gt.updateOffset(this,!0),this._changeInProgress=null)),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.zone(this._tzm):"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(e){return e=e?gt(e).zone():0,(this.zone()-e)%60===0},daysInMonth:function(){return T(this.year(),this.month())},dayOfYear:function(e){var t=kt((gt(this).startOf("day")-gt(this).startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")},quarter:function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},weekYear:function(e){var t=ot(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return null==e?t:this.add(e-t,"y")},isoWeekYear:function(e){var t=ot(this,1,4).year;return null==e?t:this.add(e-t,"y")},week:function(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")},isoWeek:function(e){var t=ot(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")},weekday:function(e){var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")},isoWeekday:function(e){return null==e?this.day()||7:this.day(this.day()%7?e:e-7)},isoWeeksInYear:function(){return O(this.year(),1,4)},weeksInYear:function(){var e=this.localeData()._week;return O(this.year(),e.dow,e.doy)},get:function(e){return e=v(e),this[e]()},set:function(e,t){return e=v(e),"function"==typeof this[e]&&this[e](t),this},locale:function(t){var n;return t===e?this._locale._abbr:(n=gt.localeData(t),null!=n&&(this._locale=n),this)},lang:i("moment().lang() is deprecated. Use moment().localeData() instead.",function(t){return t===e?this.localeData():this.locale(t)}),localeData:function(){return this._locale},_dateTzOffset:function(){return 15*Math.round(this._d.getTimezoneOffset()/15)}}),gt.fn.millisecond=gt.fn.milliseconds=_t("Milliseconds",!1),gt.fn.second=gt.fn.seconds=_t("Seconds",!1),gt.fn.minute=gt.fn.minutes=_t("Minutes",!1),gt.fn.hour=gt.fn.hours=_t("Hours",!0),gt.fn.date=_t("Date",!0),gt.fn.dates=i("dates accessor is deprecated. Use date instead.",_t("Date",!0)),gt.fn.year=_t("FullYear",!0),gt.fn.years=i("years accessor is deprecated. Use year instead.",_t("FullYear",!0)),gt.fn.days=gt.fn.day,gt.fn.months=gt.fn.month,gt.fn.weeks=gt.fn.week,gt.fn.isoWeeks=gt.fn.isoWeek,gt.fn.quarters=gt.fn.quarter,gt.fn.toJSON=gt.fn.toISOString,h(gt.duration.fn=d.prototype,{_bubble:function(){var e,t,n,s=this._milliseconds,a=this._days,i=this._months,r=this._data,o=0;r.milliseconds=s%1e3,e=_(s/1e3),r.seconds=e%60,t=_(e/60),r.minutes=t%60,n=_(t/60),r.hours=n%24,a+=_(n/24),o=_(mt(a)),a-=_(yt(o)),i+=_(a/30),a%=30,o+=_(i/12),i%=12,r.days=a,r.months=i,r.years=o},abs:function(){return this._milliseconds=Math.abs(this._milliseconds),this._days=Math.abs(this._days),this._months=Math.abs(this._months),this._data.milliseconds=Math.abs(this._data.milliseconds),this._data.seconds=Math.abs(this._data.seconds),this._data.minutes=Math.abs(this._data.minutes),this._data.hours=Math.abs(this._data.hours),this._data.months=Math.abs(this._data.months),this._data.years=Math.abs(this._data.years),this},weeks:function(){return _(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*S(this._months/12)},humanize:function(e){var t=rt(this,!e,this.localeData());return e&&(t=this.localeData().pastFuture(+this,t)),this.localeData().postformat(t)},add:function(e,t){var n=gt.duration(e,t);return this._milliseconds+=n._milliseconds,this._days+=n._days,this._months+=n._months,this._bubble(),this},subtract:function(e,t){var n=gt.duration(e,t);return this._milliseconds-=n._milliseconds,this._days-=n._days,this._months-=n._months,this._bubble(),this},get:function(e){return e=v(e),this[e.toLowerCase()+"s"]()},as:function(e){var t,n;if(e=v(e),"month"===e||"year"===e)return t=this._days+this._milliseconds/864e5,n=this._months+12*mt(t),"month"===e?n:n/12;switch(t=this._days+yt(this._months/12),e){case"week":return t/7+this._milliseconds/6048e5;case"day":return t+this._milliseconds/864e5;case"hour":return 24*t+this._milliseconds/36e5;case"minute":return 24*t*60+this._milliseconds/6e4;case"second":return 24*t*60*60+this._milliseconds/1e3;case"millisecond":return Math.floor(24*t*60*60*1e3)+this._milliseconds;default:throw new Error("Unknown unit "+e)}},lang:gt.fn.lang,locale:gt.fn.locale,toIsoString:i("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",function(){return this.toISOString()}),toISOString:function(){var e=Math.abs(this.years()),t=Math.abs(this.months()),n=Math.abs(this.days()),s=Math.abs(this.hours()),a=Math.abs(this.minutes()),i=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(e?e+"Y":"")+(t?t+"M":"")+(n?n+"D":"")+(s||a||i?"T":"")+(s?s+"H":"")+(a?a+"M":"")+(i?i+"S":""):"P0D"},localeData:function(){return this._locale}}),gt.duration.fn.toString=gt.duration.fn.toISOString;for(Yt in cn)n(cn,Yt)&&pt(Yt.toLowerCase());gt.duration.fn.asMilliseconds=function(){return this.as("ms")},gt.duration.fn.asSeconds=function(){return this.as("s")},gt.duration.fn.asMinutes=function(){return this.as("m")},gt.duration.fn.asHours=function(){return this.as("h")},gt.duration.fn.asDays=function(){return this.as("d")},gt.duration.fn.asWeeks=function(){return this.as("weeks")},gt.duration.fn.asMonths=function(){return this.as("M")},gt.duration.fn.asYears=function(){return this.as("y")},gt.locale("en",{ordinal:function(e){var t=e%10,n=1===S(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+n}}),It?module.exports=gt:"function"==typeof define&&define.amd?(define("moment",function(e,t,n){return n.config&&n.config()&&n.config().noGlobal===!0&&(vt.moment=Mt),gt}),Dt(!0)):Dt()}).call(this);ko.bindingHandlers.boxSlider={init:function(t,n,e,r,i){if(typeof $.fn.bxSlider==="undefined"){return false}var a=$(t);var o=n()||{};setTimeout(function(){a.data("boxSlider",a.bxSlider(o))},200)},update:function(t,n,e,r,i){var a=$(t).data("boxSlider");if(a){a.redrawSlider()}}};ko.bindingHandlers.tipsy={init:function(t,n,e,r,i){if(typeof $.fn.tipsy==="undefined"){return false}var a=$(t);var o=n()||{};if(typeof o.content==="string"){a.attr("data-wtip",o.content);o.title="data-wtip"}a.tipsy(o)},update:function(t,n,e,r,i){}};ko.bindingHandlers.select2={init:function(t,n,e,r,i){if(typeof $.fn.select2==="undefined"){return false}var a=$(t);var o=n()||{};a.select2(o)},update:function(t,n,e,r,i){}};ko.bindingHandlers.timerButton={init:function(t,n,e,r,i){var a=n()||{time_end:0,total_time:0,current_time:0};var o=$(t);var d=new ProgressButton(t,{statusTime:10,callback:function(t){o.addClass("progress-button");o.data("oProgressButton",t);o.data("options",a);o.attr("data-progress-button",true)}});$(t).trigger("StartTimer")},update:function(t,n,e,r,i){}};ko.bindingHandlers.scrollbar={init:function(t,n,e,r,i){var a=$(t);var o=n()||{};a.addClass("perefect-scroll");a.data("oScroll",omerta.GUI.scroll.build(a,o))},update:function(t,n,e,r,i){var a=$(t);var o=n()||{};var d=a.data("oScroll");if(typeof d==="undefined"){return}if(typeof d==="object"){omerta.GUI.scroll.refresh(d,o)}}};(function(s){"use strict";function e(s){return new RegExp("(^|\\s+)"+s+"(\\s+|$)")}var n,a,t;if("classList"in document.documentElement){n=function(s,e){return s.classList.contains(e)};a=function(s,e){s.classList.add(e)};t=function(s,e){s.classList.remove(e)}}else{n=function(s,n){return e(n).test(s.className)};a=function(s,e){if(!n(s,e)){s.className=s.className+" "+e}};t=function(s,n){s.className=s.className.replace(e(n)," ")}}function c(s,e){var c=n(s,e)?t:a;c(s,e)}var i={hasClass:n,addClass:a,removeClass:t,toggleClass:c,has:n,add:a,remove:t,toggle:c};if(typeof define==="function"&&define.amd){define(i)}else{s.classie=i}})(window);(function(t){"use strict";Modernizr.addTest("csstransformspreserve3d",function(){var e=Modernizr.prefixed("transformStyle");var s="preserve-3d";var i;if(!e)return false;e=e.replace(/([A-Z])/g,function(t,e){return"-"+e.toLowerCase()}).replace(/^ms-/,"-ms-");Modernizr.testStyles("#modernizr{"+e+":"+s+";}",function(s,n){i=t.getComputedStyle?getComputedStyle(s,null).getPropertyValue(e):""});return i===s});function e(t,e){for(var s in e){if(e.hasOwnProperty(s)){t[s]=e[s]}}return t}var s={transitions:Modernizr.csstransitions,transforms3d:Modernizr.csstransforms3d&&Modernizr.csstransformspreserve3d},i={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},n=i[Modernizr.prefixed("transition")];function r(t,s){this.button=t;this.options=e({},this.options);e(this.options,s);this._init()}r.prototype.options={statusTime:500};r.prototype._init=function(){this._validate();this._create();this._initEvents()};r.prototype._validate=function(){if(this.button.getAttribute("data-style")===null){this.button.setAttribute("data-style","fill")}if(this.button.getAttribute("data-vertical")===null&&this.button.getAttribute("data-horizontal")===null){this.button.setAttribute("data-horizontal","")}if(!s.transforms3d&&this.button.getAttribute("data-perspective")!==null){this.button.removeAttribute("data-perspective");this.button.setAttribute("data-style","fill");this.button.removeAttribute("data-vertical");this.button.setAttribute("data-horizontal","")}};r.prototype._create=function(){var t=document.createElement("span");t.className="content";t.innerHTML=this.button.innerHTML;var e=document.createElement("span");e.className="progress";var s=document.createElement("span");s.className="progress-inner";e.appendChild(s);this.button.innerHTML="";if(this.button.getAttribute("data-perspective")!==null){var i=document.createElement("span");i.className="progress-wrap";i.appendChild(t);i.appendChild(e);this.button.appendChild(i)}else{this.button.appendChild(t);this.button.appendChild(e)}this.progress=s;if(this.button.getAttribute("data-horizontal")!==null){this.progressProp="width"}else if(this.button.getAttribute("data-vertical")!==null){this.progressProp="height"}this._enable()};r.prototype._setProgress=function(t){this.progress.style[this.progressProp]=100*t+"%"};r.prototype._initEvents=function(){var t=this;var e=document.createEvent("Event");e.initEvent("StartTimer",true,true);var i=function(){t.button.setAttribute("disabled","");classie.remove(t.progress,"notransition");classie.add(this,"state-loading");setTimeout(function(){if(typeof t.options.callback==="function"){t.options.callback(t)}else{t._setProgress(1);var e=function(i){if(s.transitions&&i.propertyName!==t.progressProp)return;this.removeEventListener(n,e);t._stop()};if(s.transitions){t.progress.addEventListener(n,e)}else{e.call()}}},t.button.getAttribute("data-style")==="fill"||t.button.getAttribute("data-style")==="top-line"||t.button.getAttribute("data-style")==="lateral-lines"?0:200)};this.button.addEventListener("StartTimer",i);this.button.addEventListener("click",i);this.button.dispatchEvent(e)};r.prototype._stop=function(t){var e=this;setTimeout(function(){e.progress.style.opacity=0;var i=function(t){if(s.transitions&&t.propertyName!=="opacity")return;this.removeEventListener(n,i);classie.add(e.progress,"notransition");e.progress.style[e.progressProp]="0%";e.progress.style.opacity=1};if(s.transitions){e.progress.addEventListener(n,i)}else{i.call()}if(typeof t==="number"){var r=t>=0?"state-success":"state-error";classie.add(e.button,r);setTimeout(function(){classie.remove(e.button,r);e._enable()},e.options.statusTime)}else{e._enable()}classie.remove(e.button,"state-loading")},100)};r.prototype._enable=function(){this.button.removeAttribute("disabled")};t.ProgressButton=r})(window);var omerta={timers:{},framework:{},core:{},model:{},services:{},modules:{},widgets:{},UI:{},popup:{},server:{clock:0},plugins:{},GUI:{},users:ko.observableArray(),windowFocus:true,roundVersion:ko.observable()};omerta.server={time:0,url:window.location.host,query:function(e,r,o,t,a){$.ajax({url:"/"+r,data:o,type:e,success:function(e){omerta.server.getCB(e,t,a)},error:a?a:omerta.server.error,dataType:"JSON"})},getCB:function(e,r,o){if(e.OK==undefined)r(e);else if(e.OK)r(e);else if(o)o(e,"ecallback defined");else omerta.server.error(e,"ecallback not defined")},error:function(e,r){console.error("Server request failed:",r,e)}};omerta.debug=function(e,r,a){var o={page:e,request:r,error:a};$.post("/ajax_debug.php",o)};if(typeof String.prototype.parseUsername==="undefined"){String.prototype.parseUsername=function(e){return this.replace(/[@]+[A-Za-z0-9-_]+/g,function(r){var t=r.replace("@","");return r.blankLink(e+t)})}}if(typeof String.prototype.parseHashtag==="undefined"){String.prototype.parseHashtag=function(e){return this.replace(/[#]+[A-Za-z0-9-_]+/g,function(r){var t=r.replace("#","");return r.blankLink(e+t)})}}if(typeof Number.prototype.format==="undefined"){Number.prototype.format=function(e,r){var t="\\d(?=(\\d{"+(r||3)+"})+"+(e>0?"\\.":"$")+")";return this.toFixed(Math.max(0,~~e)).replace(new RegExp(t,"g"),"$&,")}}
omerta.Clock={date:ko.observable(new Date),interval:100,synchTime:0,id:0,totalTicks:0,events:{},load:function(){this.reTick();$(window).trigger("omerta.Clock.load",[this]);var e=omerta.Clock.syncServer(true);this.on(3e3,omerta.Clock.syncServer);return e},reTick:function(){this.totalTicks++;this.id=setTimeout($.proxy(this.tick,this),this.interval)},tick:function(){this.date(new Date(Date.now()-this.synchTime));this.executeEvents();this.reTick()},getTime:function(){return this.date().getTime()},getDate:function(){return this.date()},syncServer:function(e){var t=$.ajax("/ntp.php",{method:"GET",data:{time:Date.now()}});t.done(omerta.Clock.syncResponse);if(e===true){t.done(function(){$(window).trigger("omerta.Clock.synched",[omerta.Clock])})}return t},setSynchTime:function(e){this.synchTime=e},syncResponse:function(e){var t=Date.now();if(typeof e!=="object"){return false}if(typeof e.response!=="number"||typeof e.request!=="number"){return false}var n=new Date;var i=n.getTime()-e.request,r=n.getTime()-(e.response-i);omerta.Clock.setSynchTime(Math.ceil(r))},getTimeLeft:function(e){if(e<=0){return 0}var t=e*1e3,n=(t-this.getTime())/1e3;if(n<0){return 0}return Math.floor(n)},getTimeEnd:function(e){return Math.floor(this.getTime()/1e3+e)},on:function(e,t){if(typeof e!=="number"){return false}if(typeof t!=="function"){return false}if(typeof this.events[e]==="undefined"){this.events[e]=[]}this.events[e].push(t)},executeEvents:function(){for(var e in this.events){if(this.totalTicks%e!=0){continue}for(var t in this.events[e]){this.events[e][t](this)}}},padTime:function(e){return e<10?"0"+e:e}};omerta.framework.GUI={name:"frameworksuper",link:"./main.php",module:"GamePanel.Main",action:null,load:function(a){$.get(a?a:this.link,$.proxy(this.load_cb,this))},load_cb:function(a){$("#game_"+this.name).html(a);omerta.GUI.loader.loaded(this.name)}};omerta.core.Module={id:"",bind:"",element:null,module:"",action:"",template:null,data:{},ContainerTabs:[],_translations:{},messages:ko.observableArray(),isMobile:false,model:{},loading:ko.observable(false),init:function(t){this.template=$(t.template);this.data=t.data||{};if(this.handleRedirect(t)){return true}this.module=t.request.module||"";this.action=t.request.action||"";this._translations=t.translations||{};this.messages(t.messages||[]);this.ContainerTabs=t.tabs||[];this.isMobile=this.detectMobile();this.loading(true);return this},handleRedirect:function(t){this.statusCode=t.code||200;var e=this.data.location||false;if(this.statusCode>=300&&this.statusCode<=310&&typeof e==="string"){omerta.GUI.container.loadPage(e);return true}return false},detectMobile:function(){if(typeof Modernizr!=="object"){return false}return Modernizr.mq("only screen and (min-width: 320px) and (max-width: 1025px)")},show:function(){if(!this.module)return;if(!this.template.length)return;this.bind="modules."+this.module;this.id="module_"+this.module;var t=this.template.html();this.prepareHeader();if(typeof this.prepareData==="function"){try{this.prepareData()}catch(e){t="<div class='popup-error'>Some error happened.</div>"}}$("#game_container").html($("<div></div>").attr({id:this.id,"data-bind":"with: "+this.bind}).html(t));this.element=$("#"+this.id);ko.applyBindings(omerta,this.element[0]);this.loading(false);$("#game_loading").fadeOut("fast");omerta.GUI.container.processHash=true;omerta.GUI.loader.loaded("container");omerta.GUI.container.fixHeight();if(typeof this.afterRender==="function"){this.afterRender()}},showAnim:function(){this.element.find(".core-popup-wrapper").animate({left:$("#animate").parent().width()/2-$("#animate").width()/2,top:$("#animate").parent().height()/2-$("#animate").height()/2,width:"75%",height:"75%",borderRadius:"5px"},750)},hide:function(){this.destroy()},destroy:function(){this.element.remove()},prepareHeader:function(){omerta.GUI.container.tabs(this.ContainerTabs);if(this.ContainerTabs.length>0){var t=false;for(var e=0 in this.ContainerTabs){if(this.ContainerTabs[e].selected){omerta.GUI.container.selectedTab(this.ContainerTabs[e].name);t=true}}if(!t){omerta.GUI.container.selectedTab(this.ContainerTabs[0].name)}}if(typeof this.data.title!=="undefined"&&this.data.title.length>0){omerta.GUI.container.title(this.data.title)}},translate:function(t,e){if(_.isString(e)){e=[]}e=e||[];var i=t;var a="mobile_"+t;var n=this._translations;if(n&&this.isMobile&&n[a]){return vsprintf(n[a],e)}if(n&&n[t]){return vsprintf(n[t],e)}return i}};omerta.core.Popup={id:"",bind:"",element:null,loading:ko.observable(false),show:function(){if(!this.template)return;var t=$("#"+this.template);if(!t.length)return;this.id="p_"+this.template;var e=t.html();$("body").append($("<div></div>").attr({id:this.id,"data-bind":"with: "+this.bind}).addClass("modal fade").html(e));this.element=$("#"+this.id);ko.applyBindings(omerta,this.element[0])},hide:function(){this.destroy()},destroy:function(){this.element.remove()}};omerta.framework.service={name:"servicesuper",service:"",interval:30,timer:null,data:{},load:function(){this.run()},run:function(){$.getJSON("/?module=Services."+this.service,$.proxy(this.run_cb,this))},rerun:function(){this.timer=setTimeout($.proxy(this.run,this),this.interval*1e3)},run_cb:function(t){try{this.data=t.data}catch(e){this.data=t}this.rerun()}};omerta.Storage=function(o){var e=o||"omerta",t=typeof localStorage==="object"||typeof localStorage==="function",n=this;this.localStorageGetKey=function(o){return"oStore:"+e+":"+o};var r=function(o,e){if(!t){return false}localStorage.setItem(n.localStorageGetKey(o),e.toString())};this.get=function(o){var t=$.cookie.json;$.cookie.json=true;var n=$.cookie(e);$.cookie.json=t;if(typeof o!=="undefined"&&typeof n==="object"){if(typeof n[o]==="undefined"){return null}return n[o]}return n||{}};this.set=function(o,t){var n=this.get();n[o]=t;var i=$.cookie.json;$.cookie.json=true;$.cookie(e,n,{path:"/"});$.cookie.json=i;r(o,t);return t};this.onLocalStorage=function(o){if(typeof o==="function"){return window.addEventListener("storage",o,false)}return false}};omerta.widgets=omerta.widgets||{};omerta.core.Widget={load:function(){},init:function(){}};omerta.GUI.game_bar={name:"header",load:function(){omerta.GUI.game_bar.cooldowns.load()},cooldowns:{load:function(){$("input[data-knob-timeend]").knob({min:0,max:100});$('#game_bar .cooldown[id!="mobileMenu"]').tipsy({gravity:$.fn.tipsy.autoNS,html:true,title:function(){return"<b>"+$(this).attr("data-title")+"</b><br>"+($(this).attr("data-timeleft")<=0?$(this).attr("data-iready"):$(this).attr("data-icd"))}})},tick:function(){$("input[data-knob-timeend]").each(omerta.GUI.game_bar.cooldowns.tickElement)},tickElement:function(){var t=$(this),a=t.closest("*[data-cooldown]").attr("data-cooldown"),e=$('div.cooldown[data-cooldown="'+a+'"]'),o=t.attr("data-knob-timeend"),i=omerta.Clock.getTimeLeft(o),n=parseInt(t.attr("data-knob-timetotal")),d=t.data("inverse")||false;if(!i||!n||i<0){l=100;if(d){e.fadeTo("slow",.35)}}else{if(i==1){if(d){e.fadeTo("slow",.35)}else{e.fadeTo("slow",1)}e.addClass("fa-spin");setTimeout(function(){e.removeClass("fa-spin")},2e3)}var l=d?i*100/n:(n-i)*100/n;l=parseInt(l);if(l>=100){l=100}if(i>1){if(d){e.fadeTo("slow",1)}else{e.fadeTo("slow",.35)}}}t.val(l).trigger("change")}}};omerta.GUI.container=$.extend({},omerta.framework.GUI,{name:"container",module:"Home",action:null,processHash:false,current:"",title:ko.observable(""),subtitle:ko.observable(""),tabs:ko.observableArray([]),selectedTab:ko.observable(""),doSelectionTab:ko.observable(),elementToScroll:null,currentModule:ko.observable(""),currentModuleClassName:ko.observable(""),load:function(e){this.loadPage(e);if(_.isNull(omerta.GUI.container.elementToScroll)){omerta.GUI.container.elementToScroll=omerta.GUI.scroll.build($("#game_container_wrapper"))}else{omerta.GUI.scroll.refreshAll()}if(typeof $.fn.knob==="function"){$("#widget_avatar #knob").knob()}else{$("#widget_avatar").remove()}},loadPage:function(e){if(this.isSafeToLoad(e)===false){e=this.current}e=e.length>0?e:"/?module=Rankings";this.current=e;$("#game_loading").fadeIn("fast");omerta.GUI.container.tabs([]);omerta.GUI.container.selectedTab("");omerta.GUI.container.cleanPreviousModule();var t=$.ajax({type:"GET",url:e,success:function(t,r,a){var o=false;if(omerta.GUI.container.isModule(t)){o=t.data.title||t.request.module;if(typeof omerta.modules[t.request.module]!=="undefined"){omerta.modules[t.request.module].init(t).show();omerta.GUI.container.currentModule(t.request.module)}else{o=t.data.title||t.request.module;omerta.GUI.container.title(o);omerta.GUI.container.loadPageCB(t.template);omerta.GUI.container.currentModule(omerta.GUI.container.getCurrentModuleFromLink(e))}delete t}else{$.proxy(omerta.GUI.container.loadPageCB(t,r,a),this);omerta.GUI.container.currentModule(omerta.GUI.container.getCurrentModuleFromLink(e))}if(o===false){$("#game_menu .sublink").each(function(t,r){var a=$(r);if(a.attr("href").indexOf(e)!==-1){omerta.GUI.container.title(a.text());return false}})}}});t.fail(function(e,t,r){var a=e.responseText.replace(/\s/g,"");switch(a){case"user_dead":$("#game_loading").fadeOut("fast");omerta.GUI.container.processHash=true;omerta.GUI.helper.displayDeadContainer();break;case"logout":omerta.GUI.helper.logout();break;default:omerta.debug(omerta.GUI.container.current,"","GET error: "+r);omerta.GUI.container.loadPageErr();break}omerta.GUI.loader.loaded("container")});t.always(function(){omerta.GUI.helper.resize();omerta.GUI.container.scrollTop()});omerta.GUI.container.processHash=false;location.hash=e;return t},loadPageErr:function(){$("#game_loading").fadeIn("fast");$("#game_loading").html("<span style='color: red;'>There was an error while loading this page. A report was sent to our devs.</span>")},loadPageCB:function(e,t,r){$("#game_loading").fadeOut("fast");omerta.GUI.container.processHash=true;var a=false;if(typeof e==="string"){a=e.indexOf("<html")!=-1}if(a){omerta.GUI.container.loadPageErr();omerta.debug(this.current,"","html tag")}else{try{$("#game_container").html(e);omerta.GUI.scroll.refreshAll();omerta.GUI.container.fixHeight();$("#game_container td[align]").each(function(){$(this).css("text-align",$(this).prop("align"))});$("#game_container table").each(function(){if($(this).width()>$(window).width())$(this).attr("width","70%")});if($("#ver").length>0)$("#ver").focus()}catch(o){omerta.GUI.container.loadPageErr();omerta.debug(this.current,"","js error: "+o.message)}}omerta.GUI.loader.loaded("container");if(typeof _gaq!="undefined"){_gaq.push(["_trackPageview",this.current])}},isModule:function(e){if(typeof e!=="object"){return false}if(typeof e.request==="undefined"){return false}if(typeof e.template==="undefined"){return false}return true},cleanPreviousModule:function(){var e=omerta.GUI.container.currentModule();if(typeof e!=="string"){return false}if(e.length===0){return false}if(typeof omerta.modules[e]==="undefined"){return false}if(typeof omerta.modules[e].destroy!=="function"){return false}return omerta.modules[e].destroy()},selectTab:function(e){omerta.GUI.container.selectedTab(e);return true},toggleElement:function(e){e.toggle()},isSafeToLoad:function(e){if(typeof e!=="string"){return false}if(e.length==0){return false}var t=e.indexOf("http")===0||e.indexOf("https")===0||e.indexOf("mailto")===0;if(!t){return true}return e.indexOf(location.protocol+"//"+location.hostname)===0},getCurrentModuleFromLink:function(e){if(e.length===0||typeof e!=="string"){return false}var t=parse_url(e);var r=false;if(typeof t.query!=="undefined"){var a=t.query.split("&");var o=[];_.each(a,function(e){var t=e.split("=");if(t.length==2){o[t[0]]=t[1]}});if(typeof o.module!=="undefined"){r=o.module}}if(!r&&typeof t.path!=="undefined"){var n=function(e){return ucfirst(e.replace(/\.[^/.]+$/,""))};var i=t.path.split("/");if(i.length>=2){r="Legacy"+n(i[1])}}return r},scrollTop:function(){omerta.GUI.scroll.scrollToTop(omerta.GUI.container.elementToScroll,arguments)}});omerta.GUI.container.selectedTab.subscribe(function(e){setTimeout(function(){omerta.GUI.scroll.refreshAll()},100);if(e.length===0){return}var t=$(".mobile-tab-container #mobile-tab-select");if(t.length===0){return}t.select2("val",e)});omerta.GUI.container.doSelectionTab.subscribe(function(e){var t=$(".mobile-tab-container:visible");if(t.length===0){return}var r=omerta.GUI.container.selectedTab();if(typeof e==="undefined"){return}if(e.length===0){return}if(r===e){return}var a=$("#wrapper-tabs .menu-item-"+e);a.click()});omerta.GUI.container.fixHeight=function(){var e=0,t=250;var r=setInterval(function(){var a=$("#game_container").outerHeight(true);var o=$("#game_wrapper").outerHeight();var n=$("#game_container_wrapper .fake-height:visible");if(n.length>0){a+=n.outerHeight(true)+10}if(a>o){$("#game_wrapper_container").css({height:"99%"})}else{$("#game_wrapper_container").css({height:a+5+"px",overflow:"hidden"})}if(e>2e3){omerta.GUI.scroll.refreshAll();e=0;clearInterval(r);return false}e+=t},t);omerta.timers.processDomTimers()};omerta.GUI.container.currentModule.subscribe(function(e){var t="";if(!e){e=""}if(e.length!=0){t="module"+e}omerta.GUI.container.currentModuleClassName(t)});omerta.GUI.menu=$.extend({},omerta.framework.GUI,{name:"menu",module:"GamePanel.Menu",action:null,items:ko.observableArray([]),elementToScroll:null,load_cb:function(e){omerta.GUI.menu.items(e[this.name]);omerta.GUI.loader.loaded(this.name)},afterRenderMenu:function(e,a){$("#game_menu a").tipsy({gravity:"w"});if(_.isNull(omerta.GUI.menu.elementToScroll)){omerta.GUI.menu.elementToScroll=omerta.GUI.scroll.build($("#game_menu"))}else{omerta.GUI.scroll.refresh(omerta.GUI.menu.elementToScroll)}var l=$("#game_menu [data-collapsed]");if(l.length>0){l.parent().next().hide()}},toggleMenuItem:function(e,a){var l=$("#game_menu");var t=$("."+e.item_class);var n=t.find("a");var r=t.closest("ul");var m=t.next("ul");if(m.length>0){l.find("ul > ul > ul").not(r).slideUp();m.stop().slideToggle(function(){omerta.GUI.scroll.refresh(omerta.GUI.menu.elementToScroll)});if(n.hasClass("link")){return}}l.find("ul > li > a").removeClass("active");n.not(".link").addClass("active");l.find("ul.game-menu-list > li").each(function(){var e=$(this);var a=e.next("ul").find("li > a.active");var l=e.find("a");if(a.length>0){l.addClass("active")}else{l.removeClass("active")}});return true},loadMenuItem:function(e,a,l){var t={item_class:"menu-item-"+e};var n=$("ul.game-menu-list li."+t.item_class),r=n.find("a"),m=r.attr("href");if(m.length===0){return false}var o=parse_url(m,"query")||"",i="";if(typeof a==="object"){i=o.length===0?"?":"&";_.each(a,function(e,a){i+=a+"="+e+"&"})}m=m+i;omerta.GUI.menu.toggleMenuItem(t);return omerta.GUI.container.loadPage(m)}});omerta.GUI.helper={resize:function(){omerta.GUI.helper.responsiveTitleTabs();setTimeout(function(){omerta.GUI.scroll.refreshAll()},200)},responsiveTitleTabs:function(){var e=$("#game_wrapper_container > .title"),o=$("#wrapper-tabs"),t=$(".account-settings"),r=e.find(".title-main"),s=e.find(".title-sub");var a=e.width(),i=o.width(),l=t.width(),n=r.width(),c=s.width();var h=a-l-n-c-85;if(h<i&&!e.hasClass("forceMobile")){e.addClass("forceMobile")}if(h>=i&&e.hasClass("forceMobile")){e.removeClass("forceMobile")}},refresh:function(e){if(e)$.prompt("The game has been updated, you need to refresh to play with new changes",{title:"Omerta update",buttons:{"Click here to refresh":1},submit:function(e,o,t,r){window.location.reload(true);event.preventDefault();return false}})},knobDraw:function(){var e=this.angle(this.cv),o=this.startAngle,t=this.startAngle,r,s=t+e,a=1;this.g.lineWidth=this.lineWidth;if(this.$.attr("shaded")){function i(e){e=e.toString(16);if(e.length<2){e="0"+e}return e}var l=a?this.o.fgColor:this.fgColor;var n=this.$.attr("shadeColor")?this.$.attr("shadeColor"):"#ffffff";var c=omerta.GUI.helper.getGradient(n,l);var h=parseInt(o*180/Math.PI%360);var d=parseInt(s*180/Math.PI%360);for(var p=h;p%360!=d;p++){t=p*(Math.PI/180);s=(p+2)*(Math.PI/180);if(c.color2[0]!=c.color1[0]&&(p+1)%c.steps[0]==0){c.color1[0]+=c.adder[0]}if(c.color2[1]!=c.color1[1]&&(p+1)%c.steps[1]==0){c.color1[1]+=c.adder[1]}if(c.color2[2]!=c.color1[2]&&(p+1)%c.steps[2]==0){c.color1[2]+=c.adder[2]}color="#"+i(c.color1[0])+i(c.color1[1])+i(c.color1[2]);this.g.beginPath();this.g.strokeStyle=color;this.g.arc(this.xy,this.xy,this.radius,t,s,false);this.g.stroke()}}else{this.g.beginPath();this.g.strokeStyle=a?this.o.fgColor:this.fgColor;this.g.arc(this.xy,this.xy,this.radius,t,s,false);this.g.stroke()}return false},getGradient:function(e,o){var t=new Object;t.color1=new Array;t.color2=new Array;t.steps=new Array;t.adder=new Array;e=e.replace("#","");t.color1[0]=parseInt(e.slice(0,2),16),t.color1[1]=parseInt(e.slice(2,4),16),t.color1[2]=parseInt(e.slice(4,6),16);o=o.replace("#","");t.color2[0]=parseInt(o.slice(0,2),16),t.color2[1]=parseInt(o.slice(2,4),16),t.color2[2]=parseInt(o.slice(4,6),16);t.steps[0]=t.color1[0]==t.color2[0]?0:parseInt(360/Math.abs(t.color1[0]-t.color2[0])),t.steps[1]=t.color1[1]==t.color2[1]?0:parseInt(360/Math.abs(t.color1[1]-t.color2[1])),t.steps[2]=t.color1[2]==t.color2[2]?0:parseInt(360/Math.abs(t.color1[2]-t.color2[2])),t.adder[0]=t.color1[0]>t.color2[0]?-1:1;t.adder[1]=t.color1[1]>t.color2[1]?-1:1;t.adder[2]=t.color1[2]>t.color2[2]?-1:1;return t},loading:{},displayDeadContainer:function(){$("#wrapper").addClass("blur");$("#dead-container").fadeTo(1500,1);$("#dead-container .dead-skull img").fadeTo(3e3,1)},logout:function(e){if(omerta.plugins.popups.isPrompted()){$.prompt.close()}setTimeout(function(){omerta.plugins.popups.prompt("You've been logged out, since you've been inactive",{title:"Omerta logged you out",buttons:{"Go to the Homepage":1},submit:function(e,o,t,r){window.location.href="/logout.php";event.preventDefault();return false}})},500)}};omerta.GUI.loader={GUI:["menu","container"],GUI_loaded:[],GUI_setup:false,fp_id:0,dialog_loading_info:function(o){$("#dialog_loading_info").text(o)},ready:function(){},load:function(o){omerta.GUI.loader.dialog_loading_info("preparing framework");var e=window.location.hash;var a=e.replace("//","");if(a.length>4)a=a.substr(1);else a=o[2];var r=omerta.Clock.load();$.when(r).done(function(){omerta.GUI.omerta_bar.load();omerta.GUI.game_bar.load();omerta.GUI.menu.load(o[1]);omerta.GUI.container.load(a);for(i in omerta.services){omerta.services[i].load()}for(i in omerta.modules){omerta.modules[i].load()}if(typeof omerta.widgets.Clock==="object"){omerta.widgets.Clock.load()}omerta.widgets.Sidepanel.load()})},loaded:function(o){if($.inArray(o,omerta.GUI.loader.GUI)>-1){omerta.GUI.loader.GUI_loaded.push(o);omerta.GUI.loader.check()}},done:function(){if(!this.GUI_setup){this.GUI_setup=true;setTimeout(function(){$("#splash_loading").remove();$(document).trigger("omerta:loaded")},2e3)}},check:function(){var o=[];for(i in omerta.GUI.loader.GUI)if($.inArray(omerta.GUI.loader.GUI[i],omerta.GUI.loader.GUI_loaded)==-1)o.push(omerta.GUI.loader.GUI[i]);if(o.length==0)omerta.GUI.loader.done();else{var e=o.join(",");omerta.GUI.loader.dialog_loading_info("loading "+e)}}};omerta.GUI.omerta_bar={name:"header",load:function(){}};omerta.GUI.scroll={_defaults:{suppressScrollX:true,includePadding:true},build:function(e,r){if(!(e instanceof jQuery)){return false}if(typeof r!=="object"){r={}}if(typeof Modernizr!=="object"){return omerta.GUI.scroll.buildForWeb(e,r)}if(Modernizr.mobile===true||Modernizr.tablet===true){return omerta.GUI.scroll.buildForMobile(e,r)}if(Modernizr.touch){return omerta.GUI.scroll.buildForMobile(e,r)}return omerta.GUI.scroll.buildForWeb(e,r)},buildForWeb:function(e,r){r=$.extend({},r,omerta.GUI.scroll._defaults);return e.perfectScrollbar(r)},buildForMobile:function(e,r){return omerta.GUI.scroll.buildNativeScroll(e,r)},buildNativeScroll:function(e,r){e.addClass("nativeScroll");return e},refresh:function(e){if(typeof e==="undefined"){return false}if(_.isNull(e)){return false}e.perfectScrollbar("update");setTimeout(function(){e.perfectScrollbar("update")},300)},isPluginActiveForElement:function(e){var r=e.data("psId");if(typeof r==="undefined"){return false}return r},scrollToTop:function(){var e=arguments[0];if(omerta.GUI.scroll.isPluginActiveForElement(e)===false){return false}e.scrollTop(0)},refreshAll:function(){var e=$("[data-ps-id]");if(e.length==0){return false}e.each(function(){$(this).perfectScrollbar("update")})}};function colorGetContrast50(r){return parseInt(r,16)>16777215/2?"black":"white"}function colorGetContrastYIQ(r){var t=parseInt(r.substr(0,2),16);var e=parseInt(r.substr(2,2),16);var s=parseInt(r.substr(4,2),16);var a=(t*299+e*587+s*114)/1e3;return a>=128?"black":"white"}function colorSupportsRGBA(){if(!("result"in arguments.callee)){var r=document.getElementsByTagName("script")[0];var t=r.style.color;var e="rgba(0, 0, 0, 0.5)";if(t==e){arguments.callee.result=true}else{try{r.style.color=e}catch(s){}arguments.callee.result=r.style.color!=t;r.style.color=t}}return arguments.callee.result}function colorSetHexaOpactiy(r,t){if(typeof t==="undefined"){t=1}var e=parseInt(r.substr(0,2),16);var s=parseInt(r.substr(2,2),16);var a=parseInt(r.substr(4,2),16);if(colorSupportsRGBA()){return"rgba("+e+", "+s+", "+a+", "+t+")"}return"rgb("+e+", "+s+", "+a+")"}
var sprintf=function(){function e(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function r(e,r){for(var t=[];r>0;t[--r]=e){}return t.join("")}var t=function(){if(!t.cache.hasOwnProperty(arguments[0])){t.cache[arguments[0]]=t.parse(arguments[0])}return t.format.call(null,t.cache[arguments[0]],arguments)};t.format=function(t,n){var s=1,a=t.length,i="",o,u=[],f,l,c,p,h,g;for(f=0;f<a;f++){i=e(t[f]);if(i==="string"){u.push(t[f])}else if(i==="array"){c=t[f];if(c[2]){o=n[s];for(l=0;l<c[2].length;l++){if(!o.hasOwnProperty(c[2][l])){throw sprintf('[sprintf] property "%s" does not exist',c[2][l])}o=o[c[2][l]]}}else if(c[1]){o=n[c[1]]}else{o=n[s++]}if(/[^s]/.test(c[8])&&e(o)!="number"){throw sprintf("[sprintf] expecting number but found %s",e(o))}switch(c[8]){case"b":o=o.toString(2);break;case"c":o=String.fromCharCode(o);break;case"d":o=parseInt(o,10);break;case"e":o=c[7]?o.toExponential(c[7]):o.toExponential();break;case"f":o=c[7]?parseFloat(o).toFixed(c[7]):parseFloat(o);break;case"o":o=o.toString(8);break;case"s":o=(o=String(o))&&c[7]?o.substring(0,c[7]):o;break;case"u":o=Math.abs(o);break;case"x":o=o.toString(16);break;case"X":o=o.toString(16).toUpperCase();break}o=/[def]/.test(c[8])&&c[3]&&o>=0?"+"+o:o;h=c[4]?c[4]=="0"?"0":c[4].charAt(1):" ";g=c[6]-String(o).length;p=c[6]?r(h,g):"";u.push(c[5]?o+p:p+o)}}return u.join("")};t.cache={};t.parse=function(e){var r=e,t=[],n=[],s=0;while(r){if((t=/^[^\x25]+/.exec(r))!==null){n.push(t[0])}else if((t=/^\x25{2}/.exec(r))!==null){n.push("%")}else if((t=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(r))!==null){if(t[2]){s|=1;var a=[],i=t[2],o=[];if((o=/^([a-z_][a-z_\d]*)/i.exec(i))!==null){a.push(o[1]);while((i=i.substring(o[0].length))!==""){if((o=/^\.([a-z_][a-z_\d]*)/i.exec(i))!==null){a.push(o[1])}else if((o=/^\[(\d+)\]/.exec(i))!==null){a.push(o[1])}else{throw"[sprintf] huh?"}}}else{throw"[sprintf] huh?"}t[2]=a}else{s|=2}if(s===3){throw"[sprintf] mixing positional and named placeholders is not (yet) supported"}n.push(t)}else{throw"[sprintf] huh?"}r=r.substring(t[0].length)}return n};return t}();var vsprintf=function(e,r){r.unshift(e);return sprintf.apply(null,r)};function ucfirst(e){e+="";var r=e.charAt(0).toUpperCase();return r+e.substr(1)}
function number_format(e,n,t,r){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var i=!isFinite(+e)?0:+e,f=!isFinite(+n)?0:Math.abs(n),a=typeof r==="undefined"?",":r,o=typeof t==="undefined"?".":t,u="",d=function(e,n){var t=Math.pow(10,n);return""+(Math.round(e*t)/t).toFixed(n)};u=(f?d(i,f):""+Math.round(i)).split(".");if(u[0].length>3){u[0]=u[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,a)}if((u[1]||"").length<f){u[1]=u[1]||"";u[1]+=new Array(f-u[1].length+1).join("0")}return u.join(o)}function number2text_format(e,n){var t=function(e){var n=e>1e6?1e6:1e3;return e%n==0?0:1};if(typeof n==="undefined"){n=t(e)}var r=e;if(e>999&&e<=999999){r=number_format(e/1e3,n)+"K"}else if(e>999999){r=number_format(e/1e6,n)+"M"}return r}
omerta.plugins.popups={generateForm:function(t,r,e,a){var o={};o.title=e.title;o.buttons=e.buttons;if(e.pos)o.position=e.pos;if(e.focus)o.focus=e.focus;o.focus=1;if(e.html)o.html=e.html;o.submit=function(o,s,n,u){if(s==1){$("#jqistate_form .jqibuttons").html("<img style='margin-right: 15px;' src='/assets/omerta/main/layout/assets/img/icons/loading_bar.gif' />");var l={};if(a)l=a;for(i in u)l[i]=u[i];$.ajax({data:l,type:"POST",url:"/?module="+t+"&action="+r,timeout:2e4,dataType:"json",success:function(t,r){if(r=="success"){try{var a=t;if(t.data)a=t.data;if(e.callback)e.callback(a);else{try{$.prompt.goToState("formSuccess")}catch(o){$.prompt.close()}}}catch(o){$.prompt.close();omerta.GUI.container.loadPageErr()}}},error:function(t,r,e){$.prompt.close();omerta.GUI.container.loadPageErr()}});o.preventDefault();return false}};return o},isPrompted:function(){var t=$.prompt.getPrompt();if(typeof t!=="undefined"&&t.length>0){return true}return false},prompt:function(t,r){if(arguments.length==0){return false}if(omerta.plugins.popups.isPrompted()){return false}r.url=r.url||false;if(r.url){t='<div class="loader-container"><i class="fa fa-spinner fa-spin"></i></div>';var e=$.ajax(r.url);e.done(function(t){$(".jqimessage ").html(t)})}return $.prompt(t,r)}};window.matchMedia=window.matchMedia||function(e){"use strict";var t,n=e.documentElement,a=n.firstElementChild||n.firstChild,s=e.createElement("body"),i=e.createElement("div");return i.id="mq-test-1",i.style.cssText="position:absolute;top:-100em",s.style.background="none",s.appendChild(i),function(e){return i.innerHTML='&shy;<style media="'+e+'"> #mq-test-1 { width: 42px; }</style>',n.insertBefore(s,a),t=42===i.offsetWidth,n.removeChild(s),{matches:t,media:e}}}(document);(function(e){"use strict";function t(){w(!0)}var n={};if(e.respond=n,n.update=function(){},n.mediaQueriesSupported=e.matchMedia&&e.matchMedia("only all").matches,!n.mediaQueriesSupported){var a,s,i,r=e.document,o=r.documentElement,l=[],d=[],m=[],h={},u=30,c=r.getElementsByTagName("head")[0]||o,p=r.getElementsByTagName("base")[0],f=c.getElementsByTagName("link"),y=[],v=function(){for(var t=0;f.length>t;t++){var n=f[t],a=n.href,s=n.media,i=n.rel&&"stylesheet"===n.rel.toLowerCase();a&&i&&!h[a]&&(n.styleSheet&&n.styleSheet.rawCssText?(x(n.styleSheet.rawCssText,a,s),h[a]=!0):(!/^([a-zA-Z:]*\/\/)/.test(a)&&!p||a.replace(RegExp.$1,"").split("/")[0]===e.location.host)&&y.push({href:a,media:s}))}g()},g=function(){if(y.length){var t=y.shift();T(t.href,function(n){x(n,t.href,t.media),h[t.href]=!0,e.setTimeout(function(){g()},0)})}},x=function(e,t,n){var a=e.match(/@media[^\{]+\{([^\{\}]*\{[^\}\{]*\})+/gi),s=a&&a.length||0;t=t.substring(0,t.lastIndexOf("/"));var i=function(e){return e.replace(/(url\()['"]?([^\/\)'"][^:\)'"]+)['"]?(\))/g,"$1"+t+"$2$3")},r=!s&&n;t.length&&(t+="/"),r&&(s=1);for(var o=0;s>o;o++){var m,h,u,c;r?(m=n,d.push(i(e))):(m=a[o].match(/@media *([^\{]+)\{([\S\s]+?)$/)&&RegExp.$1,d.push(RegExp.$2&&i(RegExp.$2))),u=m.split(","),c=u.length;for(var p=0;c>p;p++)h=u[p],l.push({media:h.split("(")[0].match(/(only\s+)?([a-zA-Z]+)\s?/)&&RegExp.$2||"all",rules:d.length-1,hasquery:h.indexOf("(")>-1,minw:h.match(/\(\s*min\-width\s*:\s*(\s*[0-9\.]+)(px|em)\s*\)/)&&parseFloat(RegExp.$1)+(RegExp.$2||""),maxw:h.match(/\(\s*max\-width\s*:\s*(\s*[0-9\.]+)(px|em)\s*\)/)&&parseFloat(RegExp.$1)+(RegExp.$2||"")})}w()},E=function(){var e,t=r.createElement("div"),n=r.body,a=!1;return t.style.cssText="position:absolute;font-size:1em;width:1em",n||(n=a=r.createElement("body"),n.style.background="none"),n.appendChild(t),o.insertBefore(n,o.firstChild),e=t.offsetWidth,a?o.removeChild(n):n.removeChild(t),e=i=parseFloat(e)},w=function(t){var n="clientWidth",h=o[n],p="CSS1Compat"===r.compatMode&&h||r.body[n]||h,y={},v=f[f.length-1],g=(new Date).getTime();if(t&&a&&u>g-a)return e.clearTimeout(s),s=e.setTimeout(w,u),void 0;a=g;for(var x in l)if(l.hasOwnProperty(x)){var T=l[x],C=T.minw,S=T.maxw,$=null===C,b=null===S,R="em";C&&(C=parseFloat(C)*(C.indexOf(R)>-1?i||E():1)),S&&(S=parseFloat(S)*(S.indexOf(R)>-1?i||E():1)),T.hasquery&&($&&b||!($||p>=C)||!(b||S>=p))||(y[T.media]||(y[T.media]=[]),y[T.media].push(d[T.rules]))}for(var M in m)m.hasOwnProperty(M)&&m[M]&&m[M].parentNode===c&&c.removeChild(m[M]);for(var O in y)if(y.hasOwnProperty(O)){var B=r.createElement("style"),L=y[O].join("\n");B.type="text/css",B.media=O,c.insertBefore(B,v.nextSibling),B.styleSheet?B.styleSheet.cssText=L:B.appendChild(r.createTextNode(L)),m.push(B)}},T=function(e,t){var n=C();n&&(n.open("GET",e,!0),n.onreadystatechange=function(){4!==n.readyState||200!==n.status&&304!==n.status||t(n.responseText)},4!==n.readyState&&n.send(null))},C=function(){var t=!1;try{t=new e.XMLHttpRequest}catch(n){t=new e.ActiveXObject("Microsoft.XMLHTTP")}return function(){return t}}();v(),n.update=v,e.addEventListener?e.addEventListener("resize",t,!1):e.attachEvent&&e.attachEvent("onresize",t)}})(this);function time_left(t,e){if(t<=0){return 0}e=e||false;var a="";var r=Math.floor(t/86400);a+=r>0?r+"<span>D</span> ":"";var o=Math.floor((t-r*86400)/3600);a+=o>0?o+"<span>H</span> ":"";var n=Math.floor((t-r*86400-o*3600)/60);a+=n>0?n+"<span>M</span> ":"";if(!e){var i=Math.floor(t-r*86400-o*3600-n*60);a+=i>0?i+"<span>S</span>":""}return a}omerta.timers.callback={sent_bodyguard:false,lackey:function(t){var e=$(t).attr("data-lackey");$(t).html('<img src="/assets/omerta/main/layout/assets/img/icons/loading_bar.gif" alt="loading" />');omerta.modules.Lackeys.update();$(t).attr("data-timeleft",parseInt($(t).attr("data-timeleft"))-1);return false},bodyguard:function(t){if(omerta.timers.callback.sent_bodyguard){return}omerta.timers.callback.sent_bodyguard=true;var e=omerta.GUI.container.loadPage("/index.php?module=Bodyguards");e.always(function(){omerta.timers.callback.sent_bodyguard=false})},cityRaid:function(t){omerta.modules.City.citySpotRaidLink(t)},popupButtonNow:function(t){var e=$("#popupButtonNow");if(e.length>0){e.removeAttr("disabled");e.removeClass("btn-grey").addClass("btn-red");e.text(e.data("ready"))}$(t).text("Now");return 0},userActionWrapper:function(t){$(t).text("Now");return 0}};function omerta_cooldown(t,e,a){var r=$("div[data-cooldown="+t+"] input[data-knob-timeend]"),o=r.attr("data-knob-timeend"),n=omerta.Clock.getTimeLeft(o),i=omerta.Clock.getTimeEnd(e);if(r.length==0){return false}if(parseInt(n)>0){return false}if(_.isNumber(a)){a=parseInt(a)}else{a=0}r.attr("data-knob-timeend",i);if(a>0){r.attr("data-knob-timetotal",a)}if(typeof omerta.modules.UserInformation!=="undefined"){omerta.modules.UserInformation.updateActionTimer(t,i,a)}}function omerta_progressbar(t,e){$("*[data-pbar="+t+"]").attr("data-perc",e)}omerta.timers.processDomTimers=function(){var t=$("*[data-timeleft]:visible, *[data-time-end]:visible");t.each(function(){var t=$(this),e=t.attr("data-timeleft")||0,a=t.attr("data-time-end")||0,r=t.data("timecb"),o=t.data("timedone"),n=t.data("hide-seconds")||false;var i=false;if(e===0&&a>0){e=omerta.Clock.getTimeLeft(a);i=true}var s=parseInt(e);if(s<0){return}var l;var m=true;if(s==0){if(r){try{m=omerta.timers.callback[r](this)}catch(d){console.log("Timer callback not found:"+r)}}l=o?o:"Now"}else{if(e>86400&&n){n=true}else{n=false}l=time_left(e,n)}if(!m)return;if(t.find(".label").length>0){t.find(".label").html(l)}else{t.html(l)}if(!i){$(this).attr("data-timeleft",s-1)}})};omerta.timers.processProgressButtons=function(){var t=$("*[data-progress-button]");if(t.length==0){return false}t.each(function(){omerta.timers._processSingleProgressButton($(this))});return true};omerta.timers._processSingleProgressButton=function(t){var e=t.data("oProgressButton"),a=t.data("options");if(typeof e==="undefined"||typeof a!=="object"){return false}var r=parseInt(a.time_end||0);var o=omerta.Clock.getTimeLeft(r);var n=a.total_time||0;var i=parseInt(a.current_time)||0;var s=0;if(n>0){s=n-o}if(o<=0){e._stop(1);t.removeClass("progress-button");t.data("options",a);return false}if(n>0){var l=s/n}else{var l=i/o}e._setProgress(l);o-=1;i+=1;a.current_time=i;t.data("options",a)};omerta.Clock.on(10,function(){omerta.GUI.game_bar.cooldowns.tick();omerta.timers.processDomTimers();omerta.timers.processProgressButtons();omerta.GUI.scroll.refresh(omerta.GUI.container.elementToScroll)});window.setInterval(function(){var t=$("[data-wtype=inbox]").data("counts"),e=$("[data-wtype=alert]").data("counts"),a=omerta.chat.unreadedMentions(),r=$("#pageTitle"),o=r.text();var n={singular:{chat:"%s Mention",inbox:"%s Mail",alert:"%s Alert"},plural:{chat:"%s Mentions",inbox:"%s Mails",alert:"%s Alerts"}};if(omerta.windowFocus===true){return}var i={};if(a>0){i.chat=a}if(t>0){i.inbox=t}if(e>0){i.alert=e}if(i.length==0){r.text(omerta.gameTitle);return}if(o==omerta.gameTitle){var s=[];for(var l in i){var m=i[l],d=m>1?"plural":"singular";s.push(sprintf(n[d][l],m));r.text(s.join(", "))}}else{r.text(omerta.gameTitle)}},1800);function parse_url(e,r){try{this.php_js=this.php_js||{}}catch(p){this.php_js={}}var s;var a=this.php_js&&this.php_js.ini||{};var h=a["phpjs.parse_url.mode"]&&a["phpjs.parse_url.mode"].local_value||"php";var t=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"];var u={php:/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/\/?)?((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/};var i=u[h].exec(e);var l={};var o=14;while(o--){if(i[o]){l[t[o]]=i[o]}}if(r){return l[r.replace("PHP_URL_","").toLowerCase()]}if(h!=="php"){var c=a["phpjs.parse_url.queryKey"]&&a["phpjs.parse_url.queryKey"].local_value||"queryKey";u=/(?:^|&)([^&=]*)=?([^&]*)/g;l[c]={};s=l[t[12]]||"";s.replace(u,function(e,r,p){if(r){l[c][r]=p}})}delete l.source;return l}
$(document).ready(function(){omerta.GUI.loader.ready();omerta.clickEvent=function(){if(typeof Modernizr!=="object"){return"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch?"touchstart":"click"}if(Modernizr.touch){return"touchstart"}return"click"}();$(window).bind("hashchange",function(){if(window.location.hash.length===0||window.location.hash==="undefined"){return false}if(window.location.hash=="#"||window.location.hash=="#undefined"){return false}if(omerta.GUI.container.processHash){omerta.GUI.container.loadPage(window.location.hash.substr(1))}});$(document).on("keyup","input[type=text][data-number]",function(e){var t=$(this).val().replace(/k/g,"000").replace(/m/g,"000000").replace(/[^0-9\.]+/g,"");$(this).val(t)});$(document).on("click","*[data-cooldown]",function(e){$("#game_menu a[data-menu='"+$(this).attr("data-cooldown")+"']").trigger("click")});$(document).on("click",'a[data-trusted-link="false"]',function(e){var t=$(this),a=t.data("original-link");var n="You are now leaving the Omerta website. Omerta can not guarantee the content on an external site and can not take any responsibility for anything that might happen to you. <br/> If you are sure you want to leave and you trust the website below please click the link.  If you believe you have clicked a valid Omerta link that should redirect you to another area of our website please contact a member of the crew to inform them.",o="Leaving us already?";n+='<br/><br/> <a target="_blank" id="popup-unsafe-url" class="text-blue text-bold" href="'+a+'">'+a+"</a>";var r={title:o,buttons:{Cancel:-1,"Go to website":1},submit:function(e,t,n,o){switch(t){case 1:window.open(a,"_blank");break}}};omerta.plugins.popups.prompt(n,r);e.preventDefault()});$("#game_container").on("click","input[type=submit]",function(e){var t=$(this),a=$(this.form);if(a.length===0){return}if(a.attr("data-ajax")&&a.attr("data-ajax")==="false"){return true}if(t.attr("data-confirm")){var n=confirm(t.attr("data-confirm"));if(!n){return false}}var o=a.data("loading");if(o===true||o==="true"){e.preventDefault();return false}if(a.attr("target")!=="_blank"){if(!a.attr("action")||a.attr("action").length<3){omerta.GUI.container.loadPageErr();omerta.debug(window.location.hash,"","FORM no-action error");e.preventDefault();return false}var r=t.attr("name")+"="+$(this).val();var i="";i+=a.serialize();if(i.length>2)i+="&";i+=r;if(!a.attr("method")||a.attr("method").toUpperCase()=="POST"){a.data("loading",true);var l=$.ajax({data:i,type:"POST",url:a.attr("action"),timeout:2e4,dataType:"html"});l.success(function(e,t){if(t==="success"){var a=false;if(typeof e==="object"&&typeof e.request!=="undefined"&&typeof e.template!=="undefined"){if(typeof omerta.modules[e.request.module]!=="undefined"){omerta.modules[e.request.module].init(e).show()}else{a=e.data.title||e.request.module;omerta.GUI.container.title(a);omerta.GUI.container.loadPageCB(e.template)}delete e}else{omerta.GUI.container.loadPageCB(e)}}});l.always(function(){a.data("loading",false);omerta.GUI.container.scrollTop()})}else{omerta.GUI.container.loadPage(a.attr("action")+"?"+i)}e.preventDefault();return false}});$("#game_container, #game_menu").on("submit","form",function(e){if($(this).attr("data-ajax")&&$(this).attr("data-ajax")=="false"){return true}if($(this).attr("target")!="_blank"){if(!$(this).attr("action")||$(this).attr("action").length<3){omerta.GUI.container.loadPageErr();omerta.debug(window.location.hash,"","FORM no-action error");e.preventDefault();return false}if(!$(this).attr("method")||$(this).attr("method").toUpperCase()=="POST"){$.ajax({data:$(this).serialize(),type:"POST",url:$(this).attr("action"),timeout:2e4,success:function(e,t){if(t=="success"){var a=false;if(typeof e==="object"&&typeof e.request!=="undefined"&&typeof e.template!=="undefined"){if(typeof omerta.modules[e.request.module]!=="undefined"){omerta.modules[e.request.module].init(e).show()}else{a=e.data.title||e.request.module;omerta.GUI.container.title(a);omerta.GUI.container.loadPageCB(e.template)}delete e}else{omerta.GUI.container.loadPageCB(e)}}}})}else{omerta.GUI.container.loadPage($(this).attr("action")+"?"+$(this).serialize())}e.preventDefault();return false}});$(document).on("click","*[data-box]",function(e){var t=$(this).next();if(t.is(":hidden")){t.slideDown("slow");$(this).find(".menu_closed").removeClass("menu_closed").addClass("menu_open")}else{t.slideUp("slow");$(this).find(".menu_open").removeClass("menu_open").addClass("menu_closed")}e.preventDefault();return false});$(document).on("click",'a[href!="#"]',function(e){var t=$(this),a=t.attr("href"),n=t.attr("target"),o=t.attr("data-confirm");if(typeof a==="undefined"){return}if(a){if(a.indexOf("javascript:")!==-1)return;if(a.indexOf("mailto:")!==-1)return}if($(this).attr("data-box"))return;if(o){var r=confirm(o);if(!r){return false}}if(n!="_blank"&&n!="_top"){e.preventDefault();if($("#mobileMenu").is(":visible")&&$("#game_menu").offset().left==0){$("#mobileMenu").trigger(omerta.clickEvent)}var i=omerta.GUI.container.loadPage($(this).attr("href"));if(t.closest("#selected").length>0){var l=t.data("page-title")||t.text()}i.success(function(e){if(typeof e==="object"&&typeof e.data==="object"&&typeof e.data.title==="string"){l=e.data.title}if(l)omerta.GUI.container.title(l);l=null});return false}});$(window).on("resize",function(){omerta.GUI.helper.resize()});$("img[rel=tooltip]").tipsy({gravity:$.fn.tipsy.autoNS,html:true,live:true});$(document).on("click","#wrapper-tabs li, #wrapper-tabs li a",function(e){var t=omerta.GUI.container.tabs();var a=omerta.GUI.container.selectedTab();_.each(t,function(t,n,o){if(t.name===a){var r=t.element.attributes["data-href"];if(r){omerta.GUI.container.loadPage(r);e.preventDefault()}}})});$(document).on(omerta.clickEvent,"#mobileMenu",function(e){e.preventDefault();var t=$("#game_menu");if(t.offset().left<0){$("#game_wrapper").fadeTo("fast",.5);t.animate({left:0});$("#mobileMenu").animate({left:-8})}else{$("#game_wrapper").fadeTo("fast",1);t.animate({left:-200});$("#mobileMenu").animate({left:5})}});if(omerta.clickEvent=="touchstart"){$(document).on("touchend",function(e){var t=$(e.target);if(t.parents("#game_menu").length>0||t.attr("id")==="mobileMenu"){return}var a=$("#game_menu");if(a.offset().left>=0){$("#mobileMenu").trigger(omerta.clickEvent)}})}var e={event:"click touchend",target:".popup-box-wrapper"};if(omerta.clickEvent=="touchstart"){e.target=".popup-box-wrapper .foot .btn-red"}$("#game_wrapper").on("click touchstart",e.target,function(e){e.preventDefault();e.stopPropagation();if($(this).data("name")){var t=$(this)}else{var a=$(this);var t=a.find(".btn-red")}var n=t.data("name");var o=t.data("value");if(n.length===0){return null}$("#crimes-selected-option").attr("name",n);$("#crimes-selected-option").attr("value",o);$(".popup-place-wrapper").removeClass("active");$(t).parents(".popup-place-wrapper").addClass("active");$("form[name=doPopupAction]").submit()})});$(window).blur(function(){omerta.windowFocus=false});$(window).focus(function(){omerta.windowFocus=true;var e=omerta.chat.unreadedMentions();omerta.chat.setPageTitle(e)});String.prototype.ucfirst=function(){return this.charAt(0).toUpperCase()+this.slice(1).toLowerCase()};omerta.services.account=$.extend({},omerta.framework.service,{name:"account",service:"Account",run_cb:function(t){this.data=t.data;if(typeof this.data.forward!=="undefined"){window.location=this.data.forward;return}if(typeof this.data.user_status!=="undefined"&&this.data.user_status==3){clearTimeout(this.timer);omerta.GUI.helper.displayDeadContainer();return}if(this.data.logout){omerta.GUI.helper.logout();return}if(this.data.version!=omerta.version){omerta.GUI.helper.refresh(true);omerta={};return}$("#omerta_release").text(this.data.release);for(i in this.data.cooldowns){if(this.data.cooldowns[i]>0){omerta_cooldown(i,this.data.cooldowns[i])}}if(typeof this.data.bonus==="object"){omerta_cooldown("boost",this.data.bonus.timeleft,this.data.bonus.timeduration)}omerta.widgets.sidebar.updateNotifications("inbox",this.data.messages.inbox,this.data.messages.counter.inbox);omerta.widgets.sidebar.updateNotifications("alert",this.data.messages.alert,this.data.messages.counter.alert);omerta.widgets.sidebar.updateNotifications("bugs",this.data.bugs,this.data.bugs.length);omerta.widgets.sidebar.updateNotifications("tickets",this.data.tickets,this.data.tickets.length);if(this.data.messages.counter.admin>0&&!omerta.plugins.popups.isPrompted()){var a=this.data.messages.admin;$.prompt("You have received a message from an admin, please read it.",{buttons:{"Read It":1},title:"Admin message",submit:function(t,e,s,r){if(_.isUndefined(a[0])){return null}if(!_.isObject(a[0])){return null}omerta.GUI.container.loadPage("/?module=Mail&action=showMsg&iMsgId="+a[0].id)}})}var e=this.data.messages.news;if(e.length>0){var s=e.shift();$("#latest-new-link").attr("href",s.link).html('<img src="/assets/temp/img-news.png">'+s.date_string+" "+s.sbj)}else{$("#news-topbar-container").remove()}if(typeof omerta!=="undefined"&&typeof omerta.character!=="undefined"){omerta.character.progress.health(parseFloat(this.data.progressbars.health));omerta.character.progress.kill_skill(parseFloat(this.data.progressbars.killskill));omerta.character.progress.rank_progress(parseFloat(this.data.progressbars.rankprogress));omerta.character.progress.bustskill(parseFloat(this.data.progressbars.bustskill));omerta.character.progress.raceform(parseFloat(this.data.progressbars.raceform));omerta.character.progress.honorpoints(parseInt(this.data.progressbars.honorpoints));omerta.character.progress.money(this.data.money);omerta.character.progress.bank(this.data.bank);omerta.character.progress.bullets(this.data.bullets);omerta.character.progress.rank(this.data.rankname);omerta.character.game.city(this.data.city.name);omerta.character.info.family(this.data.family);$("#travel_cityname .title").text(this.data.city.name)}if(typeof this.data.widgets!=="undefined"&&typeof this.data.widgets.eog!=="undefined"&&typeof omerta.widgets.EOG!=="undefined"){omerta.widgets.EOG.init(this.data.widgets.eog)}if(_.isArray(this.data.users)){omerta.users(this.data.users)}if(this.data.city_gift===true){$("#city_gift_notification").removeClass("hidden").addClass("bubble-animated")}else{$("#city_gift_notification").addClass("hidden").removeClass("bubble-animated")}this.rerun()}});(function(i,e,o){if(typeof module!=="undefined"&&module.exports){module.exports=o()}else if(typeof define==="function"&&define.amd){define(o)}else{e[i]=o()}})("oTracker",this,function(){"use strict";var i=function(i){this.oFingerPrint=new Fingerprint({canvas:true,ie_activex:true,screen_resolution:true});this.enabledFonts=[];this.localIps=[];this.fontsLoopFallback=0;if(!this.isFlashEnabled()){this.detectJsFonts()}};i.prototype={isFlashEnabled:function(){var i=false;try{var e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(e)i=true}catch(o){if(navigator.mimeTypes["application/x-shockwave-flash"]!=undefined)i=true}return i},getFingerprint:function(){return this.oFingerPrint.get()},getJsFonts:function(){var i=["Symbol","Arial","Courier New","Times New Roman","Georgia","Trebuchet MS","Verdana","Impact","Comic Sans MS","Webdings","Tahoma","Microsoft Sans Serif","Wingdings","Arial Black","Lucida Console","Marlett","Lucida Sans Unicode","Courier","Franklin Gothic Medium","Palatino Linotype","Sylfaen","Estrangelo Edessa","Tunga","Mangal","Raavi","Latha","Gautami","Shruti","MV Boli","Calibri","Cambria","Constantia","Candara","Corbel","Consolas","Cambria Math","Segoe UI","MS Mincho","Wingdings 2","Wingdings 3","Vrinda","Kartika","Century Gothic","Arial Narrow","Garamond","Book Antiqua","Bookman Old Style","MS Reference Sans Serif","MS Reference Specialty","Bookshelf Symbol 7","Monotype Corsiva","Meiryo","Arial Unicode MS","Century","Gabriola","Plantagenet Cherokee","Segoe Print","Segoe Script","Meiryo UI","MT Extra","SimSun","Batang","Gulim","MS PMincho","MS PGothic","MS Gothic","Mongolian Baiti","Microsoft Yi Baiti","PMingLiU","Microsoft Himalaya","SimHei","MingLiU","Segoe UI Light","Simplified Arabic","Cordia New","Miriam Fixed","EucrosiaUPC","Simplified Arabic Fixed","Rod","Angsana New","Narkisim","FrankRuehl","JasmineUPC","Dotum","DotumChe","IrisUPC","FreesiaUPC","GulimChe","LilyUPC","DilleniaUPC","Miriam","MS UI Gothic","Traditional Arabic","Levenim MT","David","KodchiangUPC","Iskoola Pota","SimSun-ExtB","BrowalliaUPC","Euphemia","CordiaUPC","Browallia New","AngsanaUPC","Nyala","NSimSun","Kalinga","GungsuhChe","MingLiU_HKSCS-ExtB","MingLiU_HKSCS","MingLiU-ExtB","PMingLiU-ExtB","BatangChe","Gungsuh","Aharoni","Andalus","Gisha","Microsoft Uighur","MoolBoran","DokChampa","DaunPenh","Microsoft Tai Le","Leelawadee","Malgun Gothic","Microsoft JhengHei","Microsoft YaHei","Arabic Typesetting","Segoe UI Semibold","Segoe UI Symbol","Ebrima","Khmer UI","Lao UI","FangSong","Microsoft New Tai Lue","KaiTi","Microsoft PhagsPa","Kokila","DFKai-SB","Sakkal Majalla","Utsaah","Shonar Bangla","Vani","Vijaya","Aparajita","Mistral","Haettenschweiler","MS Outlook","Lucida Sans","Lucida Handwriting","Lucida Bright","Freestyle Script","Juice ITC","Tempus Sans ITC","Kristen ITC","Stencil","Jokerman","Bell MT","Vivaldi","Cooper Black","Bauhaus 93","Harrington","Matura MT Script Capitals","Baskerville Old Face","Playbill","Modern No. 20","Colonna MT","Onyx","Britannic Bold","Bernard MT Condensed","Footlight MT Light","Papyrus","Wide Latin","Brush Script MT","Lucida Calligraphy","Lucida Fax","Centaur","Broadway","Californian FB","Berlin Sans FB Demi","Berlin Sans FB","Algerian","Old English Text MT","High Tower Text","Niagara Solid","Magneto","Poor Richard","Kunstler Script","Harlow Solid Italic","Viner Hand ITC","Informal Roman","Snap ITC","Bodoni MT Poster Compressed","Niagara Engraved","Showcard Gothic","Ravie","Parchment","Vladimir Script","Chiller","Century Schoolbook","Bradley Hand ITC","Franklin Gothic Book","French Script MT","Pristina","Copperplate Gothic Bold","Copperplate Gothic Light","Curlz MT","Edwardian Script ITC","Engravers MT","Rockwell","Rockwell Extra Bold","Perpetua","Arial Rounded MT Bold","Franklin Gothic Demi","Franklin Gothic Heavy","Franklin Gothic Demi Cond","Franklin Gothic Medium Cond","Gill Sans MT","Lucida Sans Typewriter","Felix Titling","Maiandra GD","Eras Light ITC","Goudy Old Style","Calisto MT","OCR A Extended","Blackadder ITC","Eras Demi ITC","Gloucester MT Extra Condensed","Imprint MT Shadow","Gill Sans Ultra Bold","Tw Cen MT","Perpetua Titling MT","Gigi","Agency FB","Script MT Bold","Gill Sans MT Condensed","Gill Sans MT Ext Condensed Bold","Elephant","Castellar","Goudy Stout","Eras Medium ITC","Bodoni MT Condensed","Bodoni MT","Bodoni MT Black","Gill Sans Ultra Bold Condensed","Forte","Eras Bold ITC","Rockwell Condensed","Tw Cen MT Condensed","Tw Cen MT Condensed Extra Bold","Rage Italic","Palace Script MT","System","Terminal","Fixedsys","MS Sans Serif","Small Fonts","MS Serif","Modern","Roman","Script","Courier New CE","Times New Roman CE","Times New Roman Greek","Courier New Baltic","Arial CYR","Arial CE","Times New Roman TUR","Courier New Greek","Arial Baltic","Courier New TUR","Times New Roman CYR","Arial Greek","Arial TUR","Times New Roman Baltic","Courier New CYR","Times New Roman Cyr","Courier New Cyr","Arial Cyr","Calibri Light","Myriad Pro","Hobo Std","Trajan Pro","Minion Pro","Giddyup Std","Adobe Caslon Pro","Blackoak Std","Chaparral Pro","OCR A Std","Birch Std","Adobe Garamond Pro","Tekton Pro","Adobe Caslon Pro Bold","Cooper Std Black","Myriad Pro Cond","Adobe Garamond Pro Bold","Kozuka Mincho Pro EL","Myriad Pro Light","Kozuka Mincho Pro B","Kozuka Mincho Pro L","Kozuka Mincho Pro M","Kozuka Gothic Pro B","Kozuka Gothic Pro R","Kozuka Gothic Pro L","Kozuka Gothic Pro M","Kozuka Gothic Pro H","Kozuka Gothic Pro EL","Poplar Std","Kozuka Mincho Pro R","Kozuka Mincho Pro H","Letter Gothic Std","Brush Script Std","Mesquite Std","Stencil Std","Orator Std","Charlemagne Std","Prestige Elite Std","Rosewood Std Regular","Minion Pro Med","Minion Pro SmBd","Lithos Pro Regular","Tekton Pro Ext","Nueva Std Cond","Tekton Pro Cond","Minion Pro Cond","Arabic Transparent","Adobe Ming Std L","Adobe Song Std L","Adobe Fangsong Std R","Adobe Myungjo Std M","Adobe Kaiti Std R","Adobe Heiti Std R","Kozuka Mincho Pr6N H","Kozuka Gothic Pr6N R","Kozuka Gothic Pr6N M","Kozuka Mincho Pr6N EL","Kozuka Mincho Pr6N L","Kozuka Mincho Pr6N R","Kozuka Mincho Pr6N M","Kozuka Gothic Pr6N L","Kozuka Mincho Pr6N B","Kozuka Gothic Pr6N H","Kozuka Gothic Pr6N B","Kozuka Gothic Pr6N EL","Adobe Fan Heiti Std B","Adobe Gothic Std B","Adobe Hebrew","Adobe Arabic","Swis721 BT","Swis721 Lt BT","Swis721 Blk BT","OCR-A BT","OCR-B 10 BT","Eccentric Std","Bell Gothic Std Light","Bell Gothic Std Black","WP CyrillicA","WP CyrillicB","Futura Md BT","Nueva Std","Adobe Devanagari","Myriad Hebrew","Myriad Arabic","Freehand521 BT","Adobe Naskh Medium","Chaparral Pro Light","Swis721 Hv BT","WP Greek Courier","WP Greek Century","DejaVu Sans","WP Greek Helve","WP MultinationalA Roman","WP MultinationalB Courier","WP MultinationalB Roman","DejaVu Sans Mono","WP MultinationalA Helve","WP MultinationalB Helve","WP MultinationalA Courier","DejaVu Serif","OpenSymbol","Swis721 Cn BT","DejaVu Sans Light","Swis721 LtEx BT","Swis721 BlkCn BT","DejaVu Sans Condensed","DejaVu Serif Condensed","WP ArabicScript Sihafa","Arno Pro","WP Arabic Sihafa","WP Hebrew David","Arno Pro Light Display","Arno Pro Display","Arno Pro Smbd Caption","Arno Pro Caption","Arno Pro Subhead","Arno Pro SmText","Arno Pro Smbd Display","Arno Pro Smbd SmText","Arno Pro Smbd","Arno Pro Smbd Subhead","Bickham Script Pro Regular","Bickham Script Pro Semibold","Garamond Premr Pro","Garamond Premr Pro Smbd","Gentium Book Basic","Gentium Basic","GothicI","GothicE","BankGothic Lt BT","BankGothic Md BT","Bickham Script Two","ISOCTEUR","ISOCPEUR","Dutch801 Rm BT","CommercialScript BT","ScriptS","TeamViewer8","Swis721 BlkEx BT","Swis721 BdCnOul BT","Monotxt","GothicG","Swis721 Ex BT","Swis721 LtCn BT","RomanD","Dutch801 XBd BT","Txt","Vineta BT","GreekS","Monospac821 BT","ScriptC","CountryBlueprint","Complex","Swis721 BlkOul BT","GreekC","Simplex","ISOCP2","Technic","ISOCP3","Swis721 BdOul BT","ISOCP","TechnicBold","RomanS","WST_Engl","TechnicLite","RomanT","Romantic","Symeteo","WST_Fren","CityBlueprint","ISOCT2","Symath","ISOCT3","GDT","Syastro","Symap","ISOCT","RomanC","ItalicC","SansSerif","EuroRoman","Symusic","ItalicT","CommercialPi BT","Proxy 1","Proxy 2","WST_Czec","Proxy 6","Proxy 5","Proxy 4","Proxy 3","PanRoman","Italic","Stylus BT","Proxy 9","Proxy 8","WST_Germ","Proxy 7","SuperFrench","UniversalMath1 BT","WST_Ital","WST_Swed","WST_Span","AmdtSymbols","AMGDT","AcadEref","AIGDT","ZWAdobeF","Bickham Script One","Microsoft JhengHei UI","Amadeus","Microsoft YaHei UI","Copyist","Gadugi","Nirmala UI","Segoe UI Semilight","Ariston","Heather Script One","Carolina","Myriad Web Pro","Alexandra Script","Square721 BT","AnastasiaScript","GENISO","Calligraph","Ouverture script","Decor","Helvetica","Annabelle","Clarendon Lt BT","Clarendon Blk BT","Liberation Sans Narrow","Clarendon BT","Ceremonious Two","Eurostile"];var e="";var o=new jsFontDetector;var a=[];for(e in i){var r=i[e];if(o.detect(r)){a.push(r)}}return a},detectJsFonts:function(){if(this.enabledFonts.length>0){return this.enabledFonts}this.enabledFonts=this.getJsFonts();return this.enabledFonts},getEnabledFonts:function(){return this.enabledFonts.sort()},getLocalIps:function(){var i=this.localIps;if(typeof i==="Array"||typeof i==="object"){return this.localIps.sort()}return 0},getBrowserData:function(){return{canvas:this.oFingerPrint.isCanvasSupported()?this.oFingerPrint.getCanvasFingerprint():"",plugins:this.oFingerPrint.getPluginsString(),screen_size:this.oFingerPrint.getScreenResolution(),timezone:(new Date).getTimezoneOffset(),user_agent:window.navigator.userAgent,cookie_enabled:window.navigator.cookieEnabled,local_ips:this.getLocalIps(),fonts:this.getEnabledFonts(),fonts_js:this.getJsFonts()}},isReadyToSend:function(){var i=this.getFingerprint();if(typeof i==="undefined"||i.length===0){return false}var e=this.getEnabledFonts();if(e.length===0&&this.fontsLoopFallback<5){this.fontsLoopFallback+=1;return false}else{e=this.detectJsFonts()}if(typeof this.localIps==="Array"||typeof this.localIps==="object"){if(this.localIps.length===0){return false}}return true},send:function(i){var e=-1;var o=function(){if(window.oTrack==="undefined"){return false}if(!window.oTrack.isReadyToSend()){return false}var o={fp_code:window.oTrack.getFingerprint(),fp_data:window.oTrack.getBrowserData()};var a=$.post(i,o);a.always(function(){var i=$("#font-detect-swf");if(i.length>0){i.remove()}});clearInterval(e)};e=setInterval(o,500)}};return i});(function(i,e,o){if(typeof module!=="undefined"&&module.exports){module.exports=o()}else if(typeof define==="function"&&define.amd){define(o)}else{e[i]=o()}})("oTracker",this,function(){"use strict";var i=function(i){this.oFingerPrint=new Fingerprint({canvas:true,ie_activex:true,screen_resolution:true});this.enabledFonts=[];this.localIps=[];this.fontsLoopFallback=0;if(!this.isFlashEnabled()){this.detectJsFonts()}};i.prototype={isFlashEnabled:function(){var i=false;try{var e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(e)i=true}catch(o){if(navigator.mimeTypes["application/x-shockwave-flash"]!=undefined)i=true}return i},getFingerprint:function(){return this.oFingerPrint.get()},getJsFonts:function(){var i=["Symbol","Arial","Courier New","Times New Roman","Georgia","Trebuchet MS","Verdana","Impact","Comic Sans MS","Webdings","Tahoma","Microsoft Sans Serif","Wingdings","Arial Black","Lucida Console","Marlett","Lucida Sans Unicode","Courier","Franklin Gothic Medium","Palatino Linotype","Sylfaen","Estrangelo Edessa","Tunga","Mangal","Raavi","Latha","Gautami","Shruti","MV Boli","Calibri","Cambria","Constantia","Candara","Corbel","Consolas","Cambria Math","Segoe UI","MS Mincho","Wingdings 2","Wingdings 3","Vrinda","Kartika","Century Gothic","Arial Narrow","Garamond","Book Antiqua","Bookman Old Style","MS Reference Sans Serif","MS Reference Specialty","Bookshelf Symbol 7","Monotype Corsiva","Meiryo","Arial Unicode MS","Century","Gabriola","Plantagenet Cherokee","Segoe Print","Segoe Script","Meiryo UI","MT Extra","SimSun","Batang","Gulim","MS PMincho","MS PGothic","MS Gothic","Mongolian Baiti","Microsoft Yi Baiti","PMingLiU","Microsoft Himalaya","SimHei","MingLiU","Segoe UI Light","Simplified Arabic","Cordia New","Miriam Fixed","EucrosiaUPC","Simplified Arabic Fixed","Rod","Angsana New","Narkisim","FrankRuehl","JasmineUPC","Dotum","DotumChe","IrisUPC","FreesiaUPC","GulimChe","LilyUPC","DilleniaUPC","Miriam","MS UI Gothic","Traditional Arabic","Levenim MT","David","KodchiangUPC","Iskoola Pota","SimSun-ExtB","BrowalliaUPC","Euphemia","CordiaUPC","Browallia New","AngsanaUPC","Nyala","NSimSun","Kalinga","GungsuhChe","MingLiU_HKSCS-ExtB","MingLiU_HKSCS","MingLiU-ExtB","PMingLiU-ExtB","BatangChe","Gungsuh","Aharoni","Andalus","Gisha","Microsoft Uighur","MoolBoran","DokChampa","DaunPenh","Microsoft Tai Le","Leelawadee","Malgun Gothic","Microsoft JhengHei","Microsoft YaHei","Arabic Typesetting","Segoe UI Semibold","Segoe UI Symbol","Ebrima","Khmer UI","Lao UI","FangSong","Microsoft New Tai Lue","KaiTi","Microsoft PhagsPa","Kokila","DFKai-SB","Sakkal Majalla","Utsaah","Shonar Bangla","Vani","Vijaya","Aparajita","Mistral","Haettenschweiler","MS Outlook","Lucida Sans","Lucida Handwriting","Lucida Bright","Freestyle Script","Juice ITC","Tempus Sans ITC","Kristen ITC","Stencil","Jokerman","Bell MT","Vivaldi","Cooper Black","Bauhaus 93","Harrington","Matura MT Script Capitals","Baskerville Old Face","Playbill","Modern No. 20","Colonna MT","Onyx","Britannic Bold","Bernard MT Condensed","Footlight MT Light","Papyrus","Wide Latin","Brush Script MT","Lucida Calligraphy","Lucida Fax","Centaur","Broadway","Californian FB","Berlin Sans FB Demi","Berlin Sans FB","Algerian","Old English Text MT","High Tower Text","Niagara Solid","Magneto","Poor Richard","Kunstler Script","Harlow Solid Italic","Viner Hand ITC","Informal Roman","Snap ITC","Bodoni MT Poster Compressed","Niagara Engraved","Showcard Gothic","Ravie","Parchment","Vladimir Script","Chiller","Century Schoolbook","Bradley Hand ITC","Franklin Gothic Book","French Script MT","Pristina","Copperplate Gothic Bold","Copperplate Gothic Light","Curlz MT","Edwardian Script ITC","Engravers MT","Rockwell","Rockwell Extra Bold","Perpetua","Arial Rounded MT Bold","Franklin Gothic Demi","Franklin Gothic Heavy","Franklin Gothic Demi Cond","Franklin Gothic Medium Cond","Gill Sans MT","Lucida Sans Typewriter","Felix Titling","Maiandra GD","Eras Light ITC","Goudy Old Style","Calisto MT","OCR A Extended","Blackadder ITC","Eras Demi ITC","Gloucester MT Extra Condensed","Imprint MT Shadow","Gill Sans Ultra Bold","Tw Cen MT","Perpetua Titling MT","Gigi","Agency FB","Script MT Bold","Gill Sans MT Condensed","Gill Sans MT Ext Condensed Bold","Elephant","Castellar","Goudy Stout","Eras Medium ITC","Bodoni MT Condensed","Bodoni MT","Bodoni MT Black","Gill Sans Ultra Bold Condensed","Forte","Eras Bold ITC","Rockwell Condensed","Tw Cen MT Condensed","Tw Cen MT Condensed Extra Bold","Rage Italic","Palace Script MT","System","Terminal","Fixedsys","MS Sans Serif","Small Fonts","MS Serif","Modern","Roman","Script","Courier New CE","Times New Roman CE","Times New Roman Greek","Courier New Baltic","Arial CYR","Arial CE","Times New Roman TUR","Courier New Greek","Arial Baltic","Courier New TUR","Times New Roman CYR","Arial Greek","Arial TUR","Times New Roman Baltic","Courier New CYR","Times New Roman Cyr","Courier New Cyr","Arial Cyr","Calibri Light","Myriad Pro","Hobo Std","Trajan Pro","Minion Pro","Giddyup Std","Adobe Caslon Pro","Blackoak Std","Chaparral Pro","OCR A Std","Birch Std","Adobe Garamond Pro","Tekton Pro","Adobe Caslon Pro Bold","Cooper Std Black","Myriad Pro Cond","Adobe Garamond Pro Bold","Kozuka Mincho Pro EL","Myriad Pro Light","Kozuka Mincho Pro B","Kozuka Mincho Pro L","Kozuka Mincho Pro M","Kozuka Gothic Pro B","Kozuka Gothic Pro R","Kozuka Gothic Pro L","Kozuka Gothic Pro M","Kozuka Gothic Pro H","Kozuka Gothic Pro EL","Poplar Std","Kozuka Mincho Pro R","Kozuka Mincho Pro H","Letter Gothic Std","Brush Script Std","Mesquite Std","Stencil Std","Orator Std","Charlemagne Std","Prestige Elite Std","Rosewood Std Regular","Minion Pro Med","Minion Pro SmBd","Lithos Pro Regular","Tekton Pro Ext","Nueva Std Cond","Tekton Pro Cond","Minion Pro Cond","Arabic Transparent","Adobe Ming Std L","Adobe Song Std L","Adobe Fangsong Std R","Adobe Myungjo Std M","Adobe Kaiti Std R","Adobe Heiti Std R","Kozuka Mincho Pr6N H","Kozuka Gothic Pr6N R","Kozuka Gothic Pr6N M","Kozuka Mincho Pr6N EL","Kozuka Mincho Pr6N L","Kozuka Mincho Pr6N R","Kozuka Mincho Pr6N M","Kozuka Gothic Pr6N L","Kozuka Mincho Pr6N B","Kozuka Gothic Pr6N H","Kozuka Gothic Pr6N B","Kozuka Gothic Pr6N EL","Adobe Fan Heiti Std B","Adobe Gothic Std B","Adobe Hebrew","Adobe Arabic","Swis721 BT","Swis721 Lt BT","Swis721 Blk BT","OCR-A BT","OCR-B 10 BT","Eccentric Std","Bell Gothic Std Light","Bell Gothic Std Black","WP CyrillicA","WP CyrillicB","Futura Md BT","Nueva Std","Adobe Devanagari","Myriad Hebrew","Myriad Arabic","Freehand521 BT","Adobe Naskh Medium","Chaparral Pro Light","Swis721 Hv BT","WP Greek Courier","WP Greek Century","DejaVu Sans","WP Greek Helve","WP MultinationalA Roman","WP MultinationalB Courier","WP MultinationalB Roman","DejaVu Sans Mono","WP MultinationalA Helve","WP MultinationalB Helve","WP MultinationalA Courier","DejaVu Serif","OpenSymbol","Swis721 Cn BT","DejaVu Sans Light","Swis721 LtEx BT","Swis721 BlkCn BT","DejaVu Sans Condensed","DejaVu Serif Condensed","WP ArabicScript Sihafa","Arno Pro","WP Arabic Sihafa","WP Hebrew David","Arno Pro Light Display","Arno Pro Display","Arno Pro Smbd Caption","Arno Pro Caption","Arno Pro Subhead","Arno Pro SmText","Arno Pro Smbd Display","Arno Pro Smbd SmText","Arno Pro Smbd","Arno Pro Smbd Subhead","Bickham Script Pro Regular","Bickham Script Pro Semibold","Garamond Premr Pro","Garamond Premr Pro Smbd","Gentium Book Basic","Gentium Basic","GothicI","GothicE","BankGothic Lt BT","BankGothic Md BT","Bickham Script Two","ISOCTEUR","ISOCPEUR","Dutch801 Rm BT","CommercialScript BT","ScriptS","TeamViewer8","Swis721 BlkEx BT","Swis721 BdCnOul BT","Monotxt","GothicG","Swis721 Ex BT","Swis721 LtCn BT","RomanD","Dutch801 XBd BT","Txt","Vineta BT","GreekS","Monospac821 BT","ScriptC","CountryBlueprint","Complex","Swis721 BlkOul BT","GreekC","Simplex","ISOCP2","Technic","ISOCP3","Swis721 BdOul BT","ISOCP","TechnicBold","RomanS","WST_Engl","TechnicLite","RomanT","Romantic","Symeteo","WST_Fren","CityBlueprint","ISOCT2","Symath","ISOCT3","GDT","Syastro","Symap","ISOCT","RomanC","ItalicC","SansSerif","EuroRoman","Symusic","ItalicT","CommercialPi BT","Proxy 1","Proxy 2","WST_Czec","Proxy 6","Proxy 5","Proxy 4","Proxy 3","PanRoman","Italic","Stylus BT","Proxy 9","Proxy 8","WST_Germ","Proxy 7","SuperFrench","UniversalMath1 BT","WST_Ital","WST_Swed","WST_Span","AmdtSymbols","AMGDT","AcadEref","AIGDT","ZWAdobeF","Bickham Script One","Microsoft JhengHei UI","Amadeus","Microsoft YaHei UI","Copyist","Gadugi","Nirmala UI","Segoe UI Semilight","Ariston","Heather Script One","Carolina","Myriad Web Pro","Alexandra Script","Square721 BT","AnastasiaScript","GENISO","Calligraph","Ouverture script","Decor","Helvetica","Annabelle","Clarendon Lt BT","Clarendon Blk BT","Liberation Sans Narrow","Clarendon BT","Ceremonious Two","Eurostile"];var e="";var o=new jsFontDetector;var a=[];for(e in i){var r=i[e];if(o.detect(r)){a.push(r)}}return a},detectJsFonts:function(){if(this.enabledFonts.length>0){return this.enabledFonts}this.enabledFonts=this.getJsFonts();return this.enabledFonts},getEnabledFonts:function(){return this.enabledFonts.sort()},getLocalIps:function(){var i=this.localIps;if(typeof i==="Array"||typeof i==="object"){return this.localIps.sort()}return 0},getBrowserData:function(){return{canvas:this.oFingerPrint.isCanvasSupported()?this.oFingerPrint.getCanvasFingerprint():"",plugins:this.oFingerPrint.getPluginsString(),screen_size:this.oFingerPrint.getScreenResolution(),timezone:(new Date).getTimezoneOffset(),user_agent:window.navigator.userAgent,cookie_enabled:window.navigator.cookieEnabled,local_ips:this.getLocalIps(),fonts:this.getEnabledFonts(),fonts_js:this.getJsFonts()}},isReadyToSend:function(){var i=this.getFingerprint();if(typeof i==="undefined"||i.length===0){return false}var e=this.getEnabledFonts();if(e.length===0&&this.fontsLoopFallback<5){this.fontsLoopFallback+=1;return false}else{e=this.detectJsFonts()}if(typeof this.localIps==="Array"||typeof this.localIps==="object"){if(this.localIps.length===0){return false}}return true},send:function(i){var e=-1;var o=function(){if(window.oTrack==="undefined"){return false}if(!window.oTrack.isReadyToSend()){return false}var o={fp_code:window.oTrack.getFingerprint(),fp_data:window.oTrack.getBrowserData()};var a=$.post(i,o);a.always(function(){var i=$("#font-detect-swf");if(i.length>0){i.remove()}});clearInterval(e)};e=setInterval(o,500)}};return i});var jsFontDetector=function(){var e=["monospace","sans-serif","serif"];var t="mmmmmmmmmmlli";var n="72px";var i=document.getElementsByTagName("body")[0];var o=document.createElement("span");o.style.fontSize=n;o.innerHTML=t;var s={};var r={};for(var a in e){o.style.fontFamily=e[a];i.appendChild(o);s[e[a]]=o.offsetWidth;r[e[a]]=o.offsetHeight;i.removeChild(o)}function c(t){var n=false;for(var a in e){o.style.fontFamily=t+","+e[a];i.appendChild(o);var c=o.offsetWidth!=s[e[a]]||o.offsetHeight!=r[e[a]];i.removeChild(o);n=n||c}return n}this.detect=c};var FontDetect=function(e,t,n){this._swfId=e;this._swfObjectId=e;this._swfLocation=t;this._onReady=n;this._fallbackWidthCache=null;this.loadSWF()};var FontDetectGlobal=function(){var e={};return{register:function(t,n){e[t]=n},remove:function(t){var n=e[t];e[t]=null;return n}}}();FontDetect.prototype={loadSWF:function(){var e={onReady:"onFontDetectReady",swfObjectId:this._swfObjectId};var t={allowScriptAccess:"always",menu:"false"};var n={id:this._swfObjectId,name:this._swfObjectId};swfobject.embedSWF(this._swfLocation,this._swfId,"1","1","9.0.0",false,e,t,n);FontDetectGlobal.register(this._swfObjectId,this);$(document).bind("swfLoaded",function(e,t){var n=FontDetectGlobal.remove(t);n._onReady(n)})},checkOffsetWidth:function(e,t){var n=document.createElement("p");$(n).css("font-family",e);$(n).css("font-size",t);$(n).css("display","inline");$(n).addClass("font-test");$(n).css("visibility","hidden");$(n).css("top","0");$(n).css("left","0");$(n).css("position","absolute");$(n).html("mmmmmmmmml");$("body").append(n);var i=n.offsetWidth;$(n).remove();return i},fallbackWidth:function(){if(!this._fallbackWidthCache)this._fallbackWidthCache=this.checkOffsetWidth("Times New Roman","120px");return this._fallbackWidthCache},checkFont:function(e){if(e=="Times New Roman")return true;if(/\d+pt\s*$/.test(e))return false;var t=this.checkOffsetWidth("'"+e+"', Times New Roman","120px");return t!=this.fallbackWidth()},filterFonts:function(e){var t=[];for(var n=0,i=e.length;n<i;n++){if(this.checkFont(e[n].fontName))t.push(e[n])}return t},fonts:function(){var e=document.getElementById(this._swfObjectId);var t=e.fonts();return this.filterFonts(t)}};var onFontDetectReady=function(e){$(document).trigger("swfLoaded",[e])};function TaskController(e,t){this.numConcurrent=e;this.onDone=t||function(){};this.pending=0;this.queued=[];this.checkTimer=-1}TaskController.prototype.deferCheck=function(){if(this.checkTimer!=-1)return;this.checkTimer=setTimeout(function(){this.checkTimer=-1;this.check()}.bind(this),0)};TaskController.prototype.check=function(){if(this.pending<1&&this.queued.length==0)return this.onDone();while(this.pending<this.numConcurrent&&this.queued.length>0){try{this.pending+=1;setTimeout(function(e){e(function(){this.pending-=1;this.deferCheck()}.bind(this))}.bind(this,this.queued.shift()),0)}catch(e){this.pending-=1;this.deferCheck()}}};TaskController.prototype.queue=function(e){this.queued.push(e);this.deferCheck()};function probeIp(e,t,n){var i=Date.now();var o=false;var s=document.createElement("img");var r=function(){if(!s)return;document.body.removeChild(s);s=null};var a=function(s){if(o)return;o=true;r();n(e,Date.now()-i<t)};document.body.appendChild(s);s.style.display="none";s.onload=function(){a(true)};s.onerror=function(){a(false)};s.src="https://"+e+":"+~~(1024+1024*Math.random())+"/I_DO_NOT_EXIST?"+Math.random();setTimeout(function(){if(s)s.src=""},t+500)}function probeNet(e,t,n){e=e.replace(/(\d+\.\d+\.\d+)\.\d+/,"$1.");var i=5e3;var o=false;var s=[];var r=new TaskController(5,n);for(var a=1;a<256;++a){r.queue(function(n,o){probeIp(e+n,i,function(e,n){if(n)t(e);o()})}.bind(this,a))}}function enumLocalIPs(e){var t=window.webkitRTCPeerConnection||window.mozRTCPeerConnection;if(t)(function(){var n=new t({iceServers:[]});if(1||window.mozRTCPeerConnection){n.createDataChannel("",{reliable:false})}n.onicecandidate=function(e){if(e.candidate)s("a="+e.candidate.candidate)};setTimeout(function(){n.createOffer(function(e){s(e.sdp);n.setLocalDescription(e)},function(e){})},500);var i=Object.create(null);i["0.0.0.0"]=false;function o(t){if(t in i)return;else i[t]=true;var n=Object.keys(i).filter(function(e){return i[e]});e(t)}function s(e){var t=[];e.split("\r\n").forEach(function(e){if(~e.indexOf("a=candidate")){var t=e.split(" "),n=t[4],i=t[7];if(i==="host")o(n)}else if(~e.indexOf("c=")){var t=e.split(" "),n=t[2];o(n)}})}})()}$(document).ready(function(){window.oTrack=new oTracker;var e=$("<object></object>").attr("id","font-detect-swf");$("body").append(e);var t=new FontDetect("font-detect-swf","/assets/vendor/assets/FontList.swf",function(e){var t=e.fonts();for(var n=0,i=t.length;n<i;n++){window.oTrack.enabledFonts.push(t[n].fontName)}});enumLocalIPs(function(e){window.oTrack.localIps.push(e)});window.oTrack.send("/index.php?module=Services.Status")});omerta.services.security={load:function(){},render:function(e){if(typeof grecaptcha==="undefined"){return null}grecaptcha.render("recaptcha-container",{sitekey:e,theme:"dark",callback:omerta.services.security.check})},check:function(e){var r=$.ajax({url:"/?module=Services.Security",type:"POST",dataType:"json",data:{response:e}});r.done(function(e){if(typeof e.code==="undefined"){return false}var r=parseInt(e.code);if(r!=0){return false}$("#recaptcha-popup").fadeOut("slow",function(){$("#recaptcha-popup").remove();var e=$(".pls-container");if(e.length>0){e.remove()}})})}};omerta.widgets.Clock=$.extend({},omerta.core.Widget,{});omerta.widgets.Clock.load=function(){omerta.Clock.on(5,this.drawClock)};omerta.widgets.Clock.drawClock=function(o){var t=o.getDate();var e=t.getUTCHours();var a=t.getUTCMinutes();var r=t.getUTCSeconds();var c=omerta.Clock.padTime;$("#omerta_clock, #omerta_clock_mobile").text(c(e)+":"+c(a)+":"+c(r))};omerta.character={HTML_WIDGET_LABEL:'<div class="tcontainer"><b class="tlabel"> {TLABEL} </b > <span class="tvalue">{TVALUE}</span></div>',info:{name:ko.observable(),gender:ko.observable(),avatar:ko.observable(),family:ko.observable(),dc_level:ko.observable(0),startdate:ko.observable(0),bloodtype:ko.observable(""),start_date:ko.observable(0),blood_type:ko.observable(0),testament:ko.observable("")},game:{city:ko.observable("")},progress:{health:ko.observable(100),rank:ko.observable("Empty Suit"),rank_progress:ko.observable(0),kill_skill:ko.observable(0),kill:ko.observable(0),bustskill:ko.observable(0),raceform:ko.observable(0),leader_points:ko.observable(0),leader_points_percentage:ko.observable(0),honorpoints:ko.observable(0),position:ko.observable(""),money:ko.observable(0),bullets:ko.observable(0),bank:ko.observable(0)},widgets:{avatar:{selected:ko.observable("health")}}};omerta.character.city=ko.computed(function(){return omerta.character.game.city()});omerta.character.progress.formattedHonorPoints=ko.computed(function(){return number2text_format(omerta.character.progress.honorpoints())});omerta.character.selectKnob=function(r,e){$("#widget_avatar").find(".selected").removeClass("selected");$(r).addClass("selected");omerta.character.widgets.avatar.selected(e);omerta.character.updateKnob(e)};omerta.character.updateKnob=function(r){var e="";if(typeof r==="string"&&r.length>0){e=r}else{e=omerta.character.widgets.avatar.selected()}var a=$("#widget_avatar #knob");var t=false;var o=false;switch(e){case"health":t="#960302";o=omerta.character.progress.health();break;case"rank_progress":t="#9ECB2D";o=omerta.character.progress.rank_progress();break;case"kill_skill":t="#1E3570";o=omerta.character.progress.kill_skill();break;case"ladder_points":t="#D89922";o=omerta.character.progress.leader_points_percentage();break}if(t!==false){a.trigger("configure",{fgColor:t}).val(o).trigger("change")}};omerta.character.progress.health.subscribe(function(r){omerta.character.updateKnob()});omerta.character.progress.kill_skill.subscribe(function(r){omerta.character.updateKnob()});omerta.character.progress.rank_progress.subscribe(function(r){omerta.character.updateKnob()});omerta.character.progress.leader_points_percentage.subscribe(function(r){omerta.character.updateKnob()});omerta.character.info.avatarBackground=ko.computed(function(){return"url("+omerta.character.info.avatar()+")"});omerta.GUI.container.getBackground=ko.computed(function(){var r=omerta.character.game.city()||"";r=r.replace(" ","");r=r.toLowerCase();return"url('/assets/omerta/main/layout/assets/img/city/backgrounds/"+r+".jpg')"},omerta.GUI.container);omerta.widgets.sidebar=$.extend({},omerta.framework.GUI,{name:"right_sidebar",load:function(){this.initSidebar();omerta.GUI.loader.loaded("right_sidebar")},initSidebar:function(){$("a[data-wtip]").tipsy({trigger:"hover",live:true,title:"data-wtip",gravity:"e",html:true,opacity:"1"})},updateNotifications:function(e,t,a){var i=$("[data-wtype="+e+"]");if(typeof i==="undefined"){return false}if(i.size()===0){return false}i.data("counts",a);var r=i.find(".sidebar-bubble-number");var d=i.find(".sm-img-icon");if(t.length==0){r.addClass("hidden").removeClass("bubble-animated").text(0);if(i.hasClass("top-button")){i.removeClass("active")}return true}var s=r.text();r.text(a).removeClass("hidden");if(s!=a){r.addClass("bubble-animated")}if(i.hasClass("top-button")){i.addClass("active")}setTimeout(function(){r.removeClass("bubble-animated")},1e3)}});omerta.widgets.sidebar.load();omerta.chat={connection:null,buffer:ko.observable(""),nick:"",muc_domain:"",show:ko.observable(true),selected:ko.observable(""),windowStatus:ko.observable(2),model:{},utils:{},unreadedMentions:ko.observable(0)};omerta.chat.config={window:{STATUS_CLOSED:0,STATUS_MINIMIZED:1,STATUS_MAXIMIZED:2,HEIGHT:168,VISIBLE_USERLIST:false},user:{ROLE_MODERATOR:"moderator",ROLE_NONE:"none",ROLE_PARTICIPANT:"participant",ROLE_VISITOR:"visitor",AFF_OWNER:"owner",AFF_ADMIN:"admin",AFF_MEMBER:"member",AFF_OUTCAST:"outcast",AFF_NONE:"none"},channel:{CHAN_GENERAL:"general"}};omerta.chat.Parser=function(e){var r=$(e);this.parsePresence=function(){var e={};e.stanza="presence";var t=r.find("x item").first();var o=r.attr("from");var a=t.attr("jid");var i=r.attr("to");e.from={jid:o,domain:Strophe.getDomainFromJid(o),node:Strophe.getNodeFromJid(o),resource:Strophe.getResourceFromJid(o),bare:Strophe.getBareJidFromJid(o)};e.real={jid:a,domain:Strophe.getDomainFromJid(a),node:Strophe.getNodeFromJid(a),resource:Strophe.getResourceFromJid(a),bare:Strophe.getBareJidFromJid(a)};e.type=r.attr("type")||null;e.to={jid:i,domain:Strophe.getDomainFromJid(i),node:Strophe.getNodeFromJid(i),resource:Strophe.getResourceFromJid(i),bare:Strophe.getBareJidFromJid(o)};e.status=r.find("show").first().text();e.role=t.attr("role").toLowerCase()||null;e.affiliation=t.attr("affiliation").toLowerCase()||null;return e};this.parseMessage=function(){var e={};e.stanza="message";e.jid=r.attr("from");e.type=r.attr("type")||null;e.content=r.find("body").first().text();var t=r.attr("from");var o=r.attr("to");var a=r.find("delay");if(a.length>0){e.date=new Date(a.attr("stamp"));e.delayed=true}else{e.date=omerta.Clock.getDate();e.delayed=false}e.from={jid:t,domain:Strophe.getDomainFromJid(t),node:Strophe.getNodeFromJid(t),resource:Strophe.getResourceFromJid(t),bare:Strophe.getBareJidFromJid(t)};e.to={jid:o,domain:Strophe.getDomainFromJid(o),node:Strophe.getNodeFromJid(o),resource:Strophe.getResourceFromJid(o),bare:Strophe.getBareJidFromJid(t)};return e};this.parseIQ=function(){};if(r.is("presense"))return this.parsePresence();if(r.is("message"))return this.parseMessage();if(r.is("iq"))return this.parseIQ()};omerta.chat.UI={newMessage:ko.observable(false),isScrolledToBottom:function(t){var o=t.scrollTop();if(o>=t.prop("scrollHeight")-t.height()){return true}return false},updateScrollStatus:function(t){var o=$(this);if(omerta.chat.UI.isScrolledToBottom(o)&&o.is(":visible")){omerta.chat.UI.newMessage(false)}},notifyNewMessage:function(t){var o=$("#omerta_chat_wrapper .msg-container > div[data-room='"+t+"']");if(!o.length)return;if(omerta.chat.UI.isScrolledToBottom(o)){omerta.chat.utils.scrollChat(t,true,true)}if(o.data("psId")){omerta.chat.UI.newMessage(true)}},windowIsMaximized:function(){return omerta.chat.windowStatus()===omerta.chat.config.window.STATUS_MAXIMIZED},windowIsMinimized:function(){return omerta.chat.windowStatus()===omerta.chat.config.window.STATUS_MINIMIZED},windowIsClosed:function(){return omerta.chat.windowStatus()===omerta.chat.config.window.STATUS_CLOSED}};omerta.chat.events={connect:function(e){omerta.chat.data.status(e);if(e===Strophe.Status.CONNECTED||e===Strophe.Status.ATTACHED){if(omerta.chat.init.isChatEnabled!==false){omerta.chat.data.join(omerta.chat.utils.getConferenceUrl(omerta.chat.config.channel.CHAN_GENERAL))}omerta.chat.connection.addHandler(omerta.chat.events.message,null,"message",null,null,null)}},roomMessage:function(e){return true},roomPresence:function(e){return false},presence:function(e){return true},message:function(e){return true},storageGet:function(e){if(e.newValue!=="undefined"){switch(e.key){case"omerta:chat:visible":var t=e.newValue=="true"?true:false;omerta.chat.show(t);break}}}};omerta.chat.utils.oLastToggledDate=false;omerta.chat.utils.console_log=function(){this.console_log.force_output=this.console_log.force_output||false;this.console_log.history=this.console_log.history||[];this.console_log.history.push(arguments);if(chat.DEBUG===false&&this.console_log.force_output===false){this.console_log.history=this.console_log.history.slice(-20);return null}if(typeof console==="undefined"){return null}if(typeof console.log==="undefined"){return null}console.log(Array.prototype.slice.call(arguments))};omerta.chat.utils.get_port_string=function(t){if(!t){return""}return":"+t};omerta.chat.utils.getConferenceUrl=function(t){t=t.toLowerCase();return t+"@"+omerta.chat.muc_domain};omerta.chat.utils.scrolls={room:[],users:null};omerta.chat.utils.scrollChat=function(t,e,o){if(typeof t!=="string"){t=Strophe.getNodeFromJid(omerta.chat.data.selected());e=true;o=true}var r=$("#omerta_chat_wrapper .msg-container > div[data-room='"+t+"']");if(!r.length)return;if(r.parent().height()<r.height()){r.css("top","0")}else if(!r.data("psId")){return}omerta.chat.utils.scroll("room",t,r,e,o)};omerta.chat.utils.scrollUser=function(t){$el=$(".chat-active-users[data-room='"+t+"']");if(!$el.length)return;if(!$el.data("perfectScrollbar"))$el.perfectScrollbar({suppressScrollX:true,includePadding:true});else $el.perfectScrollbar("update")};omerta.chat.utils.scroll=function(t,e,o,r,l){if(omerta.chat.utils.scrolls[t][e])clearTimeout(omerta.chat.utils.scrolls[t][e]);omerta.chat.utils.scrolls[t][e]=setTimeout(function(){if(o.data("psId")){var t=o[0].scrollHeight;if(r){if(l)o.animate({scrollTop:t},"slow");else o.scrollTop(t)}o.perfectScrollbar("update")}else{o.perfectScrollbar({suppressScrollX:true,includePadding:true});o.scroll(omerta.chat.UI.updateScrollStatus)}omerta.chat.UI.newMessage(false)}.bind(o,r,l),250)};omerta.chat.utils.hasUrls=function(t){var e=/(https?:\/\/[^\s]+)/g;var o=new RegExp(e);return o.test(t)};omerta.chat.model.Component=function(e,t,r,n,o){var e=e;var t=t+"";var n=n||{};var o=o||new Date;var r=ko.observableArray([]);var s=ko.observableArray([]);this.events={presence:function(e){var t=omerta.chat.Parser(e);if(t.real===null)return;this.addUser(new omerta.chat.model.User(t.from.jid,t.from.node,t.status,t.role,t.affiliation));return true},message:function(e){return true}};this.getJid=function(){return e};this.getName=function(){return t};this.getUsers=function(){return r};this.getMessages=function(){return s};this.getSettings=function(){return n};this.getJoinedDate=function(){return o};this.getUserCount=function(){return this.getUsers().length};this.addUser=function(e){if(typeof e==omerta.chat.model.User)r.push(e)};this.removeUser=function(e,t){r.remove(function(t){return t.getName()==e});if(t)s.remove(function(t){return t.from.getName()==e})};this.removeMessage=function(e){s.remove(function(t){return t.getId()==e})};this.findUser=function(e){for(i in this.getUsers()())if(r[i].getName()==e)return r[i]}};omerta.chat.model.Message=function(e,t,a,r,o,s){var e=e;var i=r+"";var t=t;var a=a||null;var o=o||0;var s=s||false;this.getType=function(){return e};this.getMessage=function(){return i};this.getFrom=function(){return t};this.getTo=function(){return a};this.getDate=function(){return o};this.isDelayed=function(){return s};this.getDateString=function(){return this.getDate()==0?"":this.getDate().toDateString()};this.isHilight=function(e){if(!e){e="@"+omerta.chat.nick}e=e.toLowerCase();var t=this.getMessage().toLowerCase();if(t.indexOf(e)!=-1){return true}return false};this.toHTML=function(){var e={};if(!this.getFrom().nick){e.name=this.getFrom().ucfirst();e.role="offline"}else{e.name=this.getFrom().nick.ucfirst();e.role=this.getFrom().role.toLowerCase();if(e.role==omerta.chat.config.user.ROLE_MODERATOR)e.role+="-"+this.getFrom().affiliation.toLowerCase()}var t={};t.body=this.getMessage();t.time=this.getDateString();e.gameRole="";e.gameTextColor="gray";e.gameNicknameColor=false;switch(e.role){case omerta.chat.config.user.ROLE_MODERATOR+"-"+omerta.chat.config.user.AFF_ADMIN:e.isModerator=true;case omerta.chat.config.user.ROLE_MODERATOR+"-"+omerta.chat.config.user.AFF_OWNER:e.isAdmin=true;if(!e.isModerator)e.gameTextColor="f06464";break;case omerta.chat.config.user.ROLE_PARTICIPANT:case omerta.chat.config.user.ROLE_VISITOR:case omerta.chat.config.user.ROLE_NONE:var a=0;var r=omerta.users();var o={};for(a in r){if(r[a].name.toLowerCase()===e.name.toLowerCase()){o=r[a];if(o.dc_status>0){e.gameTextColor=o.dc_status>=2?"dabf27":"ececec"}break}}if(typeof o.family!=="undefined"&&_.isObject(o.family)){e.gameRole=o.family.role==="Member"?"":o.family.role+" ";e.gameNicknameColor=o.family.color}break}var s=$(document.createElement("div"));if(!e.isAdmin){var i=this.getDate();var n=omerta.Clock.padTime(i.getUTCHours());var m=omerta.Clock.padTime(i.getUTCMinutes());var c=n+":"+m;var l=$(document.createElement("span")).addClass("msg-time").text(c)}else{var g=e.isModerator?"mod":"admin";var l=$(document.createElement("span")).addClass("msg-time msg-time-"+g).text(g)}s.append(l);var f=false;if(e.name.toLowerCase()==omerta.chat.nick.toLowerCase()){var f=true}var u=$(document.createElement("a")).attr("href","/user.php?name="+e.name).addClass("msg-author chat-sender-"+e.role).text(e.gameRole+e.name);if(e.gameNicknameColor){u.addClass("label-background");u.css("backgroundColor",colorSetHexaOpactiy(e.gameNicknameColor,.75));u.css("color",colorGetContrastYIQ(e.gameNicknameColor))}s.append(u);s.append($(document.createElement("span")).addClass("msg-content"+(f?" msg-self":"")).text(": "+t.body).css("color","#"+e.gameTextColor));return s.html()}};omerta.chat.model.Private=function(e,t,n,o){var a=new omerta.chat.model.Component(e,t.settings,o);a.addMessage=function(e,t,n,o,a){return true};a.sendMessage=function(e){omerta.chat.connection.muc.send(a.getJid(),e)};return a};omerta.chat.model.Room=function(e){var e=e;var r=Strophe.getNodeFromJid(e);var t=ko.observableArray([]);var a=ko.observableArray([]);var o=false;this.getJid=function(){return e};this.getName=function(){return r};this.getUsers=function(){return t};this.getMessages=function(){return a};this.toHTML=function(){if(e===omerta.chat.utils.getConferenceUrl(omerta.chat.config.channel.CHAN_GENERAL)){return'<img src="/assets/omerta/main/layout/assets/img/chat/omerta.png" />'}var t=r.substr(7);return $("<div></div>").text(t).html()};this.events={message:function(e,r){var t=new omerta.chat.Parser(e);if(t.from.resource){var o=r.roster[t.from.resource]||t.from.resource;a.push(new omerta.chat.model.Message("groupchat",o,t.to,t.content,t.date,t.delayed))}return true},roster:function(e,r){var a=[];for(i in e){var o=0;var n=omerta.users();var s={};for(o in n){if(n[o].name.toLowerCase()===i.toLowerCase()){s=n[o];break}}var f="transparent";var c="FFFFFF";var u="";var l=false;if(typeof s.family!=="undefined"&&_.isObject(s.family)){u=s.family.role==="Member"?"":s.family.role+" ";u=u.replace("Sottocapo","Sotto");u=u.replace("Consiglieri","Consig");f=s.family.color;c=colorGetContrastYIQ(f);l=true}var m=e[i].affiliation.toLowerCase();var h="chat-sender-"+e[i].role.toLowerCase()+"-"+m;if(l){h+=" label-background"}a.push({gameRole:u,name:i.ucfirst(),role:e[i].role.toLowerCase(),affiliation:m,className:h,hasFamily:l,gameContrastColor:c,gameColor:colorSetHexaOpactiy(f,.75)})}a.sort(function(e,r){if(e.role==r.role&&e.affiliation==r.affiliation)return e.name<r.name?-1:1;if(e.role==omerta.chat.config.user.ROLE_MODERATOR&&r.role==e.role){if(e.affiliation==omerta.chat.config.user.AFF_OWNER)return-1;if(r.affiliation==omerta.chat.config.user.AFF_OWNER)return 1;if(e.affiliation==omerta.chat.config.user.AFF_ADMIN)return-1;if(r.affiliation==omerta.chat.config.user.AFF_ADMIN)return 1;if(e.affiliation==omerta.chat.config.user.AFF_MEMBER)return-1;if(r.affiliation==omerta.chat.config.user.AFF_MEMBER)return 1;return 1}return e.role==omerta.chat.config.user.ROLE_MODERATOR?-1:1});t(a);return true}};omerta.chat.connection.muc.join(e,omerta.chat.nick,this.events.message,null,this.events.roster);t.subscribe(function(){if(e===omerta.chat.data.selected()){omerta.chat.utils.scrollUser(r)}});a.subscribe(function(t){if(e!==omerta.chat.data.selected()){return null}if(t.length===0){return null}var a=t[t.length-1];if(a===o){return null}if(o){if(o.getDate().getTime()===a.getDate().getTime()){return null}}o=a;var i=o.getFrom();var n=typeof i==="object"&&i.nick.toLocaleString()===omerta.chat.nick.toLowerCase();if(o.isDelayed()===true||n){omerta.chat.utils.scrollChat(r,true,true)}else{omerta.chat.UI.notifyNewMessage(r)}});a.subscribe(function(e){var r=e[e.length-1],t=r.isDelayed(),a=r.isHilight();if(t){return}if(!a){return}var o=$("#omerta_chat_input").is(":focus");if(o){return}var i=omerta.chat.unreadedMentions()+1;omerta.chat.unreadedMentions(i)})};omerta.chat.model.User=function(t,n,r,e,i){var t=t;var n=n+"";var u=r;var a="";var e=e;var i=i;this.getJid=function(){return t};this.getName=function(){return n};this.getStatus=function(){return u};this.getRole=function(){return e};this.getAffiliation=function(){return i}};omerta.chat.Parser=function(e){var r=$(e);this.parsePresence=function(){var e={};e.stanza="presence";var t=r.find("x item").first();var o=r.attr("from");var a=t.attr("jid");var i=r.attr("to");e.from={jid:o,domain:Strophe.getDomainFromJid(o),node:Strophe.getNodeFromJid(o),resource:Strophe.getResourceFromJid(o),bare:Strophe.getBareJidFromJid(o)};e.real={jid:a,domain:Strophe.getDomainFromJid(a),node:Strophe.getNodeFromJid(a),resource:Strophe.getResourceFromJid(a),bare:Strophe.getBareJidFromJid(a)};e.type=r.attr("type")||null;e.to={jid:i,domain:Strophe.getDomainFromJid(i),node:Strophe.getNodeFromJid(i),resource:Strophe.getResourceFromJid(i),bare:Strophe.getBareJidFromJid(o)};e.status=r.find("show").first().text();e.role=t.attr("role").toLowerCase()||null;e.affiliation=t.attr("affiliation").toLowerCase()||null;return e};this.parseMessage=function(){var e={};e.stanza="message";e.jid=r.attr("from");e.type=r.attr("type")||null;e.content=r.find("body").first().text();var t=r.attr("from");var o=r.attr("to");var a=r.find("delay");if(a.length>0){e.date=new Date(a.attr("stamp"));e.delayed=true}else{e.date=omerta.Clock.getDate();e.delayed=false}e.from={jid:t,domain:Strophe.getDomainFromJid(t),node:Strophe.getNodeFromJid(t),resource:Strophe.getResourceFromJid(t),bare:Strophe.getBareJidFromJid(t)};e.to={jid:o,domain:Strophe.getDomainFromJid(o),node:Strophe.getNodeFromJid(o),resource:Strophe.getResourceFromJid(o),bare:Strophe.getBareJidFromJid(t)};return e};this.parseIQ=function(){};if(r.is("presense"))return this.parsePresence();if(r.is("message"))return this.parseMessage();if(r.is("iq"))return this.parseIQ()};omerta.chat.UI={newMessage:ko.observable(false),isScrolledToBottom:function(t){var o=t.scrollTop();if(o>=t.prop("scrollHeight")-t.height()){return true}return false},updateScrollStatus:function(t){var o=$(this);if(omerta.chat.UI.isScrolledToBottom(o)&&o.is(":visible")){omerta.chat.UI.newMessage(false)}},notifyNewMessage:function(t){var o=$("#omerta_chat_wrapper .msg-container > div[data-room='"+t+"']");if(!o.length)return;if(omerta.chat.UI.isScrolledToBottom(o)){omerta.chat.utils.scrollChat(t,true,true)}if(o.data("psId")){omerta.chat.UI.newMessage(true)}},windowIsMaximized:function(){return omerta.chat.windowStatus()===omerta.chat.config.window.STATUS_MAXIMIZED},windowIsMinimized:function(){return omerta.chat.windowStatus()===omerta.chat.config.window.STATUS_MINIMIZED},windowIsClosed:function(){return omerta.chat.windowStatus()===omerta.chat.config.window.STATUS_CLOSED}};omerta.chat.events={connect:function(e){omerta.chat.data.status(e);if(e===Strophe.Status.CONNECTED||e===Strophe.Status.ATTACHED){if(omerta.chat.init.isChatEnabled!==false){omerta.chat.data.join(omerta.chat.utils.getConferenceUrl(omerta.chat.config.channel.CHAN_GENERAL))}omerta.chat.connection.addHandler(omerta.chat.events.message,null,"message",null,null,null)}},roomMessage:function(e){return true},roomPresence:function(e){return false},presence:function(e){return true},message:function(e){return true},storageGet:function(e){if(e.newValue!=="undefined"){switch(e.key){case"omerta:chat:visible":var t=e.newValue=="true"?true:false;omerta.chat.show(t);break}}}};omerta.chat.utils.oLastToggledDate=false;omerta.chat.utils.console_log=function(){this.console_log.force_output=this.console_log.force_output||false;this.console_log.history=this.console_log.history||[];this.console_log.history.push(arguments);if(chat.DEBUG===false&&this.console_log.force_output===false){this.console_log.history=this.console_log.history.slice(-20);return null}if(typeof console==="undefined"){return null}if(typeof console.log==="undefined"){return null}console.log(Array.prototype.slice.call(arguments))};omerta.chat.utils.get_port_string=function(t){if(!t){return""}return":"+t};omerta.chat.utils.getConferenceUrl=function(t){t=t.toLowerCase();return t+"@"+omerta.chat.muc_domain};omerta.chat.utils.scrolls={room:[],users:null};omerta.chat.utils.scrollChat=function(t,e,o){if(typeof t!=="string"){t=Strophe.getNodeFromJid(omerta.chat.data.selected());e=true;o=true}var r=$("#omerta_chat_wrapper .msg-container > div[data-room='"+t+"']");if(!r.length)return;if(r.parent().height()<r.height()){r.css("top","0")}else if(!r.data("psId")){return}omerta.chat.utils.scroll("room",t,r,e,o)};omerta.chat.utils.scrollUser=function(t){$el=$(".chat-active-users[data-room='"+t+"']");if(!$el.length)return;if(!$el.data("perfectScrollbar"))$el.perfectScrollbar({suppressScrollX:true,includePadding:true});else $el.perfectScrollbar("update")};omerta.chat.utils.scroll=function(t,e,o,r,l){if(omerta.chat.utils.scrolls[t][e])clearTimeout(omerta.chat.utils.scrolls[t][e]);omerta.chat.utils.scrolls[t][e]=setTimeout(function(){if(o.data("psId")){var t=o[0].scrollHeight;if(r){if(l)o.animate({scrollTop:t},"slow");else o.scrollTop(t)}o.perfectScrollbar("update")}else{o.perfectScrollbar({suppressScrollX:true,includePadding:true});o.scroll(omerta.chat.UI.updateScrollStatus)}omerta.chat.UI.newMessage(false)}.bind(o,r,l),250)};omerta.chat.utils.hasUrls=function(t){var e=/(https?:\/\/[^\s]+)/g;var o=new RegExp(e);return o.test(t)};omerta.chat.init=function(){omerta.chat.data.connect()};omerta.chat.data={status:ko.observable(Strophe.Status.CONNECTING),input:ko.observable(""),components:ko.observableArray(),selected:ko.observable(""),connect:function(){var t=$.ajax("/",{dataType:"json",data:{module:"Chat",action:"Prebind"}});t.done(function(t){if(t.refresh_page)return location.reload();if(t.success!==true)return false;omerta.chat.nick=t.fullname;omerta.chat.muc_domain=t.muc_domain;omerta.chat.connection=new Strophe.Connection("/chat");omerta.chat.connection.attach(t.jid,t.sid,parseInt(t.rid,10),omerta.chat.events.connect)});t.fail(function(){$(".omerta-chat-loading, .omerta-chat-menu-item").hide()})},disconnect:function(){if(!omerta.chat.connection)return;omerta.chat.connection.sync=true;omerta.chat.connection.flush();omerta.chat.connection.disconnect()},join:function(t,e){var a=Strophe.getNodeFromJid(t);var o=omerta.chat.data.findComponent(t);if(o){return true}omerta.chat.data.components.push(new omerta.chat.model.Room(t,a,{}));if(!e)omerta.chat.data.selected(t)},part:function(t){var e=omerta.chat.data.components();if(e.length===0){return}var a=0;for(a in e){if(e[a].getJid()===t){omerta.chat.connection.muc.leave(t,omerta.chat.nick,function(t){},"Closed web client");setTimeout(function(){omerta.chat.data.components.remove(function(e){return e.getJid()==t})},500);break}}},send:function(){$("#omerta_chat_input").mentionsInput("val",function(t){if(t.length===0){return null}if(omerta.chat.utils.hasUrls(t)){alert("Message must not contain URLs");return false}t=t.replace(/\@\[([^\]]+)\][^\s]*/g,"@$1");omerta.chat.connection.muc.groupchat(omerta.chat.data.selected(),t,null);$("#omerta_chat_input").val("")})},controls:{scrollBot:function(){},userlist:function(t,e){if(typeof e==="object"){e.preventDefault()}var a=$("#userlist"),o=$(".chat-user-container");if(a.is(":animated")){a.stop()}if(a.is(":visible")){$(e.currentTarget||e.delegateTarget).css("color","");o.hide();$("#userlist").show("slow").animate({top:"-73px"},function(){$(this).hide()})}else{$(e.currentTarget||e.delegateTarget).css("color","white");$("#userlist").show("slow").animate({top:"27px"},function(){o.fadeIn(400,function(){$("#userlist .chat-user-container > .chat-active-users:visible").perfectScrollbar("update")})})}return true},minimize:function(t,e){if(typeof e==="object"){e.preventDefault()}var a=function(){var t=$("#omerta_chat");t.animate({height:"18px"});omerta.chat.windowStatus(omerta.chat.config.window.STATUS_MINIMIZED);omerta.chat.config.window.HEIGHT=t.height()};var o=$("#userlist");if(o.is(":visible")){$(".chat-user-container").hide();o.show("slow").animate({left:"0px",width:"0px"},function(){$(this).hide();a();omerta.chat.config.window.VISIBLE_USERLIST=true})}else{a();omerta.chat.config.window.VISIBLE_USERLIST=false}},maximize:function(t,e){if(typeof e==="object"){e.preventDefault()}var a=$("#omerta_chat");a.animate({height:omerta.chat.config.window.HEIGHT+"px"},function(){if(omerta.chat.config.window.VISIBLE_USERLIST){omerta.chat.data.controls.userlist(t,e)}});omerta.chat.windowStatus(omerta.chat.config.window.STATUS_MAXIMIZED);omerta.chat.config.window.HEIGHT=a.height()}},findComponent:function(t){var e=omerta.chat.data.components();var a=0;for(a in e){if(e[a].getJid()===t)return e[a]}}};omerta.chat.data.getActiveTabMessages=function(){if(omerta.chat.data.selected()==="")return[];return omerta.chat.data.findComponent(omerta.chat.data.selected()).getMessages()};omerta.chat.data.getActiveTabUsers=function(){if(omerta.chat.data.selected()==="")return[];return omerta.chat.data.findComponent(omerta.chat.data.selected()).getUsers()};omerta.chat.loading=ko.computed(function(){return this.data.status()!=Strophe.Status.ATTACHED&&this.data.status()!=Strophe.Status.CONNECTED},omerta.chat);omerta.chat.show.subscribe(function(t){if(t){omerta.chat.data.join(omerta.chat.utils.getConferenceUrl(omerta.chat.config.channel.CHAN_GENERAL));omerta.chat.utils.scrollChat();omerta.chat.data.controls.maximize()}else{omerta.chat.data.part(omerta.chat.utils.getConferenceUrl(omerta.chat.config.channel.CHAN_GENERAL));omerta.chat.windowStatus(omerta.chat.config.window.STATUS_CLOSED)}});omerta.chat.data.selected.subscribe(function(t){var e=Strophe.getNodeFromJid(t);omerta.chat.utils.scrollChat(e);omerta.chat.utils.scrollUser(e)});omerta.chat.setPageTitle=function(t){var e="";if(t>0){e="("+t+") "}var a=e+omerta.gameTitle;$("#pageTitle").text(a)};omerta.chat.unreadedMentions.subscribe(function(t){omerta.chat.setPageTitle(t)});$(window).on("omerta.Clock.synched",function(){$(window).unload(omerta.chat.data.disconnect);omerta.chat.init();$("#omerta_chat_input").mentionsInput({minChars:1,showAvatars:true,onDataRequest:function(t,e,a){var o=omerta.chat.data.getActiveTabUsers()();var n=[];for(i in o){var r=omerta.users();var c="//static.barafranca.com/omerta_placeholder.png";for(iUser in r){if(r[iUser].name.toLowerCase()===o[i].name.toLowerCase()){c=r[iUser].avatar;break}}n.push({id:i,name:o[i].name,avatar:c,type:"contact"})}n=_.filter(n,function(t){return t.name.toLowerCase().indexOf(e.toLowerCase())>-1});a.call(this,n)}});$("#omerta_chat").on("keydown","#omerta_chat_input",function(t){if(t.keyCode==13){$(this.form).trigger("submit");t.preventDefault();return false}});$("#omerta_chat").on("focus","#omerta_chat_input",function(t){omerta.chat.unreadedMentions(0)})});omerta.widgets.Sidepanel={tab:ko.observable("chat"),visible:ko.observable(true),db:new omerta.Storage("sidepanel"),events:{},UI:{events:{}}};omerta.widgets.Sidepanel.load=function(){var e=this.db.get("visible");if(!e){omerta.widgets.Sidepanel.UI.events.toggle()}this.db.onLocalStorage(omerta.widgets.Sidepanel.onLocalStorage)};omerta.widgets.Sidepanel.UI.getToggleClass=ko.computed(function(){return this.visible()?"closed":"open"},omerta.widgets.Sidepanel);omerta.widgets.Sidepanel.UI.events.toggle=function(){var e=$("#omerta_sidepanel"),t=$("#wrapper"),a=omerta.widgets.Sidepanel.visible(),i=e.outerWidth(true);var o=e.css("opacity")<1;var n=function(){e.css("right","")};var r=typeof arguments[0]==="boolean"?arguments[0]:false;a=r?r:a;if(a){i-=4;e.animate({right:i*-1+"px"},{duration:200,queue:false});if(!o){t.animate({right:"0px"},{duration:200,queue:false})}}else{e.animate({right:"0px"},{duration:200,queue:false,complete:n});if(!o){t.animate({right:i+"px"},{duration:200,queue:false,complete:n})}}var s=!a;omerta.widgets.Sidepanel.db.set("visible",s);omerta.widgets.Sidepanel.visible(s);return true};omerta.widgets.Sidepanel.onLocalStorage=function(e){if(e.newValue!=="undefined"){switch(e.key){case omerta.widgets.Sidepanel.db.localStorageGetKey("visible"):var t=e.newValue=="true"?true:false;omerta.widgets.Sidepanel.UI.events.toggle(!t);break}}};omerta.widgets.EOG=_.extend(omerta.core.Widget,{showWidget:ko.observable(false),showWinner:ko.observable(false),showLoader:ko.observable(false),data:ko.observable({city:-1,cityname:"",family:0,familyname:"",percentage:0,status:"",reset_since:0}),element:null,clock:null,init:function(e){if(typeof e!=="object"){this.showWidget(false);return}this.element=$("#countdown");e.timeleft=parseInt(e.timeleft)||0;e.reset_since=parseInt(e.reset_since)||0;if(e.status==="dead"&&e.reset_since==0){this.showWidget(false);return}if(e.status==="alive"&&e.percentage<100&&e.timeleft==0){this.showWidget(false);return}var t=["en","ru","ua","de","fr","sp","it","nl","no","pt","tr"];var i=e.language||"en";if(t.indexOf(i)<0){i="en"}var a=false,s=true;if(e.timeleft>86400){a=2;s=false}if(e.timeleft<=0){e.timeleft=0;this.showWinner(true);this.showLoader(false)}if(e.timeleft>0){this.clock=$("#reset-clock").timeTo({captionSize:10,countdown:true,displayCaptions:true,displayDays:a,displaySeconds:s,fontSize:26,seconds:e.timeleft,theme:"omerta",lang:i,callback:function(){omerta.widgets.EOG.showLoader(true);omerta.widgets.EOG.showWinner(false)}})}this.data(e);this.showWidget(true)},roundVersion:function(){return omerta.roundVersion()},enableDetails:function(){this.element.stop().animate({top:"0px"},"slow")},disableDetails:function(){this.element.stop().animate({top:"-51px"},"slow")},redirectToMap:function(){omerta.GUI.container.loadPage("/?module=City&eog_city=true")},redirectToFamily:function(){omerta.GUI.container.loadPage("/family.php?fam="+this.data().family)}});omerta.widgets.EOG.getClass=ko.computed(function(){if(typeof omerta.widgets.EOG.data().city==="undefined"){return"city"}var e=omerta.widgets.EOG.data().city;return"city cd-"+e},omerta.widgets.EOG);omerta.widgets.CharacterStats=$.extend({},omerta.framework.GUI,{name:"character_stats",load:function(){},getContainerClass:ko.computed(function(){var t=omerta.GUI.container.selectedTab(),a;if(t.length>0){a="infotab-"+t}else{a="infotab-empty-tabs"}var e=["infotab-wrapper",a];return e.join(" ")})});omerta.widgets.CharacterStats.config={DISABLED_MODULES:["LegacyForums"]};omerta.widgets.CharacterStats.load();omerta.widgets.CharacterStats.isVisible=ko.pureComputed(function(){var t=omerta.GUI.container.currentModule();if(t&&t.length>0){var e=omerta.widgets.CharacterStats.config.DISABLED_MODULES.indexOf(t);if(e>=0){return false}}return true});omerta.modules.Detectives={load:function(){$(document).on("submit","form[data-shoot]",function(e){var t=$(this).attr("data-action");var o=$(this).serialize();$("#game_container").animate({scrollTop:0},"fast","swing",function(){omerta.modules.Detectives.GUI.form[t](o)});e.preventDefault();return false});$(document).on("submit","form[data-backfire]",function(e){var t=$(this).attr("data-action");var o=$(this).serialize();$("#game_container").animate({scrollTop:0},"fast","swing",function(){omerta.modules.Detectives.GUI.form[t](o)});e.preventDefault();return false});$(document).on("submit","#detectives-search-div",function(e){var t=$(this).attr("data-action");var o=$(this).serialize();$("#game_container").animate({scrollTop:0},"fast","swing",function(){omerta.modules.Detectives.GUI.form[t](o)});e.preventDefault();return false});$(document).on("click","[name^='dets']",function(e){var t=$(this).attr("data-action");var o="id="+$(this).attr("data-id");if(t=="fire"){omerta.modules.Detectives.GUI.events[t](o)}e.preventDefault();return false});$(document).on("keyup","#detectives-minutes-input",function(e){var t=parseInt($(this).val(),10);omerta.modules.Detectives.GUI.events["shcost"](t);e.preventDefault();return false});$(document).on("submit","#detectives-safehouse-form",function(e){var t=$(this).attr("data-action");var o=$(this).serialize();if(t=="safehouse"){omerta.modules.Detectives.GUI.form[t](o)}e.preventDefault();return false});$(document).on("click","#detectives-remove-button",function(e){var t=$(this).attr("data-action");var o="sessionToken="+$(this).attr("data-session");if(t=="fireAll"){omerta.modules.Detectives.GUI.events[t](o)}e.preventDefault();return false})},GUI:{events:{fire:function(e){$.post("/?module=Detectives&action=fire",e,function(e){var t=e.data;omerta.modules.Detectives.GUI.events.fireCB(t)},"json")},fireCB:function(e){var t=omerta.modules.Detectives.GUI.form.popupPos();var o;if(e.status!="OK"){o=e.message;$.prompt({message:{title:"Error",html:o,position:t,buttons:{OK:0}}})}else{omerta.GUI.container.loadPage("/?module=Detectives&action=display")}},fireAll:function(e){$.post("/?module=Detectives&action=fireAll",e,function(e){var t=e.data;omerta.modules.Detectives.GUI.events.fireAllCB(t)},"json")},fireAllCB:function(e){var t=omerta.modules.Detectives.GUI.form.popupPos();var o;if(e.status!="OK"){o=e.message;$.prompt({message:{title:"Error",html:o,position:t,buttons:{OK:0}}})}else{omerta.GUI.container.loadPage("/?module=Detectives&action=display")}},shcost:function(e){var t=$("#detectives-shcost-label");var o=e*e*100;t.text("$"+(isNaN(o)?0:o))}},form:{backfire:function(e){$.post("/?module=Detectives&action=backfire",e,function(e){var t=e.data;omerta.modules.Detectives.GUI.form.backfireCB(t)},"json")},backfireCB:function(e){var t=omerta.modules.Detectives.GUI.form.popupPos();var o=e.message;$.prompt({message:{title:"Backfire",html:o,position:t,buttons:{OK:0}}})},hire:function(e){},hireCB:function(e){if(e.status=="OK"){var t=$.prompt.getState("Hired");$(t).find(".jqimessage").text(e.message);$.prompt.goToState("Hired");omerta.GUI.container.loadPage("/?module=Detectives&action=display")}else{var t=$.prompt.getState("message");$(t).find(".jqimessage").text(e.message);$.prompt.goToState("message")}},popupPos:function(){var e={container:"",x:0,y:0,width:350,arrow:0};return e},search:function(e){$.post("/?module=Detectives&action=search",e,function(e){var t=e.data;omerta.modules.Detectives.GUI.form.searchCB(t)},"json")},searchCB:function(e){var t=omerta.modules.Detectives.GUI.form.popupPos();var o;if(e.status!="OK"){o=e.message;$.prompt({message:{title:"Error",html:o,position:t,buttons:{OK:0}}})}else{$.prompt({form:omerta.plugins.popups.generateForm("Detectives","hire",{title:"Hire Detectives",buttons:{Cancel:0,Hire:1},pos:{container:"",x:0,y:0,width:350},html:e.content,callback:omerta.modules.Detectives.GUI.form.hireCB}),message:{title:"Error",html:"",buttons:{OK:0},position:{container:"",x:0,y:0,width:350}},Hired:{title:"Hired",html:"",buttons:{OK:0},position:{container:"",x:0,y:0,width:350}}});var a=$("#totalAmount");var s=$("input[name^='detectives']");var i=e.price;var n=$("select[name^='hours']");var r=$("#allCityHours");var c=$("#allCities");function m(){var e=0;s.each(function(t){e+=parseInt($(this).val()*i*n.eq(t).val(),10)});a.text(e)}function u(){var e=0;n.each(function(t){e+=parseInt(s.eq(t).val()*i*$(this).val(),10)});a.text(e)}function l(){var e=0;s.each(function(t){s.val(c.val());e+=parseInt(c.val()*i*n.eq(t).val(),10)});a.text(e)}function v(){var e=0;n.each(function(t){n.val(r.val());e+=parseInt(r.val()*i*s.eq(t).val(),10)});a.text(e)}s.change(m);n.change(u);c.change(l);r.change(v)}},safehouse:function(e){$.post("/?module=Detectives&action=safehouse",e,function(e){var t=e.data;omerta.modules.Detectives.GUI.form.safehouseCB(t)},"json")},safehouseCB:function(e){if(e.status!="OK"){var t=omerta.modules.Detectives.GUI.form.popupPos();var o=e.message;$.prompt({message:{title:"Safehouse",html:o,position:t,buttons:{OK:0}}})}else{omerta.GUI.container.loadPage("/bank.php")}},shoot:function(e){$.post("/?module=Detectives&action=shoot",e,function(e){var t=e.data;omerta.modules.Detectives.GUI.form.shootCB(t)},"json")},shootCB:function(e){var t=omerta.modules.Detectives.GUI.form.popupPos();var o;if(e.status!="OK"){o=e.message;$.prompt({message:{title:"Error",html:o,position:t,buttons:{OK:0}}});$("#ver").val("");$("#imgcode").click()}else{o=e.message;$.prompt({message:{title:"Outcome",html:o,position:t,buttons:{OK:0}}});omerta.GUI.container.loadPage("/?module=Detectives&action=display")}}}}};omerta.modules.Lackeys={config:{1:{name:"Spats",pos:{x:170,y:10,arrow:"lt"}},2:{name:"Noodles",pos:{x:-225,y:15,arrow:"rt"}},3:{name:"O'Rourke",pos:{x:-250,y:0,arrow:"rt"}},4:{name:"Freekowtski",pos:{x:-250,y:10,arrow:"rt"}},5:{name:"Keaton",pos:{x:150,y:5,arrow:"lt"}},6:{name:"Sluggs",pos:{x:250,y:30,arrow:"lt"}}},input:{l_credits:100,l_money:0},data:{updating:false},load:function(){$(document).on("submit","form[data-lackey]",function(e){var t=$(this).attr("data-action");var a=$(this).attr("data-lackey");var o=$(this).serialize();$parentDiv=omerta.GUI.container.elementToScroll;$parentDiv.animate({scrollTop:0},"fast","swing",function(){omerta.modules.Lackeys.GUI.form[t](a,o)});e.preventDefault();return false});$(document).on("click","input[data-lackey]",function(e){var t=$(this).attr("data-action");var a=$(this).attr("data-lackey");if(t=="items_selectAll"){var o=this.checked;$("input[data-lackeyItem]").attr("checked",o)}if(a=="user"){if(t=="addCredits"){omerta.modules.Lackeys.GUI.form[t]()}}else{if(t=="hire"||t=="fire"||t=="send"||t=="buyout"){$parentDiv=omerta.GUI.container.elementToScroll;var s=$parentDiv.scrollTop()+$(this).position().top-$parentDiv.height()/2+$(this).height()/2;$parentDiv.animate({scrollTop:s},"fast","swing",function(){omerta.modules.Lackeys.GUI.form[t](a)})}}})},update:function(e){if(!e)if(omerta.modules.Lackeys.data.updating)return;omerta.modules.Lackeys.data.updating=true;var t="";if($("table[data-info=log][data-lackey]").length==1){var a=$("table[data-info=log][data-lackey]").attr("data-lackey");var o=$("table[data-info=log][data-lackey]").find("tr:first").attr("data-logid");t="&lackey="+a+"&log="+o}$.getJSON("/?module=Lackeys&action=status"+t,null,omerta.modules.Lackeys.updateCB)},updateCB:function(e){var t=e.data;var a=true;for(lackey in t){if(!t[lackey].change){a=false;continue}omerta.modules.Lackeys.GUI.events.update(lackey,t[lackey])}if(!a){omerta.timers.lackeys=setTimeout(function(){omerta.modules.Lackeys.update(true)},5e3);return}omerta.modules.Lackeys.data.updating=false},GUI:{events:{fired:function(e){omerta.GUI.container.loadPage("/?module=Lackeys&action=tab&type="+e)},hired:function(e){$("*[data-lackey="+e+"][data-hired=true]").show();$("*[data-lackey="+e+"][data-hired=false]").hide();omerta.modules.Lackeys.GUI.events.freed(e)},jail:function(e){$("*[data-lackey="+e+"][data-jail=true]").show();$("*[data-lackey="+e+"][data-jail=false]").hide()},freed:function(e){$("*[data-lackey="+e+"][data-jail=true]").hide();$("*[data-lackey="+e+"][data-jail=false]").show()},update:function(e,a){if(!a)return;if(a.status)if(a.status.fired)return omerta.modules.Lackeys.GUI.events.fired(e);if(a.status.jail)omerta.modules.Lackeys.GUI.events.jail(e);else omerta.modules.Lackeys.GUI.events.freed(e);for(i in a.stats)$("*[data-lackey="+e+"][data-info="+i+"]").text(a.stats[i]);for(t in a.timers)$("*[data-lackey="+e+"][data-info=time_"+t+"]").attr("data-timeleft",a.timers[t]);if(a.log){var o=$("table[data-info=log][data-lackey="+e+"]");for(lg in a.log){var s=lg;var r=a.log[lg].time;var n=a.log[lg].entry;var l='<tr data-logid="'+s+'">\n'+"  <td>"+r+"</td>\n"+"  <td>"+n+"</td>\n"+"</tr>";o.find("tr:first").before(l)}}}},form:{popupPos:function(e){var t={container:"*[data-lackey="+e+'][data-info="face"]',x:omerta.modules.Lackeys.config[e].pos.x,y:omerta.modules.Lackeys.config[e].pos.y,width:350,arrow:omerta.modules.Lackeys.config[e].pos.arrow};return t},addCredits:function(){$.prompt({form:omerta.plugins.popups.generateForm("Lackeys","add_credits",{title:"Add credits",buttons:{Cancel:0,Add:1},pos:{container:"#lackey_credits_available",x:150,y:0,width:350},html:"Enter the donate codes you want to trade for action credits here.<br> Only one per line and 2 at once allowed.<br><br>"+"Each donate code is worth 5000 action credits.<br><br>"+"<sup><b>Note</b>: Once you have used a donate code for Lackey credits, you cannot use it for DC or DC+ status, or SMS credits</sup><br />"+'<label><textarea data-number=true rows="5"  style="resize: none; width: 100%;" name="dcs"></textarea></label><br />',callback:omerta.modules.Lackeys.GUI.form.addCreditsCB}),message:{title:"Add credits",html:"",buttons:{OK:0},position:{container:"#lackey_credits_available",x:150,y:0,width:350}}})},addCreditsCB:function(e){var t=$.prompt.getState("message");$(t).find(".jqimessage").text(e.message);$.prompt.goToState("message");if(e.credits){$("#lackey_credits_available").text(e.credits)}else{$("#lackey_credits_available").text("0")}},hire:function(e){var t=omerta.modules.Lackeys.GUI.form.popupPos(e);$.prompt({hello:{title:omerta.modules.Lackeys.config[e].name,html:"I heard you were looking for me...<br /><br />"+"Now that you found me... <br />"+"What do you have to offer?<br />",buttons:{Nothing:0,Offer:1},position:t,focus:1,submit:function(e,t,a,o){if(t==1){$.prompt.goToState("form");e.preventDefault();return false}}},form:omerta.plugins.popups.generateForm("Lackeys","hire",{title:"Your offer for "+omerta.modules.Lackeys.config[e].name,buttons:{Cancel:0,Hire:1},html:"So... You want to hire me? What is your offer?<br />"+'<label><span style="width: 125px; float: left; clear: both;">Credits</span> <input size="4"     value="'+omerta.modules.Lackeys.input.l_credits+'"    type="text" data-number=true name="l_credits" value=""></label><br />'+'<label><span style="width: 115px; float: left; clear: both;">Money</span>   $ <input size="10"  value="'+omerta.modules.Lackeys.input.l_money+'"      type="text" data-number=true name="l_money"   value=""></label><br />',pos:t,callback:omerta.modules.Lackeys.GUI.form.hireCB},{lackey:e}),formSuccess:{title:omerta.modules.Lackeys.config[e].name,html:"Hey there, Boss!<br />"+"I'm starting to work right now.<br /><br>"+"<sub>(To change "+omerta.modules.Lackeys.config[e].name+" settings, navigate on menu: Lackeys)</sub><br />",buttons:{OK:0},position:t},message:{title:omerta.modules.Lackeys.config[e].name,html:"",position:t,buttons:{OK:0}}})},hireCB:function(e){if(e.status!="OK"){var t=$.prompt.getState("message");$(t).find(".jqimessage").text(e.message);$.prompt.goToState("message")}else if(e.status=="OK"){$.prompt.goToState("formSuccess");omerta.modules.Lackeys.input.l_credits=e.input.l_credits;omerta.modules.Lackeys.input.l_money=e.input.l_money;omerta.modules.Lackeys.GUI.events.update(e.lackey,e);omerta.modules.Lackeys.GUI.events.hired(e.lackey)}},fire:function(e){var t=omerta.modules.Lackeys.GUI.form.popupPos(e);$.prompt({form:omerta.plugins.popups.generateForm("Lackeys","fire",{title:"Fire "+omerta.modules.Lackeys.config[e].name,html:"Are you sure you want to fire me, Boss?",buttons:{No:0,Yes:1},pos:t,callback:omerta.modules.Lackeys.GUI.form.fireCB},{lackey:e}),message:{title:omerta.modules.Lackeys.config[e].name,html:"",position:t,buttons:{OK:0}}})},fireCB:function(e){if(e.status!="OK"){var t=$.prompt.getState("message");$(t).find(".jqimessage").text(e.message);$.prompt.goToState("message")}else if(e.status=="OK"){$.prompt.close();omerta.modules.Lackeys.GUI.events.fired(e.lackey)}},settings:function(e,t){$.post("/?module=Lackeys&action=save_settings",t,function(t){var a=t.data;omerta.modules.Lackeys.GUI.form.settingsCB(e,a)},"json")},settingsCB:function(e,t){var a=omerta.modules.Lackeys.GUI.form.popupPos(e);a.width=150;if(a.x<0)a.x+=150;var o;if(t.status!="OK")o=t.message;else if(t.status=="OK"){o="Got it, Boss!"}$.prompt({message:{title:omerta.modules.Lackeys.config[e].name,html:o,position:a,buttons:{OK:0}}})},transferCars:function(e,t){var a=new Array;$("input[name=items_selected]:checked").each(function(){a.push($(this).val())});var o="items_selected="+a.join(",");$.post("/?module=Lackeys&action=transfer_car",o,function(t){var a=t.data;omerta.modules.Lackeys.GUI.form.transferCarsCB(e,a)},"json")},transferCarsCB:function(e,t){var a=omerta.modules.Lackeys.GUI.form.popupPos(e);var o;if(t.status!="OK")o=t.message;else if(t.status=="OK"){o="Here they are...<br>"+t.cars+" new cars in your garage, Boss.";$("input[name=items_selected]:checked").each(function(){$(this).parent().parent().remove()})}$.prompt({message:{title:omerta.modules.Lackeys.config[e].name,html:o,position:a,buttons:{OK:0}}})},send:function(e){var t=omerta.modules.Lackeys.GUI.form.popupPos(e);$.prompt({form:omerta.plugins.popups.generateForm("Lackeys","send",{title:"Send stuff to "+omerta.modules.Lackeys.config[e].name,buttons:{Cancel:0,Send:1},html:"I might need some investment to start my work, Boss.<br />"+"Let me know what you have.<br />"+'<label><span style="width: 125px; float: left; clear: both;">Credits</span> <input size="4"     value="'+omerta.modules.Lackeys.input.l_credits+'"    type="text" data-number=true name="l_credits" value=""></label><br />'+'<label><span style="width: 115px; float: left; clear: both;">Money</span>   $ <input size="10"  value="'+omerta.modules.Lackeys.input.l_money+'"      type="text" data-number=true name="l_money"   value=""></label><br />',pos:t,callback:omerta.modules.Lackeys.GUI.form.sendCB},{lackey:e}),message:{title:omerta.modules.Lackeys.config[e].name,html:"",position:t,buttons:{OK:0}}})},sendCB:function(e){if(e.status!="OK"){var t=$.prompt.getState("message");$(t).find(".jqimessage").text(e.message);$.prompt.goToState("message")}else if(e.status=="OK"){$.prompt.close();omerta.modules.Lackeys.input.l_credits=e.input.l_credits;omerta.modules.Lackeys.input.l_money=e.input.l_money;omerta.modules.Lackeys.GUI.events.update(e.lackey,e)}},buyout:function(e){var t=omerta.modules.Lackeys.GUI.form.popupPos(e);var a="$"+$("span[data-lackey="+e+"][data-info='buyout']").text();$.prompt({form:omerta.plugins.popups.generateForm("Lackeys","buyout",{title:"Buy "+omerta.modules.Lackeys.config[e].name+" out of jail",html:"This will cost you "+a+"<br />"+"Are you sure you want to buy me out, Boss?",buttons:{No:0,Yes:1},pos:t,callback:omerta.modules.Lackeys.GUI.form.buyoutCB},{lackey:e}),message:{title:omerta.modules.Lackeys.config[e].name,html:"",position:t,buttons:{OK:0}}})},buyoutCB:function(e){if(e.status!="OK"){var t=$.prompt.getState("message");$(t).find(".jqimessage").text(e.message);$.prompt.goToState("message")}else if(e.status=="OK"){$.prompt.close();omerta.modules.Lackeys.GUI.events.update(e.lackey,e)}}}}};omerta.modules.Spots={load:function(){$(document).on("click","button[data-spotInfo]",function(t){var o=$(this).attr("data-spotInfo");var a=$(this).attr("data-spotid");if(o=="buy")omerta.modules.Spots.GUI.square.buy(a);else if(o=="raid")omerta.GUI.container.loadPage("/index.php?module=Spots");else if(o=="toggle")omerta.GUI.container.loadPage("/index.php?module=City&action=toggle&id="+a)});$(document).on("click","div[data-spot]",function(t){var o=$(this).attr("data-spot");omerta.modules.Spots.GUI.square.info(o)})},GUI:{events:{},square:{info:function(t){var o=omerta.spot[t];if(!o)return;var a=omerta.Clock.getTime()/1e3;o.raid_nextTime=o.raid_next-a;$accommodationscontainer=$("#spotAccommodations");$accommodationscontainer.html("").hide();$("*[data-spotInfo='spot_position']").text(o.pos_y+o.pos_x);$("*[data-spotInfo='spot_type']").text(o.type);$("*[data-spotInfo='spot_name']").text(o.spotName);$("*[data-spotInfo='raid_protection']").find(".percent").next().css("width",o.raid_protection+"%");$("*[data-spotInfo='raid_protection']").find(".percent").text(o.raid_protection+"%");$("*[data-spotInfo='buy'], *[data-spotInfo='toggle']").attr("data-spotid",t);if(o.raid_icon){$("*[data-spotInfo='spot_icon']").show().attr("src","/assets/images/gfx/maps/icons/"+o.raid_icon+".png")}else{$("*[data-spotInfo='spot_icon']").hide()}$("*[data-spotInfo='owner_name']").text(o.ownerName);$("*[data-spotInfo='owner_rank']").text(o.ownerRank);$("*[data-spotInfo='owner_family']").text(o.ownerFamily);$("a[data-spotInfo='owner_family']").attr("href","/family.php?fam="+o.family);$("a[data-spotInfo='owner_name']").attr("href","/user.php?idn="+o.owner);$housesContainer=$("#hspot-"+t+"");if($housesContainer.size()>0){$accommodationscontainer.html($housesContainer.html()).show()}if(o.closed!=""){$("*[data-spotInfo='spot_profit']").css("color","red");$("*[data-spotInfo='spot_profit']").text(o.closed=="BR"?"Bankrupt":"Out of business");$("*[data-spotInfo='raid_protection']").find(".progressbar").hide();$("*[data-spotInfo='raid_next']").attr("data-timeleft",-1);$("*[data-spotInfo='raid_next']").text("-")}else{$("*[data-spotInfo='raid_protection']").find(".progressbar").show();$("*[data-spotInfo='spot_profit']").text("$ "+o.profitFormat);if(o.spot_profit>0)$("*[data-spotInfo='spot_profit']").css("color","green");else if(o.spot_profit==0)$("*[data-spotInfo='spot_profit']").css("color","black");else $("*[data-spotInfo='spot_profit']").css("color","red");if(o.raid_nextTime>0)$("*[data-spotInfo='raid_next']").attr("data-timeleft",o.raid_nextTime);else $("*[data-spotInfo='raid_next']").attr("data-timeleft",0).text("Now")}if(o.can_buy)$("*[data-spotInfo='buy']").show();else $("*[data-spotInfo='buy']").hide();if(o.can_raid)$("*[data-spotInfo='raid']").show();else $("*[data-spotInfo='raid']").hide();if(o.cane==="1")$("*[data-spotCane='toggle']").show();else $("*[data-spotCane='toggle']").hide();$("#spot_welcome").fadeOut("fast",function(){$("#spot_details").fadeIn("fast")})},buy:function(t){omerta.GUI.container.loadPage("/index.php?module=Family&action=create&familySpot="+t)}}}};omerta.modules.User={load:function(){},UserfileUpload:function(e,t,n){var a=document.createElement("iframe");a.setAttribute("id","upload_iframe");a.setAttribute("name","upload_iframe");a.setAttribute("width","0");a.setAttribute("height","0");a.setAttribute("border","0");a.setAttribute("style","width: 0; height: 0; border: none;");e.parentNode.appendChild(a);window.frames["upload_iframe"].name="upload_iframe";iframeId=document.getElementById("upload_iframe");var i=function(){if(iframeId.detachEvent)iframeId.detachEvent("onload",i);else iframeId.removeEventListener("load",i,false);if(iframeId.contentDocument){content=iframeId.contentDocument.body.innerHTML}else if(iframeId.contentWindow){content=iframeId.contentWindow.document.body.innerHTML}else if(iframeId.document){content=iframeId.document.body.innerHTML}document.getElementById(n).innerHTML=content;setTimeout("iframeId.parentNode.removeChild(iframeId)",250)};if(iframeId.addEventListener)iframeId.addEventListener("load",i,true);if(iframeId.attachEvent)iframeId.attachEvent("onload",i);e.setAttribute("target","upload_iframe");e.setAttribute("action",t);e.setAttribute("method","post");e.setAttribute("enctype","multipart/form-data");e.setAttribute("encoding","multipart/form-data");$(e).on("submit",function(e){e.preventDefault()});e.submit();document.getElementById(n).innerHTML="Uploading..."},CheckLen:function(e){var t=$(e).data("maxlength");var n=e.value.length;if(n==1&&e.value.substring(0,1)==" "){e.value="";n=0}if(n>t){e.value=e.value.substring(0,t);CharsLeft=0}else{CharsLeft=t-n}document.quoteform.Charleft.value=CharsLeft}};omerta.modules.City=$.extend({},omerta.core.Module,{TAB_FAM:"families",TAB_SPOT:"spot",spots:ko.observableArray(),top_families:ko.observableArray(),families:ko.observableArray(),houses:ko.observable(),visibleSpotContent:ko.observable("spot"),city_name:ko.observable(),selectedSpot:ko.observable(),load:function(){},prepareData:function(){this.selectedSpot(null);omerta.GUI.container.selectedTab("families");this.visibleSpotContent("spot");this.houses({});this.top_families([]);this.families([]);this.spots([]);if(this.__initSpots(this.data.spots)===false){throw"Empty spots"}if(this.__initFamilies(this.data.families)===false){throw"Empty Families"}this.__initHouses(this.data.houses);this.city_name(this.data.city_name);this.selectedSpot.subscribe(this.renderSelectedSpot);this.__initGameIntro(this.data.game_intro);delete this.data},__initSpots:function(e){if(_.isArray(e)===false&&_.isObject(e)===false){return false}if(_.isEmpty(e)){return true}this.spots([]);var t=ko.utils.arrayMap(e,function(e,t){e.key=t;return new omerta.modules.City.model.Spot(e)});this.spots.push.apply(this.spots,t);return true},__initFamilies:function(e){if(_.isArray(e)===false&&_.isObject(e)===false){return false}if(_.isEmpty(e)){return true}this.families([]);this.top_families([]);var t=0;for(t in e){var i=new omerta.modules.City.model.Family(e[t]);if(t<3){this.top_families.push(i)}else{this.families.push(i)}}return true},__initHouses:function(e){if(_.isArray(e)===false&&_.isObject(e)===false){return false}if(_.isEmpty(e)){return true}this.houses([]);var t=0;var i=0;for(t in e){var s=[];for(i in e[t]){s.push(new omerta.modules.City.model.House(e[t][i]))}e[t]=s}this.houses(e);return true},__initGameIntro:function(e){if(typeof omerta.modules.GameIntro==="undefined"){return false}if(_.isObject(e)===false){return false}if(_.isEmpty(e)){return true}if(typeof GameIntroOptions!=="undefined"&&typeof GameIntroOptions.shown!=="undefined"&&GameIntroOptions.shown===false){return false}setTimeout(function(){var t=omerta.modules.GameIntro.display(e);if(t===false){return false}},500)},renderSelectedSpot:function(e){omerta.GUI.container.selectedTab(omerta.modules.City.TAB_SPOT)},getUserCity:function(){var e=this.city_name();if(typeof e==="undefined"||e.length===0){return omerta.character.game.city()}return e},getLinkFamily:function(e,t){var i="/family.php?fam="+e;return'<a href="[LINK]">[NAME]</a>'.replace("[LINK]",i).replace("[NAME]",t)},getLinkUser:function(e){var t="/user.php?name="+e;return'<a href="[LINK]">[INGAME]</a>'.replace("[LINK]",t).replace("[INGAME]",e)},buySpot:function(){var e=this.selectedSpot();if(typeof e==="undefined"){return false}omerta.GUI.container.loadPage("/index.php?module=Family&action=create&familySpot="+e.ID())},toggleSpotInformation:function(e,t){var i=this.selectedSpot();if(typeof i==="undefined"){return false}var s=e.visibleSpotContent();if(s!=="spot"){var a="spot"}else{var a="houses"}e.visibleSpotContent(a)},calculatePercentage:function(e,t,i){t=parseInt(t);e=parseInt(e);i=Math.abs(parseInt(i))||0;if(t===0){return 0}var s=e*100/t;return Math.round(s,i)},citySpotRaidLink:function(e){var t=this.selectedSpot();if(typeof t==="undefined"){return false}var i=$(e);if(i.data("loaded-link")){return}var s=i.text();i.data("loaded-link",true);var a=parseInt(omerta.character.info.family());if(a===0){return}i.html('<a href="/index.php?module=Spots" class="raidActionLink">'+s+"</a>")},destroy:function(){this.spots=ko.observableArray([]);this.top_families=ko.observableArray([]);this.families=ko.observableArray([]);this.houses=ko.observable(null);this.visibleSpotContent=ko.observable("spot");this.city_name=ko.observable("");this.selectedSpot=ko.observable(null)}});omerta.modules.City.model.Family=function(t){var n=parseInt(function(){return t.id||0}());var i=parseInt(function(){return t.bossid||0}());this.name=function(){return t.name||""}().toString();this.color=function(){return t.color||""}().toString();this.worth=parseInt(function(){return t.worth||0}());this.city=parseInt(function(){return t.city||0}());this.num_spots=parseInt(function(){return t.family_spots||0}());this.num_users=parseInt(function(){return t.users||0}());this.donName=function(){return t.boss||""}().toString();this.imageUrl=function(t){t=t||"medium";return"/family_image.php?family="+n.toString()+"&size="+t};this.ribbonVisible=function(t){return n>0};this.ribbonUrl=function(t){t=parseInt(t)||1;return"/assets/omerta/modules/City/assets/img/ribbon-"+t+".png"};this.getFamilyId=function(){return n};this.getFamilyLink=function(){if(n<=0){return this.name}return omerta.modules.City.getLinkFamily(n,this.name)};this.getDonLink=function(){if(this.donName==="Local Gangster"){return this.donName}return omerta.modules.City.getLinkUser(this.donName)};this.getTerritoriesPercentage=function(){return omerta.modules.City.calculatePercentage(this.num_spots,omerta.modules.City.spots().length)}};omerta.modules.City.model.House=function(n){var e=function(){return n.urls||{}}();this.owner_name=function(){return n.owner_name||"Local Mob"}().toString();this.owner_id=parseInt(function(){return n.owner_id||0}());this.type=parseInt(function(){return n.house_type||0}());this.name=function(){return n.name||""}().toString();this.can_rent=Boolean(function(){return n.can_rent||false}());this.can_rent_villa=Boolean(function(){return n.can_rent_villa||false}());this.getOwnerLink=function(){var n=this.owner_name;if(this.owner_id===0){return n}return omerta.modules.City.getLinkUser(n)};this.getActionLink=function(){var n=omerta.character.info.name().toLowerCase()===this.owner_name.toLowerCase();if(n){return'<a class="house-action h-owned" href="'+e.mine+'">Owned</a>'}if(this.owner_id>0){return'<span class="house-action h-occupied">Occupied</span>'}if(this.can_rent===false){return'<span class="house-action h-disabled">Can\'t Rent</span>'}if(this.can_rent_villa===false&&this.type===100){return'<span class="house-action h-disabled">Limit reached</span>'}return'<a class="house-action h-rent" href="'+e.rent+'">Rent</a>'}};omerta.modules.City.model.Spot=function(t){var r=t.buyable||false;var e=t.can_buy||false;var i=t.can_e||false;var n=t.cdtc||"";var o=t.cid||0;var s=t.closed||"";var a=t.closed_reason||"";var u=t.closed_times||0;var f=t.color||"c6c6c6";var h=t.family||0;var c=t.owner||0;var l=t.ownerFamily||"Local Mob";var g=t.ownerName||"Local Gangster";var m=t.ownerRank||0;var p=t.pos_x||"";var v=t.pos_y||"";var y=t.profitFormat||0;var d=t.raid_last||0;var C=t.raid_next||0;var I=t.raid_protection||0;var S=t.spotName||"";var w=t.spot_profit||0;var F=t.type||"HQ";var N=t.key||0;var P=t.has_gift||false;this.ID=function(){return o};this.getPosX=function(){return parseInt(p)};this.getPosY=function(){return v};this.getSpotType=function(){return F};this.isBuyable=function(){return Boolean(e)};this.hasGift=function(){return Boolean(P)};this.isClosed=function(){return a.length!==0};this.getSpotName=function(){return S.toString()};this.getOwnerID=function(){return parseInt(c)};this.getFamilyID=function(){return parseInt(h)};this.getOwnerName=function(){return g.toString()};this.getOwnerLink=function(){var t=this.getOwnerName();if(this.getOwnerID()===0){return t}return omerta.modules.City.getLinkUser(t)};this.getOwnerRank=function(){if(this.getOwnerID()===0){return 0}return m};this.getFamilyLink=function(){var t=this.getFamilyID();if(t===0){return this.getFamilyName()}return omerta.modules.City.getLinkFamily(t,this.getFamilyName())};this.getFamilyName=function(){return l.toString()};this.getSpotProfit=function(){if(this.isClosed()){return 0}return parseInt(w)};this.formatSpotProfit=function(){var t=this.getSpotProfit();if(this.isClosed()){return a==="BR"?"Bankrupt":"Out of business"}return"$ "+t.format()};this.getProtection=function(){if(this.isClosed()){return 0}return I};this.colorBarProtection=function(){var t=this.getProtection();if(t<=0){return"transparent"}if(t<=20){return"#B41313"}if(t>20&&t<50){return"#C98B19"}return"#588527"};this.getFamilyColor=function(){if(h){return"#"+f}return false};this.getNextRaid=function(){var t=omerta.Clock.getTime()/1e3;var r=C-t;if(r<0){return 0}return r};this.getSpotColor=function(){if(h){return"customColor"}if(this.isBuyable()===false){return"gray"}return"green"};this.getClassName=function(){var t=["hq_box","row"+this.getPosY(),"column"+this.getPosX()];t.push(this.getSpotColor());if(this.isClosed()){t.push("closed")}if(this.getSpotType()!=="HQ"){t.push("spotWithImage")}if(this.hasGift()){t.push("hasGift")}t.push("spotType"+this.getSpotType());t.push("spotKey"+N);return t.join(" ")};this.getAccomodations=function(){var t=omerta.modules.City.houses();if(_.isObject(t)===false){return[]}if(_.isEmpty(t)){return[]}var r=t[this.ID()];if(_.isUndefined(r)){return[]}r.sort(function(t,r){return t.type-r.type}).reverse();return r};this.giftUrl=function(){return"/?module=City.Gift&action=claim&city_spot="+this.ID()}};omerta.modules.Desk={loader:'<div><i class="icon-spinner icon-spin icon-large">&nbsp;</i>&nbsp;Loading ...</div>',load:function(){$(document).on("change","#desk-ticket-category",function(){omerta.modules.Desk.toggleOptions(this)})},loadPopup:function(e,t){t.preventDefault();var o=$.ajax({url:"/?module=Desk&rt="+Math.random(),type:"GET",dataType:"json"});if(omerta.plugins.popups.isPrompted()){return false}$.prompt(omerta.modules.Desk.loader,{title:"Help & Support",buttons:{Cancel:false,Submit:true},submit:omerta.modules.Desk.createTicket,loaded:function(){$("#jqi_state0_buttonSubmit").hide();$(".jqimessage ").addClass("desk-popup")}});o.done(omerta.modules.Desk.renderPopup)},renderPopup:function(e,t){if(!_.isObject(e)){return false}if(typeof e.template==="undefined"){return false}if(_.isNull(e.template)){return false}$(".jqimessage").html(e.template);$(".desk-input-autofocus").focus();omerta.modules.Desk.toggleOptions($("#desk-ticket-category"))},createTicket:function(e,t,o,s){if(t==false){return null}e.preventDefault();$(".jqimessage").html(omerta.modules.Desk.loader);$("#jqi_state0_buttonSubmit").hide();var a=$.ajax({url:"/?module=Desk&action=create&rt="+Math.random(),type:"POST",dataType:"json",data:s});a.done(function(e){$(".jqimessage").html(e.template);if(e.data.success){$("#jqi_state0_buttonSubmit").remove()}else{omerta.modules.Desk.toggleOptions($("#desk-ticket-category"))}})},toggleOptions:function(e){var t=$(e);var o=t.val();var s=$(".desk-ticket-fields-wrapper");if(o.length>0){s.slideDown();$("#jqi_state0_buttonSubmit").show()}else{s.slideUp();$("#jqi_state0_buttonSubmit").hide()}}};omerta.modules.GameIntro={oIntro:null,load:function(){$(document).bind("omerta:loaded",function(){omerta.modules.GameIntro.displayFromBody()})},displayFromBody:function(){if(typeof GameIntroOptions==="undefined"){return false}if(!_.isObject(GameIntroOptions)){return false}if(typeof Modernizr!=="undefined"){if(Modernizr.mq("only screen and (min-width: 320px) and (max-width: 1024px)")){return false}}return omerta.modules.GameIntro.display(GameIntroOptions)},display:function(o){if(typeof introJs!=="function"){throw"Vendor IntroJS not loaded"}var e={steps:[]};$.extend(e,o);if(e.steps.length==0){return false}omerta.modules.GameIntro.oIntro=introJs();omerta.modules.GameIntro.oIntro.setOptions(e);omerta.modules.GameIntro.oIntro.start();omerta.modules.GameIntro.oIntro.oncomplete(function(o){$(document).trigger("omerta:intro:completed")});omerta.modules.GameIntro.oIntro.onexit(function(o){$(document).trigger("omerta:intro:closed")});omerta.modules.GameIntro.oIntro.onafterchange(function(o){$(document).trigger("omerta:intro:afterchange")});omerta.modules.GameIntro.oIntro.onchange(function(o){$(document).trigger("omerta:intro:change")});omerta.modules.GameIntro.oIntro.onbeforechange(function(o){$(document).trigger("omerta:intro:beforechange")});$(document).trigger("omerta:intro:created");return omerta.modules.GameIntro.oIntro}};omerta.modules.UserInformation=$.extend({},omerta.core.Module,{information:ko.observableArray([]),user:ko.observableArray([]),ranks:ko.observableArray([]),family:null,actions:ko.observableArray([]),actions_stats:ko.observableArray([]),currentRank:ko.observable(),bodyguards:ko.observableArray([]),hiredBodyguards:ko.observable(0),lackeys:ko.observableArray([]),hiredLackeys:ko.observable(0),possessions:ko.observable({}),selectedCityString:ko.observable(null),citiesMap:{0:"Detroit",1:"Chicago",3:"New York",4:"Las Vegas",5:"Philadelphia",6:"Baltimore",7:"Corleone",2:"Palermo"},citiesArray:function(e){var r=$.map(this.citiesMap,function(e){return e});if(typeof e==="undefined"){e=false}if(e){r.unshift(null)}return r},load:function(){},destroy:function(){this.unsubscribeTickings();this.information=ko.observableArray([]);this.user=ko.observableArray([]);this.ranks=ko.observableArray([]);this.family=null;this.actions=ko.observableArray([]);this.actions_stats=ko.observableArray([]);this.currentRank=ko.observable();this.bodyguards=ko.observableArray([]);this.hiredBodyguards=ko.observable(0);this.lackeys=ko.observableArray([]);this.hiredLackeys=ko.observable(0);this.possessions=ko.observable({});this.selectedCityString=ko.observable(null)}});omerta.modules.UserInformation.USER_ALLOWED_HOURS=34;omerta.modules.UserInformation.model.ActionStat=function(t){var e=t.type||"",r=t.value||0,n=t.title||"";this.getAttributesForWrapper=function(){return{"class":"action-info-item action-info-"+e}};this._getVal=function(){return r};this.getShortValue=function(){return this.getValue(true)};this.getTitle=function(){return n};this.getTip=function(){return this.getTitle()+": "+this.getValue(false)};this.getValue=function(t){if(typeof t==="undefined"){t=false}var e=this._getVal();if(typeof e==="object"){if(e.length===2&&t===true){return number2text_format(e[0])+" ("+number2text_format(e[1])+")"}if(e.length===2&&t===false){return number_format(e[0])+" ("+number_format(e[1])+")"}return e.join(" / ")}if(t===true){e=number2text_format(e)}else{e=number_format(e)}return e}};omerta.modules.UserInformation.model.MarketItem=function(e){var t=e.name_owned||"",n=e.name_unowned||"",i=e.name_manage||"",r=e.owned||"",u=e.description||"",s=e.href||"",o=e.cities||null,a=e.image||"",f=e.blocked||false,h=e.type||"",c=e.value||0,l=e.city_values||[];this.getName=function(){return t};this.getDescription=function(){return u};this.getImage=function(){return a};this.getBuyName=function(){return n};this.getManageName=function(){return i};this.getHref=function(){return s};this.loadAction=function(){omerta.GUI.container.loadPage(this.getHref())};this.owned=function(){return r?true:false};this.notOwned=function(){return!this.owned()};this.blocked=function(){return f?true:false};this.notBlocked=function(){return!this.blocked()};this.getCities=function(){return o};this.getMainAttrs=function(){var e=["character-wrapper"];if(this.owned()){e.push("owned")}else{e.push("unowned")}if(this.blocked()){e.push("blocked")}return{"class":e.join(" ")}};this.getType=function(){return this.type};this.getTitle=function(){if(this.owned()){return this.getName()}return this.getBuyName()};this.getValue=function(){return c};this.getCitiesValues=function(){return l||[]};this.valueByCity=ko.pureComputed(function(){var e=omerta.modules.UserInformation.selectedCityValue();var t=this.getCitiesValues();if(typeof t[e]!=="undefined"){return t[e]}return this.getValue()},this);this.getCitiesNames=function(){var e=this.getCities()||[],t=[];if(typeof e==="undefined"){return false}if(e.length==0){return false}_.each(e,function(e,n){t.push(omerta.modules.UserInformation.citiesMap[e])});return t}};omerta.modules.UserInformation.model.UserAction=function(t){var e=t.type||"";var i=t.title||"";var r=t.image||"";var n=t.href||"";var o=t.blocked||[];var a=t.total_time||0;this.time_end=ko.observable(parseInt(t.time_end||0));this.time_left=ko.computed(function(){var t=omerta.Clock.date();return omerta.Clock.getTimeLeft(this.time_end())},this).extend({rateLimit:1e3});this.timeSubscriber=0;this.getType=function(){return e};this.getTitle=function(){return i};this.getImage=function(){return r};this.getHref=function(){return n};this.getTotalTime=function(){return parseInt(a)};this.getBlocked=function(){return o};this.getLockedReason=function(){var t=this.getBlocked();if(typeof t==="object"){if(typeof t.value==="string"&&t.value.length>0){return t.value}}return false};this.getTemplateName=ko.computed(function(){if(this.time_left()>0){return"timer"}if(this.getLockedReason()){return"locked"}return"normal"},this);this.loadAction=function(){omerta.GUI.container.loadPage(this.getHref())}};omerta.modules.UserInformation.model.UserFamily=function(t){var n=t.family_id||0;var r=t.user_capomoney||0;var e=t.family_name||"";var i=t.boss_id||0;var a=t.sotto_id||0;var s=t.consig_id||0;var o=t.capo_id||0;var u=t.boss_name||"";var c=t.sotto_name||"";var h=t.consig_name||"";var f=t.capo_name||"";var m=t.bank||0;var g=t.rank||0;var l=t.hq||0;var p=t.count_members||0;var v=t.role||"";var I=t.role_text||"";this.getFamilyId=function(){return parseInt(n)};this.getUserCapoMoney=function(){return parseInt(r)};this.getFamilyName=function(){return e};this.getBossId=function(){return parseInt(i)};this.getSottoId=function(){return parseInt(a)};this.getConsigId=function(){return parseInt(s)};this.getCapoId=function(){return parseInt(o)};this.getBossName=function(){return u};this.getSottoName=function(){return c};this.getConsigName=function(){return h};this.getCapoName=function(){return f};this.getBank=function(){return parseInt(m)};this.getRank=function(){return parseInt(g)};this.countHQ=function(){return parseInt(l)};this.countMembers=function(){return parseInt(p)};this.hasFamily=function(){return this.getFamilyId()>0};this.hasLinkUser=function(t){return t>0};this.isFamless=function(){return!this.hasFamily()};this.getRole=function(){return v};this.getRoleText=function(){return I};this.familyUrl=function(){return"/family.php?fam="+this.getFamilyId()};this.userUrl=function(t){if(t.length>0){return"/user.php?nick="+t}return"javascript:void(0)"};this.userName=function(t){if(t.length>0){return t}return"None"}};omerta.modules.UserInformation.model.UserRank=function(e){var t=e.id||0;var n=e.completed||false;var r=e.current||false;var s=e.gender||"male";var i=e.image||"/assets/omerta/modules/UserInformation/assets/img/ranks/empty-suite-male.png";var o=e.name||"Empty-Suite";var a=e.achievements||[];this.getID=function(){return parseInt(t)};this.isCompleted=function(){return Boolean(n)};this.isCurrent=function(){return Boolean(r)};this.getGender=function(){return s};this.getImage=function(){return i};this.getName=function(){return o};this.achievements=function(){return a};this.getContentClass=function(){var e=["assasin-content","rank-outglow"];if(this.isCurrent()){e.push("outglow-white")}else{if(this.isCompleted()){e.push("outglow-green")}else{e.push("outglow-red")}}return e.join(" ")}};omerta.modules.UserInformation.prepareData=function(){this.__initUserRanks(this.data.ranks);this.__initGeneralInformation(this.data.info);this.__initUserInformation(this.data.user);this.__initUserFamily(this.data.family);this.__initActionStats(this.data.actions_stats);this.__initActions(this.data.actions);this.__initBodyguards(this.data.bodyguards);this.__initLackeys(this.data.lackeys);this.__initPossessions(this.data.possessions);setTimeout(function(){$("#game_wrapper_container").height("99%")},500)};omerta.modules.UserInformation.afterRender=function(){};omerta.modules.UserInformation.__initGeneralInformation=function(e){if(_.isArray(e)===false&&_.isObject(e)===false){return false}if(_.isEmpty(e)){return true}omerta.modules.UserInformation.information(e);omerta.character.info.dc_level(e.level);omerta.character.info.testament(e.testament);omerta.character.game.city(e.city);return true};omerta.modules.UserInformation.__initUserInformation=function(e){if(_.isArray(e)===false&&_.isObject(e)===false){return false}if(_.isEmpty(e)){return true}omerta.modules.UserInformation.user(e);omerta.character.progress.health(e.health);omerta.character.progress.rank_progress(e.rank_progress);omerta.character.progress.bustskill(e.jailbusting_skill);omerta.character.progress.raceform(e.race_form);omerta.character.progress.honorpoints(e.honorpoints);omerta.character.progress.money(e.money);omerta.character.progress.bank(e.bank);omerta.character.progress.bullets(e.bullets);return true};omerta.modules.UserInformation.__initUserFamily=function(e){if(_.isArray(e)===false&&_.isObject(e)===false){return false}if(_.isEmpty(e)){return true}this.family=new omerta.modules.UserInformation.model.UserFamily(e)};omerta.modules.UserInformation.__initUserRanks=function(e){omerta.modules.UserInformation.ranks([]);if(_.isArray(e)===false&&_.isObject(e)===false){return false}if(_.isEmpty(e)){return true}for(var r=0 in e){var t=new omerta.modules.UserInformation.model.UserRank(e[r]);if(e[r].current){omerta.modules.UserInformation.currentRank(t)}omerta.modules.UserInformation.ranks.push(t)}};omerta.modules.UserInformation.__initActionStats=function(e){omerta.modules.UserInformation.actions_stats([]);if(_.isArray(e)===false&&_.isObject(e)===false){return false}if(_.isEmpty(e)){return true}var r=ko.utils.arrayMap(e,function(e){return new omerta.modules.UserInformation.model.ActionStat(e)});omerta.modules.UserInformation.actions_stats.push.apply(omerta.modules.UserInformation.actions_stats,r)};omerta.modules.UserInformation.__initActions=function(e){omerta.modules.UserInformation.actions([]);if(_.isArray(e)===false&&_.isObject(e)===false){return false}if(_.isEmpty(e)){return true}var r=ko.utils.arrayMap(e,function(e){return new omerta.modules.UserInformation.model.UserAction(e)});omerta.modules.UserInformation.actions.push.apply(omerta.modules.UserInformation.actions,r)};omerta.modules.UserInformation.__initBodyguards=function(e){omerta.modules.UserInformation.bodyguards([]);if(_.isArray(e)===false&&_.isObject(e)===false){return false}if(_.isEmpty(e)){return true}var r=0;for(var t=0 in e){var o=new omerta.modules.UserInformation.model.MarketItem(e[t]);if(o.owned()){r+=1}omerta.modules.UserInformation.bodyguards.push(o)}omerta.modules.UserInformation.bodyguards.sort(function(e,r){return e.notBlocked()&&r.blocked()?-1:1});omerta.modules.UserInformation.hiredBodyguards(r)};omerta.modules.UserInformation.__initLackeys=function(e){omerta.modules.UserInformation.lackeys([]);if(_.isArray(e)===false&&_.isObject(e)===false){return false}if(_.isEmpty(e)){return true}var r=0;for(var t=0 in e){var o=new omerta.modules.UserInformation.model.MarketItem(e[t]);if(o.owned()){r+=1}omerta.modules.UserInformation.lackeys.push(o)}omerta.modules.UserInformation.hiredLackeys(r)};omerta.modules.UserInformation.__initPossessions=function(e){omerta.modules.UserInformation.possessions({});if(_.isArray(e)===false&&_.isObject(e)===false){return false}if(_.isEmpty(e)){return true}var r={};for(var t=0 in e){var o=e[t].type||"";r[o]=new omerta.modules.UserInformation.model.MarketItem(e[t])}omerta.modules.UserInformation.possessions(r)};omerta.modules.UserInformation.getDcValues=ko.pureComputed(function(){var e={"class":"pull-right status-donator",text:"Not a Donator",href:"/?module=Donate.Methods"};var r=omerta.character.info.dc_level();switch(r){case 1:e.text="DC Member";break;case 2:e.text="DC + Member";break;default:r=0;break}e.class+=" status-"+r;return e});omerta.modules.UserInformation.getTestamentName=function(){var e=omerta.character.info.testament();return e.length>0?e:false};omerta.modules.UserInformation.selectedCityValue=ko.computed(function(){var e=omerta.modules.UserInformation.selectedCityString();var r=omerta.modules.UserInformation.citiesMap;var t=-1;for(var o in r){var a=r[o];if(e===a){t=o;break}}return parseInt(t)},this);omerta.modules.UserInformation.getOnlineStats=ko.pureComputed(function(){var e=omerta.modules.UserInformation.information();var r=parseInt(e["online_seconds"]);var t=[],o=r/60,a=o/60;if(a>=omerta.modules.UserInformation.USER_ALLOWED_HOURS){t.push("text-red")}else{t.push("text-green")}var s={text:Math.round(a)+" HRS",timeleft:e["account_time"],attrs:{"class":t.join(" ")}};return s});omerta.modules.UserInformation.getUserProtection=function(){var e=omerta.modules.UserInformation.information(),r=[],t="none";var o=parseInt(e["protection_user"]||0),a=parseInt(e["protection_family"]||0);r.push("text-green");var s=0;if(o>0){s=o;t="startdate"}if(a>0&&o<=0){s=a;t="family"}var n={text:"",type:t,visible:t!="none",attrs:{"class":r.join(" "),"data-time-end":s}};return n};omerta.modules.UserInformation.getTotalCredits=function(){var e=omerta.modules.UserInformation.user();if(typeof e["credits"]==="undefined"){return 0}return number_format(e["credits"])};omerta.modules.UserInformation.updateActionTimer=function(e,r,t){if(this.actions().length<=0){return false}for(var o in this.actions()){if(e!=this.actions()[o].getType()){continue}if(this.actions()[o].time_left()>0){break}this.actions()[o].time_end(r)}};omerta.GUI.container.selectedTab.subscribe(function(e){if(e=="account-mobile-character"||e==="overview"){var r=$("#bxslider");if(r.length>0){setTimeout(function(){var e=r.data("boxSlider");if(e){e.reloadSlider()}},200)}}});omerta.modules.UserInformation.unsubscribeTickings=function(){var e=this.actions();for(var r=0 in e){if(typeof e[r].getTemplateName!=="undefined"){e[r].getTemplateName.dispose();e[r].time_left.dispose()}}};omerta.modules.Forum=$.extend({},omerta.core.Module,{template:"core_popup",loading:ko.observable(true),load:function(){},init:function(){this.bind="omerta.modules.Forum";this.loading(true);this.show()},getForums:function(){omerta.server.query("GET","Forum",null,{},function(e){})},previewPost:function(e){var t=$("#post"),o=$("#preview"),a=$(e),r=t.val(),i=a.data("originaltext"),n=a.data("loading"),s=a.data("closepreview"),l=a.val();if(t.is(":hidden")){t.show();o.css("minHeight",0).hide();a.val(i);return true}if(r.length===0){return false}$jqxhr=$.ajax({url:"/forums/preview_ajax.php",contentType:"text/xml",processData:false,type:"POST",data:r});a.val(n).attr("disabled",true);$jqxhr.done(function(e){var a=t.height();t.hide();o.html(e).css("minHeight",a+"px").show()});$jqxhr.always(function(){a.val(s).removeAttr("disabled")})},replyToPost:function(e){var t=$("#post-bottom"),o=$("#post_"+e),a=o.val();t.val(a).focus()},goToTopic:function(e){var t="/forums/view-topic.php?id="+e;return omerta.GUI.container.loadPage(t)}});omerta.modules.Develop={load:function(){},loadPopup:function(e,t){t.preventDefault();var o=$.ajax({url:"/?module=Develop&rt="+Math.random(),type:"GET",dataType:"json"});o.done(omerta.modules.Develop.renderPopup)},renderPopup:function(e,t){if(!_.isObject(e)){return false}if(typeof e.template==="undefined"){return false}if(_.isNull(e.template)){return false}omerta.plugins.popups.prompt(e.template,{title:"Develop toolbox",buttons:{Cancel:false,Setup:true},submit:omerta.modules.Develop.setupAccount})},setupAccount:function(e,t,o,a){if(t==false){return null}e.preventDefault();var l=$.ajax({url:"/?module=Develop&action=Save&rt="+Math.random(),type:"GET",dataType:"json",data:a});l.done(function(){$.prompt.close()})}};